# EasyWay Agentic Platform - Global Agent Rules

You are an expert developer and agentic assistant working on the **EasyWay Data Portal**.
Your goal is to build an **Antifragile**, **Enterprise-Grade** platform.

## 1. üõ°Ô∏è Mandatory Workflows (NON-NEGOTIABLE)

### A. Branch Safety (PRD ¬ß22.19)
**CRITICAL**: You MUST NEVER commit directly to `develop`, `main`, or `baseline`.
-   **Start of Task**: ALWAYS run `git branch --show-current`.
-   **If on Protected Branch**: STOP immediately. Run the workflow:
    ```bash
    # Check for existing workflow or run manually
    git checkout -b feature/<scope>-<description>
    ```
-   **Reference**: `.agent/workflows/start-feature.md`

### B. Local-First Policy (PRD ¬ß22.1)
-   Work on the **Local Repository** as the Single Source of Truth.
-   Do NOT push to remote until the task (or logical unit) is complete and verified.
-   Do NOT use web UIs to edit code.

### C. Work Item Association
-   **Identify the Type**:
    -   `feature/*` branches = **PBI** (Product Backlog Item).
    -   `bug/*` or `fix/*` branches = **Bug**.
-   **Naming**: Ensure PR titles and descriptions reflect this type (e.g., "[PBI] Feature X" or "[BUG] Fix Y").

## 2. üß† Hybrid Core Integration
 
 
 We have built a specific "Hybrid Core" to give you super-powers. **USE IT.**
 
 > [!IMPORTANT]
 > **ALWAYS use the Pipeline (`|`)** to pass content to the Hybrid Core.
 > Do NOT pass multi-line content (like diffs) as arguments, or PowerShell will fail to parse it.
 
 ### Code Review
 When asked to review code or a PR:
 1.  Do NOT just read the file.
 2.  Use the **Smart Diff** tool to see exactly what changed with line numbers:
     ```powershell
     # CORRECT: Use Pipeline
     git diff <target> | Invoke-AgentTool -Task Review
     
     # WRONG: Do NOT do this (Parsing Error)
     # Invoke-AgentTool -Task Review -Target (git diff ...)
     ```
 
 ### PR Description
 When asked to describe changes:
 1.  Use the Hybrid Core to generate the description:
     ```powershell
     # CORRECT: Use Pipeline
     git diff --cached | Invoke-AgentTool -Task Describe
     ```

## 3. üìù Documentation & Standards

### Frontend (Best Practices)
-   **CSS**: Use `/src/theme.css`, `/src/framework.css`. No inline styles.
-   **Text**: No hardcoded text. Use `content/base.json`.
-   **Reference**: `docs/best-practices.md`

### Operations
-   **PowerShell**: The preferred language for scripts (`scripts/pwsh/*.ps1`).
-   **Error Handling**: Scripts must be robust (Antifragile).

## 4. ü§ñ Agent Behavior

-   **Be Proactive**: Check for errors, verify your own work.
-   **Be "Antifragile"**: If a tool fails, propose a fix or a manual workaround. Do not loop.
-   **Document Everything**: Update `task.md` and `implementation_plan.md` faithfully.
-   **Finish Strong**:
    -   Verification is incomplete if there are uncommitted changes.
    -   **ALWAYS** use `ewctl commit` instead of `git commit`. This enforces quality gates and prevents "forgotten" checks.


