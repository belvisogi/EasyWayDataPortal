{
  "id": "kv.secret.set",
  "what": {
    "purpose": "Impostare/ruotare un secret in Azure Key Vault in modo governato e auditabile, senza mai esporre il valore nei log.",
    "inputs": {
      "vaultName": { "type": "string" },
      "secretName": { "type": "string" },
      "secretValue": { "type": "string", "description": "Valore segreto (non deve mai finire nei log/markdown)." },
      "tags": { "type": "object" },
      "whatIf": { "type": "boolean", "default": true },
      "nonInteractive": { "type": "boolean", "default": false },
      "correlationId": { "type": "string" }
    },
    "outputs": {
      "ok": { "type": "boolean" },
      "vaultName": { "type": "string" },
      "secretName": { "type": "string" },
      "secretUri": { "type": "string" },
      "appSettingReference": { "type": "string" }
    },
    "events": ["kv.secret.set.started", "kv.secret.set.completed"],
    "success_criteria": ["Secret scritto in Key Vault (se whatIf=false)", "Nessuna esposizione del valore nei log/output"],
    "failure_criteria": ["az CLI mancante", "Permessi insufficienti", "Input incompleto"]
  }
}
