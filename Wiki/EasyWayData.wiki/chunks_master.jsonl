{"doc_id":"agent-manifest-indexing-best-practices","path":"agent-manifest-and-indexing-best-practices.md","title":"Agent Manifest & Indexing - Best Practices","owner":"team-docs","tags":["best-practices","ai-readiness","layer/reference","universal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Obiettivo\r","anchor_slug":"obiettivo","chunk_index":1,"content":"## Obiettivo\r\nPermettere a qualsiasi agente di localizzare rapidamente i contenuti rilevanti senza aprire interi file, riducendo i token. Si basa su tre artefatti sempre presenti alla radice:\n\n- `index_master.jsonl` (manifest per agenti)\r\n- `index_master.csv` (filtri rapidi per umani/Excel)\r\n- `anchors_master.csv` (mappe verso sezioni H2/H3)","size_chars":343,"tokens_estimate":86}
{"doc_id":"agent-manifest-indexing-best-practices","path":"agent-manifest-and-indexing-best-practices.md","title":"Agent Manifest & Indexing - Best Practices","owner":"team-docs","tags":["best-practices","ai-readiness","layer/reference","universal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Manifest JSONL (consumo per agenti)\r","anchor_slug":"manifest-jsonl-consumo-per-agenti","chunk_index":2,"content":"## Manifest JSONL (consumo per agenti)\r\nOgni riga √® un documento con campi:\r\n- `id`, `title`, `summary` (‚â§50 parole), `path`, `format` (md|html|confluence|notion|gdoc|pdf)\r\n- `owner`, `tags[]`, `entities[]`, `llm.include`, `llm.pii`, `chunk_hint`, `updated`\r\n- `questions_answered[]` (se estratte), `anchors[]` (H2/H3: `level,text,slug`)\n\nStrategia d‚Äôuso:\r\n- Caricare `index_master.jsonl` all‚Äôavvio della sessione.\r\n- Filtrare per `tags`, `entities`, `owner`, `format` per ridurre il set.\r\n- Aprire i file solo quando serve e con deep‚Äëlink a `#slug` partendo da `anchors[]`.\r\n- Rispettare `llm.include` e `llm.pii` quando si propagano i contenuti.","size_chars":647,"tokens_estimate":162}
{"doc_id":"agent-manifest-indexing-best-practices","path":"agent-manifest-and-indexing-best-practices.md","title":"Agent Manifest & Indexing - Best Practices","owner":"team-docs","tags":["best-practices","ai-readiness","layer/reference","universal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Anchors CSV (richiami di sezione)\r","anchor_slug":"anchors-csv-richiami-di-sezione","chunk_index":3,"content":"## Anchors CSV (richiami di sezione)\r\n`anchors_master.csv` espone righe: `path,level,slug,text`. Gli agenti possono:\r\n- Costruire URL locali o web con `path#slug`.\r\n- Selezionare solo le sezioni richieste dall‚Äôutente (es. ‚ÄúIAM‚Äù, ‚ÄúPolicy‚Äù).","size_chars":239,"tokens_estimate":60}
{"doc_id":"agent-manifest-indexing-best-practices","path":"agent-manifest-and-indexing-best-practices.md","title":"Agent Manifest & Indexing - Best Practices","owner":"team-docs","tags":["best-practices","ai-readiness","layer/reference","universal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Compatibilit√† multi‚Äëformato\r","anchor_slug":"compatibilit-multiformato","chunk_index":4,"content":"## Compatibilit√† multi‚Äëformato\r\n- Markdown/Wiki: `path` relativo e `format=md`. `anchors[]` popolato.\r\n- Confluence/Notion/GDocs/HTML/PDF: usare `url` (se disponibile) e `format`. `anchors[]` facoltativo.","size_chars":204,"tokens_estimate":51}
{"doc_id":"agent-manifest-indexing-best-practices","path":"agent-manifest-and-indexing-best-practices.md","title":"Agent Manifest & Indexing - Best Practices","owner":"team-docs","tags":["best-practices","ai-readiness","layer/reference","universal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Come generare gli artefatti\r","anchor_slug":"come-generare-gli-artefatti","chunk_index":5,"content":"## Come generare gli artefatti\r\n- CSV + JSONL + Anchors:\r\n  - `EasyWayData.wiki/scripts/generate-master-index.ps1 -Root EasyWayData.wiki`","size_chars":137,"tokens_estimate":34}
{"doc_id":"agent-manifest-indexing-best-practices","path":"agent-manifest-and-indexing-best-practices.md","title":"Agent Manifest & Indexing - Best Practices","owner":"team-docs","tags":["best-practices","ai-readiness","layer/reference","universal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Buone pratiche\r","anchor_slug":"buone-pratiche","chunk_index":6,"content":"## Buone pratiche\r\n- Aggiungere sempre `summary`, `tags`, `entities` e la sezione ‚ÄúDomande a cui risponde‚Äù.\r\n- Tenere `chunk_hint` tra 300‚Äì600 token per pagine generaliste.\r\n- Evitare log e output estesi nelle pagine principali: spostarli in allegati.","size_chars":251,"tokens_estimate":63}
{"doc_id":"agent-manifest-indexing-best-practices","path":"agent-manifest-and-indexing-best-practices.md","title":"Agent Manifest & Indexing - Best Practices","owner":"team-docs","tags":["best-practices","ai-readiness","layer/reference","universal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":7,"content":"## Domande a cui risponde\r\n- Come pu√≤ un agente sapere ‚Äúcosa aprire‚Äù senza leggere tutto?\r\n- Come ridurre i token usando ancore e manifest?\r\n- Come uniformare l‚Äôaccesso ai contenuti tra progetti/formati diversi?","size_chars":211,"tokens_estimate":53}
{"doc_id":"ew-agents-governance","path":"agents-governance.md","title":"agents-governance","owner":"team-platform","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T18:41:16+02:00","section_level":2,"anchor_text":"agents-governance","anchor_slug":"agents-governance","chunk_index":1,"content":"Visione\n- Agenti specializzati (DBA, Frontend, AMS, Governance) coordinati da un control plane (Azure DevOps) con policy, gates e audit.\n\nRuoli\n- Agent_DBA: migrazioni Flyway, drift, ERD/SP docs, RLS rollout\n- Agent_Frontend: mini‚Äëportal, branding, MSAL wiring\n- Agent_AMS: esecuzione ricette KB, setup env, checklist, variable group\n- Agent_Governance: policy, qualit√†, gates (Checklist/Drift/KB), approvazioni\n\nPolicy & Manifests\n- `agents/<role>/manifest.json`: scope path, tools ammessi, gates richiesti, approvazioni\n- KB operativa: `agents/kb/recipes.jsonl` (JSONL) consumabile via `/api/docs/kb.json`\n\nGates in pipeline (ADO)\n- Pre‚ÄëDeploy Checklist: verifica env/connessioni e OpenAPI\n- DB Drift Check: oggetti richiesti presenti\n- KB Consistency: se cambiano `db/**` o `src/**`, obbligo aggiornamento KB + Wiki\n- (Opz.) Flyway Migrate Dev/Test: esegue validate/migrate con variabili Flyway\n\nChatOps (opzionali)\n- Teams/Logic Apps per comandi semplici; l‚Äôagente usa la KB e pubblica artifact (checklist.json/drift.json)\n\nAudit & Osservabilit√†\n- `PORTAL.LOG_AUDIT` per eventi agent; Application Insights/OTel per tracing e KPI (in roadmap)","size_chars":1145,"tokens_estimate":286}
{"doc_id":"best-practices-token-tuning-roadmap","path":"best-practices-token-tuning-roadmap.md","title":"Best Practices & Roadmap ‚Äì Token Tuning, AI-Readiness e Governance Universale","owner":"team-docs","tags":["best-practices","roadmap","token-tuning","ai-readiness","quality","documentation","universal","governance","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Obiettivo\r","anchor_slug":"obiettivo","chunk_index":1,"content":"## Obiettivo\r\nFornire linee guida e una roadmap universale per ottimizzare qualsiasi knowledge base o documentazione tecnica (di progetto, aziendale, open source, ecc.) in ottica di riduzione token, modularit√†, chunking, AI-readiness e governance, a prescindere dal formato (Markdown, Wiki, Confluence, Notion, Google Docs, HTML, ecc.).\n\n---","size_chars":341,"tokens_estimate":85}
{"doc_id":"best-practices-token-tuning-roadmap","path":"best-practices-token-tuning-roadmap.md","title":"Best Practices & Roadmap ‚Äì Token Tuning, AI-Readiness e Governance Universale","owner":"team-docs","tags":["best-practices","roadmap","token-tuning","ai-readiness","quality","documentation","universal","governance","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"1. Best Practices per la Riduzione Token e l‚ÄôAI-Readiness\r","anchor_slug":"1-best-practices-per-la-riduzione-token-e-lai-readiness","chunk_index":2,"content":"## 1. Best Practices per la Riduzione Token e l‚ÄôAI-Readiness\n\n- **Pagine brevi e modulari:** Suddividi i documenti lunghi in molte pagine o sezioni tematiche, ognuna focalizzata su un solo argomento.\r\n- **Heading/sezioni chiare:** Usa heading (H2/H3, titoli, sezioni) per separare i concetti e facilitare lo split automatico in chunk.\r\n- **Sintesi e rimozione ridondanze:** Elimina ripetizioni, frasi inutili, spiegazioni duplicate.\r\n- **Summary e metadati ricchi:** Ogni pagina/sezione deve avere un riassunto breve e preciso, tag e metadati per il filtraggio (dove supportato).\r\n- **Esempi e codice essenziali:** Includi solo esempi utili e rappresentativi, sposta quelli estesi in allegati o pagine dedicate.\r\n- **Export e chunking automatico:** Usa strumenti/script per generare file chunked (es. JSONL, CSV, API, ecc.) con chunk da 400‚Äì600 token.\r\n- **Evita allegati testuali pesanti:** Log e output estesi vanno in file separati o allegati, non nelle pagine principali.\r\n- **Controllo periodico:** Esegui script o tool di stima token e report chunk troppo lunghi.\n\n---","size_chars":1074,"tokens_estimate":268}
{"doc_id":"best-practices-token-tuning-roadmap","path":"best-practices-token-tuning-roadmap.md","title":"Best Practices & Roadmap ‚Äì Token Tuning, AI-Readiness e Governance Universale","owner":"team-docs","tags":["best-practices","roadmap","token-tuning","ai-readiness","quality","documentation","universal","governance","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"2. Applicazione alle Principali Varianti di Formato\r","anchor_slug":"2-applicazione-alle-principali-varianti-di-formato","chunk_index":3,"content":"## 2. Applicazione alle Principali Varianti di Formato","size_chars":54,"tokens_estimate":14}
{"doc_id":"best-practices-token-tuning-roadmap","path":"best-practices-token-tuning-roadmap.md","title":"Best Practices & Roadmap ‚Äì Token Tuning, AI-Readiness e Governance Universale","owner":"team-docs","tags":["best-practices","roadmap","token-tuning","ai-readiness","quality","documentation","universal","governance","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Markdown/Wiki (GitHub, GitLab, Docusaurus, Obsidian, ecc.)\r","anchor_slug":"markdownwiki-github-gitlab-docusaurus-obsidian-ecc","chunk_index":4,"content":"### Markdown/Wiki (GitHub, GitLab, Docusaurus, Obsidian, ecc.)\r\n- Struttura i file in cartelle tematiche.\r\n- Usa heading H2/H3 per chunking.\r\n- Inserisci front matter YAML/JSON (se supportato) per summary e tag.\r\n- Automatizza export e linting con script (es. PowerShell, Python).","size_chars":280,"tokens_estimate":70}
{"doc_id":"best-practices-token-tuning-roadmap","path":"best-practices-token-tuning-roadmap.md","title":"Best Practices & Roadmap ‚Äì Token Tuning, AI-Readiness e Governance Universale","owner":"team-docs","tags":["best-practices","roadmap","token-tuning","ai-readiness","quality","documentation","universal","governance","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Confluence/Notion/Wiki SaaS\r","anchor_slug":"confluencenotionwiki-saas","chunk_index":5,"content":"### Confluence/Notion/Wiki SaaS\r\n- Crea pagine brevi e collegate tramite link.\r\n- Usa template di pagina con campi summary/tag.\r\n- Sfrutta le API per esportare e analizzare i contenuti.\r\n- Organizza la knowledge base in spazi e sezioni tematiche.","size_chars":246,"tokens_estimate":62}
{"doc_id":"best-practices-token-tuning-roadmap","path":"best-practices-token-tuning-roadmap.md","title":"Best Practices & Roadmap ‚Äì Token Tuning, AI-Readiness e Governance Universale","owner":"team-docs","tags":["best-practices","roadmap","token-tuning","ai-readiness","quality","documentation","universal","governance","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Google Docs/Office/Word\r","anchor_slug":"google-docsofficeword","chunk_index":6,"content":"### Google Docs/Office/Word\r\n- Usa titoli e sottotitoli per separare i chunk.\r\n- Inserisci un abstract/summary all‚Äôinizio di ogni documento.\r\n- Separa gli allegati/log in file a parte.\r\n- Esporta in formato testuale (txt, csv, json) per analisi token.","size_chars":251,"tokens_estimate":63}
{"doc_id":"best-practices-token-tuning-roadmap","path":"best-practices-token-tuning-roadmap.md","title":"Best Practices & Roadmap ‚Äì Token Tuning, AI-Readiness e Governance Universale","owner":"team-docs","tags":["best-practices","roadmap","token-tuning","ai-readiness","quality","documentation","universal","governance","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"HTML/Portali Web\r","anchor_slug":"htmlportali-web","chunk_index":7,"content":"### HTML/Portali Web\r\n- Struttura i contenuti in pagine e sezioni ben delimitate.\r\n- Usa tag <section>, <h2>, <h3> per chunking.\r\n- Inserisci metadati nei tag <meta> o in header strutturati.\r\n- Automatizza l‚Äôestrazione con scraper o API.","size_chars":237,"tokens_estimate":59}
{"doc_id":"best-practices-token-tuning-roadmap","path":"best-practices-token-tuning-roadmap.md","title":"Best Practices & Roadmap ‚Äì Token Tuning, AI-Readiness e Governance Universale","owner":"team-docs","tags":["best-practices","roadmap","token-tuning","ai-readiness","quality","documentation","universal","governance","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Altri formati (PDF, LaTeX, ecc.)\r","anchor_slug":"altri-formati-pdf-latex-ecc","chunk_index":8,"content":"### Altri formati (PDF, LaTeX, ecc.)\r\n- Segmenta i contenuti in capitoli e sezioni.\r\n- Inserisci sommari e indici.\r\n- Esporta in formato testuale per analisi e chunking.\n\n---","size_chars":174,"tokens_estimate":44}
{"doc_id":"best-practices-token-tuning-roadmap","path":"best-practices-token-tuning-roadmap.md","title":"Best Practices & Roadmap ‚Äì Token Tuning, AI-Readiness e Governance Universale","owner":"team-docs","tags":["best-practices","roadmap","token-tuning","ai-readiness","quality","documentation","universal","governance","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"3. Roadmap Universale per Token Tuning, AI-Readiness e Governance\r","anchor_slug":"3-roadmap-universale-per-token-tuning-ai-readiness-e-governance","chunk_index":9,"content":"## 3. Roadmap Universale per Token Tuning, AI-Readiness e Governance","size_chars":68,"tokens_estimate":17}
{"doc_id":"best-practices-token-tuning-roadmap","path":"best-practices-token-tuning-roadmap.md","title":"Best Practices & Roadmap ‚Äì Token Tuning, AI-Readiness e Governance Universale","owner":"team-docs","tags":["best-practices","roadmap","token-tuning","ai-readiness","quality","documentation","universal","governance","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"3.1 Razionalizzazione e Pulizia (Fase 1)\r","anchor_slug":"31-razionalizzazione-e-pulizia-fase-1","chunk_index":10,"content":"### 3.1 Razionalizzazione e Pulizia (Fase 1)\r\n- [ ] Normalizza i nomi di file/pagine/sezioni (naming coerente, niente caratteri strani).\r\n- [ ] Uniforma i metadati/summary/tag su tutte le pagine chiave.\r\n- [ ] Rimuovi o isola i contenuti legacy e allinea i link interni.\r\n- [ ] Genera/aggiorna indici e sommari per tutte le macro-sezioni.\r\n- [ ] Esegui il link checker e correggi link rotti/anchor mancanti.","size_chars":407,"tokens_estimate":102}
{"doc_id":"best-practices-token-tuning-roadmap","path":"best-practices-token-tuning-roadmap.md","title":"Best Practices & Roadmap ‚Äì Token Tuning, AI-Readiness e Governance Universale","owner":"team-docs","tags":["best-practices","roadmap","token-tuning","ai-readiness","quality","documentation","universal","governance","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"3.2 Modularizzazione e Ottimizzazione AI (Fase 2)\r","anchor_slug":"32-modularizzazione-e-ottimizzazione-ai-fase-2","chunk_index":11,"content":"### 3.2 Modularizzazione e Ottimizzazione AI (Fase 2)\r\n- [ ] Suddividi i documenti lunghi in pagine/sezioni pi√π corte e tematiche.\r\n- [ ] Applica chunking automatico (400‚Äì600 token) tramite script/tool.\r\n- [ ] Sintetizza i summary e rimuovi ridondanze.\r\n- [ ] Sposta esempi estesi e log in allegati o pagine dedicate.\r\n- [ ] Aggiorna la checklist AI readiness e integrala nei controlli periodici.","size_chars":396,"tokens_estimate":99}
{"doc_id":"best-practices-token-tuning-roadmap","path":"best-practices-token-tuning-roadmap.md","title":"Best Practices & Roadmap ‚Äì Token Tuning, AI-Readiness e Governance Universale","owner":"team-docs","tags":["best-practices","roadmap","token-tuning","ai-readiness","quality","documentation","universal","governance","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"3.3 Automazione e Controlli Periodici (Fase 3)\r","anchor_slug":"33-automazione-e-controlli-periodici-fase-3","chunk_index":12,"content":"### 3.3 Automazione e Controlli Periodici (Fase 3)\r\n- [ ] Automatizza il controllo naming e metadati (report periodico).\r\n- [ ] Automatizza la generazione di indici e report di anchor/naming.\r\n- [ ] Integra script/tool di export per dataset AI (con chunk e metadati).\r\n- [ ] Esegui regolarmente il controllo privacy/PII e aggiorna i flag/metadati.","size_chars":347,"tokens_estimate":87}
{"doc_id":"best-practices-token-tuning-roadmap","path":"best-practices-token-tuning-roadmap.md","title":"Best Practices & Roadmap ‚Äì Token Tuning, AI-Readiness e Governance Universale","owner":"team-docs","tags":["best-practices","roadmap","token-tuning","ai-readiness","quality","documentation","universal","governance","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"3.4 Espansione Tassonomia e Tagging (Fase 4)\r","anchor_slug":"34-espansione-tassonomia-e-tagging-fase-4","chunk_index":13,"content":"### 3.4 Espansione Tassonomia e Tagging (Fase 4)\r\n- [ ] Espandi la tassonomia di entit√†/argomenti chiave.\r\n- [ ] Mappa le entit√† nei metadati/tag delle pagine.\r\n- [ ] Arricchisci i tag per dominio, layer, audience, privacy, lingua.","size_chars":231,"tokens_estimate":58}
{"doc_id":"best-practices-token-tuning-roadmap","path":"best-practices-token-tuning-roadmap.md","title":"Best Practices & Roadmap ‚Äì Token Tuning, AI-Readiness e Governance Universale","owner":"team-docs","tags":["best-practices","roadmap","token-tuning","ai-readiness","quality","documentation","universal","governance","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"3.5 Export, Integrazione e Sperimentazione AI (Fase 5)\r","anchor_slug":"35-export-integrazione-e-sperimentazione-ai-fase-5","chunk_index":14,"content":"### 3.5 Export, Integrazione e Sperimentazione AI (Fase 5)\r\n- [ ] Valida l‚Äôexport e testa l‚Äôintegrazione con sistemi di Q&A/RAG.\r\n- [ ] Sperimenta batch embedding e retrieval su subset pilota.\r\n- [ ] Ottimizza la struttura in base ai feedback AI (chunk troppo lunghi, ambiguit√†, ecc.).","size_chars":285,"tokens_estimate":71}
{"doc_id":"best-practices-token-tuning-roadmap","path":"best-practices-token-tuning-roadmap.md","title":"Best Practices & Roadmap ‚Äì Token Tuning, AI-Readiness e Governance Universale","owner":"team-docs","tags":["best-practices","roadmap","token-tuning","ai-readiness","quality","documentation","universal","governance","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"3.6 Formazione, Governance e Best Practices (Continuativo)\r","anchor_slug":"36-formazione-governance-e-best-practices-continuativo","chunk_index":15,"content":"### 3.6 Formazione, Governance e Best Practices (Continuativo)\r\n- [ ] Aggiorna e diffondi le guide rapide per ruoli e formati.\r\n- [ ] Promuovi la cultura della documentazione breve, chiara e AI-friendly.\r\n- [ ] Definisci un processo di review e accettazione per ogni nuova pagina/aggiornamento.\r\n- [ ] Monitora l‚Äôadozione delle convenzioni e la qualit√† tramite report periodici.\n\n---","size_chars":383,"tokens_estimate":96}
{"doc_id":"best-practices-token-tuning-roadmap","path":"best-practices-token-tuning-roadmap.md","title":"Best Practices & Roadmap ‚Äì Token Tuning, AI-Readiness e Governance Universale","owner":"team-docs","tags":["best-practices","roadmap","token-tuning","ai-readiness","quality","documentation","universal","governance","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"4. Milestone, Priorit√† e Monitoraggio\r","anchor_slug":"4-milestone-priorit-e-monitoraggio","chunk_index":16,"content":"## 4. Milestone, Priorit√† e Monitoraggio\n\n| Milestone | Target | Owner | Note |\r\n|-----------|--------|-------|------|\r\n| Pulizia nomi e metadati | Mese 1 | team-docs | Naming e summary/tag |\r\n| Modularizzazione e chunking | Mese 2 | team-docs + AI | Split pagine, export chunk |\r\n| Automazione controlli | Mese 3 | team-devops | Linter, report, indici |\r\n| Espansione entit√†/tag | Mese 4 | team-data | Tassonomia e tagging |\r\n| Export e test AI | Mese 5 | team-ai | Q&A, embedding, feedback |\r\n| Formazione e governance | continuo | tutti | Review, guide, cultura |","size_chars":566,"tokens_estimate":142}
{"doc_id":"best-practices-token-tuning-roadmap","path":"best-practices-token-tuning-roadmap.md","title":"Best Practices & Roadmap ‚Äì Token Tuning, AI-Readiness e Governance Universale","owner":"team-docs","tags":["best-practices","roadmap","token-tuning","ai-readiness","quality","documentation","universal","governance","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Monitoraggio e Aggiornamento\r","anchor_slug":"monitoraggio-e-aggiornamento","chunk_index":17,"content":"### Monitoraggio e Aggiornamento\r\n- La roadmap va rivista periodicamente (es. ogni trimestre).\r\n- Ogni milestone completata va loggata in un registro attivit√† (es. ACTIVITY_LOG.md o tool equivalente).\r\n- I report di automazione e i feedback AI vanno usati per aggiornare le priorit√†.\n\n---","size_chars":288,"tokens_estimate":72}
{"doc_id":"best-practices-token-tuning-roadmap","path":"best-practices-token-tuning-roadmap.md","title":"Best Practices & Roadmap ‚Äì Token Tuning, AI-Readiness e Governance Universale","owner":"team-docs","tags":["best-practices","roadmap","token-tuning","ai-readiness","quality","documentation","universal","governance","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":18,"content":"## Domande a cui risponde\r\n- Quali sono le best practices per ridurre il consumo di token in qualsiasi knowledge base?\r\n- Come si applicano queste regole ai diversi formati di documentazione?\r\n- Quali azioni concrete vanno fatte e in che ordine?\r\n- Come si garantisce la qualit√†, la governance e l‚ÄôAI-readiness nel tempo?\r\n- Chi √® responsabile di ogni fase?\r\n- Come si monitora l‚Äôavanzamento?","size_chars":392,"tokens_estimate":98}
{"doc_id":"ew-deploy-appservice","path":"deploy-app-service.md","title":"deploy-app-service","owner":"team-platform","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:18:58+02:00","section_level":2,"anchor_text":"deploy-app-service","anchor_slug":"deploy-app-service","chunk_index":1,"content":"Obiettivo\n- Descrivere come eseguire il deploy dell‚ÄôAPI EasyWay su Azure App Service usando la pipeline ADO, con variabili/toggle e mapping App Settings.\n\nPrerequisiti\n- Azure DevOps con Service Connection (Azure Resource Manager) ‚Üí `AZURE_SERVICE_CONNECTION`\n- Risorse Azure: Resource Group, App Service (Web App), opzionale Slot (es. `staging`)\n- Variable Group con segreti/env applicativi (Auth/DB/Storage/Branding/OTel)\n\nPipeline ‚Äì Stages (ordine)\n1. Infra (Terraform plan/apply)\n2. DB (Flyway validate/migrate) ‚Äì condizionato da `FLYWAY_ENABLED`\n3. BuildAndTest\n   - Versions Report (artifact `versions-report.txt`)\n   - NodeBuild (build/lint/test; publish artifact `api-dist`)\n   - Gates: Pre‚ÄëDeploy Checklist, KB Consistency, DB Drift\n   - Activity Log + Gates Report (artifact `gates-report.json`)\n4. Deploy (App Service) ‚Äì condizionato da `ENABLE_DEPLOY`\n\nVariabili ‚Äì Toggle & Versioni\n- Toggle gates/job:\n  - `ENABLE_CHECKLIST` (default `true`)\n  - `ENABLE_DB_DRIFT` (default `true`)\n  - `ENABLE_KB_CONSISTENCY` (default `true`)\n  - `FLYWAY_ENABLED` (default `false`)\n  - `ENABLE_DEPLOY` (default `false`)\n  - `ENABLE_SWAP` (default `false`) ‚Äì esegue lo swap di slot post‚Äëdeploy\n- Versioni (template `ci/versions.yml`):\n  - `node_version` (default `22.x`)\n  - `flyway_version` (default `9.22.3`)\n  - `terraform_version` (default `1.9.5`)\n\nVariabili ‚Äì Deploy\n- Obbligatorie:\n  - `AZURE_SERVICE_CONNECTION` ‚Äì Service Connection (Azure RM)\n  - `WEBAPP_NAME` ‚Äì nome Web App\n  - `RESOURCE_GROUP` ‚Äì Resource Group della Web App\n- Opzionale:\n  - `WEBAPP_SLOT` ‚Äì nome slot (es. `staging`); se impostato, il deploy avviene sullo slot\n\nApp Settings (mapping)\n- Vengono applicati dalla pipeline (task AzureAppServiceSettings@1):\n  - Auth/JWT: `AUTH_ISSUER`, `AUTH_JWKS_URI`, `AUTH_AUDIENCE`, `AUTH_CLIENT_ID`, `AUTH_TENANT_ID`, `TENANT_CLAIM`, `AUTH_SCOPES`\n  - DB: `DB_CONN_STRING` (oppure AAD variabili alternative)\n  - Storage: `AZURE_STORAGE_CONNECTION_STRING`, `AZURE_STORAGE_ACCOUNT`\n  - Branding: `BRANDING_CONTAINER`, `BRANDING_PREFIX`, `DEFAULT_TENANT_ID`\n  - RLS/Log/Portal: `RLS_CONTEXT_ENABLED`, `LOG_LEVEL`, `LOG_DIR`, `PORTAL_BASE_PATH`\n  - Rate limit/body: `RATE_LIMIT_WINDOW_MS`, `RATE_LIMIT_MAX`, `BODY_LIMIT`\n  - Observability: `APPLICATIONINSIGHTS_CONNECTION_STRING`, `OTEL_ENABLED`, `OTEL_TRACES_SAMPLER`, `OTEL_TRACES_SAMPLER_ARG`","size_chars":2350,"tokens_estimate":588}
{"doc_id":"ew-deploy-appservice","path":"deploy-app-service.md","title":"deploy-app-service","owner":"team-platform","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:18:58+02:00","section_level":2,"anchor_text":"deploy-app-service","anchor_slug":"deploy-app-service","chunk_index":2,"content":"Procedura ‚Äì Deploy su slot + swap (opzionale)\n1. Imposta variabili: `ENABLE_DEPLOY=true`, `AZURE_SERVICE_CONNECTION`, `WEBAPP_NAME`, `RESOURCE_GROUP`, `WEBAPP_SLOT=staging`\n2. (Opzionale) `ENABLE_SWAP=true` per eseguire lo swap `staging ‚Üí production` post‚Äëdeploy\n3. Avvia la pipeline; verifica l‚Äôesito del job Deploy e (se attivo) dello swap\n\nVerifica post‚ÄëDeploy\n- `https://<webapp>.azurewebsites.net/portal` ‚Üí mini‚Äëportale\n- `https://<webapp>.azurewebsites.net/api/docs` ‚Üí documentazione API (OpenAPI)\n- In caso di slot: testare lo slot prima dello swap (`https://<webapp>-staging.azurewebsites.net/...`)\n\nSicurezza & Governance\n- App Settings provengono da Variable Group/Key Vault; non inserire segreti in YAML\n- Branch protection + approvazioni per abilitare `ENABLE_DEPLOY`/`ENABLE_SWAP` in ambienti critici\n- Gates (Checklist/Drift/KB) come prerequisiti qualitativi\n- Guardrail Sync App Settings: il job di sincronizzazione da `.env.local` √® condizionato da `ENABLE_SYNC_APPSETTINGS=true` e richiede `GOV_APPROVED=true` se il branch √® `main` o l'ambiente √® `prod` (variabili: `ENVIRONMENT`, `GOV_APPROVED`).\n  - Nelle esecuzioni approvate comparir√† un badge ‚úÖ nella colonna \"Gov\" del diario di bordo (Wiki/EasyWayData.wiki/ACTIVITY_LOG.md).\n\nEsempio (screenshot)\n![Activity Log ‚Äì Esempio](.attachments/activity-log-example.svg)\n\nTroubleshooting\n- Logs App Service (Kudu), Application Insights (se configurato), artifact `versions-report.txt`\n- Riferimenti: `agents/kb/recipes.jsonl` (ricette deploy, slot/swap, toggle)\n\nEsempio App Settings (starter JSON)\nPuoi incollare questo JSON (adattando i valori) nel task AzureAppServiceSettings@1 o usarlo come riferimento per configurare manualmente gli App Settings nel portale Azure.\n\n```\n[\n  {\"name\":\"AUTH_ISSUER\",\"value\":\"https://login.microsoftonline.com/<TENANT_ID>/v2.0\",\"slotSetting\":false},\n  {\"name\":\"AUTH_JWKS_URI\",\"value\":\"https://login.microsoftonline.com/<TENANT_ID>/discovery/v2.0/keys\",\"slotSetting\":false},\n  {\"name\":\"AUTH_AUDIENCE\",\"value\":\"api://your-app-id\",\"slotSetting\":false},\n  {\"name\":\"AUTH_CLIENT_ID\",\"value\":\"<CLIENT_ID>\",\"slotSetting\":false},\n  {\"name\":\"AUTH_TENANT_ID\",\"value\":\"<TENANT_ID>\",\"slotSetting\":false},\n  {\"name\":\"TENANT_CLAIM\",\"value\":\"ew_tenant_id\",\"slotSetting\":false},\n  {\"name\":\"AUTH_SCOPES\",\"value\":\"api://default/.default\",\"slotSetting\":false},","size_chars":2340,"tokens_estimate":585}
{"doc_id":"ew-deploy-appservice","path":"deploy-app-service.md","title":"deploy-app-service","owner":"team-platform","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:18:58+02:00","section_level":2,"anchor_text":"deploy-app-service","anchor_slug":"deploy-app-service","chunk_index":3,"content":"  {\"name\":\"DB_CONN_STRING\",\"value\":\"Server=tcp:<sql-host>,1433;Database=<db>;User Id=<user>;Password=<pwd>;Encrypt=true\",\"slotSetting\":false},\n\n  {\"name\":\"AZURE_STORAGE_CONNECTION_STRING\",\"value\":\"<conn-string-o-NULL-se-MI>\",\"slotSetting\":false},\n  {\"name\":\"AZURE_STORAGE_ACCOUNT\",\"value\":\"<account-name>\",\"slotSetting\":false},\n\n  {\"name\":\"BRANDING_CONTAINER\",\"value\":\"portal-assets\",\"slotSetting\":false},\n  {\"name\":\"BRANDING_PREFIX\",\"value\":\"config\",\"slotSetting\":false},\n  {\"name\":\"DEFAULT_TENANT_ID\",\"value\":\"tenant01\",\"slotSetting\":false},\n\n  {\"name\":\"RLS_CONTEXT_ENABLED\",\"value\":\"true\",\"slotSetting\":false},\n  {\"name\":\"LOG_LEVEL\",\"value\":\"info\",\"slotSetting\":false},\n  {\"name\":\"LOG_DIR\",\"value\":\"logs\",\"slotSetting\":false},\n  {\"name\":\"PORTAL_BASE_PATH\",\"value\":\"/portal\",\"slotSetting\":false},\n  {\"name\":\"RATE_LIMIT_WINDOW_MS\",\"value\":\"60000\",\"slotSetting\":false},\n  {\"name\":\"RATE_LIMIT_MAX\",\"value\":\"600\",\"slotSetting\":false},\n  {\"name\":\"BODY_LIMIT\",\"value\":\"1mb\",\"slotSetting\":false},\n\n  {\"name\":\"APPLICATIONINSIGHTS_CONNECTION_STRING\",\"value\":\"<AI connection string>\",\"slotSetting\":false},\n  {\"name\":\"OTEL_ENABLED\",\"value\":\"true\",\"slotSetting\":false},\n  {\"name\":\"OTEL_TRACES_SAMPLER\",\"value\":\"parentbased_always_on\",\"slotSetting\":false},\n  {\"name\":\"OTEL_TRACES_SAMPLER_ARG\",\"value\":\"\",\"slotSetting\":false}\n]\n```\n\nSnippet alternativi (riuso rapido)\n- Formato CLI (az webapp config appsettings set --settings @appsettings.cli.json)\n```\n{\n  \"AUTH_ISSUER\": \"https://login.microsoftonline.com/<TENANT_ID>/v2.0\",\n  \"AUTH_JWKS_URI\": \"https://login.microsoftonline.com/<TENANT_ID>/discovery/v2.0/keys\",\n  \"AUTH_AUDIENCE\": \"api://your-app-id\",\n  \"AUTH_CLIENT_ID\": \"<CLIENT_ID>\",\n  \"AUTH_TENANT_ID\": \"<TENANT_ID>\",\n  \"TENANT_CLAIM\": \"ew_tenant_id\",\n  \"AUTH_SCOPES\": \"api://default/.default\",\n  \"DB_CONN_STRING\": \"Server=tcp:<sql-host>,1433;Database=<db>;User Id=<user>;Password=<pwd>;Encrypt=true\",\n  \"AZURE_STORAGE_CONNECTION_STRING\": \"<conn-string>\",\n  \"AZURE_STORAGE_ACCOUNT\": \"<account>\",\n  \"BRANDING_CONTAINER\": \"portal-assets\",\n  \"BRANDING_PREFIX\": \"config\",\n  \"DEFAULT_TENANT_ID\": \"tenant01\",\n  \"RLS_CONTEXT_ENABLED\": \"true\",\n  \"LOG_LEVEL\": \"info\",\n  \"LOG_DIR\": \"logs\",\n  \"PORTAL_BASE_PATH\": \"/portal\",\n  \"RATE_LIMIT_WINDOW_MS\": \"60000\",\n  \"RATE_LIMIT_MAX\": \"600\",\n  \"BODY_LIMIT\": \"1mb\",\n  \"APPLICATIONINSIGHTS_CONNECTION_STRING\": \"<AI conn>\",\n  \"OTEL_ENABLED\": \"true\",\n  \"OTEL_TRACES_SAMPLER\": ","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-deploy-appservice","path":"deploy-app-service.md","title":"deploy-app-service","owner":"team-platform","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:18:58+02:00","section_level":2,"anchor_text":"deploy-app-service","anchor_slug":"deploy-app-service","chunk_index":4,"content":"\"parentbased_always_on\",\n  \"OTEL_TRACES_SAMPLER_ARG\": \"\"\n}\n```\n\n- Formato Task Azure DevOps (AzureAppServiceSettings@1) ‚Äì appsettings.task.json\n```\n[\n  {\"name\":\"AUTH_ISSUER\",\"value\":\"...\",\"slotSetting\":false},\n  {\"name\":\"AUTH_JWKS_URI\",\"value\":\"...\",\"slotSetting\":false}\n  // ... (vedi starter JSON sopra)\n]\n```","size_chars":311,"tokens_estimate":78}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"1) Nomi di file e cartelle (semplici)\r","anchor_slug":"1-nomi-di-file-e-cartelle-semplici","chunk_index":1,"content":"## 1) Nomi di file e cartelle (semplici)\r\n- Solo minuscole, trattini `-`, numeri. Niente spazi, niente `%2D`, niente accenti, niente backtick/quote.\r\n- Forma: kebab-case (es: `login-flussi-onboarding.md`).\r\n- Evita maiuscole (es: `README.md` ‚Üí `readme.md` se serve coerenza locale).\r\n- Esempi di rinomina:\r\n  - `api-esterne-integrazione.md` ‚Üí `api-esterne-integrazione.md`\r\n  - `GET-CRUD-`api_users`.md` ‚Üí `get-crud-api-users.md`\r\n  - `best-practice-naming-and-scalability.md` ‚Üí `best-practice-naming-and-scalability.md`","size_chars":520,"tokens_estimate":130}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"1.1) Convenzione di Nomenclatura ‚Äì kebab-case vs snake_case\r","anchor_slug":"11-convenzione-di-nomenclatura-kebab-case-vs-snakecase","chunk_index":2,"content":"## 1.1) Convenzione di Nomenclatura ‚Äì kebab-case vs snake_case\n\n---\n\n---\n\ntitle: Convenzione di Nomenclatura ‚Äì kebab-case vs snake_case\r\ntags: [standard, naming, ai, database, api, frontend]\n\n# üß≠ Linea Guida EasyWay Data Portal","size_chars":228,"tokens_estimate":57}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Uso di kebab-case e snake_case per AI, DB e API\r","anchor_slug":"uso-di-kebab-case-e-snakecase-per-ai-db-e-api","chunk_index":3,"content":"## Uso di kebab-case e snake_case per AI, DB e API","size_chars":50,"tokens_estimate":12}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"üéØ Obiettivo\r","anchor_slug":"obiettivo","chunk_index":4,"content":"### üéØ Obiettivo\r\nGarantire coerenza semantica e tecnica nell‚Äôintero ecosistema EasyWay Data Portal, migliorando:\r\n- leggibilit√† umana e machine-readability,\r\n- comprensione da parte dei modelli AI conversazionali,\r\n- coerenza tra API, database e frontend.\n\n---","size_chars":261,"tokens_estimate":65}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"üîπ 1. kebab-case (es. `data-quality-report`)\r","anchor_slug":"1-kebab-case-es-data-quality-report","chunk_index":5,"content":"### üîπ 1. kebab-case (es. `data-quality-report`)\n\nUsa kebab-case per:\r\n| Contesto | Esempio | Motivo |\r\n|-----------|----------|--------|\r\n| URL / Routing Web | `/dashboard/data-quality-report` | SEO-friendly, leggibile, separa chiaramente i token |\r\n| Slug o ID semantici | `user-profile-settings` | Chiaro per AI e utenti |\r\n| Cartelle e file del frontend | `user-dashboard/summary-view.tsx` | Standard moderno in ambienti web |\r\n| Tag semantici / Ontologie AI | `ai-data-quality` | Aiuta l‚ÄôAI a riconoscere i concetti distinti |\n\nMotivazione AI: il trattino `-` aiuta la tokenizzazione e la comprensione semantica: `data-quality-report` ‚Üí `data`, `quality`, `report`.\n\n---","size_chars":675,"tokens_estimate":169}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"üîπ 2. snake_case (es. `data_quality_report`)\r","anchor_slug":"2-snakecase-es-dataqualityreport","chunk_index":6,"content":"### üîπ 2. snake_case (es. `data_quality_report`)\n\nUsa snake_case per:\r\n| Contesto | Esempio | Motivo |\r\n|-----------|----------|--------|\r\n| Database (SQL Server) | `user_profile_id`, `created_at` | Standard tecnico compatibile e leggibile |\r\n| File CSV / JSON / API payloads | `{ \"user_id\": 1001 }` | Uniforme e facilmente parsabile |\r\n| Script o codice server-side | `def process_user_data():` | Convenzione tecnica consolidata |\r\n| Chiavi di configurazione/metadati | `portal_schema_name` | Evita ambiguit√† con trattini nei parser |\n\nMotivazione AI: gli underscore sono neutri per la tokenizzazione nei contesti tecnici e non confondono interpreti/parsers.\n\n---","size_chars":664,"tokens_estimate":166}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"üîπ 3. Regola generale EasyWay\r","anchor_slug":"3-regola-generale-easyway","chunk_index":7,"content":"### üîπ 3. Regola generale EasyWay","size_chars":33,"tokens_estimate":8}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Mappa di conversione consigliata (canonico ‚Üí derivati)\r","anchor_slug":"mappa-di-conversione-consigliata-canonico-derivati","chunk_index":8,"content":"### Mappa di conversione consigliata (canonico ‚Üí derivati)\n\n ```text \r\nCanonico (slug/tag): kebab-case    es. user-profile-settings\r\nsnake_case (DB/payload):           user_profile_settings\r\nPascalCase (classi/DTO):           UserProfileSettings\r\ncamelCase (variabili/JS):          userProfileSettings\r\n ``` \n\nRegola: il canonico √® kebab-case; gli altri sono derivati meccanici per il dominio tecnico di riferimento.\n\n| Ambito | Formato raccomandato |\r\n|---------|----------------------|\r\n| Database (colonne, tabelle, viste) | snake_case |\r\n| API REST (endpoint URL) | kebab-case |\r\n| Frontend Web / React component path | kebab-case |\r\n| Script o variabili codice server | snake_case |\r\n| AI Conversational / Prompt / Tag semantici | kebab-case |\r\n| File system / repository folders | kebab-case |\n\n---","size_chars":804,"tokens_estimate":201}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"üîπ 4. Esempio di coerenza complessiva\r","anchor_slug":"4-esempio-di-coerenza-complessiva","chunk_index":9,"content":"### üîπ 4. Esempio di coerenza complessiva\n\n| Componente | Nome coerente |\r\n|-------------|----------------|\r\n| Tabella DB | `portal_user_profile` |\r\n| API REST | `/api/user-profile/details` |\r\n| File Frontend | `/components/user-profile/details-view.tsx` |\r\n| Variabile Server | `user_profile_id` |\r\n| Prompt AI | `explain-user-profile-data-quality` |\n\n---","size_chars":356,"tokens_estimate":89}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"üîπ 5. Note di standardizzazione\r","anchor_slug":"5-note-di-standardizzazione","chunk_index":10,"content":"### üîπ 5. Note di standardizzazione\n\n- I trattini `-` non devono mai essere usati nei nomi di variabili o tabelle (incompatibile con SQL/Python).  \r\n- Gli underscore `_` non devono mai essere usati negli URL o nei tag AI.  \r\n- Ogni parola deve essere in minuscolo ASCII (niente accenti/simboli; `&` ‚Üí `and`).  \r\n- I separatori devono essere coerenti con il contesto (nessun mix `data_quality-report`).\n\nQuick Check (regex)\r\n```text\r\n# Slug (senza estensione)\r\nkebab-case: ^[a-z0-9]+(?:-[a-z0-9]+)*$\r\nsnake_case: ^[a-z0-9]+(?:_[a-z0-9]+)*$\n\n# File con estensione (comune)\r\nkebab-case file .md: ^[a-z0-9]+(?:-[a-z0-9]+)*\\.md$\r\nsnake_case file .md: ^[a-z0-9]+(?:_[a-z0-9]+)*\\.md$\n\n# File con estensioni permesse\r\nkebab-case: ^[a-z0-9]+(?:-[a-z0-9]+)*\\.(?:md|yml|yaml|json|sql|ps1)$\r\nsnake_case: ^[a-z0-9]+(?:_[a-z0-9]+)*\\.(?:md|yml|yaml|json|sql|ps1)$\n\n# Percorsi (normalizza i separatori a / prima del match)\r\n# es.: $path.Replace('\\\\','/') -match ...\r\npath kebab-case: ^(?:[a-z0-9]+(?:-[a-z0-9]+)*/)*[a-z0-9]+(?:-[a-z0-9]+)*\\.(?:md|yml|yaml|json|sql|ps1)$\r\npath snake_case: ^(?:[a-z0-9]+(?:_[a-z0-9]+)*/)*[a-z0-9]+(?:_[a-z0-9]+)*\\.(?:md|yml|yaml|json|sql|ps1)$\r\n```text\n\nNote pratiche\r\n- Usa il trattino ASCII ‚Äú-‚Äù U+002D, non i trattini tipografici (‚Äì, ‚Äî).\r\n- Niente doppie/estreme: no `--`, `__`, `-nome`, `nome-`.\r\n- I check sono pensati per ‚Äúslug‚Äù e per ‚Äúfile.ext‚Äù: applica la regex giusta per il contesto.\r\n- √à normale applicare pi√π passate di pulizia (come setacciare la farina): prima i casi evidenti (percent-encoding, maiuscole), poi i dettagli (accenti, simboli), poi l‚Äôallineamento finale.\n\nEccezioni del linter (whitelist ragionata)\r\n- File di servizio e allegati: `.gitignore`, `**/.order`, `**/.attachments/**` (esclusi dai check)\r\n- Meta della root: `ACTIVITY_LOG.md`, `DOCS_CONVENTIONS.md`, `LLM_READINESS_CHECKLIST.md`, `TODO_CHECKLIST.md`, `INDEX.md` (tenuti in UPPERCASE per riconoscibilit√†)\r\n- Segmenti legacy (solo path check): `EasyWay_WebApp/`, `01_database_architecture/`, `01b_schema_structure/` (il controllo path √® disattivato per questi segmenti finch√© non si pianifica una migrazione)","size_chars":2111,"tokens_estimate":528}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"üîπ 5. Note di standardizzazione\r","anchor_slug":"5-note-di-standardizzazione","chunk_index":11,"content":"Strategia di miglioramento iterativo\r\n- Prima riduci il rumore con whitelist minime e rename a basso rischio.\r\n- Poi affronta rinomine di cartelle legacy (se necessario) con aggiornamento link e indici.\r\n- Gli script `review-examples.ps1` e `review-run.ps1` recepiscono queste eccezioni e possono essere estesi in futuro.\n\nAnti-pattern comuni: `Data_Quality`, `data_quality-report`, `UserProfile`, `dataquality`, `data-quality_2024`.","size_chars":433,"tokens_estimate":108}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"2) Struttura delle pagine (sempre uguale)\r","anchor_slug":"2-struttura-delle-pagine-sempre-uguale","chunk_index":12,"content":"## 2) Struttura delle pagine (sempre uguale)\r\nOgni pagina Markdown segue questo ordine di sezioni (H2/H3 chiari):\r\n- Scopo (perch√© esiste questa pagina)\r\n- Prerequisiti (cosa serve prima)\r\n- Passi (step 1, 2, 3‚Ä¶ chiari e corti)\r\n- Esempi (codice o comandi reali)\r\n- Errori comuni (come riconoscerli, come risolverli)\r\n- Domande a cui risponde (3‚Äì7 Q&A brevi)\r\n- Collegamenti (2‚Äì5 link utili a pagine sorelle)\n\nScrittura: frasi brevi, parole semplici, niente ‚Äúvedi sopra/sotto‚Äù. Evita termini ambigui. Se usi sigle, spiega la prima volta.","size_chars":537,"tokens_estimate":134}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"3) Metadati in testa (front matter YAML)\r","anchor_slug":"3-metadati-in-testa-front-matter-yaml","chunk_index":13,"content":"## 3) Metadati in testa (front matter YAML)\r\nMetti questo blocco all‚Äôinizio di ogni `.md` (sopra il titolo):\n\n```text\r\n---\r\nid: ew-<slug-unico>\r\ntitle: Titolo umano breve\r\nsummary: 1‚Äì2 frasi semplici sul contenuto\r\nstatus: draft | review | approved | deprecated\r\nowner: team-api | team-data | team-ops | team-frontend\r\ncreated: '2025-01-01'\r\nupdated: '2025-01-01'\r\ntags:\r\n  - domain/webapp\r\n  - layer/how-to\r\n  - artifact/endpoint\r\n  - audience/dev\r\n  - privacy/internal\r\n  - language/it\r\nintents:\r\n  - cosa vuoi fare (es: creare tabella pippo)\r\nllm:\r\n  include: true\r\n  pii: none | contains-pii\r\n  chunk_hint: 400-600\r\n  redaction: [email, phone]\r\nentities: []  # id da entities.yaml\r\n---\r\n```text\n\nNote:\r\n- `summary` √® fondamentale: aiuta la ricerca e l‚ÄôAI.\r\n- `tags` e `entities` migliorano risposte precise.\r\n- `llm.include: false` per file da NON esporre all‚ÄôAI.","size_chars":867,"tokens_estimate":217}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"4) Macro cartelle (semplici e chiare)\r","anchor_slug":"4-macro-cartelle-semplici-e-chiare","chunk_index":14,"content":"## 4) Macro cartelle (semplici e chiare)\r\n- `01-architettura/` (db, backend, frontend, integrazioni)\r\n- `02-api/` (linee guida, endpoint, test)","size_chars":143,"tokens_estimate":36}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":15,"content":"## Domande a cui risponde\r\n- Quali convenzioni usare per nomi di file, cartelle e slug?\r\n- Quando scegliere kebab-case e quando snake_case nei diversi contesti?\r\n- Qual √® la struttura minima di una pagina e quali metadati servono?\r\n- Come scrivere esempi e codice in modo uniforme e AI‚Äëfriendly?\r\n- Quali eccezioni/whitelist adotta il linter e perch√©?\r\n- `03-datalake/` (naming, accesso, pipeline)\r\n- `04-security-compliance/` (IAM, policy, audit, PII)\r\n- `05-operations/` (deploy, iac, logging, runbook)\r\n- `06-flussi-prodotto/` (onboarding, notifiche, use case)\n\nMantieni nomi brevi e chiari. Se serve ordinare, usa prefissi locali `01-`, `02-`.","size_chars":647,"tokens_estimate":162}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"5) Regole per codice, tabelle e API (norme MUST)\r","anchor_slug":"5-regole-per-codice-tabelle-e-api-norme-must","chunk_index":16,"content":"## 5) Regole per codice, tabelle e API (norme MUST)\r\n- Sempre idempotente: script che non rompono se rilanciati.\r\n- Commenti chiari: spiega cosa fa e perch√©.\r\n- Esempi reali: richieste/risposte API, DDL tabelle, query.","size_chars":218,"tokens_estimate":54}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"5.1 Database (DBA)\r","anchor_slug":"51-database-dba","chunk_index":17,"content":"### 5.1 Database (DBA)\r\n- Nomi: `snake_case`, singolare per tabelle (es: `pippo`).\r\n- PK: `<table>_id`. Default UTC per `created_at`.\r\n- Vincoli nominati: `pk_`, `fk_`, `idx_`, `ck_`, `df_`.\r\n- Soft delete (se serve): `deleted_at` + vista filtrata.\r\n- Esempio base (SQL Server):\n\n```text\r\nIF OBJECT_ID('portal.pippo','U') IS NULL\r\nBEGIN\r\n  CREATE TABLE portal.pippo (\r\n    pippo_id INT IDENTITY(1,1) NOT NULL,\r\n    name NVARCHAR(200) NOT NULL,\r\n    status TINYINT NOT NULL CONSTRAINT df_pippo_status DEFAULT (1),\r\n    created_at DATETIME2(3) NOT NULL CONSTRAINT df_pippo_created_at DEFAULT (SYSUTCDATETIME()),\r\n    updated_at DATETIME2(3) NULL,\r\n    deleted_at DATETIME2(3) NULL,\r\n    CONSTRAINT pk_pippo PRIMARY KEY CLUSTERED (pippo_id),\r\n    CONSTRAINT ck_pippo_status CHECK (status IN (0,1))\r\n  );\r\nEND\r\nGO\n\nCREATE INDEX idx_pippo__status ON portal.pippo (status);\r\nGO\r\n```text\n\nChecklist DBA (rapida): nomi ok, idempotenza ok, default UTC, indici, FK, commenti.","size_chars":965,"tokens_estimate":241}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"5.2 API (Backend)\r","anchor_slug":"52-api-backend","chunk_index":18,"content":"### 5.2 API (Backend)\r\n- Rotte chiare: `/api/config`, `/api/branding`, `/api/users`.\r\n- Specifica sempre: metodo, path, input, validazioni, output, errori.\r\n- Esempi `curl` e JSON ben formattati.","size_chars":195,"tokens_estimate":49}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"5.3 ETL / Datalake\r","anchor_slug":"53-etl-datalake","chunk_index":19,"content":"### 5.3 ETL / Datalake\r\n- Descrivi: sorgente, mapping, regole qualit√†, schedule, output.\r\n- Formati chiari: schema colonne (nome, tipo, null, note).","size_chars":148,"tokens_estimate":37}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"5.4 AMS / Operazioni\r","anchor_slug":"54-ams-operazioni","chunk_index":20,"content":"### 5.4 AMS / Operazioni\r\n- Runbook semplici: come avviare/fermare, verifiche salute, log utili.\r\n- Allarmi: cosa scatta, dove arriva, come si gestisce.","size_chars":152,"tokens_estimate":38}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"5.5 Analista / BI\r","anchor_slug":"55-analista-bi","chunk_index":21,"content":"### 5.5 Analista / BI\r\n- Definisci metriche: nome, formula, fonte, filtro.\r\n- Dashboard: obiettivo, utenti, viste chiave, drilldown.","size_chars":132,"tokens_estimate":33}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"6) ‚ÄúRicette‚Äù per l‚ÄôAI (task standard)\r","anchor_slug":"6-ricette-per-lai-task-standard","chunk_index":22,"content":"## 6) ‚ÄúRicette‚Äù per l‚ÄôAI (task standard)\r\nOgni ricetta descrive input minimi, output obbligatori, esempi buoni/cattivi.\r\n- create-table: usa schema DB di sopra (DDL completo + indici + rollback).\r\n- create-endpoint: route, DTO, validazioni, esempi request/response.\r\n- create-job-etl: sorgente‚Üísink, mapping, qualit√† dati, schedule, monitoraggio.","size_chars":346,"tokens_estimate":86}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"7) Domande a cui le pagine devono rispondere\r","anchor_slug":"7-domande-a-cui-le-pagine-devono-rispondere","chunk_index":23,"content":"## 7) Domande a cui le pagine devono rispondere\r\n- Cosa fa? Per chi? Con quali passi? Con quali input? Cosa esce? Come verifico? Cosa pu√≤ andare storto? Dove trovo altro?","size_chars":170,"tokens_estimate":42}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"8) Piccole regole d‚Äôoro\r","anchor_slug":"8-piccole-regole-doro","chunk_index":24,"content":"## 8) Piccole regole d‚Äôoro\r\n- Una idea per paragrafo. Frasi brevi. Parole semplici.\r\n- Niente immagini di testo (usa codice). Diagrammi in `mermaid` se servono.\r\n- Date ISO-8601, orari UTC. Evita ‚Äúoggi/ieri‚Äù.","size_chars":208,"tokens_estimate":52}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"9) Activity Log del progetto (CSV-friendly)\r","anchor_slug":"9-activity-log-del-progetto-csv-friendly","chunk_index":25,"content":"## 9) Activity Log del progetto (CSV-friendly)\r\n- Formato riga: `timestampUTC¬¶type¬¶scope¬¶status¬¶owner¬¶message`\r\n- Timestamp UTC: `yyyyMMddHHmmssZ` (es: `20250101120000Z`)\r\n- Delimitatore: barra spezzata `¬¶` per separare i campi in modo sicuro nei CSV\r\n- Una azione per riga; descrizione breve senza newline\n\nEsempi\r\n```text\r\n20250101120000Z¬¶SCAN¬¶wiki¬¶success¬¶team-docs¬¶Scansione H1‚ÄìH3 e naming issues\r\n20250101123000Z¬¶RENAME¬¶endpoint¬¶success¬¶team-api¬¶Rinominato endp-002-get-api-branding.md\r\n20250101124500Z¬¶DOC¬¶conventions¬¶success¬¶team-docs¬¶Aggiornata guida kebab-case vs snake_case\r\n```text\n\nAppend veloce (PowerShell)\r\n```text\r\n$ts = (Get-Date).ToUniversalTime().ToString('yyyyMMddHHmmss');\r\n$type='DOC'; $scope='conventions'; $status='success'; $owner='team-docs'; $msg='Aggiornata guida naming';\r\nAdd-Content EasyWayData.wiki/ACTIVITY_LOG.md (\"${ts}Z¬¶${type}¬¶${scope}¬¶${status}¬¶${owner}¬¶${msg}\")\r\n```text\n\nScript dedicato\r\n- Usa lo script helper per appending strutturato:\r\n```text\r\nEasyWayData.wiki/scripts/add-log.ps1 -Type DOC -Scope conventions -Status success -Owner team-docs -Message \"Aggiornata guida naming\"\r\n```text\n\nOpzioni di split e mirror\r\n- Parametri aggiuntivi:\r\n  - `-Split none|monthly|scope` (default: `none`)\r\n  - `-MirrorToMaster $true|$false` (default: `true`)\r\n- Esempi:\r\n```text\r\n# Log in master + log mensile in logs/date/yyyymm.log\r\nEasyWayData.wiki/scripts/add-log.ps1 -Type DOC -Scope conventions -Status success -Owner team-docs -Message \"Aggiornata guida naming\" -Split monthly\n\n# Log in master + log per ambito in logs/scope/endpoint.log\r\nEasyWayData.wiki/scripts/add-log.ps1 -Type RENAME -Scope endpoint -Status success -Owner team-api -Message \"Rinominati 3 file endpoint\" -Split scope\n\n# Solo log per ambito, senza master (sconsigliato)\r\nEasyWayData.wiki/scripts/add-log.ps1 -Type LINT -Scope wiki -Status warn -Owner team-docs -Message \"Naming checker warning\" -Split scope -MirrorToMaster:$false\r\n```text","size_chars":1945,"tokens_estimate":486}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"10) Script revisione doc (PowerShell)\r","anchor_slug":"10-script-revisione-doc-powershell","chunk_index":26,"content":"## 10) Script revisione doc (PowerShell)\r\nSnippet pronti per controlli ricorrenti. Copia/incolla e adatta.\n\n1) Check naming (slug/file/percorso) e report non conformi\r\n```text\r\n$ErrorActionPreference='Stop'\r\n$root = 'EasyWayData.wiki'\r\n$slugRx = '^[a-z0-9]+(?:-[a-z0-9]+)*$'\r\n$fileRx = '^[a-z0-9]+(?:-[a-z0-9]+)*\\.(?:md|yml|yaml|json|sql|ps1)$'\r\n$pathRx = '^(?:[a-z0-9]+(?:-[a-z0-9]+)*/)*[a-z0-9]+(?:-[a-z0-9]+)*\\.(?:md|yml|yaml|json|sql|ps1)$'\r\nGet-ChildItem -Path $root -Recurse -File | ForEach-Object {\r\n  $name = $_.Name; $slug = [IO.Path]::GetFileNameWithoutExtension($name)\r\n  $path = ($_.FullName -replace '\\\\','/')\r\n  $issues = @()\r\n  if ($name -cmatch '[A-Z]') { $issues += 'uppercase' }\r\n  if ($name -match '%[0-9A-Fa-f]{2}') { $issues += 'percent-encoded' }\r\n  if ($name -match '[`\"\\'']') { $issues += 'quotes/backticks' }\r\n  if ($name -match 'ÔøΩ') { $issues += 'encoding-char' }\r\n  if ($slug -notmatch $slugRx) { $issues += 'slug' }\r\n  if ($name -notmatch $fileRx) { $issues += 'file' }\r\n  if (($path -replace '^.+?/EasyWayData\\.wiki/','') -notmatch $pathRx) { $issues += 'path' }\r\n  if ($issues.Count) { '{0} | {1}' -f $path, ($issues -join ',') }\r\n}\r\n```text\n\n2) Aggiungi front matter minimo se assente (funzione riusabile)\r\n```text\r\nfunction Add-FrontMatter($path, $id, $title, $tags){\r\n  if (!(Test-Path -LiteralPath $path)) { return }\r\n  $content = Get-Content -LiteralPath $path -Raw -Encoding UTF8\r\n  if ($content -match '(?s)^---\\s*\\n') { return }\r\n  $fm = @(\r\n    '---',\r\n    \"id: $id\",\r\n    \"title: $title\",\r\n    'summary: Breve descrizione del documento.',\r\n    'status: draft',\r\n    'owner: team-docs',\r\n    \"created: '2025-01-01'\",\r\n    \"updated: '2025-01-01'\",\r\n    'tags:',\r\n    \"  - $tags\",\r\n    '  - privacy/internal',\r\n    '  - language/it',\r\n    'llm:',\r\n    '  include: true',\r\n    '  pii: none',\r\n    '  chunk_hint: 400-600',\r\n    '  redaction: [email, phone]',\r\n    'entities: []',\r\n    '---',''\r\n  ) -join \"`n\"\r\n  Set-Content -LiteralPath $path -Value ($fm + $content) -Encoding UTF8\r\n}\r\n```text","size_chars":2029,"tokens_estimate":507}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"10) Script revisione doc (PowerShell)\r","anchor_slug":"10-script-revisione-doc-powershell","chunk_index":27,"content":"3) Aggiornamento link in blocco (mappa vecchio‚Üínuovo)\r\n```text\r\n$map = @{\r\n  'vecchio-nome.md' = 'nuovo-nome.md'\r\n  'cartella%2Dold' = 'cartella-old'\r\n}\r\nGet-ChildItem -Path 'EasyWayData.wiki' -Recurse -File -Filter *.md | ForEach-Object {\r\n  $c = Get-Content -LiteralPath $_.FullName -Raw -Encoding UTF8\r\n  $orig = $c\r\n  foreach($k in $map.Keys){ $c = $c -replace [regex]::Escape($k), $map[$k] }\r\n  if($c -ne $orig){ Set-Content -LiteralPath $_.FullName -Value $c -NoNewline -Encoding UTF8 }\r\n}\r\n```text\n\n4) Estrazione heading H1‚ÄìH3 (per generare indici)\r\n```text\r\nGet-ChildItem -Path 'EasyWayData.wiki' -Recurse -File -Filter *.md | ForEach-Object {\r\n  $rel = (Resolve-Path -Relative $_.FullName)\r\n  Get-Content -LiteralPath $_.FullName -Encoding UTF8 | Where-Object { $_ -match '^(#|##|###)\\s+' } | ForEach-Object {\r\n    '{0}`t{1}' -f $rel, $_\r\n  }\r\n}\r\n```text\n\n5) Appendi al log (master + split)\r\n```text\r\nEasyWayData.wiki/scripts/add-log.ps1 -Type LINT -Scope wiki -Status success -Owner team-docs -Message \"Naming check eseguito\" -Split monthly\r\n```text\n\nNota: questi snippet sono ‚Äúsetacci‚Äù incrementali. √à normale ripassarli pi√π volte e affinare i controlli via via che emergono casi bordo.\n\nRiferimento script consolidato\r\n- Usa le funzioni gi√† pronte in: `EasyWayData.wiki/scripts/review-examples.ps1`\r\n- Carica in sessione: `. EasyWayData.wiki/scripts/review-examples.ps1`\r\n- Esempi:\r\n```text\r\n. EasyWayData.wiki/scripts/review-examples.ps1\r\nGet-NameCompliance -Root 'EasyWayData.wiki' -Mode kebab | Out-Host\r\nWrite-Activity -Type LINT -Scope wiki -Status success -Owner team-docs -Message 'Naming check eseguito' -Split monthly\r\n```text","size_chars":1647,"tokens_estimate":412}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"10) Script revisione doc (PowerShell)\r","anchor_slug":"10-script-revisione-doc-powershell","chunk_index":28,"content":"Task runner (one-shot)\r\n- Usa l‚Äôorchestratore: `EasyWayData.wiki/scripts/review-run.ps1`\r\n- Parametri principali:\r\n  - `-Root` (default: repo wiki)\r\n  - `-Mode kebab|snake|both` (default: kebab)\r\n  - `-FrontMatterCsv fm.csv` (Path,Id,Title,Tags,Owner,Summary)\r\n  - `-LinksMapCsv links.csv` (Old,New)\r\n  - `-IndexFolders @('path1','path2',...)`\r\n  - `-Split none|monthly|scope` (default: monthly)\r\n  - `-NoGlobalIndex` (disabilita la generazione dell‚Äôindice globale)\r\n  - Esempio:\r\n```text\r\nEasyWayData.wiki/scripts/review-run.ps1 -FrontMatterCsv fm.csv -LinksMapCsv links.csv -Mode kebab -IndexFolders @(\r\n  'EasyWayData.wiki/EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT',\r\n  'EasyWayData.wiki/EasyWay_WebApp/02_logiche_easyway'\r\n)\r\n```text\r\n  - Esempio senza indice globale:\r\n```text\r\nEasyWayData.wiki/scripts/review-run.ps1 -FrontMatterCsv fm.csv -LinksMapCsv links.csv -Mode kebab -NoGlobalIndex\r\n```text\n\nEsempi CSV\r\n- Front matter CSV di esempio: `EasyWayData.wiki/scripts/examples/fm.csv`\r\n- Link mapping CSV di esempio: `EasyWayData.wiki/scripts/examples/links.csv`\n\nIndice Globale (obbligatorio)\r\n- Mantieni sempre aggiornato `EasyWayData.wiki/INDEX.md` con H1/H2.\r\n- Genera con la funzione pronta:\r\n```text\r\n. EasyWayData.wiki/scripts/review-examples.ps1\r\nNew-RootIndex -Root 'EasyWayData.wiki'\r\n```text\r\n- L‚Äôorchestratore `review-run.ps1` pu√≤ essere esteso per includerlo automaticamente nelle run periodiche.\n\nEntities Index\r\n- Consulta l‚Äôelenco centralizzato delle entit√†: `EasyWayData.wiki/ENTITIES_INDEX.md`\r\n- Fonte dati: `EasyWayData.wiki/entities.yaml` (mantenerlo allineato durante le revisioni)","size_chars":1637,"tokens_estimate":409}
{"doc_id":"docs-conventions","path":"docs-conventions.md","title":"EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)","owner":"team-docs","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"5bis) Code fence (linguaggi ammessi)\r","anchor_slug":"5bis-code-fence-linguaggi-ammessi","chunk_index":29,"content":"## 5bis) Code fence (linguaggi ammessi)\r\n- Usa sempre il linguaggio nei blocchi: `sql, `sh/`\bash, `powershell, `json, `yaml, `js/`\ts/`\tsx, `python, `\text.\r\n- Default per SQL/DDL/DML: `sql. Per testo puro: `\text.\r\n- Evita fence senza lingua (aumentano l ambiguit√† per lAI e i tool di evidenziazione).","size_chars":299,"tokens_estimate":75}
{"doc_id":"easyway-webapp","path":"easyway-webapp.md","title":"üéØ EasyWay Data Portal ‚Äì Start With Why","owner":"team-docs","tags":["vision","why","how","what","presentazione","overview","multi-tenant","ai","ams","conversational","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üß≠ Why ‚Äì Perch√© lo facciamo\r","anchor_slug":"why-perch-lo-facciamo","chunk_index":1,"content":"## üß≠ Why ‚Äì Perch√© lo facciamo\n\nCrediamo che ogni persona o azienda debba poter **capire e controllare i propri dati**.  \r\nVogliamo che **il valore nascosto nei numeri** diventi **accessibile, leggibile e utile** ‚Äì anche a chi non √® un tecnico.  \r\nPerch√© **il dato √® una risorsa**, ma solo se sai come leggerlo.\n\nEasyWay Data Portal √® una piattaforma SaaS multi-tenant che consente a ciascun cliente/tenant di gestire in autonomia dati, utenti, configurazioni e servizi, con isolamento e sicurezza a livello enterprise.\n\n---","size_chars":524,"tokens_estimate":131}
{"doc_id":"easyway-webapp","path":"easyway-webapp.md","title":"üéØ EasyWay Data Portal ‚Äì Start With Why","owner":"team-docs","tags":["vision","why","how","what","presentazione","overview","multi-tenant","ai","ams","conversational","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üõ† How ‚Äì Come lo facciamo\r","anchor_slug":"how-come-lo-facciamo","chunk_index":2,"content":"## üõ† How ‚Äì Come lo facciamo\n\n- Costruiamo una piattaforma **modulare e intuitiva**, accessibile da web  \r\n- Ogni dato viene **smontato, arricchito e riconnesso** con logiche precise  \r\n- Le informazioni sono **analizzabili, tracciabili, e personalizzabili**  \r\n- Ogni utente ha **solo ci√≤ che gli serve**, con accessi profilati e sicuri  \n\n---","size_chars":344,"tokens_estimate":86}
{"doc_id":"easyway-webapp","path":"easyway-webapp.md","title":"üéØ EasyWay Data Portal ‚Äì Start With Why","owner":"team-docs","tags":["vision","why","how","what","presentazione","overview","multi-tenant","ai","ams","conversational","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üì¶ What ‚Äì Cosa offriamo\r","anchor_slug":"what-cosa-offriamo","chunk_index":3,"content":"## üì¶ What ‚Äì Cosa offriamo\n\nUn portale dati dove puoi:\r\n- üì• **Caricare** dati da Excel, FattureInCloud, Danea  \r\n- üîÑ **Arricchire** i dati con logiche personalizzate  \r\n- üìä **Analizzare** tramite dashboard dinamiche  \r\n- üìÜ **Schedulare** eventi ricorrenti o automatismi  \r\n- üë§ **Gestire utenti, ruoli e profili di accesso**  \r\n- ü§ñ **Integrare AI Agents intelligenti** per:\r\n  - automatizzare attivit√† di **Application Management Services (AMS)**  \r\n  - abilitare un‚Äôinterazione **naturale, efficace e contestualizzata** con i servizi della piattaforma\n\nTutto questo in un ecosistema **scalabile**, **containerizzato** (Docker), e **pronto al cloud**.","size_chars":656,"tokens_estimate":164}
{"doc_id":"easyway-webapp","path":"easyway-webapp.md","title":"üéØ EasyWay Data Portal ‚Äì Start With Why","owner":"team-docs","tags":["vision","why","how","what","presentazione","overview","multi-tenant","ai","ams","conversational","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":4,"content":"## Domande a cui risponde\r\n- Quale visione guida EasyWay Data Portal (Why/How/What)?\r\n- Quali sono i benefici chiave per i tenant e gli utenti?\r\n- Come √® organizzata l‚Äôarchitettura a livello alto?\r\n- In che modo l‚ÄôAI/AMS si integra nei flussi del portale?","size_chars":255,"tokens_estimate":64}
{"doc_id":"ew-entities-index","path":"entities-index.md","title":"Entities Index","owner":"team-docs","tags":["catalog","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Endpoints\r","anchor_slug":"endpoints","chunk_index":1,"content":"## Endpoints\n\n| id | name | kind | link |\r\n|---|---|---|---|\r\n| api-config | GET /api-config | endpoint | [./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-001-get-api-config.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-001-get-api-config.md) |\r\n| api-branding | GET /api-branding | endpoint | [./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-002-get-api-branding.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-002-get-api-branding.md) |\r\n| api-users | CRUD /api/users | endpoint | [./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-003-get-crud-api-users.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-003-get-crud-api-users.md) |","size_chars":813,"tokens_estimate":203}
{"doc_id":"ew-entities-index","path":"entities-index.md","title":"Entities Index","owner":"team-docs","tags":["catalog","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"DB Stored Procedures\r","anchor_slug":"db-stored-procedures","chunk_index":2,"content":"## DB Stored Procedures\n\n| id | name | kind | link |\r\n|---|---|---|---|\r\n| sp-portal-configuration | PORTAL.stored-procedure.configuration | stored-procedure | [./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md) |\r\n| sp-portal-profile-domains | PORTAL.stored-procedure.profile-domains | stored-procedure | [./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md) |\r\n| sp-portal-section-access | PORTAL.stored-procedure.section-access | stored-procedure | [./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md) |\r\n| sp-portal-stats-execution-log | PORTAL.stored-procedure.stats-execution-log | stored-procedure | [./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md) |\r\n| sp-portal-subscription | PORTAL.stored-procedure.subscription | stored-procedure | [./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md) |\r\n| sp-portal-tenant | PORTAL.stored-procedure.tenant | stored-procedure | [./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md) |\r\n| sp-portal-user-notification-settings | PORTAL.stored-procedure.user-notification-settings | stored-procedure | [./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/program","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-entities-index","path":"entities-index.md","title":"Entities Index","owner":"team-docs","tags":["catalog","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"DB Stored Procedures\r","anchor_slug":"db-stored-procedures","chunk_index":3,"content":"mability/stored-procedure/user-notification-settings.md) |\r\n| sp-portal-users | PORTAL.stored-procedure.users | stored-procedure | [./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md) |","size_chars":359,"tokens_estimate":90}
{"doc_id":"ew-entities-index","path":"entities-index.md","title":"Entities Index","owner":"team-docs","tags":["catalog","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"DB Sequences\r","anchor_slug":"db-sequences","chunk_index":4,"content":"## DB Sequences\n\n| id | name | kind | link |\r\n|---|---|---|---|\r\n| seq-portal | SEQUENCE (PORTAL) | sequence | [./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md) |","size_chars":311,"tokens_estimate":78}
{"doc_id":"ew-entities-index","path":"entities-index.md","title":"Entities Index","owner":"team-docs","tags":["catalog","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Policies\r","anchor_slug":"policies","chunk_index":5,"content":"## Policies\n\n| id | name | kind | link |\r\n|---|---|---|---|\r\n| policy-api-store-procedure | Policy API ‚Üî Store Procedure | policy | [./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/policy-api-store-procedure-easyway-data-portal.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/policy-api-store-procedure-easyway-data-portal.md) |\r\n| policy-logging-sensitive | Gestione Log & Dati Sensibili | policy | [./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili.md) |\r\n| policy-microservices-gateway | Policy di Configurazione & Sicurezza ‚Äî Microservizi e API Gateway | policy | [./EasyWay_WebApp/02_logiche_easyway/policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway.md](./EasyWay_WebApp/02_logiche_easyway/policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway.md) |","size_chars":970,"tokens_estimate":242}
{"doc_id":"ew-entities-index","path":"entities-index.md","title":"Entities Index","owner":"team-docs","tags":["catalog","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Flows\r","anchor_slug":"flows","chunk_index":6,"content":"## Flows\n\n| id | name | kind | link |\r\n|---|---|---|---|\r\n| flow-login-onboarding | Login & Onboarding | flow | [./EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding.md](./EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding.md) |\r\n| flow-notifiche | Notifiche ‚Äì Gestione | flow | [./EasyWay_WebApp/02_logiche_easyway/notifiche-gestione.md](./EasyWay_WebApp/02_logiche_easyway/notifiche-gestione.md) |\r\n| flow-external-apis | API Esterne ‚Äì Integrazione | flow | [./EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione.md](./EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione.md) |","size_chars":606,"tokens_estimate":152}
{"doc_id":"ew-entities-index","path":"entities-index.md","title":"Entities Index","owner":"team-docs","tags":["catalog","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Data\r","anchor_slug":"data","chunk_index":7,"content":"## Data\n\n| id | name | kind | link |\r\n|---|---|---|---|\r\n| datalake-naming-standard | Standard Accesso Storage e Datalake (IAM & Naming) | standard | [./EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md](./EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md) |","size_chars":366,"tokens_estimate":92}
{"doc_id":"ew-entities-index","path":"entities-index.md","title":"Entities Index","owner":"team-docs","tags":["catalog","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Standards\r","anchor_slug":"standards","chunk_index":8,"content":"## Standards\n\n| id | name | kind | link |\r\n|---|---|---|---|\r\n| std-rest-naming | Convenzioni REST e naming | standard | [./EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/convenzioni-rest-e-naming.md](./EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/convenzioni-rest-e-naming.md) |\r\n| std-best-practice-naming | Best Practice Naming & Scalabilit√† | standard | [./EasyWay_WebApp/02_logiche_easyway/best-practice-naming-and-scalability.md](./EasyWay_WebApp/02_logiche_easyway/best-practice-naming-and-scalability.md) |","size_chars":540,"tokens_estimate":135}
{"doc_id":"ew-entities-index","path":"entities-index.md","title":"Entities Index","owner":"team-docs","tags":["catalog","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Guides\r","anchor_slug":"guides","chunk_index":9,"content":"## Guides\n\n| id | name | kind | link |\r\n|---|---|---|---|\r\n| guide-logging-audit | Logging & Audit | guide | [./EasyWay_WebApp/02_logiche_easyway/logging-and-audit.md](./EasyWay_WebApp/02_logiche_easyway/logging-and-audit.md) |\r\n| guide-api-onboarding | API ‚Äì Onboarding | guide | [./EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-onboarding.md](./EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-onboarding.md) |\r\n| guide-api-notifiche | API ‚Äì Notifiche | guide | [./EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-notifiche.md](./EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-notifiche.md) |\r\n| guide-api-invio-notifica | API ‚Äì Invio Notifica | guide | [./EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-invio-notifica.md](./EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-invio-notifica.md) |\r\n| guide-api-checklist-test | Checklist di test API | guide | [./EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/checklist-di-test-api.md](./EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/checklist-di-test-api.md) |\r\n| guide-integrazione-shopify | Esempio ‚Äì Integrazione Shopify | guide | [./EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/esempio-integrazione-shopify.md](./EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/esempio-integrazione-shopify.md) |","size_chars":1390,"tokens_estimate":348}
{"doc_id":"ew-entities-index","path":"entities-index.md","title":"Entities Index","owner":"team-docs","tags":["catalog","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":10,"content":"## Domande a cui risponde\r\n- Dove trovo l'elenco delle entit√† e i link rapidi?\r\n- Quali categorie di entit√† sono coperte?\r\n- Come navigo verso documenti specifici partendo dall'indice?","size_chars":184,"tokens_estimate":46}
{"doc_id":"index","path":"INDEX.md","title":"Indice Globale","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Indice Globale","anchor_slug":"indice-globale","chunk_index":1,"content":"# Indice Globale\n\n- [ACTIVITY_LOG.md](./ACTIVITY_LOG.md) - Activity Log ‚Äì CSV friendly (delimiter: ¬¶)\n  - H2: Domande a cui risponde\n  - H2: API ‚Äì Eventi approvati\n- [agent-manifest-and-indexing-best-practices.md](./agent-manifest-and-indexing-best-practices.md) - Agent Manifest & Indexing - Best Practices\n  - H2: Obiettivo\n  - H2: Manifest JSONL (consumo per agenti)\n  - H2: Anchors CSV (richiami di sezione)\n- [agents-governance.md](./agents-governance.md) - AGENTS_GOVERNANCE\n- [best-practices-token-tuning-roadmap.md](./best-practices-token-tuning-roadmap.md) - Best Practices & Roadmap ‚Äì Token Tuning, AI-Readiness e Governance Universale\n  - H2: Obiettivo\n  - H2: 1. Best Practices per la Riduzione Token e l‚ÄôAI-Readiness\n  - H2: 2. Applicazione alle Principali Varianti di Formato\n- [blueprints/replicate-easyway-dataportal.md](./blueprints/replicate-easyway-dataportal.md) - Variabili Pipeline (ADO) ‚Äì Esempio\n- [deploy-app-service.md](./deploy-app-service.md) - DEPLOY_APP_SERVICE\n- [docs-conventions.md](./docs-conventions.md) - EasyWayData Portal ‚Äì Regole Semplici (La Nostra Bibbia)\n  - H2: 1) Nomi di file e cartelle (semplici)\n  - H2: 1.1) Convenzione di Nomenclatura ‚Äì kebab-case vs snake_case\n  - H2: Uso di kebab-case e snake_case per AI, DB e API\n- [EasyWay_WebApp/01_database_architecture/01a-db-setup.md](./EasyWay_WebApp/01_database_architecture/01a-db-setup.md) - EasyWay Data Portal ‚Äì Database SETUP\n  - H2: ‚úÖ Scopo del file\n  - H2: 1Ô∏è‚É£ **Login SQL Server (da creare su MASTER)**\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/01_database_architecture/01b_schema_structure/portal.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/portal.md) - EasyWay Data Portal ‚Äì PORTAL.md\n  - H2: ‚úÖ Scopo del file\n  - H2: üìã **Riepilogo tabelle principali schema PORTAL**\n  - H2: 5Ô∏è‚É£ **Accesso sezioni Portale** (Policy Section Access custom)\n- [EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability.md) - Domande a cui risponde\n  - H2: Domande a cui risponde\n  - H2: Scopo\n  - H2: Schema/DDL\n- [EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md) - Domande a cui risponde\n  - H2: Domande a cui risponde\n  ","size_chars":2400,"tokens_estimate":600}
{"doc_id":"index","path":"INDEX.md","title":"Indice Globale","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Indice Globale","anchor_slug":"indice-globale","chunk_index":2,"content":"- H2: Scopo\n  - H2: Schema/DDL\n- [EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/index.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/index.md) - Indice\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md) - EasyWay Data Portal ‚Äì SEQUENCE\n  - H2: ‚úÖ Scopo del file\n  - H2: 1Ô∏è‚É£ Sequence PRODUZIONE (NDG reali)\n  - H2: 2Ô∏è‚É£ Sequence DEBUG/TEST (codici demo)\n- [EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md) - EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template\n  - H2: ‚úÖ Scopo del documento\n  - H2: **Template** ##\n  - H2: Template standard EasyWay (produzione)\n- [EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md) - a) **sp_insert_configuration**\n  - H2: Domande a cui risponde\n  - H2: Scopo\n  - H2: Schema/DDL\n- [EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/index.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/index.md) - Indice\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md) - a) **sp_insert_profile_domain**\n  - H2: Domande a cui risponde\n  - H2: Scopo\n  - H2: Schema/DDL\n- [EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md) - a) **sp_insert_section_access**\n  - H2: Domande a cui risponde\n  - H2: Scopo\n  - H2: Schema/DDL\n- [EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-proce","size_chars":2400,"tokens_estimate":600}
{"doc_id":"index","path":"INDEX.md","title":"Indice Globale","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Indice Globale","anchor_slug":"indice-globale","chunk_index":3,"content":"dure/stats-execution-log.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md) - Domande a cui risponde\n  - H2: Domande a cui risponde\n  - H2: Scopo\n  - H2: Schema/DDL\n- [EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md) - a) **sp_insert_subscription**\n  - H2: Domande a cui risponde\n  - H2: Scopo\n  - H2: Schema/DDL\n- [EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md) - sp_insert_tenant\n  - H2: Domande a cui risponde\n  - H2: Scopo\n  - H2: Schema/DDL\n- [EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md) - a) **sp_insert_user_notification_settings**\n  - H2: Domande a cui risponde\n  - H2: Scopo\n  - H2: Schema/DDL\n- [EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md](./EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md) - Domande a cui risponde\n  - H2: Domande a cui risponde\n  - H2: Scopo\n  - H2: Schema/DDL\n- [EasyWay_WebApp/01_database_architecture/01b-schema-structure.md](./EasyWay_WebApp/01_database_architecture/01b-schema-structure.md) - Domande a cui risponde\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/01_database_architecture/best-practices-checklist.md](./EasyWay_WebApp/01_database_architecture/best-practices-checklist.md) - BEST_PRACTICES_CHECKLIST\n- [EasyWay_WebApp/01_database_architecture/db-studio.md](./EasyWay_WebApp/01_database_architecture/db-studio.md) - DB_STUDIO\n- [EasyWay_WebApp/01_database_architecture/flyway.md](./EasyWay_WebApp/01_database_architecture/flyway.md) - Le credenziali (URL/USER/PASSWORD) si passano come env nel runner\n- [EasyWay_WebApp/01_database_architecture/index.md](./EasyWay_WebApp/01_database_architecture/index.md) - Indice\n  - H2: Domande a cui risponde\n- [Ea","size_chars":2400,"tokens_estimate":600}
{"doc_id":"index","path":"INDEX.md","title":"Indice Globale","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Indice Globale","anchor_slug":"indice-globale","chunk_index":4,"content":"syWay_WebApp/01_database_architecture/portal.md](./EasyWay_WebApp/01_database_architecture/portal.md) - PORTAL\n- [EasyWay_WebApp/01_database_architecture/sequence.md](./EasyWay_WebApp/01_database_architecture/sequence.md) - SEQUENCE\n- [EasyWay_WebApp/01_database_architecture/storeprocess.md](./EasyWay_WebApp/01_database_architecture/storeprocess.md) - STOREPROCESS\n- [EasyWay_WebApp/01-database-architecture.md](./EasyWay_WebApp/01-database-architecture.md) - EasyWay Data Portal ‚Äì Database Architecture Master\n  - H2: ‚úÖ Scopo del Documento\n  - H2: üëæ Conversational Intelligence & AMS Ready ‚Äî Principi Base\n  - H2: üìÇ Schemi Database Principali\n- [EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione.md](./EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione.md) - Integrazione API Esterne ‚Äì EasyWay Data Portal\n  - H2: Lookup ‚Äì Integrazione API Esterne\n  - H2: Tabella Integrazioni API Esterne\n  - H2: Policy Sicurezza & Gestione Key/API\n- [EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-invio-notifica.md](./EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-invio-notifica.md) - **1. Schema di validazione**\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-notifiche.md](./EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-notifiche.md) - **1. Schema di validazione**\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-onboarding.md](./EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-onboarding.md) - ENDPOINT: POST `/api/onboarding`\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/checklist-di-test-api.md](./EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/checklist-di-test-api.md) - Checklist di test API (EasyWay Data Portal)\n  - H2: Checklist di test API (EasyWay Data Portal)\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/convenzioni-rest-e-naming.md](./EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/convenzioni-rest-e-naming.md) - Convenzioni REST EasyWay\n  - H2: Convenzioni REST EasyWay\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/esempio-integrazione-shopify.md](./EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/esempio-integrazione-shopify.md)","size_chars":2400,"tokens_estimate":600}
{"doc_id":"index","path":"INDEX.md","title":"Indice Globale","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Indice Globale","anchor_slug":"indice-globale","chunk_index":5,"content":" - Integrazione Shopify ‚Äì Dettaglio & Esempio Pratico\n  - H2: Overview\n  - H2: Tabella Integrazione Shopify\n  - H2: Esempio Pratico ‚Äì Recupero Ordini (API)\n- [EasyWay_WebApp/02_logiche_easyway/best-practice-naming-and-scalability.md](./EasyWay_WebApp/02_logiche_easyway/best-practice-naming-and-scalability.md) - Lookup ‚Äì Best Practice Naming & Scalabilit√†\n  - H2: Tabella Naming Convention (macro overview)\n  - H2: Best Practice Scalabilit√†\n  - H2: Checklist Naming & Scalabilit√†\n- [EasyWay_WebApp/02_logiche_easyway/index.md](./EasyWay_WebApp/02_logiche_easyway/index.md) - Indice\n- [EasyWay_WebApp/02_logiche_easyway/logging-and-audit.md](./EasyWay_WebApp/02_logiche_easyway/logging-and-audit.md) - Logging & Audit ‚Äì EasyWay Data Portal\n  - H2: Lookup Logging & Audit ‚Äì Microservizi & API Gateway\n  - H2: Tabella Eventi/Audit da Tracciare\n  - H2: Best Practice Monitoring & Audit\n- [EasyWay_WebApp/02_logiche_easyway/logging-and-audit/readme.md](./EasyWay_WebApp/02_logiche_easyway/logging-and-audit/readme.md) - Checklist Operativa ‚Äì Logging & Audit\n  - H2: Obiettivo\n  - H2: Checklist Logging & Audit\n  - H2: Template di commento/README da includere in ogni script/codice\n- [EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding.md](./EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding.md) - Lookup ‚Äì Flussi Onboarding/Login\n  - H2: Tabella Flussi Utente\n  - H2: Best Practice Onboarding/Login\n  - H2: Esempio Flusso Step-by-Step ‚Äì Onboarding Locale\n- [EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/esempi-flussi-avanzati-onboarding-login.md](./EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/esempi-flussi-avanzati-onboarding-login.md) - Esempi Flussi Avanzati Onboarding/Login\n  - H2: Esempi Flussi Avanzati Onboarding/Login\n  - H2: Dettaglio Esempio ‚Äì SSO Aziendale Custom (Entra ID/SAML/OIDC)\n  - H2: Dettaglio Esempio ‚Äì Gestione Consensi Privacy\n- [EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/esempi-flussi-verticali-pa-accesso-tramite-spid-e-cie.md](./EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/esempi-flussi-verticali-pa-accesso-tramite-spid-e-cie.md) - Esempi Flussi Verticali PA ‚Äì Accesso tramite SPID e CIE\n  - H2: Esempio Dettagliato ‚Äì Accesso tramite SPID\n  - H2: Esempio Dettagliato ‚Äì Accesso tramite CIE\n  - H2: Esempio Onboarding Integrato SPID/CIE\n- [EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/readme.m","size_chars":2400,"tokens_estimate":600}
{"doc_id":"index","path":"INDEX.md","title":"Indice Globale","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Indice Globale","anchor_slug":"indice-globale","chunk_index":6,"content":"d](./EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/readme.md) - Flussi Onboarding/Login ‚Äì Dettagli & Variazioni\n  - H2: Tabella Flussi Aggiuntivi e Variazioni\n  - H2: Dettaglio Pratiche Operative\n  - H2: Esempio Flusso ‚ÄúUpgrade prospect ‚Üí cliente reale‚Äù\n- [EasyWay_WebApp/02_logiche_easyway/notifiche-gestione.md](./EasyWay_WebApp/02_logiche_easyway/notifiche-gestione.md) - Lookup ‚Äì Gestione Notifiche\n  - H2: Tabella Tipologia Notifiche\n  - H2: Gestione Preferenze Notifica Utente\n  - H2: Flusso Invio Notifiche (step-by-step)\n- [EasyWay_WebApp/02_logiche_easyway/notifiche-gestione/esempi-notifiche-and-template-email-configurabili.md](./EasyWay_WebApp/02_logiche_easyway/notifiche-gestione/esempi-notifiche-and-template-email-configurabili.md) - Esempi Notifiche & Template Email Configurabili (Excel su Storage)\n  - H2: 1. Flusso Gestione Template Email\n  - H2: 2. Struttura file Excel `email_templates.xlsx`\n  - H2: 3. Esempio di codice (pseudo, architettura agnostica)\n- [EasyWay_WebApp/02_logiche_easyway/policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway.md](./EasyWay_WebApp/02_logiche_easyway/policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway.md) - Policy di Configurazione & Sicurezza ‚Äì Microservizi e API Gateway\n  - H2: Dettaglio Implementativo Policy Chiave\n  - H2: **Best Practice Operativa**\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/02_logiche_easyway/raccomandazione-architetturale-easyway-data-portal.md](./EasyWay_WebApp/02_logiche_easyway/raccomandazione-architetturale-easyway-data-portal.md) - **Dalle chat emerge chiaramente che:**\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/02-logiche-easyway.md](./EasyWay_WebApp/02-logiche-easyway.md) - Prefazione ‚Äì EasyWay Data Portal  \n  - H2: Guida alla Documentazione Funzionale e Architetturale\n  - H2: Macro-sezioni documentate\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md](./EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md) - üóÇÔ∏è EasyWay DataPortal - Standard Accesso Storage e Datalake (IAM & Naming)\n  - H2: üéØ Scopo del Documento\n  - H2: üîé Differenza tra Blob Storage e Datalake HNS\n  - H2: üè∑Ô∏è Naming Convention - Utenze di Servizio\n- [EasyWay_WebApp/03_datalake_dev/index.md](./EasyWay_WebApp/03_datalake_dev/index.md) -","size_chars":2400,"tokens_estimate":600}
{"doc_id":"index","path":"INDEX.md","title":"Indice Globale","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Indice Globale","anchor_slug":"indice-globale","chunk_index":7,"content":" Indice\n- [EasyWay_WebApp/03-datalake-dev.md](./EasyWay_WebApp/03-datalake-dev.md) - `landing/`\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/04-accesso-registrazione-notifiche.md](./EasyWay_WebApp/04-accesso-registrazione-notifiche.md) - EasyWay Data Portal - Documentazione Funzionale Completa\n  - H2: 1Ô∏è‚É£ Obiettivo\n  - H2: 2Ô∏è‚É£ Flusso Registrazione e Accesso Utente\n  - H2: 3Ô∏è‚É£ Architettura Generale del Portale (Microservizi / Container)\n- [EasyWay_WebApp/05_codice_easyway_portale/apim-jwt-tenant-claim-policy.md](./EasyWay_WebApp/05_codice_easyway_portale/apim-jwt-tenant-claim-policy.md) - apim-jwt-tenant-claim-policy\n- [EasyWay_WebApp/05_codice_easyway_portale/docs.md](./EasyWay_WebApp/05_codice_easyway_portale/docs.md) - Domande a cui risponde\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/agentic-readiness-and-examples.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/agentic-readiness-and-examples.md) - Agentic Readiness & Esempi (Users/Onboarding)\n  - H2: Scopo\n  - H2: Linee guida agentiche\n  - H2: Esempio 1 ‚Äî USERS (CRUD via SP)\n- [EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/dinamiche-di-manutenzione.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/dinamiche-di-manutenzione.md) - Capitolo ‚Äì Dinamiche di Manutenzione\n  - H2: Architettura delle Cartelle ‚Äî Dinamiche di Manutenzione\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/endpoint.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/endpoint.md) - Domande a cui risponde\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-001-get-api-config.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-001-get-api-config.md) - ENDPOINT: GET `/api/config`\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-001a-get-api-config-da-db.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-001a-get-api-config-da-db.md) - A. Codice - File da creare/aggiornare\n  - H2: A. Codice - File da creare/aggiornare\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-002-get-api-branding.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDP","size_chars":2400,"tokens_estimate":600}
{"doc_id":"index","path":"INDEX.md","title":"Indice Globale","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Indice Globale","anchor_slug":"indice-globale","chunk_index":8,"content":"OINT/endp-002-get-api-branding.md) - **1. `src/routes/branding.ts`**\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-003-get-crud-api-users.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-003-get-crud-api-users.md) - ENDPOINT: CRUD `/api/users`\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/index.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/index.md) - Indice\n- [EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/template-endpoint.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/template-endpoint.md) - ENDPOINT: [HTTP_VERB] `/api/your-endpoint`\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/Template-ENDPOINT/come-si-testa.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/Template-ENDPOINT/come-si-testa.md) - Domande a cui risponde\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili.md) - Gestione Log ‚Äî EasyWay Data Portal\n  - H2: **Principi guida**\n  - H2: **Tipi di log gestiti**\n  - H2: **Policy dati sensibili**\n- [EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili/automazione-export-log-su-datalake-e-compliance.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili/automazione-export-log-su-datalake-e-compliance.md) - Automazione export log su Datalake & Compliance\n  - H2: Obiettivo\n  - H2: Soluzione consigliata (EasyWay Data Portal)\n  - H2: Flusso tecnico\n- [EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili/logging-conversational-ready-agent-aware.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili/logging-conversational-ready-agent-aware.md) - Logging conversational-ready (agent-aware)\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/index.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/index.md) - Indice\n  - H2: Doma","size_chars":2400,"tokens_estimate":600}
{"doc_id":"index","path":"INDEX.md","title":"Indice Globale","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Indice Globale","anchor_slug":"indice-globale","chunk_index":9,"content":"nde a cui risponde\n- [EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/policy-api-store-procedure-easyway-data-portal.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/policy-api-store-procedure-easyway-data-portal.md) - Policy API/Store Procedure ‚Äî EasyWay Data Portal\n  - H2: Principio Guida\n  - H2: Vantaggi del modello\n  - H2: Pattern operativo\n- [EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-1-setup-ambiente/create-json.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-1-setup-ambiente/create-json.md) - EasyWay Data Portal API ‚Äî Starter Kit\n  - H2: Comandi principali\n  - H2: Struttura file configurazione\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-2-struttura-src-e-primi-file/conversational-and-agent-aware-ready.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-2-struttura-src-e-primi-file/conversational-and-agent-aware-ready.md) - **. Controller**\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-4-query-dinamiche-locale-datalake/query-in-src-queries.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-4-query-dinamiche-locale-datalake/query-in-src-queries.md) - Domande a cui risponde\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-5-validazione-avanzata-dati-in-ingresso/validazione-avanzata.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-5-validazione-avanzata-dati-in-ingresso/validazione-avanzata.md) - **A. Middleware di validazione per parametri e querystring**\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/05_codice_easyway_portale/easyway-portal-api.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway-portal-api.md) - EasyWay Data Portal ‚Äî Manifesto Tecnologico & Analitico\n  - H2: Codice\n  - H2: Premessa e Visione\n  - H2: Scelte Architetturali e Motivazioni\n- [EasyWay_WebApp/05_codice_easyway_portale/easyway-portal-frontend.md](./EasyWay_WebApp/05_codice_easyway_portale/easyway-portal-frontend.md) - Domande a cui risponde\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/05_codice_easyway_portale/iac.md](./EasyWay_WebApp/05_codice_easyway_portale/iac.md) - Domande a cui risponde\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/05_codice_easyway_portale/index.md](./Eas","size_chars":2400,"tokens_estimate":600}
{"doc_id":"index","path":"INDEX.md","title":"Indice Globale","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Indice Globale","anchor_slug":"indice-globale","chunk_index":10,"content":"yWay_WebApp/05_codice_easyway_portale/index.md) - Indice\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/05_codice_easyway_portale/qa-setup-and-test-locale.md](./EasyWay_WebApp/05_codice_easyway_portale/qa-setup-and-test-locale.md) - EasyWay Data Portal ‚Äî Q&A Setup & Test Locale\n  - H2: Aggiornamenti dal 2025-07-28 al 2025-07-29\n  - H2: **Note generali**\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/05_codice_easyway_portale/readme.md](./EasyWay_WebApp/05_codice_easyway_portale/readme.md) - Domande a cui risponde\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/05_codice_easyway_portale/scripts.md](./EasyWay_WebApp/05_codice_easyway_portale/scripts.md) - Domande a cui risponde\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/05_codice_easyway_portale/security-and-observability.md](./EasyWay_WebApp/05_codice_easyway_portale/security-and-observability.md) - security-and-observability\n- [EasyWay_WebApp/05-codice-easyway-portale.md](./EasyWay_WebApp/05-codice-easyway-portale.md) - Domande a cui risponde\n  - H2: Domande a cui risponde\n- [EasyWay_WebApp/06-frontend-architecture.md](./EasyWay_WebApp/06-frontend-architecture.md) - EasyWay Data Portal ‚Äì Frontend Architecture & Integration\n  - H2: üéØ Obiettivo\n  - H2: üìÅ Struttura Progetto Frontend (Next.js)\n  - H2: üîÑ Mappatura Controller Backend ‚áÑ Frontend UI\n- [EasyWay_WebApp/07-iam-naming-utenti-gruppi.md](./EasyWay_WebApp/07-iam-naming-utenti-gruppi.md) - üìÇ Wiki IAM - Naming Convention Utenze Tecniche e Gruppi  \n  - H2: üéØ Scopo del Documento  \n  - H2: üîë Naming Convention - Utenze Tecniche di Servizio  \n  - H2: üîë Naming Convention - Gruppi IAM (RBAC)  \n- [EasyWay_WebApp/10-ai-agents.md](./EasyWay_WebApp/10-ai-agents.md) - EasyWay DataPortal ‚Äì Conversational Intelligence & AMS\n  - H2: Obiettivo\n  - H2: Sommario\n  - H2: 1. Introduzione\n- [easyway-webapp.md](./easyway-webapp.md) - üéØ EasyWay Data Portal ‚Äì Start With Why\n  - H2: üß≠ Why ‚Äì Perch√© lo facciamo\n  - H2: üõ† How ‚Äì Come lo facciamo\n  - H2: üì¶ What ‚Äì Cosa offriamo\n- [entities-index.md](./entities-index.md) - Entities Index\n  - H2: Endpoints\n  - H2: DB Stored Procedures\n  - H2: DB Sequences\n- [INDEX.md](./INDEX.md) - Indice Globale\n  - H2: Domande a cui risponde\n- [LLM_READINESS_CHECKLIST.md](./LLM_READINESS_CHECKLIST.md) - LLM Readiness ‚Äì Lista Semplice (Per Persone e AI)\n  - H2: Checklist per OGNI pagina (.md)\n  - H2: Checklist NOMI (file e cartelle)\n ","size_chars":2400,"tokens_estimate":600}
{"doc_id":"index","path":"INDEX.md","title":"Indice Globale","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Indice Globale","anchor_slug":"indice-globale","chunk_index":11,"content":" - H2: Checklist CONTENUTI (per tipo)\n- [logs/reports/anchors-20251018064203.md](./logs/reports/anchors-20251018064203.md) - Anchor Check (20251018064203)\n  - H2: Domande a cui risponde\n- [logs/reports/anchors-20251018093206.md](./logs/reports/anchors-20251018093206.md) - Anchor Check (20251018093206)\n  - H2: Domande a cui risponde\n- [logs/reports/anchors-20251018103044.md](./logs/reports/anchors-20251018103044.md) - Anchor Check (20251018103044)\n  - H2: Domande a cui risponde\n- [logs/reports/anchors-20251018103742.md](./logs/reports/anchors-20251018103742.md) - Anchor Check (20251018103742)\n- [logs/reports/anchors-20251018104140.md](./logs/reports/anchors-20251018104140.md) - Anchor Check (20251018104140)\n- [logs/reports/anchors-20251018104418.md](./logs/reports/anchors-20251018104418.md) - Anchor Check (20251018104418)\n- [logs/reports/anchors-20251018104748.md](./logs/reports/anchors-20251018104748.md) - Anchor Check (20251018104748)\n- [logs/reports/anchors-20251018105948.md](./logs/reports/anchors-20251018105948.md) - Anchor Check (20251018105948)\n- [logs/reports/anchors-20251018110026.md](./logs/reports/anchors-20251018110026.md) - Anchor Check (20251018110026)\n- [logs/reports/anchors-20251018110253.md](./logs/reports/anchors-20251018110253.md) - Anchor Check (20251018110253)\n- [logs/reports/anchors-20251018124502.md](./logs/reports/anchors-20251018124502.md) - Anchor Check (20251018124502)\n- [logs/reports/anchors-20251018125020.md](./logs/reports/anchors-20251018125020.md) - Anchor Check (20251018125020)\n- [logs/reports/anchors-20251018132417.md](./logs/reports/anchors-20251018132417.md) - Anchor Check (20251018132417)\n- [logs/reports/anchors-20251018134027.md](./logs/reports/anchors-20251018134027.md) - Anchor Check (20251018134027)\n- [logs/reports/atomicity-20251018151337.md](./logs/reports/atomicity-20251018151337.md) - Atomicity Lint\n- [logs/reports/atomicity-20251018151922.md](./logs/reports/atomicity-20251018151922.md) - Atomicity Lint\n- [logs/reports/atomicity-20251018152434.md](./logs/reports/atomicity-20251018152434.md) - Atomicity Lint\n- [logs/reports/atomicity-20251018152951.md](./logs/reports/atomicity-20251018152951.md) - Atomicity Lint\n- [logs/reports/atomicity-20251018153046.md](./logs/reports/atomicity-20251018153046.md) - Atomicity Lint\n- [logs/reports/atomicity-20251018153234.md](./logs/reports/atomicity-20251018153234.md) - Atomicity ","size_chars":2400,"tokens_estimate":600}
{"doc_id":"index","path":"INDEX.md","title":"Indice Globale","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Indice Globale","anchor_slug":"indice-globale","chunk_index":12,"content":"Lint\n- [logs/reports/atomicity-20251018153342.md](./logs/reports/atomicity-20251018153342.md) - Atomicity Lint\n- [logs/reports/atomicity-20251018154041.md](./logs/reports/atomicity-20251018154041.md) - Atomicity Lint\n- [logs/reports/atomicity-20251018154437.md](./logs/reports/atomicity-20251018154437.md) - Atomicity Lint\n- [logs/reports/atomicity-20251018160012.md](./logs/reports/atomicity-20251018160012.md) - Atomicity Lint\n- [logs/reports/atomicity-20251018160206.md](./logs/reports/atomicity-20251018160206.md) - Atomicity Lint\n- [logs/reports/atomicity-20251018160726.md](./logs/reports/atomicity-20251018160726.md) - Atomicity Lint\n- [logs/reports/atomicity-20251018161142.md](./logs/reports/atomicity-20251018161142.md) - Atomicity Lint\n- [logs/reports/atomicity-20251018163121.md](./logs/reports/atomicity-20251018163121.md) - Atomicity Lint\n- [logs/reports/atomicity-20251018163339.md](./logs/reports/atomicity-20251018163339.md) - Atomicity Lint\n- [logs/reports/atomicity-20251018163431.md](./logs/reports/atomicity-20251018163431.md) - Atomicity Lint\n- [logs/reports/llm-readiness-20251018103206.md](./logs/reports/llm-readiness-20251018103206.md) - LLM Readiness Mini-Report (20251018103206)  | File | Missing | |---|---|\n- [logs/reports/naming-20251018061858-analysis.md](./logs/reports/naming-20251018061858-analysis.md) - Naming Report Analysis (20251018061858)\n  - H2: Domande a cui risponde\n- [logs/reports/normalize-20251018161054.md](./logs/reports/normalize-20251018161054.md) - Normalize Scan Report\n- [logs/reports/normalize-20251018161055.md](./logs/reports/normalize-20251018161055.md) - Normalize Scan Report\n- [logs/reports/normalize-20251018161134.md](./logs/reports/normalize-20251018161134.md) - Normalize Scan Report\n- [logs/reports/normalize-20251018161530-EasyWayData.wiki.md](./logs/reports/normalize-20251018161530-EasyWayData.wiki.md) - Normalize Scan Report\n- [logs/reports/normalize-20251018161531-EasyWayData.wiki.md](./logs/reports/normalize-20251018161531-EasyWayData.wiki.md) - Normalize Scan Report\n- [parametrization-best-practices.md](./parametrization-best-practices.md) - PARAMETRIZATION_BEST_PRACTICES\n- [roadmap.md](./roadmap.md) - Roadmap & Qualit√† Documentazione\n  - H2: Obiettivi\n  - H2: Comandi locali (riassunto)\n  - H2: Pipeline CI (Azure DevOps)\n- [scripts/scripts.md](./scripts/scripts.md) - Scripts - One-shot e routine frequenti\n  - H2: On","size_chars":2400,"tokens_estimate":600}
{"doc_id":"index","path":"INDEX.md","title":"Indice Globale","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Indice Globale","anchor_slug":"indice-globale","chunk_index":13,"content":"e-shot: rigenera tutto (root corrente)\n  - H2: Multi-root: aggrega pi√π progetti\n  - H2: Multi-root: normalizzazione (scan/apply) e report\n- [TODO_CHECKLIST.md](./TODO_CHECKLIST.md) - TODO ‚Äì Razionalizzazione Wiki (Semplice)\n  - H2: Convenzioni e struttura\n  - H2: Rinomine e pulizia nomi\n  - H2: Metadati e front matter\n- [wiki-uniformamento-roadmap.md](./wiki-uniformamento-roadmap.md) - Roadmap Uniformamento Wiki secondo docs-conventions\n  - H2: Obiettivi\n  - H2: Fasi e Sequenza\n  - H2: Per‚ÄëCartella (linee guida)","size_chars":517,"tokens_estimate":129}
{"doc_id":"ew-llm_readiness_checklist","path":"LLM_READINESS_CHECKLIST.md","title":"LLM Readiness ‚Äì Lista Semplice (Per Persone e AI)","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Checklist per OGNI pagina (.md)\r","anchor_slug":"checklist-per-ogni-pagina-md","chunk_index":1,"content":"## Checklist per OGNI pagina (.md)\r\n- [ ] Ha il front matter YAML completo (id, title, summary, status, owner, tags, llm, entities)?\r\n- [ ] Titolo chiaro (H1) e sezioni in ordine: Scopo, Prerequisiti, Passi, Esempi, Errori comuni, Domande, Collegamenti.\r\n- [ ] Frasi brevi, niente ‚Äúvedi sopra/sotto‚Äù, sigle spiegate la prima volta.\r\n- [ ] Esempi di codice/payload in blocchi ``` ben formattati.\r\n- [ ] Niente dati sensibili (PII). Se presenti: `llm.pii: contains-pii` e indicare redazione.\r\n- [ ] Link relativi funzionanti a 2‚Äì5 pagine correlate.\r\n- [ ] Domande a cui risponde (3‚Äì7) presenti.\r\n- [ ] `tags` e `entities` valorizzati (minimo: dominio, layer, audience, privacy, lingua).","size_chars":684,"tokens_estimate":171}
{"doc_id":"ew-llm_readiness_checklist","path":"LLM_READINESS_CHECKLIST.md","title":"LLM Readiness ‚Äì Lista Semplice (Per Persone e AI)","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Checklist NOMI (file e cartelle)\r","anchor_slug":"checklist-nomi-file-e-cartelle","chunk_index":2,"content":"## Checklist NOMI (file e cartelle)\r\n- [ ] Solo minuscole, `-`, numeri (kebab-case). Nessuno `%2D`, quote/backtick, spazi.\r\n- [ ] Niente caratteri strani (ÔøΩ). Niente & (usa `and`). Niente accenti.\r\n- [ ] Nomi corti e chiari. Se serve ordine locale: prefissi `01-`, `02-`.","size_chars":271,"tokens_estimate":68}
{"doc_id":"ew-llm_readiness_checklist","path":"LLM_READINESS_CHECKLIST.md","title":"LLM Readiness ‚Äì Lista Semplice (Per Persone e AI)","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Checklist CONTENUTI (per tipo)\r","anchor_slug":"checklist-contenuti-per-tipo","chunk_index":3,"content":"## Checklist CONTENUTI (per tipo)\r\nDBA (tabelle, procedure):\r\n- [ ] DDL idempotente (crea solo se non esiste) + rollback.\r\n- [ ] PK `<table>_id`, indici e FK nominati, default UTC per `created_at`.\r\n- [ ] Esempi query base e note di performance.\n\nAPI (endpoint):\r\n- [ ] Metodo, path, input/validazioni, output, errori (codici e messaggi).\r\n- [ ] Esempi `curl`/JSON e schema degli oggetti (se serve).\n\nETL (pipeline):\r\n- [ ] Sorgente ‚Üí destinazione, mapping colonne, qualit√† dati, schedule.\r\n- [ ] Monitoraggio e fallback (cosa fare in caso di errore).\n\nAMS/Operazioni (runbook):\r\n- [ ] Avvio/stop, health-check, log e dashboard utili.\r\n- [ ] Allarmi: causa, destinazione, come si risolve.\n\nAnalista/BI (metriche, dashboard):\r\n- [ ] Definizione metrica (nome, formula, fonte, filtro).\r\n- [ ] Scopo dashboard, utenti target, viste chiave.","size_chars":836,"tokens_estimate":209}
{"doc_id":"ew-llm_readiness_checklist","path":"LLM_READINESS_CHECKLIST.md","title":"LLM Readiness ‚Äì Lista Semplice (Per Persone e AI)","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Repository: controlli periodici\r","anchor_slug":"repository-controlli-periodici","chunk_index":4,"content":"## Repository: controlli periodici\r\n- [ ] Indice auto (per cartella) con titoli e link (`INDEX.md`).\r\n- [ ] Link checker (nessun link rotto, nessuna anchor duplicata). Anchor checker: i link con #ancora puntano a H1/H2/H3 esistenti (slug coerente).\r\n- [ ] Report nomi (niente `%2D`, backtick, maiuscole dove non servono).\r\n- [ ] Stima pezzi per AI (chunk 400‚Äì600 token): pagine molto lunghe ‚Üí sezioni pi√π piccole.\r\n- [ ] Privacy e `llm.include`: file sensibili esclusi o ridatti.","size_chars":479,"tokens_estimate":120}
{"doc_id":"ew-llm_readiness_checklist","path":"LLM_READINESS_CHECKLIST.md","title":"LLM Readiness ‚Äì Lista Semplice (Per Persone e AI)","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Suggerimenti pratici\r","anchor_slug":"suggerimenti-pratici","chunk_index":5,"content":"## Suggerimenti pratici\r\n- Pagine corte vincono. Molte pagine piccole > una enorme.\r\n- Ogni pagina risponde a poche domande specifiche.\r\n- Usa esempi reali (funzionanti). Evita immagini con testo.\n\n\r\nEsecuzione rapida (con anchor check)\r\n`\r\nEasyWayData.wiki/scripts/review-run.ps1 -Root EasyWayData.wiki -Mode kebab -CheckAnchors\r\n`\r\nIl report ancore √® in EasyWayData.wiki/logs/reports/anchors-*.md.","size_chars":399,"tokens_estimate":100}
{"doc_id":"ew-llm_readiness_checklist","path":"LLM_READINESS_CHECKLIST.md","title":"LLM Readiness ‚Äì Lista Semplice (Per Persone e AI)","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":6,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-param-best-practices","path":"parametrization-best-practices.md","title":"parametrization-best-practices","owner":"team-platform","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T19:08:35+02:00","section_level":2,"anchor_text":"parametrization-best-practices","anchor_slug":"parametrization-best-practices","chunk_index":1,"content":"Principi\n- Niente valori hardcoded: tutto parametrizzabile via env, YAML o Variable Group.\n- Config separata dal codice; default sensati in dev; sicurezza in prod (Key Vault/Variable Group).\n\nAPI (env)\n- Sicurezza: `RATE_LIMIT_WINDOW_MS`, `RATE_LIMIT_MAX`, `BODY_LIMIT`, `ALLOWED_ORIGINS`, `TRUST_PROXY`\n- Auth: `AUTH_ISSUER`, `AUTH_JWKS_URI`, `AUTH_AUDIENCE`, `TENANT_CLAIM`, `AUTH_CLIENT_ID`, `AUTH_TENANT_ID`, `AUTH_SCOPES`\n- Storage: `AZURE_STORAGE_CONNECTION_STRING` o `AZURE_STORAGE_ACCOUNT` (MI)\n- Branding: `BRANDING_CONTAINER`, `BRANDING_PREFIX`, `DEFAULT_TENANT_ID`\n- RLS: `RLS_CONTEXT_ENABLED` (true/false)\n- Log: `LOG_LEVEL`, `LOG_DIR`\n- Portal: `PORTAL_BASE_PATH` (default `/portal`)\n\nPipeline (YAML/vars)\n- Versioni esterne: `ci/versions.yml` ‚Üí `node_version`, `flyway_version`, `terraform_version`\n- Gates condizionati: `ENABLE_CHECKLIST`, `ENABLE_DB_DRIFT`, `ENABLE_KB_CONSISTENCY`, `FLYWAY_ENABLED`\n  - Disattiva/attiva i job senza modificare la pipeline.\n- Segreti/connessioni: Variable Group/Key Vault.\n\nFlyway & Terraform\n- Parametri/credenziali passati come variabili (mai hardcoded).\n- Config file (flyway.conf) minimale; URL/USER/PASSWORD da env.\n\nEsempi\n- Pipeline: `- template: ci/versions.yml` per versioni; `condition: eq(variables['ENABLE_*'],'true')` per gates.\n- API: `app.use(process.env.PORTAL_BASE_PATH || '/portal', portalRoutes)`; `withTenantContext` usa `RLS_CONTEXT_ENABLED`.","size_chars":1412,"tokens_estimate":353}
{"doc_id":"ew-roadmap","path":"roadmap.md","title":"Roadmap & Qualit√† Documentazione","owner":"team-docs","tags":["roadmap","quality","automation","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Obiettivi\r","anchor_slug":"obiettivi","chunk_index":1,"content":"## Obiettivi\r\n- Garantire naming/ancore=0, front matter completo, Q&A minime e code fence con linguaggio.\r\n- Generare manifest JSONL/CSV, anchors e chunk per agenti.\r\n- Automatizzare scan/apply multi‚Äëroot e pubblicare report in CI.","size_chars":231,"tokens_estimate":58}
{"doc_id":"ew-roadmap","path":"roadmap.md","title":"Roadmap & Qualit√† Documentazione","owner":"team-docs","tags":["roadmap","quality","automation","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Comandi locali (riassunto)\r","anchor_slug":"comandi-locali-riassunto","chunk_index":2,"content":"## Comandi locali (riassunto)\r\n```powershell\r\n# 1) Scansione normalizzazione (multi-root)\r\n. scripts/normalize-project-multi.ps1 -Roots @('.') -Mode scan\n\n# 2) Applicazione normalizzazione (front matter, fence, tag, Q&A index)\r\n. scripts/normalize-project-multi.ps1 -Roots @('.') -Mode apply -EnsureFrontMatter\n\n# 3) Rebuild + lint\r\n./scripts/review-run.ps1 -Root . -Mode kebab -CheckAnchors\r\n. ./scripts/generate-entities-index.ps1 -Root .\r\n. ./scripts/generate-master-index.ps1 -Root .\r\n. ./scripts/export-chunks-jsonl.ps1 -Root .\r\n. ./scripts/lint-atomicity.ps1 -Root .\r\n```","size_chars":577,"tokens_estimate":144}
{"doc_id":"ew-roadmap","path":"roadmap.md","title":"Roadmap & Qualit√† Documentazione","owner":"team-docs","tags":["roadmap","quality","automation","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Pipeline CI (Azure DevOps)\r","anchor_slug":"pipeline-ci-azure-devops","chunk_index":3,"content":"## Pipeline CI (Azure DevOps)\r\n- La pipeline `azure-pipelines.yml` lancia la scansione normalizzatrice in modalit√† `scan` ad ogni PR e pubblica i report `logs/reports/*` come artifact.\r\n- Estendibile per includere rebuild e linter se richiesto.","size_chars":244,"tokens_estimate":61}
{"doc_id":"ew-roadmap","path":"roadmap.md","title":"Roadmap & Qualit√† Documentazione","owner":"team-docs","tags":["roadmap","quality","automation","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Criteri di accettazione\r","anchor_slug":"criteri-di-accettazione","chunk_index":4,"content":"## Criteri di accettazione\r\n- Lint atomicit√†: nessun file con Q&A < 3 (fuori whitelist) e nessun code fence senza linguaggio.\r\n- Naming/Anchor check: 0 issue.\r\n- Manifest/Anchors/Chunks aggiornati.","size_chars":197,"tokens_estimate":49}
{"doc_id":"ew-todo_checklist","path":"TODO_CHECKLIST.md","title":"TODO ‚Äì Razionalizzazione Wiki (Semplice)","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Convenzioni e struttura\r","anchor_slug":"convenzioni-e-struttura","chunk_index":1,"content":"## Convenzioni e struttura\r\n- [ ] Integrare la guida ‚Äúkebab-case vs snake_case‚Äù in `DOCS_CONVENTIONS.md` (con regex ed esempi buoni/cattivi)\r\n- [ ] Aggiungere ‚ÄúQuick Check‚Äù con regex di verifica naming\r\n- [ ] Creare sezioni ‚ÄúRicette‚Äù per AI: `create-table`, `create-endpoint`, `create-job-etl`","size_chars":293,"tokens_estimate":73}
{"doc_id":"ew-todo_checklist","path":"TODO_CHECKLIST.md","title":"TODO ‚Äì Razionalizzazione Wiki (Semplice)","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Rinomine e pulizia nomi","anchor_slug":"rinomine-e-pulizia-nomi","chunk_index":2,"content":"## Rinomine e pulizia nomi\n- [x] Normalizzare cartella endpoint residua: `.../ENDPOINT/GET-'api%2Dconfig'/` (nomi puliti, kebab-case)\r\n- [x] Pulizia percent-encoding e caratteri speciali in `02_logiche_easyway/`\r\n- [ ] Pulizia percent-encoding e caratteri speciali in `03_datalake_dev/`\r\n- [ ] Rimuovere backtick/quote nei nomi file (`quotes/backticks`)\r\n- [ ] Uniformare maiuscole/minuscole (tutto minuscolo per file/cartelle)","size_chars":427,"tokens_estimate":107}
{"doc_id":"ew-todo_checklist","path":"TODO_CHECKLIST.md","title":"TODO ‚Äì Razionalizzazione Wiki (Semplice)","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":3,"anchor_text":"Rinomine puntuali (20251019)","anchor_slug":"rinomine-puntuali-20251019","chunk_index":3,"content":"### Rinomine puntuali (20251019)\n- [ ] EasyWayData.wiki/agents-governance.md ‚Üí agents-governance.md\n- [ ] EasyWayData.wiki/deploy-app-service.md ‚Üí deploy-app-service.md\n- [ ] EasyWayData.wiki/parametrization-best-practices.md ‚Üí parametrization-best-practices.md\n- [ ] EasyWayData.wiki/roadmap.md ‚Üí roadmap.md\n- [ ] EasyWay_WebApp/01_database_architecture/best-practices-checklist.md ‚Üí best-practices-checklist.md\n- [ ] EasyWay_WebApp/01_database_architecture/db-studio.md ‚Üí db-studio.md\n- [ ] EasyWay_WebApp/01_database_architecture/flyway.md ‚Üí flyway.md\n- [ ] EasyWay_WebApp/01_database_architecture/portal.md ‚Üí portal.md\n- [ ] EasyWay_WebApp/01_database_architecture/sequence.md ‚Üí sequence.md\n- [ ] EasyWay_WebApp/01_database_architecture/storeprocess.md ‚Üí storeprocess.md\n- [ ] EasyWay_WebApp/01_database_architecture/01b_schema_structure/portal.md ‚Üí portal.md\n- [ ] EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/dinamiche-di-manutenzione.md ‚Üí dinamiche-di-manutenzione.md\n- [ ] EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/endpoint.md ‚Üí endpoint.md\n- [ ] EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/index.md ‚Üí index.md\n- [ ] EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/template-endpoint.md ‚Üí template-endpoint.md\n- [ ] EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/Template-ENDPOINT/come-si-testa.md ‚Üí come-si-testa.md\n- [ ] Valutare esclusione dal linter dei report generati: Wiki/EasyWayData.wiki/logs/reports/normalize-*.md","size_chars":1532,"tokens_estimate":383}
{"doc_id":"ew-todo_checklist","path":"TODO_CHECKLIST.md","title":"TODO ‚Äì Razionalizzazione Wiki (Semplice)","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Metadati e front matter\r","anchor_slug":"metadati-e-front-matter","chunk_index":4,"content":"## Metadati e front matter\r\n- [ ] Aggiungere front matter YAML minimo alle pagine chiave (owner, summary, tags, llm)\r\n- [x] 02_logiche_easyway: front matter minimale aggiunto a tutti i `.md`\r\n- [ ] Marcatura privacy/PII (`llm.include`, `llm.pii`) per aree sensibili\r\n- [ ] Aggiungere sezione ‚ÄúQuestions Answered‚Äù (3‚Äì7 Q&A) nei documenti lunghi","size_chars":343,"tokens_estimate":86}
{"doc_id":"ew-todo_checklist","path":"TODO_CHECKLIST.md","title":"TODO ‚Äì Razionalizzazione Wiki (Semplice)","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Indici e link\r","anchor_slug":"indici-e-link","chunk_index":5,"content":"## Indici e link\r\n- [ ] Generare `EasyWayData.wiki/INDEX.md` con H1/H2 e link\r\n- [ ] Aggiungere `INDEX.md` per le principali sottocartelle (DB, API, flussi)\r\n- [ ] Eseguire link checker markdown e correggere link rotti/anchor mancanti\r\n- [x] 02_logiche_easyway: creati `INDEX.md` per cartella e sottocartelle principali","size_chars":319,"tokens_estimate":80}
{"doc_id":"ew-todo_checklist","path":"TODO_CHECKLIST.md","title":"TODO ‚Äì Razionalizzazione Wiki (Semplice)","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Automazioni e controlli\r","anchor_slug":"automazioni-e-controlli","chunk_index":6,"content":"## Automazioni e controlli\r\n- [ ] Linter naming file (ASCII/kebab-case), report settimanale\r\n- [ ] Verifica front matter obbligatoria (campi minimi)\r\n- [ ] Report ‚ÄúLLM readiness‚Äù periodico (mancano summary/tags/PII)","size_chars":215,"tokens_estimate":54}
{"doc_id":"ew-todo_checklist","path":"TODO_CHECKLIST.md","title":"TODO ‚Äì Razionalizzazione Wiki (Semplice)","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Export per AI (dataset)\r","anchor_slug":"export-per-ai-dataset","chunk_index":7,"content":"## Export per AI (dataset)\r\n- [ ] Definire schema `JSONL` per export (chunk H2/H3, overlap)\r\n- [ ] Script export con calcolo token e batch embedding\r\n- [ ] Escludere file con `llm.include: false`","size_chars":195,"tokens_estimate":49}
{"doc_id":"ew-todo_checklist","path":"TODO_CHECKLIST.md","title":"TODO ‚Äì Razionalizzazione Wiki (Semplice)","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Entit√† e tassonomia\r","anchor_slug":"entit-e-tassonomia","chunk_index":8,"content":"## Entit√† e tassonomia\r\n- [ ] Espandere `entities.yaml` (endpoint, SP, tabelle, flussi) con 20+ voci\r\n- [ ] Mappare entit√† dalle pagine a `entities:` nel front matter","size_chars":166,"tokens_estimate":42}
{"doc_id":"ew-todo_checklist","path":"TODO_CHECKLIST.md","title":"TODO ‚Äì Razionalizzazione Wiki (Semplice)","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Estensioni per ruoli (guide rapide)\r","anchor_slug":"estensioni-per-ruoli-guide-rapide","chunk_index":9,"content":"## Estensioni per ruoli (guide rapide)\r\n- [ ] DBA: convenzioni DDL, template idempotenza, checklist vincoli/indici\r\n- [ ] AMS/Ops: runbook, allarmi, health-check, troubleshooting\r\n- [ ] ETL: mapping, qualit√† dati, schedule, monitoraggio\r\n- [ ] Analista/BI: metriche, fonti, dashboard, glossario","size_chars":294,"tokens_estimate":74}
{"doc_id":"ew-todo_checklist","path":"TODO_CHECKLIST.md","title":"TODO ‚Äì Razionalizzazione Wiki (Semplice)","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Accettazione\r","anchor_slug":"accettazione","chunk_index":10,"content":"## Accettazione\r\n- [ ] Tutte le pagine hanno front matter base + summary\r\n- [ ] Nessun file con `%2D`, backtick, `ÔøΩ`, spazi o maiuscole\r\n- [ ] Indici presenti (radice + sottocartelle chiave)\r\n- [ ] Link checker senza errori\r\n- [ ] Export JSONL generato per subset pilota (API endpoint)","size_chars":285,"tokens_estimate":71}
{"doc_id":"ew-todo_checklist","path":"TODO_CHECKLIST.md","title":"TODO ‚Äì Razionalizzazione Wiki (Semplice)","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:45+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":11,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Obiettivi\r","anchor_slug":"obiettivi","chunk_index":1,"content":"## Obiettivi\n\n- Uniformare naming, front matter, struttura contenuti, linking e indici.\r\n- Rendere ogni pagina LLM‚Äëfriendly e bambino‚Äëfriendly.\r\n- Automatizzare check e report per iterazioni rapide.","size_chars":198,"tokens_estimate":50}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Fasi e Sequenza\r","anchor_slug":"fasi-e-sequenza","chunk_index":2,"content":"## Fasi e Sequenza","size_chars":18,"tokens_estimate":4}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Fase 0 ‚Äî Baseline e strumenti\r","anchor_slug":"fase-0-baseline-e-strumenti","chunk_index":3,"content":"### Fase 0 ‚Äî Baseline e strumenti\r\n- Confermare regole in `docs-conventions.md` e `LLM_READINESS_CHECKLIST.md`.\r\n- Usare `scripts/review-run.ps1` e `scripts/review-examples.ps1`; tenere aggiornati `entities.yaml` e `entities-index.md`.","size_chars":235,"tokens_estimate":59}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Fase 1 ‚Äî Naming e indici\r","anchor_slug":"fase-1-naming-e-indici","chunk_index":4,"content":"### Fase 1 ‚Äî Naming e indici\r\n- Applicare batch di rinomine per kebab-case; generare `index.md` in sottocartelle e `INDEX.md` globale.\r\n- Aggiornare link interni; rigenerare `entities-index.md`.","size_chars":194,"tokens_estimate":48}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Fase 2 ‚Äî Front Matter\r","anchor_slug":"fase-2-front-matter","chunk_index":5,"content":"### Fase 2 ‚Äî Front Matter\r\n- Aggiungere front matter minimo a tutti i `.md` (id, title, summary, owner, tags, llm, entities).\r\n- Assegnare owner/tag per area (es. team-docs, team-api, team-data, team-ops).","size_chars":205,"tokens_estimate":51}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Fase 3 ‚Äî Struttura Pagine\r","anchor_slug":"fase-3-struttura-pagine","chunk_index":6,"content":"### Fase 3 ‚Äî Struttura Pagine\r\n- Uniformare sezioni: Scopo, Prerequisiti, Passi, Esempi, Errori comuni, Q&A, Collegamenti.\r\n- Obbligatoria ‚ÄúQuestions Answered‚Äù (3‚Äì7) e blocchi di codice con linguaggio.","size_chars":201,"tokens_estimate":50}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Fase 4 ‚Äî Entit√† e Tagging\r","anchor_slug":"fase-4-entit-e-tagging","chunk_index":7,"content":"### Fase 4 ‚Äî Entit√† e Tagging\r\n- Aggiornare `entities.yaml` con entit√† da DB, API, policy, flussi, standard.\r\n- Aggiungere `entities: [...]` nel front matter; rigenerare `entities-index.md`.","size_chars":190,"tokens_estimate":48}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Fase 5 ‚Äî Link e Ancore\r","anchor_slug":"fase-5-link-e-ancore","chunk_index":8,"content":"### Fase 5 ‚Äî Link e Ancore\r\n- Link checker + anchor checker (`-CheckAnchors`); correggere link rotti/ancore mancanti.","size_chars":117,"tokens_estimate":29}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Fase 6 ‚Äî Privacy e PII\r","anchor_slug":"fase-6-privacy-e-pii","chunk_index":9,"content":"### Fase 6 ‚Äî Privacy e PII\r\n- Classificare privacy (`privacy/*`) e PII (`llm.pii`) nelle pagine sensibili; attivare redaction se necessario.","size_chars":140,"tokens_estimate":35}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Fase 7 ‚Äî QA Finale\r","anchor_slug":"fase-7-qa-finale","chunk_index":10,"content":"### Fase 7 ‚Äî QA Finale\r\n- Eseguire review-run completo (naming=0, anchors=0, indici creati).\r\n- Allineare `docs-conventions.md` se emergono nuovi pattern.","size_chars":154,"tokens_estimate":38}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Per‚ÄëCartella (linee guida)\r","anchor_slug":"percartella-linee-guida","chunk_index":11,"content":"## Per‚ÄëCartella (linee guida)","size_chars":29,"tokens_estimate":7}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"01_database_architecture\r","anchor_slug":"01databasearchitecture","chunk_index":12,"content":"### 01_database_architecture\r\n- `programmability/` (function.md, sequence.md, stored-procedure/*.md): front matter con `artifact/*`, check esempi DDL idempotenti; `index.md` a livello cartella e sottocartella.\r\n- `01a-db-setup.md`, `01b-schema-structure.md`: sezioni standard, Q&A, collegamenti a entit√† DB.","size_chars":307,"tokens_estimate":77}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"02_logiche_easyway\r","anchor_slug":"02logicheeasyway","chunk_index":13,"content":"### 02_logiche_easyway\r\n- Sotto‚Äëcartelle (`api-esterne-integrazione`, `logging-and-audit`, `login-flussi-onboarding`, `notifiche-gestione`): front matter completo, esempi CURL/JSON, schemi input/output, Q&A.\r\n- Aggiornare `entities.yaml` con standard (`rest-naming`, `best-practice-naming`) e guide.","size_chars":299,"tokens_estimate":75}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"03_datalake_dev\r","anchor_slug":"03datalakedev","chunk_index":14,"content":"### 03_datalake_dev\r\n- Standard IAM/naming: front matter (policy/security), esempi e tabelle schemi.","size_chars":100,"tokens_estimate":25}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"05_codice_easyway_portale\r","anchor_slug":"05codiceeasywayportale","chunk_index":15,"content":"### 05_codice_easyway_portale\r\n- `easyway_portal_api`: endpoint con schema `endp-00n-*.md` + front matter ricco; policy e step con naming pulito; index cartella; anchor check.\r\n- I log/policy e standard devono linkare entit√† e pagine correlate.","size_chars":244,"tokens_estimate":61}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"06_frontend_architecture, 07_iam_naming_utenti_gruppi, 10_ai_agents\r","anchor_slug":"06frontendarchitecture-07iamnamingutentigruppi-10aiagents","chunk_index":16,"content":"### 06_frontend_architecture, 07_iam_naming_utenti_gruppi, 10_ai_agents\r\n- Front matter + sezioni standard; esempi path e mapping, Q&A, collegamenti.","size_chars":149,"tokens_estimate":37}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Template Autoriali (snippet)\r","anchor_slug":"template-autoriali-snippet","chunk_index":17,"content":"## Template Autoriali (snippet)","size_chars":31,"tokens_estimate":8}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Endpoint (API)\r","anchor_slug":"endpoint-api","chunk_index":18,"content":"### Endpoint (API)\r\n- Purpose, Inputs/Validations, Responses (200/4xx/5xx), Examples (curl/JSON), Error handling, Related.","size_chars":122,"tokens_estimate":30}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Stored Procedure\r","anchor_slug":"stored-procedure","chunk_index":19,"content":"### Stored Procedure\r\n- Purpose, Signature, Inputs/Outputs, Idempotenza, Indici/FK/Check, Esempi invocazione, Rollback, Related.","size_chars":128,"tokens_estimate":32}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Flow/Guide/Standard\r","anchor_slug":"flowguidestandard","chunk_index":20,"content":"### Flow/Guide/Standard\r\n- Scope, Prereqs, Steps, Examples, Pitfalls, Q&A, Related, Entities.","size_chars":93,"tokens_estimate":23}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Automazioni (da usare sempre)\r","anchor_slug":"automazioni-da-usare-sempre","chunk_index":21,"content":"## Automazioni (da usare sempre)","size_chars":32,"tokens_estimate":8}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Naming + indici\r","anchor_slug":"naming-indici","chunk_index":22,"content":"### Naming + indici\r\n- `EasyWayData.wiki/scripts/review-run.ps1 -Root EasyWayData.wiki -Mode kebab`","size_chars":99,"tokens_estimate":25}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Anchor check\r","anchor_slug":"anchor-check","chunk_index":23,"content":"### Anchor check\r\n- `EasyWayData.wiki/scripts/review-run.ps1 -Root EasyWayData.wiki -Mode kebab -CheckAnchors`","size_chars":110,"tokens_estimate":28}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Index globale\r","anchor_slug":"index-globale","chunk_index":24,"content":"### Index globale\r\n- `. EasyWayData.wiki/scripts/review-examples.ps1; New-RootIndex -Root 'EasyWayData.wiki'`","size_chars":109,"tokens_estimate":27}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Log attivit√†\r","anchor_slug":"log-attivit","chunk_index":25,"content":"### Log attivit√†\r\n- `EasyWayData.wiki/scripts/add-log.ps1 -Type DOC -Scope wiki -Status success -Owner team-docs -Message \"Aggiornata roadmap uniformamento\" -Split monthly`","size_chars":172,"tokens_estimate":43}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Manifest per agenti (JSONL/CSV) + ancore\r","anchor_slug":"manifest-per-agenti-jsonlcsv-ancore","chunk_index":26,"content":"### Manifest per agenti (JSONL/CSV) + ancore\r\n- `EasyWayData.wiki/scripts/generate-master-index.ps1 -Root EasyWayData.wiki`\r\n- Output: `index_master.csv`, `index_master.jsonl`, `anchors_master.csv`","size_chars":197,"tokens_estimate":49}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Criteri di Accettazione\r","anchor_slug":"criteri-di-accettazione","chunk_index":27,"content":"## Criteri di Accettazione\n\n- Naming: 0 warning (runner naming=0) o warning solo whitelistati (meta/legacy).\r\n- Front matter: presente in tutti i `.md` (id, title, summary, owner, tags, llm, entities).\r\n- Struttura: sezioni standard + Q&A in ogni pagina.\r\n- Link: 0 link file mancanti, 0 anchor mancanti (report anchors=0).\r\n- Indici: `index.md` in cartelle chiave + `INDEX.md` globale aggiornato.\r\n- Entities: `entities.yaml` aggiornato + `entities-index.md` rigenerato.\r\n- Privacy: `llm.include/pii` coerenti; redaction indicata dove serve.","size_chars":542,"tokens_estimate":136}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Assegnazione Owner e Tag (esempio)\r","anchor_slug":"assegnazione-owner-e-tag-esempio","chunk_index":28,"content":"## Assegnazione Owner e Tag (esempio)\n\n- team-docs: root, convenzioni, checklist, indici.\r\n- team-api: easyway_portal_api, endpoint, policy api.\r\n- team-data: 01_database_architecture, 03_datalake_dev.\r\n- team-ops: logging, runbook, iac.\n\nTag base:\r\n- `layer/architecture`, `layer/reference`, `layer/how-to`, `policy/security/logging`, `artifact/endpoint/function/sequence/stored-procedure`, `audience/dev/ops/data/product`.","size_chars":424,"tokens_estimate":106}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Roadmap Operativa\r","anchor_slug":"roadmap-operativa","chunk_index":29,"content":"## Roadmap Operativa","size_chars":20,"tokens_estimate":5}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Sprint 1 (2‚Äì3 giorni)\r","anchor_slug":"sprint-1-23-giorni","chunk_index":30,"content":"### Sprint 1 (2‚Äì3 giorni)\r\n- Conferma tassonomia tag/owner; passata completa naming (runner); indici cartelle; front matter top-level; baseline `entities.yaml`.","size_chars":160,"tokens_estimate":40}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Sprint 2 (3‚Äì5 giorni)\r","anchor_slug":"sprint-2-35-giorni","chunk_index":31,"content":"### Sprint 2 (3‚Äì5 giorni)\r\n- Front matter completo per 01/02/05; struttura sezioni standard + Q&A; `entities-index.md` aggiornato.","size_chars":130,"tokens_estimate":32}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Sprint 3 (3‚Äì5 giorni)\r","anchor_slug":"sprint-3-35-giorni","chunk_index":32,"content":"### Sprint 3 (3‚Äì5 giorni)\r\n- Link + anchor checker; fix rotture; privacy/PII; index globale.","size_chars":92,"tokens_estimate":23}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Sprint 4 (2‚Äì3 giorni)\r","anchor_slug":"sprint-4-23-giorni","chunk_index":33,"content":"### Sprint 4 (2‚Äì3 giorni)\r\n- Rifiniture, report finale ‚ÄúLLM readiness‚Äù; aggiornamento `docs-conventions.md` con lessons learned.","size_chars":128,"tokens_estimate":32}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Rischi e Mitigazioni\r","anchor_slug":"rischi-e-mitigazioni","chunk_index":34,"content":"## Rischi e Mitigazioni\n\n- Link rotti post‚Äërinomina: correre sempre update link + anchor check prima del merge.\r\n- Legacy path rumorosi: whitelist documentata; migrazione pianificata a valle.\r\n- Double source/duplicati: eliminare file legacy appena la versione kebab-case √® valida (loggare CLEAN).","size_chars":297,"tokens_estimate":74}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Output e Report\r","anchor_slug":"output-e-report","chunk_index":35,"content":"## Output e Report\n\n- `logs/reports/naming-*.txt` (naming issues)\r\n- `logs/reports/anchors-*.md` (anchor issues)\r\n- `entities-index.md` rigenerato\r\n- `ACTIVITY_LOG.md` aggiornato per ogni step (CSV-friendly)\r\n- `index_master.csv` e `index_master.jsonl` per agenti e filtri rapidi\r\n- `anchors_master.csv` per richiami di sezione H2/H3","size_chars":333,"tokens_estimate":83}
{"doc_id":"wiki-uniformamento-roadmap","path":"wiki-uniformamento-roadmap.md","title":"Roadmap Uniformamento Wiki secondo docs-conventions","owner":"team-docs","tags":["roadmap","quality","documentation","governance","ai-readiness","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":36,"content":"## Domande a cui risponde\r\n- Qual √® il piano pratico per uniformare la wiki secondo le convenzioni?\r\n- Quali strumenti/script usare e quando?\r\n- Quali sono i criteri di accettazione misurabili?\r\n- Come assegnare owner/tag e tracciare l‚Äôavanzamento?","size_chars":248,"tokens_estimate":62}
{"doc_id":"ew-blueprint-replicate","path":"blueprints/replicate-easyway-dataportal.md","title":"Variabili Pipeline (ADO) ‚Äì Esempio","owner":"team-platform","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T23:18:40+02:00","section_level":3,"anchor_text":"Variabili Pipeline (ADO) ‚Äì Esempio","anchor_slug":"variabili-pipeline-ado-esempio","chunk_index":1,"content":"### Variabili Pipeline (ADO) ‚Äì Esempio\n- Variable Group (es. `EasyWay-Secrets`) o variabili di pipeline:\n  - `RESOURCE_GROUP_NAME = rg-easyway-dev`\n  - `STORAGE_ACCOUNT_NAME = ewdlkdev123` (nome storage univoco globale)\n  - `TENANTS = [\"tenant01\",\"tenant02\"]` (lista JSON; anche singolo tenant va tra [])\n- Queste variabili alimentano i parametri Terraform nello stage `Infra`.","size_chars":377,"tokens_estimate":94}
{"doc_id":"ew-blueprint-replicate","path":"blueprints/replicate-easyway-dataportal.md","title":"Variabili Pipeline (ADO) ‚Äì Esempio","owner":"team-platform","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T23:18:40+02:00","section_level":3,"anchor_text":"Creare/aggiornare Variable Group via script (PowerShell)","anchor_slug":"creareaggiornare-variable-group-via-script-powershell","chunk_index":2,"content":"### Creare/aggiornare Variable Group via script (PowerShell)\n- File esempio: `scripts/variables/easyway-secrets.sample.json` (modifica i valori e salva una copia per il tuo progetto)\n- Script: `scripts/ado-set-variable-group.ps1`\n- Esempio esecuzione:\n```\npwsh ./scripts/ado-set-variable-group.ps1 \\\n  -OrgUrl https://dev.azure.com/contoso \\\n  -Project easyway \\\n  -Pat <ADO_PAT> \\\n  -GroupName EasyWay-Secrets \\\n  -VariablesJsonPath scripts/variables/easyway-secrets.sample.json \\\n  -SecretsKeys \"AZURE_STORAGE_CONNECTION_STRING,DB_CONN_STRING\"\n```\n- Lo script crea/aggiorna il Variable Group con tutte le chiavi; quelle elencate in `SecretsKeys` sono marcate come segrete.\n- Variable Group: imposta `AZURE_STORAGE_CONNECTION_STRING` (o MI), `BRANDING_CONTAINER`, `BRANDING_PREFIX`, `AUTH_*`, DB.\n\n7) Test\n- REST Client: usa i file in `tests/api/rest-client/*` impostando `@token` con un JWT valido.\n- Jest: esegui `npm test` (test protetti ‚Üí 401 senza token per health).\n\n8) Checklist Bot (Agent‚ÄëReady)\n- Verifica automatica pre‚Äëdeploy: `pwsh ./scripts/checklist.ps1` (root) oppure `npm run check:predeploy` (API).\n- Controlli: env (Auth/Branding), connessione SQL, accesso Storage (branding/queries), OpenAPI valido.\n- Output machine‚Äëreadable (JSON) per gli agent e integrazione CI.\n\nChecklist finale\n- [ ] Terraform apply completato e output mappati alle env\n- [ ] App registration con claim tenant funzionante\n- [ ] File branding caricati in `portal-assets/config/`\n- [ ] `.env.local` aggiornato e API avviata correttamente\n- [ ] OpenAPI allineata, sicurezza Bearer documentata\n- [ ] Pipeline con Variable Group impostato\n- [ ] Smoke test REST/Jest passano (401 atteso senza token)","size_chars":1686,"tokens_estimate":422}
{"doc_id":"ew-01-database-architecture","path":"EasyWay_WebApp/01-database-architecture.md","title":"EasyWay Data Portal ‚Äì Database Architecture Master","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"‚úÖ Scopo del Documento\r","anchor_slug":"scopo-del-documento","chunk_index":1,"content":"## ‚úÖ Scopo del Documento\n\nQuesta ‚Äúbibbia architetturale‚Äù raccoglie **tutti i principi, regole, policy e best practice** del database EasyWay Data Portal, orientati anche all‚Äôautomazione e al dialogo con bot/agent (Conversational Intelligence).\r\n**Ogni oggetto tecnico (DDL, funzioni, sequence, store, ecc.) √® sempre documentato in file `.md` dedicati e linkati da questo documento.**\n\n---","size_chars":388,"tokens_estimate":97}
{"doc_id":"ew-01-database-architecture","path":"EasyWay_WebApp/01-database-architecture.md","title":"EasyWay Data Portal ‚Äì Database Architecture Master","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"üëæ Conversational Intelligence & AMS Ready ‚Äî Principi Base\r","anchor_slug":"conversational-intelligence-ams-ready-principi-base","chunk_index":2,"content":"## üëæ Conversational Intelligence & AMS Ready ‚Äî Principi Base\n\n- **Tutto √® progettato per essere gestito anche da chatbot, agent, AMS, LLM e API automatiche** (non solo da DBA/operatori umani).\r\n- **Ogni store process e funzione**:\r\n    - Parametri chiari e documentati\r\n    - Logging centralizzato su STATS_EXECUTION_LOG e LOG_AUDIT\r\n    - Output strutturato e standard (OK/KO, ID, messaggio, ...), facilmente parsabile da bot o strumenti di monitoring\r\n    - Esempi di prompt e output nei .md tecnici\r\n- **Ogni oggetto di database** ha naming self-explained, descrizione extended property e audit.\r\n- **Tutto √® sempre testabile, monitorabile e riusabile via automation**.\n\n---","size_chars":678,"tokens_estimate":170}
{"doc_id":"ew-01-database-architecture","path":"EasyWay_WebApp/01-database-architecture.md","title":"EasyWay Data Portal ‚Äì Database Architecture Master","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"üìÇ Schemi Database Principali\r","anchor_slug":"schemi-database-principali","chunk_index":3,"content":"## üìÇ Schemi Database Principali\n\n| Schema      | Scopo                              |\r\n|-------------|------------------------------------|\r\n| `PORTAL`    | Anagrafiche, ACL, tenant, ruoli, NDG, surrogate key, mascheramento, sequence, store |\r\n| `BRONZE`    | Dati raw (staging tecnico)         |\r\n| `SILVER`    | Dati validati e puliti             |\r\n| `GOLD`      | Dati business-ready, RLS, auditing |\r\n| `REPORTING` | Viste consolidate per BI           |\r\n| `WORK`      | Area tecnica temporanea            |\n\n---","size_chars":518,"tokens_estimate":130}
{"doc_id":"ew-01-database-architecture","path":"EasyWay_WebApp/01-database-architecture.md","title":"EasyWay Data Portal ‚Äì Database Architecture Master","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"üö© Policy & Principi Architetturali\r","anchor_slug":"policy-principi-architetturali","chunk_index":4,"content":"## üö© Policy & Principi Architetturali\n\n- Surrogate key INT (`id`) + NDG alfanumerica univoca su tutte le anagrafiche principali\r\n- **PORTAL**: PK, FK, relazioni hard sempre obbligatorie\r\n- **Altri schema**: FK fisiche solo se serve, logica documentata\r\n- Campi tecnici sempre: `created_by`, `created_at`, `updated_at`, `ext_attributes`\r\n- Sequence, function e store procedure sempre in doppia versione: PROD e DEBUG\r\n- Mascheramento e RLS sempre previsti dove serve\r\n- Login federata e password hashata obbligatorie per sicurezza\r\n- **Tutto deve essere gestibile, loggabile, richiamabile da bot/chatbot/agent/AMS**\r\n- Output strutturato in tutte le store process di business/AMS\r\n- Documentazione e prompt di esempio per ogni oggetto\r\n- **Ogni evoluzione architetturale va prima discussa e documentata qui**\n\n---","size_chars":813,"tokens_estimate":203}
{"doc_id":"ew-01-database-architecture","path":"EasyWay_WebApp/01-database-architecture.md","title":"EasyWay Data Portal ‚Äì Database Architecture Master","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"üóÇÔ∏è Struttura della documentazione tecnica\r","anchor_slug":"struttura-della-documentazione-tecnica","chunk_index":5,"content":"## üóÇÔ∏è Struttura della documentazione tecnica\n\nPer ogni area/oggetto di database, trovi qui il link al relativo `.md` tecnico dettagliato.","size_chars":138,"tokens_estimate":34}
{"doc_id":"ew-01-database-architecture","path":"EasyWay_WebApp/01-database-architecture.md","title":"EasyWay Data Portal ‚Äì Database Architecture Master","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**PORTAL**\r","anchor_slug":"portal","chunk_index":6,"content":"### **PORTAL**\r\nTabelle, PK/FK, NDG, sequence, policy, convenzioni","size_chars":66,"tokens_estimate":16}
{"doc_id":"ew-01-database-architecture","path":"EasyWay_WebApp/01-database-architecture.md","title":"EasyWay Data Portal ‚Äì Database Architecture Master","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**GOLD**\r","anchor_slug":"gold","chunk_index":7,"content":"### **GOLD**\r\nBusiness, reporting, auditing, RLS","size_chars":48,"tokens_estimate":12}
{"doc_id":"ew-01-database-architecture","path":"EasyWay_WebApp/01-database-architecture.md","title":"EasyWay Data Portal ‚Äì Database Architecture Master","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**STORE PROCEDURE**\r","anchor_slug":"store-procedure","chunk_index":8,"content":"### **STORE PROCEDURE**\r\nOnboarding, test, ACL, automation","size_chars":58,"tokens_estimate":14}
{"doc_id":"ew-01-database-architecture","path":"EasyWay_WebApp/01-database-architecture.md","title":"EasyWay Data Portal ‚Äì Database Architecture Master","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**SEQUENCE**\r","anchor_slug":"sequence","chunk_index":9,"content":"### **SEQUENCE**\r\nNumeratori e gestione codici NDG (prod + debug)","size_chars":65,"tokens_estimate":16}
{"doc_id":"ew-01-database-architecture","path":"EasyWay_WebApp/01-database-architecture.md","title":"EasyWay Data Portal ‚Äì Database Architecture Master","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**FUNZIONI**\r","anchor_slug":"funzioni","chunk_index":10,"content":"### **FUNZIONI**\r\nFunzioni di supporto (generazione NDG, masking, RLS)","size_chars":70,"tokens_estimate":18}
{"doc_id":"ew-01-database-architecture","path":"EasyWay_WebApp/01-database-architecture.md","title":"EasyWay Data Portal ‚Äì Database Architecture Master","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**EXCEL**\r","anchor_slug":"excel","chunk_index":11,"content":"### **EXCEL**\r\nExport documentale per audit o tool di data modeling","size_chars":67,"tokens_estimate":17}
{"doc_id":"ew-01-database-architecture","path":"EasyWay_WebApp/01-database-architecture.md","title":"EasyWay Data Portal ‚Äì Database Architecture Master","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**dbdiagram.io**\r","anchor_slug":"dbdiagramio","chunk_index":12,"content":"### **dbdiagram.io**\r\nModello visuale sempre aggiornato per import/export ERD\r\n- https://dbdiagram.io/d/687cf3b9f413ba3508bd95c0","size_chars":128,"tokens_estimate":32}
{"doc_id":"ew-01-database-architecture","path":"EasyWay_WebApp/01-database-architecture.md","title":"EasyWay Data Portal ‚Äì Database Architecture Master","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**SETUP**\r","anchor_slug":"setup","chunk_index":13,"content":"### **SETUP**\r\n- [DB-SETUP](./01_database_architecture/01a-db-setup.md)\n\n---","size_chars":76,"tokens_estimate":19}
{"doc_id":"ew-01-database-architecture","path":"EasyWay_WebApp/01-database-architecture.md","title":"EasyWay Data Portal ‚Äì Database Architecture Master","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"üìë Convenzioni e comandi di progetto\r","anchor_slug":"convenzioni-e-comandi-di-progetto","chunk_index":14,"content":"## üìë Convenzioni e comandi di progetto\n\n| Cosa vuoi                     | Cosa devi scrivere               | Dammi il `.md`                    |\r\n|-------------------------------|----------------------------------|------------------------------------|\r\n| Script setup                  | `Dammi lo script SETUP`          | `Dammi il .md SETUP`               |\r\n| Script PORTAL                 | `Dammi lo script PORTAL`         | `Dammi il .md PORTAL`              |\r\n| Script GOLD (ecc.)            | `Dammi lo script GOLD`           | `Dammi il .md GOLD`                |\r\n| Export dbdiagram.io           | `Export for dbdiagram.io`        | `Dammi il .md dbdiagram.io`        |\r\n| Excel documentale             | `Genera documentale Excel`       | `Dammi il .md Excel`               |\r\n| Script store procedure        | `Dammi lo script STOREPROCESS`   | `Dammi il .md STOREPROCESS`        |\r\n| Script sequence               | `Dammi lo script SEQUENCE`       | `Dammi il .md SEQUENCE`            |\r\n| Script funzione               | `Dammi lo script FUNZIONE`       | `Dammi il .md FUNZIONE`            |\n\n---","size_chars":1113,"tokens_estimate":278}
{"doc_id":"ew-01-database-architecture","path":"EasyWay_WebApp/01-database-architecture.md","title":"EasyWay Data Portal ‚Äì Database Architecture Master","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"üìù Linee guida operative\r","anchor_slug":"linee-guida-operative","chunk_index":15,"content":"## üìù Linee guida operative\n\n- Ogni nuovo oggetto tecnico, policy, convenzione, decisione va **sempre prima documentata qui**.\r\n- I `.md` tecnici sono linkati e devono essere aggiornati a ogni evoluzione.\r\n- Le modifiche devono essere validate e condivise prima della messa in produzione.\r\n- **Questa Architecture Master √® il riferimento vincolante per sviluppatori, DBA, revisori, auditor, project owner e‚Ä¶ chatbot/agent di AMS!**\n\n---","size_chars":436,"tokens_estimate":109}
{"doc_id":"ew-01-database-architecture","path":"EasyWay_WebApp/01-database-architecture.md","title":"EasyWay Data Portal ‚Äì Database Architecture Master","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"üëæ Conversational Intelligence Checklist\r","anchor_slug":"conversational-intelligence-checklist","chunk_index":16,"content":"### üëæ Conversational Intelligence Checklist\r\nPer ogni oggetto:  \r\n- [ ] Documentazione con prompt di esempio\r\n- [ ] Output standardizzato (resultset: stato, id, messaggio, etc.)\r\n- [ ] Logging su tutte le operazioni\r\n- [ ] Parametri chiari, self-explained\r\n- [ ] Versione DEBUG/test sempre presente\r\n- [ ] Extended property su ogni campo chiave\n\n---","size_chars":350,"tokens_estimate":88}
{"doc_id":"ew-01-database-architecture","path":"EasyWay_WebApp/01-database-architecture.md","title":"EasyWay Data Portal ‚Äì Database Architecture Master","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":17,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-02-logiche-easyway","path":"EasyWay_WebApp/02-logiche-easyway.md","title":"Prefazione ‚Äì EasyWay Data Portal  ","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Guida alla Documentazione Funzionale e Architetturale\r","anchor_slug":"guida-alla-documentazione-funzionale-e-architetturale","chunk_index":1,"content":"## Guida alla Documentazione Funzionale e Architetturale\n\nQuesta documentazione raccoglie e formalizza l‚Äôanalisi funzionale e le scelte architetturali alla base dello sviluppo di **EasyWay Data Portal**.\n\nIl documento √® pensato come **riferimento unificato e versionabile** per tutto il team di sviluppo, architetti, DevOps e stakeholder, garantendo:\r\n- **Chiarezza delle regole e dei flussi** a cui attenersi in ogni fase,\r\n- **Coerenza tra analisi, implementazione e gestione operativa**,\r\n- **Facilit√† di onboarding per nuovi sviluppatori o fornitori**.\n\nLa struttura e le macro-sezioni sono state definite in modo da coprire tutti gli aspetti chiave del progetto, dalla sicurezza all‚Äôesperienza utente, dalla scalabilit√† alla governance.\n\n**Tutte le sezioni riportate sono state validate come ‚ÄúPRONTA PER CODICE‚Äù**: ci√≤ significa che ogni parte √® pronta per essere tradotta in codice, script, template o pipeline, mantenendo la tracciabilit√† delle scelte e la conformit√† alle best practice definite dal team.","size_chars":1012,"tokens_estimate":253}
{"doc_id":"ew-02-logiche-easyway","path":"EasyWay_WebApp/02-logiche-easyway.md","title":"Prefazione ‚Äì EasyWay Data Portal  ","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Macro-sezioni documentate\r","anchor_slug":"macro-sezioni-documentate","chunk_index":2,"content":"## Macro-sezioni documentate\n\n- **Architettura Microservizi**  \r\n  Definizione dei domini funzionali, struttura a container, API Gateway, isolamenti e principi di scalabilit√†.\n\n- **Policy Configurazione & Security Microservizi/Gateway**  \r\n  Gestione delle identity tecniche, isolamento tenant, secret management, networking sicuro, ACL centralizzati.\n\n- **Logging & Audit**  \r\n  Policy di logging centralizzato, audit trail, alert automatici, retention, compliance (GDPR/SOC2/DORA).\n\n- **Best Practice Naming & Scalabilit√†**  \r\n  Convenzioni di naming, regole di scaling orizzontale/verticale, organizzazione ambienti, resource group.\n\n- **Flussi Onboarding/Login**  \r\n  Tutti i processi di registrazione, login locale/federato, gestione reset, onboarding prospect/demo e verticali PA (SPID/CIE).\n\n- **Integrazione API Esterne**  \r\n  Linee guida per l‚Äôintegrazione di API esterne (Microsoft Graph, Shopify, Fatture in Cloud, Amazon), policy sicurezza, mapping dati e gestione tenant.\n\n- **Gestione Notifiche**  \r\n  Tipologie, flussi, canali notifiche (email, Teams, dashboard), preferenze utente, logging e template personalizzati.\n\n- **Gestione Template Email via Excel su Storage**  \r\n  Modello per template email/configurabili, versionabili, caricati su Storage, con logica di merge variabili, supporto multilingua e audit.\n\n---\n\n**Tutte le scelte qui documentate sono alla base dello sviluppo della piattaforma e saranno mantenute allineate a ogni evoluzione del progetto.**  \r\n**Ogni sezione √® pronta per essere esportata, integrata o sviluppata secondo lo standard ‚Äúready for code‚Äù.**\n\n> Per qualsiasi modifica, integrazione o dettaglio operativo,  \r\n> fare sempre riferimento a queste linee guida prima di procedere con lo sviluppo.","size_chars":1740,"tokens_estimate":435}
{"doc_id":"ew-02-logiche-easyway","path":"EasyWay_WebApp/02-logiche-easyway.md","title":"Prefazione ‚Äì EasyWay Data Portal  ","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":3,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-03-datalake-dev","path":"EasyWay_WebApp/03-datalake-dev.md","title":"`landing/`","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T21:57:48+02:00","section_level":3,"anchor_text":"`landing/`\r","anchor_slug":"landing","chunk_index":1,"content":"### `landing/`\n\n*   File originali grezzi (CSV, JSON, XML)\r\n*   Ricevuti da sistemi esterni (Amazon, Shopify, ecc.)\r\n*   Nessuna trasformazione\r\n*   Solo per tracciabilit√† e audit","size_chars":179,"tokens_estimate":45}
{"doc_id":"ew-03-datalake-dev","path":"EasyWay_WebApp/03-datalake-dev.md","title":"`landing/`","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T21:57:48+02:00","section_level":3,"anchor_text":"`staging/`\r","anchor_slug":"staging","chunk_index":2,"content":"### `staging/`\n\n*   Copia da `landing/`\r\n*   Arricchimento tecnico: colonne di competenza, source system, tenant, ecc.\r\n*   Regole di **Data Quality**\r\n*   Flag `esito_dq = OK / BLOCKED`\r\n*   Non si prosegue verso `official/` in presenza di `BLOCKED`","size_chars":250,"tokens_estimate":62}
{"doc_id":"ew-03-datalake-dev","path":"EasyWay_WebApp/03-datalake-dev.md","title":"`landing/`","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T21:57:48+02:00","section_level":3,"anchor_text":"`invalidrows/`\r","anchor_slug":"invalidrows","chunk_index":3,"content":"### `invalidrows/`\n\n*   Contiene file scartati da `staging/`\r\n*   Evidenzia righe che non superano le regole di qualit√† (es. CF mancante)\r\n*   File esempi:\r\n```sql\r\ninvalidrows/2024-07-19/\r\n‚îú‚îÄ‚îÄ rejected_rows.csv\r\n‚îú‚îÄ‚îÄ dq_report.txt\r\n‚îú‚îÄ‚îÄ log.json\r\n```sql\n\nFacilita audit, troubleshooting e trasparenza verso clienti o vendor\n\nofficial/\r\n*   Solo dati **certificati, validati, completi**\r\n*   Pronti per ingestion in SQL Server (BRONZE)\r\n*   Non contiene errori, non contiene scarti\r\n    \r\n* * *","size_chars":492,"tokens_estimate":123}
{"doc_id":"ew-03-datalake-dev","path":"EasyWay_WebApp/03-datalake-dev.md","title":"`landing/`","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T21:57:48+02:00","section_level":3,"anchor_text":"`technical/`\r","anchor_slug":"technical","chunk_index":4,"content":"### `technical/`\n\n*   Logs ETL, diagnostica tecnica, file temporanei operativi\r\n    \r\n*   Scarti temporanei, export tecnici di processo","size_chars":135,"tokens_estimate":34}
{"doc_id":"ew-03-datalake-dev","path":"EasyWay_WebApp/03-datalake-dev.md","title":"`landing/`","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T21:57:48+02:00","section_level":3,"anchor_text":"`portal-assets/`\r","anchor_slug":"portal-assets","chunk_index":5,"content":"### `portal-assets/`\n\n*   Risorse statiche del Portale:\r\n    *   Loghi\r\n    *   Template\r\n    *   Palette colori\r\n    *   Icone\r\n        \r\n*   Nessuna policy di retention automatica","size_chars":181,"tokens_estimate":45}
{"doc_id":"ew-03-datalake-dev","path":"EasyWay_WebApp/03-datalake-dev.md","title":"`landing/`","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T21:57:48+02:00","section_level":3,"anchor_text":"`portal-audit/`\r","anchor_slug":"portal-audit","chunk_index":6,"content":"### `portal-audit/`\n\n*   Audit Database (PORTAL / BRONZE / SILVER / GOLD)\r\n*   Audit Storage (Access logs, ACL changes)\r\n*   Log ETL (ADF, Databricks, Synapse)\r\n*   Security Events (SIEM, Sentinel, Defender)\r\n*   Retention minima **36 mesi**\n\n\r\nüìä Retention Policy (Blob Lifecycle Management)\r\n----------------------------------------\r\n| Directory | Retention | Motivazione |\r\n| --- | --- | --- |\r\n| `landing/` | **180 giorni** | Dati grezzi, utili solo a breve |\r\n| `staging/` | **360 giorni** | Lavorazione tecnica temporanea |\r\n| `official/` | Nessuna | Master dataset |\r\n| `invalidrows/` | **360 giorni** | Audit e diagnosi |\r\n| `technical/` | **360 giorni** | Logs ETL, scarti temporanei |\r\n| `portal-assets/` | Nessuna | Gestione manuale asset del portale |\r\n| `portal-audit/` | **36 mesi min.** | Audit e compliance (ISO, DORA) |\n\nüí∞ Monitoraggio Costi e Consumi\r\n----------------------------------------\r\n| Strumento | Scopo |\r\n| --- | --- |\r\n| **Azure Cost Management** | Monitoraggio spesa mensile |\r\n| **Storage Metrics** | Visualizzazione uso per container |\r\n| **Blob Inventory** | Analisi quantit√† e tipo file |\r\n| **Azure Monitor Alerts** | Alert soglie costi e volumi |\n\nEsempi di Alert\r\n| Condizione | Soglia | Azione |\r\n| --- | --- | --- |\r\n| Storage > 80% budget | 80% | Alert IT Governance |\r\n| Container `landing/` > 2 TB | 2 TB | Verifica cleanup |\n\nüîé Audit & Compliance (Database & Storage)\r\n----------------------------------------","size_chars":1456,"tokens_estimate":364}
{"doc_id":"ew-03-datalake-dev","path":"EasyWay_WebApp/03-datalake-dev.md","title":"`landing/`","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T21:57:48+02:00","section_level":3,"anchor_text":"Audit Database attivo su:\r","anchor_slug":"audit-database-attivo-su","chunk_index":7,"content":"### Audit Database attivo su:\n\n*   PORTAL / BRONZE / SILVER / GOLD\r\n    \r\n*   Azioni tracciate: SELECT, INSERT, UPDATE, DELETE\r\n    \r\n*   Eventi critici: DATABASE_OBJECT_PERMISSION_CHANGE, ROLE_MEMBER_CHANGE\n\n\r\nAudit Storage:\r\n```sql\r\nportal-audit/\r\n‚îú‚îÄ‚îÄ db-audit-logs/\r\n‚îú‚îÄ‚îÄ storage-audit-logs/\r\n‚îú‚îÄ‚îÄ etl-execution-logs/\r\n‚îú‚îÄ‚îÄ security-events/\r\n```sql\n\n‚úÖ Best Practice Operative - Checklist IT\r\n----------------------------------------\n\n*   Retention policy attiva su ogni area tecnica\r\n*   Monitoraggio costi trimestrale tramite Azure Cost Management\r\n*   Alert configurati su soglie volumi e spesa\r\n*   Audit logs archiviati minimo 36 mesi\r\n*   Revisione annuale ACL / RBAC su tenant e storage\r\n*   Tracciamento accessi DB e storage (compliance)\n\nüöÄ Stato attuale: COMPLETO E SOSTENIBILE\r\n----------------------------------------\r\n| Aspetto | Stato |\r\n| --- | --- |\r\n| Sicurezza | ‚úÖ |\r\n| Segregazione Tenant | ‚úÖ |\r\n| Data Lifecycle | ‚úÖ |\r\n| Cost Management | ‚úÖ |\r\n| Retention Policy | ‚úÖ |\r\n| Audit / Compliance | ‚úÖ |\n\n\n\n\r\n?? Provisioning con Terraform\n----------------------------------------\nIl layout dello Storage (ADLS Gen2) pu√≤ essere creato via Terraform (vedi `infra/terraform`):\n\n- Storage Account con HNS attivo\n- Filesystem `datalake` e `portal-assets`\n- Directory per tenant: `tenant-xxxx/{landing,staging,official,invalidrows,technical}`\n- Directory `portal-assets/config/` per i file YAML di branding\n\nOutput Terraform ‚Üí variabili API:\n- `storage_connection_string` ‚Üí `AZURE_STORAGE_CONNECTION_STRING`\n- `branding_container_name` ‚Üí `BRANDING_CONTAINER` (tipicamente `portal-assets`)\n- `branding_prefix` ‚Üí `BRANDING_PREFIX` (default `config`)\n\nEsempio comandi:\n```\ncd infra/terraform\nterraform init\nterraform plan -var \"project_name=easyway\" -var \"resource_group_name=rg-easyway-dev\" -var \"storage_account_name=ewdlkdev123\" -var \"tenants=[\\\"tenant01\\\"]\"\nterraform apply\n```\n\nIntegra poi gli output in Azure DevOps (Variable Group) o Key Vault.","size_chars":1954,"tokens_estimate":488}
{"doc_id":"ew-03-datalake-dev","path":"EasyWay_WebApp/03-datalake-dev.md","title":"`landing/`","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T21:57:48+02:00","section_level":2,"anchor_text":"Domande a cui risponde","anchor_slug":"domande-a-cui-risponde","chunk_index":8,"content":"## Domande a cui risponde\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":164,"tokens_estimate":41}
{"doc_id":"ew-04-accesso-registrazione-notifiche","path":"EasyWay_WebApp/04-accesso-registrazione-notifiche.md","title":"EasyWay Data Portal - Documentazione Funzionale Completa","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"1Ô∏è‚É£ Obiettivo\r","anchor_slug":"1-obiettivo","chunk_index":1,"content":"## 1Ô∏è‚É£ Obiettivo\n\nEasyWay Data Portal garantisce un accesso sicuro e scalabile tramite **Microsoft Entra ID** (opzionale), assegnando fin dalla registrazione un **codice cliente (cod_cli)** anche ai prospect.\n\nIl sistema √® progettato per gestire utenti e tenant in modo isolato e sicuro, tramite il campo **tenant_id**.\n\nL'infrastruttura √® pensata per SaaS: un solo DB, pi√π clienti, ACL e ruoli.\n\n  \n\nIl portale gestisce anche:\n\n- Notifiche utente\n\n- Integrazioni API esterne (Shopify, Amazon, Fatture in Cloud)\n\n- Estensione futura verso flussi di Data Quality.","size_chars":562,"tokens_estimate":140}
{"doc_id":"ew-04-accesso-registrazione-notifiche","path":"EasyWay_WebApp/04-accesso-registrazione-notifiche.md","title":"EasyWay Data Portal - Documentazione Funzionale Completa","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"2Ô∏è‚É£ Flusso Registrazione e Accesso Utente\r","anchor_slug":"2-flusso-registrazione-e-accesso-utente","chunk_index":2,"content":"## 2Ô∏è‚É£ Flusso Registrazione e Accesso Utente","size_chars":44,"tokens_estimate":11}
{"doc_id":"ew-04-accesso-registrazione-notifiche","path":"EasyWay_WebApp/04-accesso-registrazione-notifiche.md","title":"EasyWay Data Portal - Documentazione Funzionale Completa","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Sequenza generale:\r","anchor_slug":"sequenza-generale","chunk_index":3,"content":"### Sequenza generale:\n\n1. L‚Äôutente si registra con email (UPN Entra ID o normale email)\n\n2. Il portale verifica via Microsoft Graph API se l‚Äôutente esiste in Entra ID (se previsto)\n\n3. Se assente ‚Üí crea utente su Entra ID (opzionale)\n\n4. Genera `cod_cli` e `tenant_id` su SQL Server\n\n5. Inserisce il nuovo utente nel database `users` associandolo a `tenant_id`\n\n6. L‚Äôutente accede tramite OAuth2 (Entra ID) o login locale","size_chars":422,"tokens_estimate":106}
{"doc_id":"ew-04-accesso-registrazione-notifiche","path":"EasyWay_WebApp/04-accesso-registrazione-notifiche.md","title":"EasyWay Data Portal - Documentazione Funzionale Completa","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Schema semplificato - Registrazione e Accesso\r","anchor_slug":"schema-semplificato-registrazione-e-accesso","chunk_index":4,"content":"### Schema semplificato - Registrazione e Accesso\n\n```sql\n\n[User Browser]\n\n¬† ¬† ¬†‚îÇ\n\n¬† ¬† ¬†‚îÇ‚îÄ Registrazione Email ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n\n¬† ¬† ¬†‚îÇ ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ‚îÇ\n\n¬† ¬† ¬†‚ñº ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ‚ñº\n\n[Portale Backend] ‚îÄ Check Entra ID ‚îÄ‚ñ∫ [Microsoft Graph API]\n\n¬† ¬† ¬†‚îÇ ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ‚îÇ\n\n¬† ¬† ¬†‚îú‚îÄ Genera cod_cli e tenant_id ¬† ‚îÇ\n\n¬† ¬† ¬†‚îú‚îÄ Scrive in tabella `users` ¬† ¬†‚îÇ\n\n¬† ¬† ¬†‚îÇ ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ‚îÇ\n\n¬† ¬† ¬†‚îî‚îÄ Login tramite EntraID OIDC ‚óÑ‚îÄ‚îò\n\n```sql","size_chars":458,"tokens_estimate":114}
{"doc_id":"ew-04-accesso-registrazione-notifiche","path":"EasyWay_WebApp/04-accesso-registrazione-notifiche.md","title":"EasyWay Data Portal - Documentazione Funzionale Completa","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"3Ô∏è‚É£ Architettura Generale del Portale (Microservizi / Container)\r","anchor_slug":"3-architettura-generale-del-portale-microservizi-container","chunk_index":5,"content":"## 3Ô∏è‚É£ Architettura Generale del Portale (Microservizi / Container)\n\n```sql\n\n[Browser]\n\n¬† ¬†‚îÇ\n\n¬† ¬†‚ñº\n\n[Portal]\n\n¬† ¬†‚îÇ\n\n¬† ¬†‚ñº\n\n[API Gateway]\n\n¬† ¬†‚îú‚îÄ‚îÄ‚ñ∫ [Auth Service] ‚îÄ‚îÄ‚ñ∫ [ACL, Tenant Validation]\n\n¬† ¬†‚îÇ ¬† ¬† ¬† ‚îÇ\n\n¬† ¬†‚îÇ ¬† ¬† ¬† ‚îî‚îÄ‚îÄ‚ñ∫ [Admin Service]\n\n¬† ¬†‚îÇ\n\n¬† ¬†‚îú‚îÄ‚îÄ‚ñ∫ [Viewer App]\n\n¬† ¬†‚îú‚îÄ‚îÄ‚ñ∫ [Scheduler]\n\n¬† ¬†‚îú‚îÄ‚îÄ‚ñ∫ [Upload Service]\n\n¬† ¬†‚îú‚îÄ‚îÄ‚ñ∫ [Import Service]\n\n¬† ¬†‚îú‚îÄ‚îÄ‚ñ∫ [Enrichment API]\n\n¬† ¬†‚îî‚îÄ‚îÄ‚ñ∫ [Dashboard Service]\n\n```sql","size_chars":399,"tokens_estimate":100}
{"doc_id":"ew-04-accesso-registrazione-notifiche","path":"EasyWay_WebApp/04-accesso-registrazione-notifiche.md","title":"EasyWay Data Portal - Documentazione Funzionale Completa","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"4Ô∏è‚É£ Database - SQL Server\r","anchor_slug":"4-database-sql-server","chunk_index":6,"content":"## 4Ô∏è‚É£ Database - SQL Server","size_chars":28,"tokens_estimate":7}
{"doc_id":"ew-04-accesso-registrazione-notifiche","path":"EasyWay_WebApp/04-accesso-registrazione-notifiche.md","title":"EasyWay Data Portal - Documentazione Funzionale Completa","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Tabelle principali:\r","anchor_slug":"tabelle-principali","chunk_index":7,"content":"### Tabelle principali:\n\n  \n\n**users:**\n\n- tenant_id\n\n- cod_cli\n\n- email\n\n- stato\n\n- notify_by_email\n\n  \n\n**user_notification_settings:**\n\n- tenant_id\n\n- cod_cli\n\n- channel (EMAIL, SMS, PUSH)\n\n- enabled","size_chars":202,"tokens_estimate":50}
{"doc_id":"ew-04-accesso-registrazione-notifiche","path":"EasyWay_WebApp/04-accesso-registrazione-notifiche.md","title":"EasyWay Data Portal - Documentazione Funzionale Completa","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"5Ô∏è‚É£ Gestione Notifiche\r","anchor_slug":"5-gestione-notifiche","chunk_index":8,"content":"## 5Ô∏è‚É£ Gestione Notifiche\n\n  \n\n**Livello Generale:**\n\n- notify_by_email TRUE/FALSE\n\n  \n\n**Livello Dettaglio:**\n\n- user_notification_settings per canale\n\n  \n\n**Priorit√† invio:**\n\n1. notify_by_email = 0 ‚Üí blocca\n\n2. Se EMAIL ON in override ‚Üí invia\n\n3. Se non override ‚Üí applica flag generale","size_chars":289,"tokens_estimate":72}
{"doc_id":"ew-04-accesso-registrazione-notifiche","path":"EasyWay_WebApp/04-accesso-registrazione-notifiche.md","title":"EasyWay Data Portal - Documentazione Funzionale Completa","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"6Ô∏è‚É£ Integrazione API esterne (Microsoft Graph, Shopify, Amazon, ecc.)\r","anchor_slug":"6-integrazione-api-esterne-microsoft-graph-shopify-amazon-ecc","chunk_index":9,"content":"## 6Ô∏è‚É£ Integrazione API esterne (Microsoft Graph, Shopify, Amazon, ecc.)","size_chars":72,"tokens_estimate":18}
{"doc_id":"ew-04-accesso-registrazione-notifiche","path":"EasyWay_WebApp/04-accesso-registrazione-notifiche.md","title":"EasyWay Data Portal - Documentazione Funzionale Completa","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Esempi API Graph:\r","anchor_slug":"esempi-api-graph","chunk_index":10,"content":"### Esempi API Graph:\n\n```sql\n\nGET /v1.0/users?$filter=userPrincipalName eq 'user@domain.com'\n\nPOST /v1.0/users { user data ... }\n\n```sql","size_chars":137,"tokens_estimate":34}
{"doc_id":"ew-04-accesso-registrazione-notifiche","path":"EasyWay_WebApp/04-accesso-registrazione-notifiche.md","title":"EasyWay Data Portal - Documentazione Funzionale Completa","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"7Ô∏è‚É£ Gestione ACL, Tenant e Sicurezza\r","anchor_slug":"7-gestione-acl-tenant-e-sicurezza","chunk_index":11,"content":"## 7Ô∏è‚É£ Gestione ACL, Tenant e Sicurezza\n\n**Accesso:**\n\n- JWT con tenant_id, ACL\n\n  \n\n**Segregazione dati:**\n\n- WHERE tenant_id = ?\n\n  \n\n**ACL:**\n\n- Tabella user_access\n\n  \n\n**Ruoli:**\n\n- Viewer, Scheduler, Admin, Enrichment","size_chars":223,"tokens_estimate":56}
{"doc_id":"ew-04-accesso-registrazione-notifiche","path":"EasyWay_WebApp/04-accesso-registrazione-notifiche.md","title":"EasyWay Data Portal - Documentazione Funzionale Completa","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"8Ô∏è‚É£ Estensione Futuro: Data Quality Flow\r","anchor_slug":"8-estensione-futuro-data-quality-flow","chunk_index":12,"content":"## 8Ô∏è‚É£ Estensione Futuro: Data Quality Flow\n\n**Flussi futuri:**\n\n- Upload (Excel, CSV, JSON)\n\n- Quality: Completezza, Formati, Business Rules\n\n- Report anomaly & fix","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-04-accesso-registrazione-notifiche","path":"EasyWay_WebApp/04-accesso-registrazione-notifiche.md","title":"EasyWay Data Portal - Documentazione Funzionale Completa","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"9Ô∏è‚É£ Deployment e Tecnologie\r","anchor_slug":"9-deployment-e-tecnologie","chunk_index":13,"content":"## 9Ô∏è‚É£ Deployment e Tecnologie\n\n**Componenti:**\n\n- Frontend Docker Azure Web App\n\n- Backend Docker Azure Web App\n\n- DB Azure SQL (esterno)","size_chars":138,"tokens_estimate":34}
{"doc_id":"ew-04-accesso-registrazione-notifiche","path":"EasyWay_WebApp/04-accesso-registrazione-notifiche.md","title":"EasyWay Data Portal - Documentazione Funzionale Completa","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üîë Tenant vs Microsoft Entra ID\r","anchor_slug":"tenant-vs-microsoft-entra-id","chunk_index":14,"content":"## üîë Tenant vs Microsoft Entra ID\n\n| Nome ¬† ¬† ¬† | Funzione ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†| Dove vive ¬†|\n\n|------------|----------------------------------|------------|\n\n| tenant_id ¬†| Isolamento logico DB ¬† ¬† ¬† ¬† ¬† ¬† ¬† | SQL Azure ¬†|\n\n| Entra ID ¬† | Federazione accessi ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†| Microsoft ¬†|\n\n  \n\nEntrambi convivono senza conflitti.","size_chars":336,"tokens_estimate":84}
{"doc_id":"ew-04-accesso-registrazione-notifiche","path":"EasyWay_WebApp/04-accesso-registrazione-notifiche.md","title":"EasyWay Data Portal - Documentazione Funzionale Completa","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":15,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-05-codice-easyway-portale","path":"EasyWay_WebApp/05-codice-easyway-portale.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":1,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-06-frontend-architecture","path":"EasyWay_WebApp/06-frontend-architecture.md","title":"EasyWay Data Portal ‚Äì Frontend Architecture & Integration","owner":"","tags":["layer/architecture","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üéØ Obiettivo\r","anchor_slug":"obiettivo","chunk_index":1,"content":"## üéØ Obiettivo\r\nDefinire l‚Äôarchitettura frontend di EasyWay Data Portal in modo coerente con:\r\n- la struttura backend `easyway-portal-api`\r\n- le policy multi-tenant, ACL e sicurezza definite nel progetto\r\n- le tabelle logiche e fisiche del database (`EasyWay DataPortal - DB`)\r\n- la roadmap AI e self-service dell‚Äôutente finale\n\n---","size_chars":333,"tokens_estimate":83}
{"doc_id":"ew-06-frontend-architecture","path":"EasyWay_WebApp/06-frontend-architecture.md","title":"EasyWay Data Portal ‚Äì Frontend Architecture & Integration","owner":"","tags":["layer/architecture","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üìÅ Struttura Progetto Frontend (Next.js)\r","anchor_slug":"struttura-progetto-frontend-nextjs","chunk_index":2,"content":"## üìÅ Struttura Progetto Frontend (Next.js)\n\n\r\n```sql\r\n/app  \r\n/dashboard ‚Üí Dashboard overview globale  \r\n/upload ‚Üí Modulo caricamento file  \r\n/enrichment ‚Üí Stato arricchimenti e controlli qualit√†  \r\n/notifications ‚Üí Visualizzazione notifiche per utente/tenant  \r\n/workspace ‚Üí Area self-service e AI Assistant  \r\n/components  \r\n/ui ‚Üí Componenti riutilizzabili (Button, Card, Table)  \r\n/layout ‚Üí Sidebar, Topbar, Breadcrumb  \r\n/lib  \r\n/api ‚Üí Connettori API per ogni controller  \r\n/auth ‚Üí Gestione token, ACL, context utente  \r\n/acl ‚Üí Logica permessi per visualizzazione moduli  \r\n/utils  \r\n/logger.ts ‚Üí Audit azioni frontend verso backend\r\n```sql\n\n\r\n---","size_chars":652,"tokens_estimate":163}
{"doc_id":"ew-06-frontend-architecture","path":"EasyWay_WebApp/06-frontend-architecture.md","title":"EasyWay Data Portal ‚Äì Frontend Architecture & Integration","owner":"","tags":["layer/architecture","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üîÑ Mappatura Controller Backend ‚áÑ Frontend UI\r","anchor_slug":"mappatura-controller-backend-frontend-ui","chunk_index":3,"content":"## üîÑ Mappatura Controller Backend ‚áÑ Frontend UI\n\n| Backend Controller (`src/controllers`)       | Frontend Sezione `/app/`       | API Connector (`lib/api/...`)         |\r\n|---------------------------------------------|--------------------------------|----------------------------------------|\r\n| `usersController.ts`                        | `/users` (gestione profili)    | `lib/api/users.ts`                     |\r\n| `notificationsController.ts`                | `/notifications`               | `lib/api/notifications.ts`             |\r\n| `onboardingController.ts`                   | `/workspace`                   | `lib/api/onboarding.ts`                |\r\n| `brandingController.ts`                     | globale (topbar, logo, tema)   | `lib/api/branding.ts`                  |\r\n| `configController.ts`                       | `/settings` (admin only)       | `lib/api/config.ts`                    |\r\n| `healthController.ts`                       | invisibile, usato per checkup  | `lib/api/health.ts`                    |\n\n---","size_chars":1037,"tokens_estimate":259}
{"doc_id":"ew-06-frontend-architecture","path":"EasyWay_WebApp/06-frontend-architecture.md","title":"EasyWay Data Portal ‚Äì Frontend Architecture & Integration","owner":"","tags":["layer/architecture","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üß© Multi-Tenant e ACL (Access Control Layer)\r","anchor_slug":"multi-tenant-e-acl-access-control-layer","chunk_index":4,"content":"## üß© Multi-Tenant e ACL (Access Control Layer)\n\nTutte le richieste frontend includono nel contesto:\r\n- `tenant_id`\r\n- `user_id` (formato `CDI00000001000`)\r\n- `profile` ACL (es. `can_upload`, `can_view_enrichment`, `can_manage_users`)\n\nQueste informazioni sono ottenute dopo login via API e salvate in context globale React (es. `TenantContext`, `AuthContext`).\n\n---","size_chars":366,"tokens_estimate":92}
{"doc_id":"ew-06-frontend-architecture","path":"EasyWay_WebApp/06-frontend-architecture.md","title":"EasyWay Data Portal ‚Äì Frontend Architecture & Integration","owner":"","tags":["layer/architecture","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üîê Sicurezza & Logging\r","anchor_slug":"sicurezza-logging","chunk_index":5,"content":"## üîê Sicurezza & Logging\n\nOgni azione utente frontend:\r\n- viene **loggata** con chiamata POST a `api/audit/log`\r\n- include i metadati:\r\n  - `event_type` (es: `UPLOAD_FILE`, `AI_DASHBOARD_REQUEST`)\r\n  - `user_id`, `tenant_id`\r\n  - `timestamp`\r\n- supporta **masking dinamico** se il dataset o colonna √® marcata come `MASKED` nel backend (`PORTAL.MASKING_METADATA`)\n\n---","size_chars":368,"tokens_estimate":92}
{"doc_id":"ew-06-frontend-architecture","path":"EasyWay_WebApp/06-frontend-architecture.md","title":"EasyWay Data Portal ‚Äì Frontend Architecture & Integration","owner":"","tags":["layer/architecture","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"ü§ñ AI Dashboard Assistant\r","anchor_slug":"ai-dashboard-assistant","chunk_index":6,"content":"## ü§ñ AI Dashboard Assistant\n\nLa sezione `/workspace` integra:\r\n- Textarea per richieste tipo ‚ÄúMostrami i report con successo <95% negli ultimi 3 mesi‚Äù\r\n- Backend AI (OpenAI / Azure OpenAI) con API POST a `/api/assistant/ask`\r\n- Visualizzazione dinamica dei widget suggeriti\r\n- Salvataggio query/risposta per audit\n\n---","size_chars":319,"tokens_estimate":80}
{"doc_id":"ew-06-frontend-architecture","path":"EasyWay_WebApp/06-frontend-architecture.md","title":"EasyWay Data Portal ‚Äì Frontend Architecture & Integration","owner":"","tags":["layer/architecture","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üß™ Esempio ACL e Componente Condizionale\r","anchor_slug":"esempio-acl-e-componente-condizionale","chunk_index":7,"content":"## üß™ Esempio ACL e Componente Condizionale\n\n```tsx\r\n{user?.profile?.can_upload && (\r\n  <UploadArea />\r\n)}\r\n```sql","size_chars":114,"tokens_estimate":28}
{"doc_id":"ew-06-frontend-architecture","path":"EasyWay_WebApp/06-frontend-architecture.md","title":"EasyWay Data Portal ‚Äì Frontend Architecture & Integration","owner":"","tags":["layer/architecture","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":8,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-07-iam-naming-utenti-gruppi","path":"EasyWay_WebApp/07-iam-naming-utenti-gruppi.md","title":"üìÇ Wiki IAM - Naming Convention Utenze Tecniche e Gruppi  ","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üéØ Scopo del Documento  \r","anchor_slug":"scopo-del-documento","chunk_index":1,"content":"## üéØ Scopo del Documento  \r\nDefinire le regole ufficiali di **naming convention** per:  \r\n- Utenze di servizio tecniche  \r\n- Gruppi di accesso IAM (RBAC)  \n\nQuesto garantisce ordine, chiarezza e coerenza su tutta la piattaforma EasyWay DataPortal.\n\n---","size_chars":253,"tokens_estimate":63}
{"doc_id":"ew-07-iam-naming-utenti-gruppi","path":"EasyWay_WebApp/07-iam-naming-utenti-gruppi.md","title":"üìÇ Wiki IAM - Naming Convention Utenze Tecniche e Gruppi  ","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üîë Naming Convention - Utenze Tecniche di Servizio  \r","anchor_slug":"naming-convention-utenze-tecniche-di-servizio","chunk_index":2,"content":"## üîë Naming Convention - Utenze Tecniche di Servizio","size_chars":53,"tokens_estimate":13}
{"doc_id":"ew-07-iam-naming-utenti-gruppi","path":"EasyWay_WebApp/07-iam-naming-utenti-gruppi.md","title":"üìÇ Wiki IAM - Naming Convention Utenze Tecniche e Gruppi  ","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"üìã Prefisso da usare: `portal.`  \r","anchor_slug":"prefisso-da-usare-portal","chunk_index":3,"content":"### üìã Prefisso da usare: `portal.`  \r\nLe utenze tecniche devono iniziare sempre con `portal.`.  \r\nQueste utenze sono dedicate a:  \r\n- Portale EasyWay  \r\n- Power BI  \r\n- ETL, App esterne  \r\n- Accesso Storage Explorer (admin)","size_chars":224,"tokens_estimate":56}
{"doc_id":"ew-07-iam-naming-utenti-gruppi","path":"EasyWay_WebApp/07-iam-naming-utenti-gruppi.md","title":"üìÇ Wiki IAM - Naming Convention Utenze Tecniche e Gruppi  ","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"üìÇ Esempi standard:\r","anchor_slug":"esempi-standard","chunk_index":4,"content":"### üìÇ Esempi standard:\r\n| Nome utenza tecnica           | Scopo                          | Ambito      |\r\n|--------------------------------|--------------------------------|-------------|\r\n| `portal.datalake.dev.read`     | Lettura dati Datalake           | App, Power BI |\r\n| `portal.datalake.dev.write`    | Scrittura su Datalake           | ETL, App    |\r\n| `portal.datalake.dev.admin`    | Admin su Datalake (Explorer)    | Amministrazione |\r\n| `portal.storage.dev.read`      | Lettura su Blob Storage (assets)| Assets, immagini |\r\n| `portal.storage.dev.write`     | Scrittura su Blob Storage       | Upload App  |\r\n| `portal.storage.dev.admin`     | Admin su Blob Storage           | IAM, ACL    |\n\n---","size_chars":708,"tokens_estimate":177}
{"doc_id":"ew-07-iam-naming-utenti-gruppi","path":"EasyWay_WebApp/07-iam-naming-utenti-gruppi.md","title":"üìÇ Wiki IAM - Naming Convention Utenze Tecniche e Gruppi  ","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üîë Naming Convention - Gruppi IAM (RBAC)  \r","anchor_slug":"naming-convention-gruppi-iam-rbac","chunk_index":5,"content":"## üîë Naming Convention - Gruppi IAM (RBAC)","size_chars":43,"tokens_estimate":11}
{"doc_id":"ew-07-iam-naming-utenti-gruppi","path":"EasyWay_WebApp/07-iam-naming-utenti-gruppi.md","title":"üìÇ Wiki IAM - Naming Convention Utenze Tecniche e Gruppi  ","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"üìã Prefisso da usare: `grp.`  \r","anchor_slug":"prefisso-da-usare-grp","chunk_index":6,"content":"### üìã Prefisso da usare: `grp.`  \r\nI gruppi IAM devono iniziare sempre con `grp.`.  \r\nQuesti gruppi controllano l'accesso tramite RBAC su Azure.","size_chars":145,"tokens_estimate":36}
{"doc_id":"ew-07-iam-naming-utenti-gruppi","path":"EasyWay_WebApp/07-iam-naming-utenti-gruppi.md","title":"üìÇ Wiki IAM - Naming Convention Utenze Tecniche e Gruppi  ","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"üìÇ Esempi standard:\r","anchor_slug":"esempi-standard","chunk_index":7,"content":"### üìÇ Esempi standard:\r\n| Nome gruppo IAM                | Permesso        | Ambito     |\r\n|--------------------------------|-----------------|------------|\r\n| `grp.portal.datalake.read`     | Lettura         | Datalake   |\r\n| `grp.portal.datalake.write`    | Scrittura       | Datalake   |\r\n| `grp.admin.datalake`           | Amministrazione | Datalake   |\r\n| `grp.portal.storage.read`      | Lettura         | Blob Storage |\r\n| `grp.admin.storage`            | Amministrazione | Blob Storage |\n\n---","size_chars":501,"tokens_estimate":125}
{"doc_id":"ew-07-iam-naming-utenti-gruppi","path":"EasyWay_WebApp/07-iam-naming-utenti-gruppi.md","title":"üìÇ Wiki IAM - Naming Convention Utenze Tecniche e Gruppi  ","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üìä Differenza tra Utenze e Gruppi\r","anchor_slug":"differenza-tra-utenze-e-gruppi","chunk_index":8,"content":"## üìä Differenza tra Utenze e Gruppi\r\n| Tipologia      | Prefisso | Scopo                                 |\r\n|----------------|----------|----------------------------------------|\r\n| **Utenza tecnica** | `portal.` | Account di servizio per App, Power BI, ETL |\r\n| **Gruppo IAM**     | `grp.`    | Gestione permessi tramite RBAC IAM      |\n\n---","size_chars":343,"tokens_estimate":86}
{"doc_id":"ew-07-iam-naming-utenti-gruppi","path":"EasyWay_WebApp/07-iam-naming-utenti-gruppi.md","title":"üìÇ Wiki IAM - Naming Convention Utenze Tecniche e Gruppi  ","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üõë Regola fondamentale\r","anchor_slug":"regola-fondamentale","chunk_index":9,"content":"## üõë Regola fondamentale\r\n| Tipo        | Utenti diretti? | Consiglio |\r\n|-------------|-----------------|-----------|\r\n| Storage IAM | **No**           | Solo tramite `grp.` gruppi |\r\n| Accesso tecnico | **S√¨** (utenza tecnica `portal.`) | Per App / Power BI / ETL |\n\n---","size_chars":273,"tokens_estimate":68}
{"doc_id":"ew-07-iam-naming-utenti-gruppi","path":"EasyWay_WebApp/07-iam-naming-utenti-gruppi.md","title":"üìÇ Wiki IAM - Naming Convention Utenze Tecniche e Gruppi  ","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üö© Esempio di organizzazione pulita\r","anchor_slug":"esempio-di-organizzazione-pulita","chunk_index":10,"content":"## üö© Esempio di organizzazione pulita\n\n```sql\r\nUsers:\r\n‚îî‚îÄ‚îÄ portal.datalake.dev.admin@tenant.onmicrosoft.com\r\n‚îî‚îÄ‚îÄ portal.storage.dev.read@tenant.onmicrosoft.com\n\nGroups:\r\n‚îî‚îÄ‚îÄ grp.admin.datalake\r\n‚îî‚îÄ‚îÄ grp.portal.datalake.read\r\n```sql\n\n---","size_chars":236,"tokens_estimate":59}
{"doc_id":"ew-07-iam-naming-utenti-gruppi","path":"EasyWay_WebApp/07-iam-naming-utenti-gruppi.md","title":"üìÇ Wiki IAM - Naming Convention Utenze Tecniche e Gruppi  ","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üìù Perch√© questa convenzione?\r","anchor_slug":"perch-questa-convenzione","chunk_index":11,"content":"## üìù Perch√© questa convenzione?\r\n| Motivazione   | Beneficio       |\r\n|---------------|-----------------|\r\n| Chiarezza     | Capisci subito cosa fa ogni utenza o gruppo |\r\n| Scalabilit√†   | Aggiungere nuovi ruoli √® semplice e ordinato |\r\n| Audit         | IAM pi√π pulito e leggibile nei log           |\n\n---","size_chars":308,"tokens_estimate":77}
{"doc_id":"ew-07-iam-naming-utenti-gruppi","path":"EasyWay_WebApp/07-iam-naming-utenti-gruppi.md","title":"üìÇ Wiki IAM - Naming Convention Utenze Tecniche e Gruppi  ","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üìÇ Best Practice - Assegnazione Permessi e IAM (IAM Assignment)\r","anchor_slug":"best-practice-assegnazione-permessi-e-iam-iam-assignment","chunk_index":12,"content":"## üìÇ Best Practice - Assegnazione Permessi e IAM (IAM Assignment)\r\nQuando assegni i permessi tramite IAM su Azure Storage o Datalake, usa sempre una **descrizione chiara** e coerente.","size_chars":184,"tokens_estimate":46}
{"doc_id":"ew-07-iam-naming-utenti-gruppi","path":"EasyWay_WebApp/07-iam-naming-utenti-gruppi.md","title":"üìÇ Wiki IAM - Naming Convention Utenze Tecniche e Gruppi  ","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"üìÑ Esempio di descrizione:\r","anchor_slug":"esempio-di-descrizione","chunk_index":13,"content":"### üìÑ Esempio di descrizione:\r\n```sql\r\nIAM Assignment:\r\nGruppo: grp.admin.datalake\r\nRuolo: Storage Account Contributor\r\nScopo: Accesso amministrazione Datalake (IAM + ACL)\r\n```sql","size_chars":180,"tokens_estimate":45}
{"doc_id":"ew-07-iam-naming-utenti-gruppi","path":"EasyWay_WebApp/07-iam-naming-utenti-gruppi.md","title":"üìÇ Wiki IAM - Naming Convention Utenze Tecniche e Gruppi  ","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"üìã Esempi pratici di descrizione:\r","anchor_slug":"esempi-pratici-di-descrizione","chunk_index":14,"content":"### üìã Esempi pratici di descrizione:\r\n| Gruppo IAM             | Ruolo Assegnato               | Descrizione consigliata                                       |\r\n|-------------------------|--------------------------------|----------------------------------------------------------------|\r\n| `grp.admin.datalake`    | `Storage Account Contributor`   | Accesso amministrativo completo al Datalake tramite IAM + ACL  |\r\n| `grp.portal.datalake.read` | `Storage Blob Data Reader`    | Accesso in sola lettura ai dati certificati Datalake per report |\r\n| `grp.portal.datalake.write`| `Storage Blob Data Contributor` | Scrittura dati in staging/landing per ETL e App                |\n\n---","size_chars":682,"tokens_estimate":170}
{"doc_id":"ew-07-iam-naming-utenti-gruppi","path":"EasyWay_WebApp/07-iam-naming-utenti-gruppi.md","title":"üìÇ Wiki IAM - Naming Convention Utenze Tecniche e Gruppi  ","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üîî Note operative future\r","anchor_slug":"note-operative-future","chunk_index":15,"content":"## üîî Note operative future\r\n- Ogni nuova utenza o gruppo deve rispettare questa convenzione.\r\n- Nessuna utenza personale (es. `giuseppebelviso@`) deve avere permessi su Storage in produzione.","size_chars":192,"tokens_estimate":48}
{"doc_id":"ew-07-iam-naming-utenti-gruppi","path":"EasyWay_WebApp/07-iam-naming-utenti-gruppi.md","title":"üìÇ Wiki IAM - Naming Convention Utenze Tecniche e Gruppi  ","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":16,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-10-ai-agents","path":"EasyWay_WebApp/10-ai-agents.md","title":"EasyWay DataPortal ‚Äì Conversational Intelligence & AMS","owner":"","tags":["layer/concept","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Obiettivo\r","anchor_slug":"obiettivo","chunk_index":1,"content":"## Obiettivo\r\nIntegrare **AI Agents intelligenti e operativi** all'interno della piattaforma EasyWay DataPortal, per automatizzare attivit√† di Application Management Services (AMS) e abilitare un'interazione naturale, efficace e contestualizzata con i servizi della piattaforma.\n\n---","size_chars":283,"tokens_estimate":71}
{"doc_id":"ew-10-ai-agents","path":"EasyWay_WebApp/10-ai-agents.md","title":"EasyWay DataPortal ‚Äì Conversational Intelligence & AMS","owner":"","tags":["layer/concept","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Sommario\r","anchor_slug":"sommario","chunk_index":2,"content":"## Sommario\n\n- [1. Introduzione](#1-introduzione)\r\n- [2. Scenari di utilizzo](#2-scenari-di-utilizzo)\r\n- [3. Architettura Conversazionale](#3-architettura-conversazionale)\r\n- [4. Tecnologie Azure utilizzate](#4-tecnologie-azure-utilizzate)\r\n- [5. Integrazione con EasyWay DataPortal](#5-integrazione-con-easyway-dataportal)\r\n- [6. Multitenancy e Sicurezza](#6-multitenancy-e-sicurezza)\r\n- [7. Costi stimati](#7-costi-stimati-per-1-ai-agent)\r\n- [8. Roadmap evolutiva](#8-roadmap-evolutiva)\r\n- [9. Naming convention AI Agents](#9-naming-convention-ai-agents)\n\n---","size_chars":561,"tokens_estimate":140}
{"doc_id":"ew-10-ai-agents","path":"EasyWay_WebApp/10-ai-agents.md","title":"EasyWay DataPortal ‚Äì Conversational Intelligence & AMS","owner":"","tags":["layer/concept","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"1. Introduzione\r","anchor_slug":"1-introduzione","chunk_index":3,"content":"## 1. Introduzione\n\nL'obiettivo √® sviluppare un'infrastruttura di **AI Agents** evoluti, in grado di:\r\n- Rispondere in linguaggio naturale a domande sul portale.\r\n- Eseguire azioni operative (es. avvio flussi, verifica ACL, apertura ticket).\r\n- Automatizzare il supporto AMS con intelligenza e precisione.\r\n- Garantire segmentazione multi-tenant e sicurezza by design.\n\n---","size_chars":373,"tokens_estimate":93}
{"doc_id":"ew-10-ai-agents","path":"EasyWay_WebApp/10-ai-agents.md","title":"EasyWay DataPortal ‚Äì Conversational Intelligence & AMS","owner":"","tags":["layer/concept","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"2. Scenari di utilizzo\r","anchor_slug":"2-scenari-di-utilizzo","chunk_index":4,"content":"## 2. Scenari di utilizzo\n\n| AI Agent | Funzione principale | Canale previsto |\r\n|--------|---------------------|-----------------|\r\n| `agent.upload` | Guida al caricamento dati e gestione errori | Web, Teams |\r\n| `agent.acl` | Supporto su permessi, profili e tenant | Web |\r\n| `agent.dq` | Analisi Data Quality, righe scartate, motivi | Web |\r\n| `agent.billing` | Verifica piani, licenze, costi | Web, Email |\r\n| `agent.audit` | Accesso e consultazione audit logs | Interno (Admins) |\n\n---","size_chars":490,"tokens_estimate":122}
{"doc_id":"ew-10-ai-agents","path":"EasyWay_WebApp/10-ai-agents.md","title":"EasyWay DataPortal ‚Äì Conversational Intelligence & AMS","owner":"","tags":["layer/concept","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"3. Architettura Conversazionale\r","anchor_slug":"3-architettura-conversazionale","chunk_index":5,"content":"## 3. Architettura Conversazionale\n\n- **Front-end Web**: AI Agent integrato nel portale via iframe/widget.\r\n- **Canali secondari**: Microsoft Teams (AMS), App mobile futura.\r\n- **Bot Service**: Azure Bot Framework o Power Virtual Agents.\r\n- **AI Engine**: Azure OpenAI (GPT-4/3.5) con grounding su contenuti reali.\r\n- **Dati di base**: Azure Cognitive Search su `.md`, log, PDF tecnici.\r\n- **Speech Services**: opzionale per interazioni vocali.\n\n---","size_chars":449,"tokens_estimate":112}
{"doc_id":"ew-10-ai-agents","path":"EasyWay_WebApp/10-ai-agents.md","title":"EasyWay DataPortal ‚Äì Conversational Intelligence & AMS","owner":"","tags":["layer/concept","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"4. Tecnologie Azure utilizzate\r","anchor_slug":"4-tecnologie-azure-utilizzate","chunk_index":6,"content":"## 4. Tecnologie Azure utilizzate\n\n| Servizio | Funzione |\r\n|---------|----------|\r\n| Azure Bot Service | Orchestrazione agenti e canali |\r\n| Azure OpenAI | Risposte intelligenti e contestualizzate |\r\n| Azure Cognitive Search | Grounding su documentazione EasyWay |\r\n| Azure Storage | Repository knowledge base & documenti |\r\n| Azure Speech | Input/output vocale naturale |\r\n| Azure App Service | Hosting container multi-tenant AI Agent |\n\n---","size_chars":443,"tokens_estimate":111}
{"doc_id":"ew-10-ai-agents","path":"EasyWay_WebApp/10-ai-agents.md","title":"EasyWay DataPortal ‚Äì Conversational Intelligence & AMS","owner":"","tags":["layer/concept","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"5. Integrazione con EasyWay DataPortal\r","anchor_slug":"5-integrazione-con-easyway-dataportal","chunk_index":7,"content":"## 5. Integrazione con EasyWay DataPortal\n\n- Gli AI Agents operano nel contesto dell‚Äôutente autenticato.\r\n- Rispettano completamente ACL, `tenant_id`, `profile_id`.\r\n- Possono accedere a dati certificati `GOLD`, `PORTAL`, `AUDIT`.\r\n- Ogni interazione pu√≤ essere tracciata in `portal-audit/`.\n\n---","size_chars":296,"tokens_estimate":74}
{"doc_id":"ew-10-ai-agents","path":"EasyWay_WebApp/10-ai-agents.md","title":"EasyWay DataPortal ‚Äì Conversational Intelligence & AMS","owner":"","tags":["layer/concept","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"6. Multitenancy e Sicurezza\r","anchor_slug":"6-multitenancy-e-sicurezza","chunk_index":8,"content":"## 6. Multitenancy e Sicurezza\n\n- Gli AI Agents applicano filtraggio dei dati per tenant e profilo.\r\n- Non accedono mai a dati di tenant terzi.\r\n- Integrati con Entra ID, Audit SQL e Audit Datalake.\r\n- Ogni azione pu√≤ essere loggata per finalit√† legali, GDPR, SOC2.\n\n---","size_chars":270,"tokens_estimate":68}
{"doc_id":"ew-10-ai-agents","path":"EasyWay_WebApp/10-ai-agents.md","title":"EasyWay DataPortal ‚Äì Conversational Intelligence & AMS","owner":"","tags":["layer/concept","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"7. Costi stimati (per 1 AI Agent)\r","anchor_slug":"7-costi-stimati-per-1-ai-agent","chunk_index":9,"content":"## 7. Costi stimati (per 1 AI Agent)\n\n| Voce | Tipo | Stima mensile |\r\n|------|------|----------------|\r\n| Azure OpenAI (GPT-4) | API usage | ~40‚Äì60‚Ç¨ |\r\n| Azure Bot Service | Hosting | ~60‚Ç¨ |\r\n| Azure Cognitive Search | 1 unit√† | ~100‚Ç¨ |\r\n| Azure Speech (TTS/STT) | Opzionale | ~5‚Äì10‚Ç¨ |\r\n| Azure Storage | ~10GB | ~2‚Ç¨ |\n\n**Totale stimato: ~200‚Äì230‚Ç¨/mese** per AI Agent AMS in produzione limitata.\n\n---","size_chars":401,"tokens_estimate":100}
{"doc_id":"ew-10-ai-agents","path":"EasyWay_WebApp/10-ai-agents.md","title":"EasyWay DataPortal ‚Äì Conversational Intelligence & AMS","owner":"","tags":["layer/concept","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"8. Roadmap evolutiva\r","anchor_slug":"8-roadmap-evolutiva","chunk_index":10,"content":"## 8. Roadmap evolutiva\n\n| Fase | Azione |\r\n|------|--------|\r\n| 1 | Prototipo `agent.upload` su ambiente Dev |\r\n| 2 | Integrazione ACL e multi-tenant |\r\n| 3 | Grounding documentazione `.md` (analisi funzionale, ACL, pipeline) |\r\n| 4 | Logging audit e feedback |\r\n| 5 | Estensione vocale (Azure Speech) |\r\n| 6 | Rilascio `agent.acl`, `agent.dq`, `agent.billing` |\r\n| 7 | Dashboard analytics uso & efficienza AMS |\n\n---","size_chars":418,"tokens_estimate":104}
{"doc_id":"ew-10-ai-agents","path":"EasyWay_WebApp/10-ai-agents.md","title":"EasyWay DataPortal ‚Äì Conversational Intelligence & AMS","owner":"","tags":["layer/concept","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"9. Naming convention AI Agents\r","anchor_slug":"9-naming-convention-ai-agents","chunk_index":11,"content":"## 9. Naming convention AI Agents\n\nTutti gli agenti seguono il prefisso `agent.` e il dominio funzionale:\n\n- `agent.upload`\r\n- `agent.acl`\r\n- `agent.dq`\r\n- `agent.billing`\r\n- `agent.audit`\n\nI nomi sono chiari, coerenti, e riflettono la modularit√† microservizi EasyWay.\n\n---","size_chars":273,"tokens_estimate":68}
{"doc_id":"ew-10-ai-agents","path":"EasyWay_WebApp/10-ai-agents.md","title":"EasyWay DataPortal ‚Äì Conversational Intelligence & AMS","owner":"","tags":["layer/concept","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":12,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-01a-db-setup","path":"EasyWay_WebApp/01_database_architecture/01a-db-setup.md","title":"EasyWay Data Portal ‚Äì Database SETUP","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"‚úÖ Scopo del file\r","anchor_slug":"scopo-del-file","chunk_index":1,"content":"## ‚úÖ Scopo del file\n\nConfigurazione iniziale e sicura di login, utenti, ruoli, permessi e policy a livello SQL Server e database,  \r\nper ambiente **EASYWAY_PORTAL_DEV**.\n\n---","size_chars":174,"tokens_estimate":44}
{"doc_id":"ew-01a-db-setup","path":"EasyWay_WebApp/01_database_architecture/01a-db-setup.md","title":"EasyWay Data Portal ‚Äì Database SETUP","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"1Ô∏è‚É£ **Login SQL Server (da creare su MASTER)**\r","anchor_slug":"1-login-sql-server-da-creare-su-master","chunk_index":2,"content":"## 1Ô∏è‚É£ **Login SQL Server (da creare su MASTER)**\n\n```sql\r\nCREATE LOGIN [EWPORTAL_APP_RO] \r\nWITH PASSWORD = 'R4nd0m!PW2024$Xx-RO@';\n\nCREATE LOGIN [EWPORTAL_APP_RW] \r\nWITH PASSWORD = 'R4nd0m!PW2024$Xx-RW@';\n\nCREATE LOGIN [EWPORTAL_ADMIN]   \r\nWITH PASSWORD = 'R4nd0m!PW2024$Xx-AD@';\n\n\r\n2Ô∏è‚É£ **Users (da creare dentro EASYWAY_PORTAL_DEV)**\n\n```sql\r\nUSE [EASYWAY_PORTAL_DEV];\n\nCREATE USER [EWPORTAL_APP_RO] FOR LOGIN [EWPORTAL_APP_RO];\r\nCREATE USER [EWPORTAL_APP_RW] FOR LOGIN [EWPORTAL_APP_RW];\r\nCREATE USER [EWPORTAL_ADMIN]   FOR LOGIN [EWPORTAL_ADMIN];\r\n```sql\n\n3Ô∏è‚É£ **Ruoli di Sicurezza**\n\n```sql\r\n-- Read-Only (Reporting)\r\nCREATE ROLE EWPORTAL_RO;\r\nALTER ROLE EWPORTAL_RO ADD MEMBER EWPORTAL_APP_RO;\n\n-- Read-Write (WebApp)\r\nCREATE ROLE EWPORTAL_RW;\r\nALTER ROLE EWPORTAL_RW ADD MEMBER EWPORTAL_APP_RW;\n\n-- Admin (DBA / ETL)\r\nCREATE ROLE EWPORTAL_ADMIN_ROLE;\r\nALTER ROLE EWPORTAL_ADMIN_ROLE ADD MEMBER EWPORTAL_ADMIN;\r\n```sql\n\n4Ô∏è‚É£ **Permessi per Schema**\n\n```sql\r\n-- READ-ONLY\r\nGRANT SELECT ON SCHEMA::REPORTING TO EWPORTAL_RO;\r\nGRANT SELECT ON SCHEMA::BRONZE    TO EWPORTAL_RO;\r\nGRANT SELECT ON SCHEMA::SILVER    TO EWPORTAL_RO;\r\nGRANT SELECT ON SCHEMA::GOLD      TO EWPORTAL_RO;\n\n-- READ-WRITE\r\nGRANT SELECT, INSERT, UPDATE, DELETE ON SCHEMA::PORTAL TO EWPORTAL_RW;\r\nGRANT SELECT, INSERT, UPDATE, DELETE ON SCHEMA::BRONZE TO EWPORTAL_RW;\r\nGRANT SELECT, INSERT, UPDATE, DELETE ON SCHEMA::SILVER TO EWPORTAL_RW;\r\nGRANT SELECT, INSERT, UPDATE, DELETE ON SCHEMA::WORK   TO EWPORTAL_RW;\r\nGRANT SELECT ON SCHEMA::GOLD TO EWPORTAL_RW;\r\nGRANT SELECT ON SCHEMA::REPORTING TO EWPORTAL_RW;\n\n-- FULL ADMIN\r\nGRANT CONTROL ON SCHEMA::PORTAL    TO EWPORTAL_ADMIN_ROLE;\r\nGRANT CONTROL ON SCHEMA::BRONZE    TO EWPORTAL_ADMIN_ROLE;\r\nGRANT CONTROL ON SCHEMA::SILVER    TO EWPORTAL_ADMIN_ROLE;\r\nGRANT CONTROL ON SCHEMA::GOLD      TO EWPORTAL_ADMIN_ROLE;\r\nGRANT CONTROL ON SCHEMA::REPORTING TO EWPORTAL_ADMIN_ROLE;\r\nGRANT CONTROL ON SCHEMA::WORK      TO EWPORTAL_ADMIN_ROLE;\r\n```sql\n\nüìå **Best practice**\r\n*   **Nessun prefisso**: il DB √® interamente dedicato a EasyWay Data Portal.\r\n    \r\n*   **Ruoli e permessi ben segregati** (WebApp, Reporting, Admin).\r\n    \r\n*   **Password complesse e uniche** per ogni login (da ruotare periodicamente).\r\n    \r\n*   Ogni cambiamento deve essere tracciato anche in documentazione di sicurezza aziendale.\r\n    \n\n* * *\n\nüîë **Audit & compliance**\r\n-------------------------","size_chars":2387,"tokens_estimate":597}
{"doc_id":"ew-01a-db-setup","path":"EasyWay_WebApp/01_database_architecture/01a-db-setup.md","title":"EasyWay Data Portal ‚Äì Database SETUP","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"1Ô∏è‚É£ **Login SQL Server (da creare su MASTER)**\r","anchor_slug":"1-login-sql-server-da-creare-su-master","chunk_index":3,"content":"*   L‚Äôassegnazione dei permessi deve essere tracciata anche nei log di change management.\r\n    \r\n*   I login devono essere monitorati tramite SQL Server Audit, Log Analytics o Azure Defender.","size_chars":191,"tokens_estimate":48}
{"doc_id":"ew-01a-db-setup","path":"EasyWay_WebApp/01_database_architecture/01a-db-setup.md","title":"EasyWay Data Portal ‚Äì Database SETUP","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":4,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-01b-schema-structure","path":"EasyWay_WebApp/01_database_architecture/01b-schema-structure.md","title":"Domande a cui risponde","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":1,"content":"## Domande a cui risponde\r\n- Quali sono le tabelle e gli schemi principali?\r\n- Dove sono le convenzioni di naming e i collegamenti a programmability?\r\n- Quali passi minimi per aggiornare struttura e indici?\r\n- Dove trovare le entit√† correlate nel dizionario?","size_chars":258,"tokens_estimate":64}
{"doc_id":"ew-db-best-practices","path":"EasyWay_WebApp/01_database_architecture/best-practices-checklist.md","title":"best-practices-checklist","owner":"team-data","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T07:06:54+02:00","section_level":2,"anchor_text":"best-practices-checklist","anchor_slug":"best-practices-checklist","chunk_index":1,"content":"Obiettivo\n- Fornire una checklist operativa e agent‚Äëfriendly per verificare che il DB sia conforme alle linee guida EasyWay.\n\nChecklist (alto livello)\n| Area | Regola | Stato | Note |\n| --- | --- | --- | --- |\n| Schemi | Esistono gli schemi PORTAL/BRONZE/SILVER/GOLD/REPORTING/WORK | ‚¨ú | V1 create_schemas |\n| Sequence | Sequence NDG create (TEN/USER + DEBUG) | ‚¨ú | V2 core_sequences |\n| Tabelle core | TENANT/USERS/CONFIGURATION con colonne standard | ‚¨ú | V3 portal_core_tables |\n| Logging | LOG_AUDIT, STATS_EXECUTION_LOG, STATS_EXECUTION_TABLE_LOG | ‚¨ú | V4 logging_tables |\n| RLS | Funzione predicate + Security Policy (OFF/ON) | ‚¨ú | V5 rls_setup |\n| SP core | CRUD TENANT, DEBUG register tenant+user, notify stub | ‚¨ú | V6 stored_procedures_core |\n| Seed | Profili/parametri base inseriti | ‚¨ú | V7 seed_minimum |\n| Extended props | Descrizioni/PII via extended properties | ‚¨ú | V8 extended_properties |\n| Flyway | `flyway_schema_history` allineata su tutti gli ambienti | ‚¨ú | Pipeline CI/CD |\n| Drift gate | Gate ‚ÄúDB Drift Check‚Äù in pipeline attivo | ‚¨ú | drift.json artifact |\n\nChecklist (tabelle)\n| Tabella | PK (id) | tenant_id | created_by | created_at | updated_at | status | ext_attributes |\n| --- | --- | --- | --- | --- | --- | --- | --- |\n| PORTAL.TENANT | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú |\n| PORTAL.USERS | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú |\n| PORTAL.CONFIGURATION | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú |\n| ... | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú |\n\nChecklist (SP)\n| SP | TRY/CATCH + TRAN | Logging `sp_log_stats_execution` | Output standard (status/rows/err) | Debug version (se prevista) |\n| --- | --- | --- | --- | --- |\n| PORTAL.sp_insert_tenant | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú |\n| PORTAL.sp_update_tenant | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú |\n| PORTAL.sp_delete_tenant | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú |\n| PORTAL.sp_debug_register_tenant_and_user | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú |\n| ... | ‚¨ú | ‚¨ú | ‚¨ú | ‚¨ú |\n\nNote operative\n- RLS: abilita la security policy solo dopo aver verificato che l‚Äôapp imposti `SESSION_CONTEXT('tenant_id')` (vedi `withTenantContext`).\n- Migrazioni: 1 file = 1 scopo; commento/header con scopo e ticket.\n- Documentazione: genera/aggiorna ERD & SP Catalog con `npm run db:generate-docs` dopo modifiche strutturali.","size_chars":2152,"tokens_estimate":538}
{"doc_id":"ew-db-studio","path":"EasyWay_WebApp/01_database_architecture/db-studio.md","title":"db-studio","owner":"team-data","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T05:25:09+02:00","section_level":2,"anchor_text":"db-studio","anchor_slug":"db-studio","chunk_index":1,"content":"Obiettivo\n- Generare documentazione aggiornata dal DB (schema attuale) in pochi secondi, pronta per wiki e agenti.\n\nOutput\n- `ERD.md` ‚Äì ER diagram (Mermaid) generato automaticamente\n- `SP_CATALOG.md` ‚Äì Catalogo Stored Procedure e parametri\n\nCome si esegue\n```\ncd EasyWay-DataPortal/easyway-portal-api\nnpm run db:generate-docs\n```\nEnv richieste (come per API): `DB_CONN_STRING` (o `DB_AAD=true` con `DB_HOST/DB_NAME`).\n\nPipeline\n- Pu√≤ essere invocato in uno stage dedicato (DB-Docs) per aggiornare la documentazione.\n\nNote\n- Gli script leggono INFORMATION_SCHEMA/sys.* e producono output idempotente.\n- Estensioni future: relazioni by columns, extended properties come descrizioni.","size_chars":680,"tokens_estimate":170}
{"doc_id":"ew-db-flyway","path":"EasyWay_WebApp/01_database_architecture/flyway.md","title":"Le credenziali (URL/USER/PASSWORD) si passano come env nel runner","owner":"team-data","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T06:01:21+02:00","section_level":2,"anchor_text":"Le credenziali (URL/USER/PASSWORD) si passano come env nel runner","anchor_slug":"le-credenziali-urluserpassword-si-passano-come-env-nel-runner","chunk_index":1,"content":"Cos‚Äô√® Flyway\n- Tool open‚Äësource (Redgate) per versionare ed applicare migrazioni DB (DDL, DML, funzioni, SP, RLS‚Ä¶).\n- Tiene uno storico (tabella `flyway_schema_history`) e applica solo le nuove versioni.\n- Si integra perfettamente con CI/CD e ChatOps (audit nativo + query di stato).\n\nCome funziona\n- Crea `flyway_schema_history` nel DB e registra: versione, checksum, autore, timestamp, esito.\n- Legge script in ordine dalla cartella configurata (es. `db/flyway/sql/`):\n```\ndb/flyway/sql/\n‚îú‚îÄ V1__create_schemas.sql\n‚îú‚îÄ V2__core_sequences.sql\n‚îú‚îÄ V3__portal_core_tables.sql\n‚îú‚îÄ V4__portal_logging_tables.sql\n‚îú‚îÄ V5__rls_and_masking.sql\n‚îî‚îÄ V6__stored_procedures_core.sql\n```\n- Esegue solo le migrazioni non ancora registrate; in caso di errore, si ferma e fallisce la pipeline.\n\nNaming (Flyway Standard)\n- Versioned: `V<n>__descrizione.sql`\n- Undo (opzionale): `U<n>__rollback.sql`\n- Repeatable: `R__nome.sql` (ri‚Äëeseguito se cambia file)\n- Baseline (per DB gi√† esistenti): `B<n>__baseline.sql` o `flyway baseline`\n\nBest practice EasyWay\n- 1 script = 1 scopo (tabella, SP, sequence, RLS‚Ä¶)\n- Commento/header standard a inizio file (progetto, autore, scopo, ticket)\n- Rollback: dove possibile aggiungere `U__rollback_*.sql`\n- Logging: audit Flyway + nostre tabelle `PORTAL.LOG_AUDIT` e `PORTAL.STATS_EXECUTION_*`\n- Pipeline: integrazione Azure DevOps (plan/apply gating) e variabili segrete in Variable Group/Key Vault\n\nIntegrazione EasyWay\n- Cartella migrazioni: `db/flyway/sql/` (gi√† presente nello skeleton)\n- Config: `db/flyway/flyway.conf` (locations, baselineOnMigrate, ecc.)\n- Esempio `flyway.conf` (DEV):\n```\nlocations=filesystem:./sql\nbaselineOnMigrate=true\nsqlMigrationSuffixes=.sql\nconnectRetries=5\n# Le credenziali (URL/USER/PASSWORD) si passano come env nel runner\n```\n\nEsecuzione (CLI)\n```\n# Env (esempio SQL Auth)\n$env:FLYWAY_URL = 'jdbc:sqlserver://<host>:1433;databaseName=<db>;encrypt=true'\n$env:FLYWAY_USER = '<user>'\n$env:FLYWAY_PASSWORD = '<password>'\n\nflyway -configFiles=db/flyway/flyway.conf validate\nflyway -configFiles=db/flyway/flyway.conf baseline -baselineVersion=1   # solo su DB esistenti\nflyway -configFiles=db/flyway/flyway.conf migrate\n```\n\nChatOps/AMS ‚Äì Query utili\n```\n-- Ultima migrazione applicata\nSELECT TOP 1 version, description, installed_on, installed_by\nFROM flyway_schema_history ORDER BY installed_on DESC;","size_chars":2345,"tokens_estimate":586}
{"doc_id":"ew-db-flyway","path":"EasyWay_WebApp/01_database_architecture/flyway.md","title":"Le credenziali (URL/USER/PASSWORD) si passano come env nel runner","owner":"team-data","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T06:01:21+02:00","section_level":2,"anchor_text":"Le credenziali (URL/USER/PASSWORD) si passano come env nel runner","anchor_slug":"le-credenziali-urluserpassword-si-passano-come-env-nel-runner","chunk_index":2,"content":"-- Migrazioni fallite o pendenti\nSELECT * FROM flyway_schema_history WHERE success = 0;\n```\n\nStato nel repo\n- Skeleton gi√† presente: `db/flyway/` con `sql/` e `flyway.conf`.\n- Migrazioni baseline create: V1 (schemi), V2 (sequence), V3 (tabelle core PORTAL), V4 (logging/audit).\n- Prossime: V5 (RLS), V6 (SP core + debug), V7 (seed), V8 (extended properties).\n\nNota su DataBase/ vs db/\n- `db/` √® il nuovo ‚Äúsource of truth‚Äù per migrazioni (DevOps‚Äëready).\n- `DataBase/` contiene SQL storici: mantenerla come archivio finch√© non confluisce in migrazioni Flyway.\n- Obiettivo: migrare i DDL storici in `db/flyway/sql/` (V1..Vn) e deprecare gradualmente `DataBase/`.","size_chars":659,"tokens_estimate":165}
{"doc_id":"ew-index","path":"EasyWay_WebApp/01_database_architecture/index.md","title":"Indice","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":1,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-db-portal","path":"EasyWay_WebApp/01_database_architecture/portal.md","title":"portal","owner":"team-data","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T05:37:48+02:00","section_level":2,"anchor_text":"portal","anchor_slug":"portal","chunk_index":1,"content":"Obiettivo\n- Definire struttura, regole e best practice per le tabelle core del portale.\n\nColonne standard\n- id (INT IDENTITY, PK), tenant_id (NVARCHAR(50), NOT NULL), created_by/created_at/updated_at (default), status (NVARCHAR(50)), ext_attributes (NVARCHAR(MAX)).\n\nTabelle principali\n- TENANT: anagrafica clienti (tenant_id univoco, plan_code, estensioni JSON)\n- USERS: utenti multi-tenant (user_id univoco per tenant, email univoca per tenant, ACL, is_active)\n- CONFIGURATION: parametri runtime (univocit√† per tenant+section+key, enabled)\n- LOG_AUDIT: eventi sistema/API/job (payload JSON)\n- STATS_EXECUTION_LOG: log di esecuzione SP, righe affette, esito\n- STATS_EXECUTION_TABLE_LOG: dettaglio per tabella (FK ‚Üí execution_id)\n\nIndice & performance\n- Unicit√†: TENANT(tenant_id), USERS(tenant_id,user_id), USERS(tenant_id,email)\n- Filtri tipici: (tenant_id), (status), (created_at)\n\nNote\n- RLS e funzioni predicate verranno aggiunte in una migrazione dedicata.","size_chars":962,"tokens_estimate":240}
{"doc_id":"ew-db-sequence","path":"EasyWay_WebApp/01_database_architecture/sequence.md","title":"sequence","owner":"team-data","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T05:38:07+02:00","section_level":2,"anchor_text":"sequence","anchor_slug":"sequence","chunk_index":1,"content":"Sequence principali (PORTAL)\n- SEQ_TENANT_ID ‚Üí genera parte numerica di TENxxxxx (start 1000)\n- SEQ_USER_ID ‚Üí genera parte numerica di CDIxxxxx (start 1000)\n- SEQ_TENANT_ID_DEBUG / SEQ_USER_ID_DEBUG ‚Üí sequenze per inserimenti di test\n\nRegola\n- Le SP di insert formattano il codice finale (prefisso + padding) se non fornito in input.","size_chars":333,"tokens_estimate":83}
{"doc_id":"ew-db-storeprocess","path":"EasyWay_WebApp/01_database_architecture/storeprocess.md","title":"storeprocess","owner":"team-data","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T05:38:29+02:00","section_level":2,"anchor_text":"storeprocess","anchor_slug":"storeprocess","chunk_index":1,"content":"Standard SP\n- Parametri chiari (in/out), `@created_by` obbligatorio\n- Transazione + TRY/CATCH\n- Logging: `PORTAL.sp_log_stats_execution` (+ `sp_log_stats_table` ove utile)\n- Output JSON‚Äëfriendly: `status`, `id/code`, `error_message`, `rows_*`\n- Versione `sp_debug_*` per ambienti test\n\nCategorie principali\n- Setup/Utility, Tenant, Users, ACL/Profile Domains, Section Access, Config/Subscription, Notifications, Audit/Masking/RLS, Stats/Monitoring, Debug/Diagnostics\n\nProssimi passi\n- Migrazioni dedicate per SP core e versioni debug","size_chars":533,"tokens_estimate":133}
{"doc_id":"ew-portal","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/portal.md","title":"EasyWay Data Portal ‚Äì PORTAL.md","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"‚úÖ Scopo del file\r","anchor_slug":"scopo-del-file","chunk_index":1,"content":"## ‚úÖ Scopo del file\n\nQuesto documento descrive tutte le tabelle anagrafiche, di ACL, di configurazione e di subscription dello schema `PORTAL` di EasyWay Data Portal, secondo le best practice multi-tenant SaaS.\n\n---","size_chars":215,"tokens_estimate":54}
{"doc_id":"ew-portal","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/portal.md","title":"EasyWay Data Portal ‚Äì PORTAL.md","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"üìã **Riepilogo tabelle principali schema PORTAL**\r","anchor_slug":"riepilogo-tabelle-principali-schema-portal","chunk_index":2,"content":"## üìã **Riepilogo tabelle principali schema PORTAL**\n\n| Tabella                    | Scopo/Funzione                                      | Note Chiave                              |\r\n|----------------------------|-----------------------------------------------------|-------------------------------------------|\r\n| TENANT                     | Anagrafica clienti/tenant SaaS                      | Un tenant = un‚Äôazienda o cliente          |\r\n| SUBSCRIPTION               | Stato abbonamento, scadenze, pagamenti              | Stripe/PayPal/Nexi, nessun dato carta     |\r\n| PROFILE_DOMAINS            | Profili/ruoli utente (ACL, permessi)                | Gestione ruoli e autorizzazioni           |\r\n| USERS                      | Utenti registrati (multi-tenant, NDG)               | Login locale/federato, tenant_id, ACL     |\r\n| SECTION_ACCESS             | Accesso sezioni portale per tenant                  | Sostenibilit√†, Data Quality, Ecommerce    |\r\n| USER_NOTIFICATION_SETTINGS | Preferenze di notifica utente                       | Email, alert, digest                      |\r\n| MASKING_METADATA           | Colonne soggette a mascheramento dati sensibili     | Compliance GDPR/SOC2, metadata masking    |\r\n| RLS_METADATA               | Row-Level Security, filtri per tenant su tabelle    | Sicurezza, filtri multi-tenant            |\r\n| CONFIGURATION              | Parametri, flag, chiavi, feature toggle             | Override per tenant/globali, API config   |\n\n---","size_chars":1486,"tokens_estimate":372}
{"doc_id":"ew-portal","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/portal.md","title":"EasyWay Data Portal ‚Äì PORTAL.md","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"1Ô∏è‚É£ **Tenant (Cliente)**\r","anchor_slug":"1-tenant-cliente","chunk_index":3,"content":"### 1Ô∏è‚É£ **Tenant (Cliente)**\n\n> **Gestisce tutte le aziende/tenant che accedono alla piattaforma EasyWay.  \r\nOgni record corrisponde a un cliente (azienda, organizzazione, partita IVA, ecc).  \r\nIl campo `plan_code` definisce il piano commerciale attivo (BASE, BRONZE, SILVER, GOLD).  \r\nContiene estensioni custom JSON per dati aggiuntivi.**\n\n```sql\r\n-- Anagrafica Tenant (Cliente/azienda)\r\nCREATE TABLE PORTAL.TENANT (\r\n    id INT IDENTITY(1,1) PRIMARY KEY,\r\n    tenant_id NVARCHAR(50) NOT NULL UNIQUE,      -- Codice NDG es. TEN00000001000\r\n    name NVARCHAR(255) NOT NULL,                 -- Ragione sociale/nome visualizzato\r\n    plan_code NVARCHAR(50) NOT NULL,             -- BASE, BRONZE, SILVER, GOLD\r\n    ext_attributes NVARCHAR(MAX),                -- Estensioni JSON custom\r\n    created_by NVARCHAR(255),\r\n    created_at DATETIME2 DEFAULT SYSUTCDATETIME(),\r\n    updated_at DATETIME2 DEFAULT SYSUTCDATETIME()\r\n);\r\n```sql","size_chars":929,"tokens_estimate":232}
{"doc_id":"ew-portal","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/portal.md","title":"EasyWay Data Portal ‚Äì PORTAL.md","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"2Ô∏è‚É£ **Abbonamenti / Subscription**\r","anchor_slug":"2-abbonamenti-subscription","chunk_index":4,"content":"### 2Ô∏è‚É£ **Abbonamenti / Subscription**\r\nTiene traccia degli abbonamenti attivi, delle scadenze, e del provider di pagamento esterno (Stripe, PayPal, Nexi).  \r\nMai salvare dati carta, solo ID/token transazione!  \r\nPermette logica di rinnovo, scadenza, upgrade/downgrade piani.\n\n```sql\r\n-- Gestione abbonamenti, scadenze, stato pagamento\r\nCREATE TABLE PORTAL.SUBSCRIPTION (\r\n    id INT IDENTITY(1,1) PRIMARY KEY,\r\n    tenant_id NVARCHAR(50) NOT NULL,                 -- FK PORTAL.TENANT.tenant_id\r\n    plan_code NVARCHAR(50) NOT NULL,                 -- Piano commerciale scelto\r\n    status NVARCHAR(50) NOT NULL,                    -- ACTIVE, EXPIRED, SUSPENDED, ecc.\r\n    start_date DATETIME2 NOT NULL,\r\n    end_date DATETIME2 NOT NULL,\r\n    external_payment_id NVARCHAR(100),               -- ID Stripe/PayPal/Nexi\r\n    payment_provider NVARCHAR(50),                   -- Stripe, PayPal, Nexi, ecc.\r\n    last_payment_date DATETIME2,\r\n    ext_attributes NVARCHAR(MAX),\r\n    created_by NVARCHAR(255),\r\n    created_at DATETIME2 DEFAULT SYSUTCDATETIME(),\r\n    updated_at DATETIME2 DEFAULT SYSUTCDATETIME(),\r\n    FOREIGN KEY (tenant_id) REFERENCES PORTAL.TENANT(tenant_id)\r\n);\r\n```sql","size_chars":1180,"tokens_estimate":295}
{"doc_id":"ew-portal","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/portal.md","title":"EasyWay Data Portal ‚Äì PORTAL.md","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"3Ô∏è‚É£ **Profili utente (ACL)**\r","anchor_slug":"3-profili-utente-acl","chunk_index":5,"content":"### 3Ô∏è‚É£ **Profili utente (ACL)**\r\nElenco dei profili ACL/ruoli disponibili nel portale.  \r\nOgni utente avr√† un profilo associato (es: TENANT_ADMIN, VIEWER, SCHEDULER).  \r\nLe descrizioni e le estensioni JSON permettono di personalizzare permessi e visibilit√†.\n\n```SQL\r\n-- Domini di profilo ACL\r\nCREATE TABLE PORTAL.PROFILE_DOMAINS (\r\n    id INT IDENTITY(1,1) PRIMARY KEY,\r\n    profile_code NVARCHAR(50) NOT NULL UNIQUE,        -- Es. TENANT_ADMIN, VIEWER\r\n    description NVARCHAR(255),\r\n    ext_attributes NVARCHAR(MAX),\r\n    created_by NVARCHAR(255),\r\n    created_at DATETIME2 DEFAULT SYSUTCDATETIME(),\r\n    updated_at DATETIME2 DEFAULT SYSUTCDATETIME()\r\n);\r\n```sql","size_chars":666,"tokens_estimate":166}
{"doc_id":"ew-portal","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/portal.md","title":"EasyWay Data Portal ‚Äì PORTAL.md","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"4Ô∏è‚É£ **Anagrafica Utenti**\r","anchor_slug":"4-anagrafica-utenti","chunk_index":6,"content":"### 4Ô∏è‚É£ **Anagrafica Utenti**\r\nTutti gli utenti abilitati al portale, con login locale o federato (Microsoft, Google, SAML, ecc).  \r\nInclude info su ACL, stato, e dati anagrafici minimi.  \r\nNessuna password in chiaro, solo hash lato app.\n\n```SQL\r\n-- Utenti multi-tenant\r\nCREATE TABLE PORTAL.USERS (\r\n    id INT IDENTITY(1,1) PRIMARY KEY,\r\n    user_id NVARCHAR(50) NOT NULL UNIQUE,             -- Codice NDG es. CDI00000001000\r\n    tenant_id NVARCHAR(50) NOT NULL,                  -- FK PORTAL.TENANT.tenant_id\r\n    email NVARCHAR(255) NOT NULL,\r\n    name NVARCHAR(100),\r\n    surname NVARCHAR(100),\r\n    password NVARCHAR(255),                           -- Password hashata (NULL se federato)\r\n    provider NVARCHAR(50),                            -- Provider federato, NULL=locale\r\n    provider_user_id NVARCHAR(255),\r\n    status NVARCHAR(50),\r\n    profile_code NVARCHAR(50) NOT NULL,               -- FK PROFILE_DOMAINS\r\n    is_tenant_admin BIT,\r\n    ext_attributes NVARCHAR(MAX),\r\n    created_by NVARCHAR(255),\r\n    created_at DATETIME2 DEFAULT SYSUTCDATETIME(),\r\n    updated_at DATETIME2 DEFAULT SYSUTCDATETIME(),\r\n    FOREIGN KEY (tenant_id) REFERENCES PORTAL.TENANT(tenant_id),\r\n    FOREIGN KEY (profile_code) REFERENCES PORTAL.PROFILE_DOMAINS(profile_code)\r\n);\r\n```sql","size_chars":1275,"tokens_estimate":319}
{"doc_id":"ew-portal","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/portal.md","title":"EasyWay Data Portal ‚Äì PORTAL.md","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"5Ô∏è‚É£ **Accesso sezioni Portale**\r","anchor_slug":"5-accesso-sezioni-portale","chunk_index":7,"content":"### 5Ô∏è‚É£ **Accesso sezioni Portale**\r\nGestione dell‚Äôabilitazione/disabilitazione di specifiche sezioni (Sostenibilit√†, Data Quality, Ecommerce, ecc.) per ogni tenant.  \r\nPermette la visibilit√† granulare delle funzioni offerte a ciascun cliente.\n\n```SQL\r\n-- Gestione abilitazione sezioni portale per tenant\r\nCREATE TABLE PORTAL.SECTION_ACCESS (\r\n    id INT IDENTITY(1,1) PRIMARY KEY,\r\n    tenant_id NVARCHAR(50) NOT NULL,              -- FK PORTAL.TENANT.tenant_id\r\n    section_code NVARCHAR(50),                    -- Es. SOSTENIBILITA, DATAQUALITY\r\n    is_enabled BIT,\r\n    ext_attributes NVARCHAR(MAX),\r\n    created_by NVARCHAR(255),\r\n    created_at DATETIME2 DEFAULT SYSUTCDATETIME(),\r\n    updated_at DATETIME2 DEFAULT SYSUTCDATETIME(),\r\n    FOREIGN KEY (tenant_id) REFERENCES PORTAL.TENANT(tenant_id)\r\n);\r\n```sql","size_chars":815,"tokens_estimate":204}
{"doc_id":"ew-portal","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/portal.md","title":"EasyWay Data Portal ‚Äì PORTAL.md","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"5Ô∏è‚É£ **Accesso sezioni Portale** (Policy Section Access custom)\r","anchor_slug":"5-accesso-sezioni-portale-policy-section-access-custom","chunk_index":8,"content":"## 5Ô∏è‚É£ **Accesso sezioni Portale** (Policy Section Access custom)\n\nGestione avanzata e flessibile di quali sezioni/funzionalit√† (Sostenibilit√†, Data Quality, Ecommerce, ecc.)  \r\nsono abilitate/disabilitate per ogni tenant, profilo ACL, o singolo utente, con supporto per accessi temporanei, permessi premium, override granulari.\n\n**La tabella PORTAL.SECTION_ACCESS consente policy custom con questa logica:**","size_chars":408,"tokens_estimate":102}
{"doc_id":"ew-portal","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/portal.md","title":"EasyWay Data Portal ‚Äì PORTAL.md","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"üìë **Tabellina campi chiave**\r","anchor_slug":"tabellina-campi-chiave","chunk_index":9,"content":"### üìë **Tabellina campi chiave**\r\n| Campo        | Uso/Funzione                                    | Note                                  |\r\n|--------------|-------------------------------------------------|---------------------------------------|\r\n| tenant_id    | Tenant destinatario della policy                | FK obbligatoria                       |\r\n| section_code | Codice sezione (es. SOSTENIBILITA, ECOMMERCE)   |                                       |\r\n| profile_code | (opzionale) Profilo ACL per granularit√†         | Per controllare su ruoli specifici     |\r\n| user_id      | (opzionale) Utente specifico per override       | Per abilitare/disabilitare singolo     |\r\n| is_enabled   | Flag abilitazione/disabilitazione               | 1 = abilitato, 0 = disabilitato        |\r\n| valid_from/to| Periodo validit√† policy (accesso temporaneo)    | Per ‚Äúfeature a scadenza‚Äù               |\r\n| ext_attributes| JSON con permessi extra, note, motivazioni     | Audit, motivazioni override, tag       |","size_chars":1010,"tokens_estimate":252}
{"doc_id":"ew-portal","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/portal.md","title":"EasyWay Data Portal ‚Äì PORTAL.md","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"üèóÔ∏è **DDL con estensioni**\r","anchor_slug":"ddl-con-estensioni","chunk_index":10,"content":"### üèóÔ∏è **DDL con estensioni**\r\n```sql\r\nCREATE TABLE PORTAL.SECTION_ACCESS (\r\n    id INT IDENTITY(1,1) PRIMARY KEY,\r\n    tenant_id NVARCHAR(50) NOT NULL,              -- FK PORTAL.TENANT.tenant_id\r\n    section_code NVARCHAR(50),                    -- Es: SOSTENIBILITA, DATAQUALITY, ECOMMERCE\r\n    profile_code NVARCHAR(50) NULL,               -- (opzionale) FK PROFILE_DOMAINS per granularit√† su profilo\r\n    user_id NVARCHAR(50) NULL,                    -- (opzionale) FK USERS per override singolo utente\r\n    is_enabled BIT,                               -- Flag attiva/disattiva\r\n    valid_from DATETIME2 NULL,                    -- Periodo di validit√† (custom access temporanei)\r\n    valid_to DATETIME2 NULL,\r\n    ext_attributes NVARCHAR(MAX),                 -- Campi custom (es. JSON con note o permessi extra)\r\n    created_by NVARCHAR(255),\r\n    created_at DATETIME2 DEFAULT SYSUTCDATETIME(),\r\n    updated_at DATETIME2 DEFAULT SYSUTCDATETIME(),\r\n    FOREIGN KEY (tenant_id) REFERENCES PORTAL.TENANT(tenant_id)\r\n    -- FK opzionali su profile_code, user_id se vuoi enforcement SQL\r\n);\r\n```sql\r\nEsempi pratici di policy custom:\r\n| tenant_id | section_code | profile_code | user_id | is_enabled | valid_from | valid_to | ext_attributes |\r\n| --- | --- | --- | --- | --- | --- | --- | --- |\r\n| TEN0000000100 | SOSTENIBILITA | NULL | NULL | 1 | NULL | NULL | NULL |\r\n| TEN0000000100 | ECOMMERCE | VIEWER | NULL | 0 | NULL | NULL | NULL |\r\n| TEN0000000101 | DATAQUALITY | NULL | CDI0000002 | 1 | 2025-01-01 | 2025-12-31 | {\"note\":\"accesso premium\"} |\n\n\r\n**Best practice:**\r\n*   Usa ext_attributes per motivazioni di override, permessi temporanei, note audit\r\n    \r\n*   Audit ogni modifica tramite LOG_AUDIT\r\n    \r\n*   Mantieni la granularit√† solo dove necessario (tenant > profilo > utente > periodo > custom)\r\n    \r\n*   Struttura sempre pronta a essere estesa per nuove sezioni/funzioni","size_chars":1889,"tokens_estimate":472}
{"doc_id":"ew-portal","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/portal.md","title":"EasyWay Data Portal ‚Äì PORTAL.md","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"6Ô∏è‚É£ **Preferenze Notifica Utente**\r","anchor_slug":"6-preferenze-notifica-utente","chunk_index":11,"content":"### 6Ô∏è‚É£ **Preferenze Notifica Utente**\n\nConfigurazione delle preferenze di notifica per ogni utente (upload, alert, digest).  \r\nLa tabella permette la gestione avanzata di notifiche personalizzate per utente/tenant.\n\n```SQL\r\n-- Preferenze notifica granulari per utente\r\nCREATE TABLE PORTAL.USER_NOTIFICATION_SETTINGS (\r\n    id INT IDENTITY(1,1) PRIMARY KEY,\r\n    tenant_id NVARCHAR(50) NOT NULL,                  -- FK PORTAL.TENANT.tenant_id\r\n    user_id NVARCHAR(50) NOT NULL,                    -- FK PORTAL.USERS.user_id\r\n    notify_on_upload BIT,\r\n    notify_on_alert BIT,\r\n    notify_on_digest BIT,\r\n    ext_attributes NVARCHAR(MAX),\r\n    created_by NVARCHAR(255),\r\n    created_at DATETIME2 DEFAULT SYSUTCDATETIME(),\r\n    updated_at DATETIME2 DEFAULT SYSUTCDATETIME(),\r\n    FOREIGN KEY (tenant_id) REFERENCES PORTAL.TENANT(tenant_id),\r\n    FOREIGN KEY (user_id) REFERENCES PORTAL.USERS(user_id)\r\n);\r\n```sql","size_chars":912,"tokens_estimate":228}
{"doc_id":"ew-portal","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/portal.md","title":"EasyWay Data Portal ‚Äì PORTAL.md","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"7Ô∏è‚É£ **Mascheramento dati sensibili (GDPR, SOC2, ISO27001, DORA)**\r","anchor_slug":"7-mascheramento-dati-sensibili-gdpr-soc2-iso27001-dora","chunk_index":12,"content":"### 7Ô∏è‚É£ **Mascheramento dati sensibili (GDPR, SOC2, ISO27001, DORA)**\r\nRegistra tutte le colonne soggette a mascheramento (Dynamic Data Masking),  \r\ncon regole, note e dettagli per compliance e audit.  \r\nUsata da funzioni e policy di sicurezza.\n\n```SQL\r\n-- Metadata colonne da mascherare (GDPR/SOC2)\r\nCREATE TABLE PORTAL.MASKING_METADATA (\r\n    id INT IDENTITY(1,1) PRIMARY KEY,\r\n    tenant_id NVARCHAR(50),                         -- NULL = globale, valorizzato = per tenant\r\n    schema_name NVARCHAR(50),\r\n    table_name NVARCHAR(100),\r\n    column_name NVARCHAR(100),\r\n    mask_type NVARCHAR(50),\r\n    note NVARCHAR(255),\r\n    ext_attributes NVARCHAR(MAX),\r\n    created_by NVARCHAR(255),\r\n    created_at DATETIME2 DEFAULT SYSUTCDATETIME(),\r\n    updated_at DATETIME2 DEFAULT SYSUTCDATETIME()\r\n);\r\n```sql","size_chars":804,"tokens_estimate":201}
{"doc_id":"ew-portal","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/portal.md","title":"EasyWay Data Portal ‚Äì PORTAL.md","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"8Ô∏è‚É£ **Row-Level Security (RLS) Metadata**\r","anchor_slug":"8-row-level-security-rls-metadata","chunk_index":13,"content":"### 8Ô∏è‚É£ **Row-Level Security (RLS) Metadata**\r\nTraccia le policy di Row-Level Security applicate alle tabelle per filtraggio automatico  \r\nsui dati per tenant, garantendo isolamento dati, sicurezza multi-tenant, auditing.\r\n```SQL\r\n-- Metadata Row-Level Security\r\nCREATE TABLE PORTAL.RLS_METADATA (\r\n    id INT IDENTITY(1,1) PRIMARY KEY,\r\n    tenant_id NVARCHAR(50),                         -- NULL = globale, valorizzato = per tenant\r\n    schema_name NVARCHAR(50),\r\n    table_name NVARCHAR(100),\r\n    column_name NVARCHAR(100),\r\n    policy_name NVARCHAR(100),\r\n    predicate_function NVARCHAR(255),\r\n    note NVARCHAR(255),\r\n    ext_attributes NVARCHAR(MAX),\r\n    created_by NVARCHAR(255),\r\n    created_at DATETIME2 DEFAULT SYSUTCDATETIME(),\r\n    updated_at DATETIME2 DEFAULT SYSUTCDATETIME()\r\n);\r\n```sql","size_chars":804,"tokens_estimate":201}
{"doc_id":"ew-portal","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/portal.md","title":"EasyWay Data Portal ‚Äì PORTAL.md","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"9Ô∏è‚É£ **Configurazione globale/tenant**\r","anchor_slug":"9-configurazione-globaletenant","chunk_index":14,"content":"### 9Ô∏è‚É£ **Configurazione globale/tenant**\r\nGestione centralizzata dei parametri di configurazione della piattaforma,  \r\nflag, feature toggle, chiavi API, limiti, soglie, override per tenant e parametri globali.  \r\nEstensibile e auditabile.\n\n```SQL\r\n-- Parametri di configurazione e flag globali/per-tenant\r\nCREATE TABLE PORTAL.CONFIGURATION (\r\n    id INT IDENTITY(1,1) PRIMARY KEY,\r\n    tenant_id NVARCHAR(50),                              -- NULL = globale, valorizzato = per tenant\r\n    config_key NVARCHAR(100) NOT NULL,\r\n    config_value NVARCHAR(MAX) NOT NULL,\r\n    description NVARCHAR(255),\r\n    is_active BIT DEFAULT 1,\r\n    created_by NVARCHAR(255),\r\n    created_at DATETIME2 DEFAULT SYSUTCDATETIME(),\r\n    updated_at DATETIME2 DEFAULT SYSUTCDATETIME(),\r\n    UNIQUE (tenant_id, config_key)\r\n);\r\n```sql\n\nüìù **Best practice & note operative**\r\n-------------------------------------\n\n*   Ogni tabella preceduta da commento descrittivo\r\n    \r\n*   Tabellina riepilogativa delle tabelle all‚Äôinizio della sezione\r\n    \r\n*   PK/FK obbligatorie in tutte le anagrafiche principali\r\n    \r\n*   Surrogate key INT (`id`) + chiave NDG (`tenant_id`, `user_id`) sempre\r\n    \r\n*   `ext_attributes` come JSON per campi custom per tenant/utente\r\n    \r\n*   NO dati sensibili (carta, CVC, ecc.) in alcuna tabella: solo ID/token forniti da provider\r\n    \r\n*   Audit e compliance: tutti i cambiamenti devono essere tracciati\r\n    \r\n*   Configurazione: parametri e flag in PORTAL.CONFIGURATION, override per tenant\r\n    \r\n*   Abbonamento: stato abilitato/disabilitato sempre verificato via SUBSCRIPTION","size_chars":1586,"tokens_estimate":396}
{"doc_id":"ew-portal","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/portal.md","title":"EasyWay Data Portal ‚Äì PORTAL.md","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":15,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-programmability","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":1,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-programmability","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":2,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-programmability","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":3,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  ## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":289,"tokens_estimate":72}
{"doc_id":"ew-programmability","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":4,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section ## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":239,"tokens_estimate":60}
{"doc_id":"ew-programmability","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":5,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->","size_chars":125,"tokens_estimate":31}
{"doc_id":"ew-programmability","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":6,"content":"## Esempi Query\r\n`sql\r\n-- SELECT ... FROM ...\r\n`\r\n\"@\r\n  ## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":221,"tokens_estimate":55}
{"doc_id":"ew-programmability","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":7,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-programmability","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":8,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  ## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":289,"tokens_estimate":72}
{"doc_id":"ew-programmability","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":9,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section ## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":239,"tokens_estimate":60}
{"doc_id":"ew-programmability","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":10,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n = Ensure-Section ## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":310,"tokens_estimate":78}
{"doc_id":"ew-programmability","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":11,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-programmability","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":12,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  ## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":289,"tokens_estimate":72}
{"doc_id":"ew-programmability","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":13,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section ## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":239,"tokens_estimate":60}
{"doc_id":"ew-programmability","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":14,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n 'Domande a cui risponde' @\"\r\n- Cosa fa?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":281,"tokens_estimate":70}
{"doc_id":"ew-programmability","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Collegamenti\r","anchor_slug":"collegamenti","chunk_index":15,"content":"## Collegamenti\r\n- [Entities Index](../../../../entities-index.md)","size_chars":66,"tokens_estimate":16}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":1,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":2,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":3,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  -- Modello in uso: Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG univoche, ext_attributes, RLS, auditing).\r\n-- Queste funzioni sono da creare nello schema PORTAL.\n\n-- ========================\r\n-- 1Ô∏è‚É£ Funzione PRODUZIONE: Generazione tenant_id (TEN00000001000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_tenant_id()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n    RETURN 'TEN' + RIGHT('000000000' + CAST(@seq AS NVARCHAR), 9);\r\nEND\r\nGO\r\n```sql\r\n-- ========================\r\n-- 2Ô∏è‚É£ Funzione PRODUZIONE: Generazione user_id (CDI00000001000)\r\n-- ========================\n\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_user_id()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n    RETURN 'CDI' + RIGHT('000000000' + CAST(@seq AS NVARCHAR), 9);\r\nEND\r\nGO\r\n```sql\n\n-- ========================\r\n-- 3Ô∏è‚É£ Funzione DEBUG: Generazione tenant_id di test (TENDEBUG000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_tenant_id_debug()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n    RETURN 'TENDEBUG' + RIGHT('000' + CAST(@seq AS NVARCHAR), 3);\r\nEND\r\nGO\r\n```sql\n\n-- ========================\r\n-- 4Ô∏è‚É£ Funzione DEBUG: Generazione user_id di test (CDIDEBUG000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_user_id_debug()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n    RETURN 'CDIDEBUG' + RIGHT('000' + CAST(@seq AS NVARCHAR), 3);\r\nEND\r\nGO\r\n```sql","size_chars":1741,"tokens_estimate":435}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":4,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":5,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section -- Modello in uso: Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG univoche, ext_attributes, RLS, auditing).\r\n-- Queste funzioni sono da creare nello schema PORTAL.\n\n-- ========================\r\n-- 1Ô∏è‚É£ Funzione PRODUZIONE: Generazione tenant_id (TEN00000001000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_tenant_id()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n    RETURN 'TEN' + RIGHT('000000000' + CAST(@seq AS NVARCHAR), 9);\r\nEND\r\nGO\r\n```sql\r\n-- ========================\r\n-- 2Ô∏è‚É£ Funzione PRODUZIONE: Generazione user_id (CDI00000001000)\r\n-- ========================\n\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_user_id()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n    RETURN 'CDI' + RIGHT('000000000' + CAST(@seq AS NVARCHAR), 9);\r\nEND\r\nGO\r\n```sql\n\n-- ========================\r\n-- 3Ô∏è‚É£ Funzione DEBUG: Generazione tenant_id di test (TENDEBUG000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_tenant_id_debug()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n    RETURN 'TENDEBUG' + RIGHT('000' + CAST(@seq AS NVARCHAR), 3);\r\nEND\r\nGO\r\n```sql\n\n-- ========================\r\n-- 4Ô∏è‚É£ Funzione DEBUG: Generazione user_id di test (CDIDEBUG000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_user_id_debug()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n    RETURN 'CDIDEBUG' + RIGHT('000' + CAST(@seq AS NVARCHAR), 3);\r\nEND\r\nGO\r\n```sql","size_chars":1691,"tokens_estimate":423}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":6,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":7,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->","size_chars":125,"tokens_estimate":31}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":8,"content":"## Esempi Query\r\n`sql\r\n-- SELECT ... FROM ...\r\n`\r\n\"@\r\n  -- Modello in uso: Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG univoche, ext_attributes, RLS, auditing).\r\n-- Queste funzioni sono da creare nello schema PORTAL.\n\n-- ========================\r\n-- 1Ô∏è‚É£ Funzione PRODUZIONE: Generazione tenant_id (TEN00000001000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_tenant_id()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n    RETURN 'TEN' + RIGHT('000000000' + CAST(@seq AS NVARCHAR), 9);\r\nEND\r\nGO\r\n```sql\r\n-- ========================\r\n-- 2Ô∏è‚É£ Funzione PRODUZIONE: Generazione user_id (CDI00000001000)\r\n-- ========================\n\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_user_id()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n    RETURN 'CDI' + RIGHT('000000000' + CAST(@seq AS NVARCHAR), 9);\r\nEND\r\nGO\r\n```sql\n\n-- ========================\r\n-- 3Ô∏è‚É£ Funzione DEBUG: Generazione tenant_id di test (TENDEBUG000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_tenant_id_debug()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n    RETURN 'TENDEBUG' + RIGHT('000' + CAST(@seq AS NVARCHAR), 3);\r\nEND\r\nGO\r\n```sql\n\n-- ========================\r\n-- 4Ô∏è‚É£ Funzione DEBUG: Generazione user_id di test (CDIDEBUG000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_user_id_debug()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n    RETURN 'CDIDEBUG' + RIGHT('000' + CAST(@seq AS NVARCHAR), 3);\r\nEND\r\nGO\r\n```sql","size_chars":1673,"tokens_estimate":418}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":9,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":10,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":11,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  -- Modello in uso: Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG univoche, ext_attributes, RLS, auditing).\r\n-- Queste funzioni sono da creare nello schema PORTAL.\n\n-- ========================\r\n-- 1Ô∏è‚É£ Funzione PRODUZIONE: Generazione tenant_id (TEN00000001000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_tenant_id()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n    RETURN 'TEN' + RIGHT('000000000' + CAST(@seq AS NVARCHAR), 9);\r\nEND\r\nGO\r\n```sql\r\n-- ========================\r\n-- 2Ô∏è‚É£ Funzione PRODUZIONE: Generazione user_id (CDI00000001000)\r\n-- ========================\n\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_user_id()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n    RETURN 'CDI' + RIGHT('000000000' + CAST(@seq AS NVARCHAR), 9);\r\nEND\r\nGO\r\n```sql\n\n-- ========================\r\n-- 3Ô∏è‚É£ Funzione DEBUG: Generazione tenant_id di test (TENDEBUG000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_tenant_id_debug()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n    RETURN 'TENDEBUG' + RIGHT('000' + CAST(@seq AS NVARCHAR), 3);\r\nEND\r\nGO\r\n```sql\n\n-- ========================\r\n-- 4Ô∏è‚É£ Funzione DEBUG: Generazione user_id di test (CDIDEBUG000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_user_id_debug()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n    RETURN 'CDIDEBUG' + RIGHT('000' + CAST(@seq AS NVARCHAR), 3);\r\nEND\r\nGO\r\n```sql","size_chars":1741,"tokens_estimate":435}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":12,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":13,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section -- Modello in uso: Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG univoche, ext_attributes, RLS, auditing).\r\n-- Queste funzioni sono da creare nello schema PORTAL.\n\n-- ========================\r\n-- 1Ô∏è‚É£ Funzione PRODUZIONE: Generazione tenant_id (TEN00000001000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_tenant_id()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n    RETURN 'TEN' + RIGHT('000000000' + CAST(@seq AS NVARCHAR), 9);\r\nEND\r\nGO\r\n```sql\r\n-- ========================\r\n-- 2Ô∏è‚É£ Funzione PRODUZIONE: Generazione user_id (CDI00000001000)\r\n-- ========================\n\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_user_id()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n    RETURN 'CDI' + RIGHT('000000000' + CAST(@seq AS NVARCHAR), 9);\r\nEND\r\nGO\r\n```sql\n\n-- ========================\r\n-- 3Ô∏è‚É£ Funzione DEBUG: Generazione tenant_id di test (TENDEBUG000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_tenant_id_debug()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n    RETURN 'TENDEBUG' + RIGHT('000' + CAST(@seq AS NVARCHAR), 3);\r\nEND\r\nGO\r\n```sql\n\n-- ========================\r\n-- 4Ô∏è‚É£ Funzione DEBUG: Generazione user_id di test (CDIDEBUG000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_user_id_debug()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n    RETURN 'CDIDEBUG' + RIGHT('000' + CAST(@seq AS NVARCHAR), 3);\r\nEND\r\nGO\r\n```sql","size_chars":1691,"tokens_estimate":423}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":14,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":15,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n = Ensure-Section -- Modello in uso: Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG univoche, ext_attributes, RLS, auditing).\r\n-- Queste funzioni sono da creare nello schema PORTAL.\n\n-- ========================\r\n-- 1Ô∏è‚É£ Funzione PRODUZIONE: Generazione tenant_id (TEN00000001000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_tenant_id()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n    RETURN 'TEN' + RIGHT('000000000' + CAST(@seq AS NVARCHAR), 9);\r\nEND\r\nGO\r\n```sql\r\n-- ========================\r\n-- 2Ô∏è‚É£ Funzione PRODUZIONE: Generazione user_id (CDI00000001000)\r\n-- ========================\n\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_user_id()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n    RETURN 'CDI' + RIGHT('000000000' + CAST(@seq AS NVARCHAR), 9);\r\nEND\r\nGO\r\n```sql\n\n-- ========================\r\n-- 3Ô∏è‚É£ Funzione DEBUG: Generazione tenant_id di test (TENDEBUG000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_tenant_id_debug()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n    RETURN 'TENDEBUG' + RIGHT('000' + CAST(@seq AS NVARCHAR), 3);\r\nEND\r\nGO\r\n```sql\n\n-- ========================\r\n-- 4Ô∏è‚É£ Funzione DEBUG: Generazione user_id di test (CDIDEBUG000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_user_id_debug()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n    RETURN 'CDIDEBUG' + RIGHT('000' + CAST(@seq AS NVARCHAR), 3);\r\nEND\r\nGO\r\n```sql","size_chars":1762,"tokens_estimate":440}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":16,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":17,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":18,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  -- Modello in uso: Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG univoche, ext_attributes, RLS, auditing).\r\n-- Queste funzioni sono da creare nello schema PORTAL.\n\n-- ========================\r\n-- 1Ô∏è‚É£ Funzione PRODUZIONE: Generazione tenant_id (TEN00000001000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_tenant_id()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n    RETURN 'TEN' + RIGHT('000000000' + CAST(@seq AS NVARCHAR), 9);\r\nEND\r\nGO\r\n```sql\r\n-- ========================\r\n-- 2Ô∏è‚É£ Funzione PRODUZIONE: Generazione user_id (CDI00000001000)\r\n-- ========================\n\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_user_id()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n    RETURN 'CDI' + RIGHT('000000000' + CAST(@seq AS NVARCHAR), 9);\r\nEND\r\nGO\r\n```sql\n\n-- ========================\r\n-- 3Ô∏è‚É£ Funzione DEBUG: Generazione tenant_id di test (TENDEBUG000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_tenant_id_debug()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n    RETURN 'TENDEBUG' + RIGHT('000' + CAST(@seq AS NVARCHAR), 3);\r\nEND\r\nGO\r\n```sql\n\n-- ========================\r\n-- 4Ô∏è‚É£ Funzione DEBUG: Generazione user_id di test (CDIDEBUG000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_user_id_debug()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n    RETURN 'CDIDEBUG' + RIGHT('000' + CAST(@seq AS NVARCHAR), 3);\r\nEND\r\nGO\r\n```sql","size_chars":1741,"tokens_estimate":435}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":19,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":20,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section -- Modello in uso: Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG univoche, ext_attributes, RLS, auditing).\r\n-- Queste funzioni sono da creare nello schema PORTAL.\n\n-- ========================\r\n-- 1Ô∏è‚É£ Funzione PRODUZIONE: Generazione tenant_id (TEN00000001000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_tenant_id()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n    RETURN 'TEN' + RIGHT('000000000' + CAST(@seq AS NVARCHAR), 9);\r\nEND\r\nGO\r\n```sql\r\n-- ========================\r\n-- 2Ô∏è‚É£ Funzione PRODUZIONE: Generazione user_id (CDI00000001000)\r\n-- ========================\n\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_user_id()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n    RETURN 'CDI' + RIGHT('000000000' + CAST(@seq AS NVARCHAR), 9);\r\nEND\r\nGO\r\n```sql\n\n-- ========================\r\n-- 3Ô∏è‚É£ Funzione DEBUG: Generazione tenant_id di test (TENDEBUG000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_tenant_id_debug()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n    RETURN 'TENDEBUG' + RIGHT('000' + CAST(@seq AS NVARCHAR), 3);\r\nEND\r\nGO\r\n```sql\n\n-- ========================\r\n-- 4Ô∏è‚É£ Funzione DEBUG: Generazione user_id di test (CDIDEBUG000)\r\n-- ========================\r\n```sql\r\nCREATE FUNCTION PORTAL.fn_next_user_id_debug()\r\nRETURNS NVARCHAR(50)\r\nAS\r\nBEGIN\r\n    DECLARE @seq INT = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n    RETURN 'CDIDEBUG' + RIGHT('000' + CAST(@seq AS NVARCHAR), 3);\r\nEND\r\nGO\r\n```sql","size_chars":1691,"tokens_estimate":423}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":21,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":22,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n 'Domande a cui risponde' @\"\r\n- Cosa fa?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":281,"tokens_estimate":70}
{"doc_id":"ew-function","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/function.md","title":"Domande a cui risponde","owner":"","tags":["artifact/function","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Collegamenti\r","anchor_slug":"collegamenti","chunk_index":23,"content":"## Collegamenti\r\n- [Entities Index](../../../../../entities-index.md)","size_chars":69,"tokens_estimate":17}
{"doc_id":"index","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/index.md","title":"Indice","owner":"team-data","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":1,"content":"## Domande a cui risponde\r\n- Dove trovare function/sequence/stored procedure e le rispettive guide?\r\n- Come navigare tra i template e gli esempi per ogni artefatto?\r\n- Dove sono indicati i riferimenti alle entit√† e agli indici correlati?\r\n- Come verificare rapidamente naming e ancore della cartella?","size_chars":300,"tokens_estimate":75}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"‚úÖ Scopo del file\r","anchor_slug":"scopo-del-file","chunk_index":1,"content":"## ‚úÖ Scopo del file\n\nDefinire tutte le **sequence numeriche** utilizzate per la generazione dei codici NDG (tenant, user, ecc.)  \r\nsia in produzione che in debug/test, garantendo tracciabilit√† e nessuna collisione tra dati reali e mock.\n\n---","size_chars":241,"tokens_estimate":60}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"1Ô∏è‚É£ Sequence PRODUZIONE (NDG reali)\r","anchor_slug":"1-sequence-produzione-ndg-reali","chunk_index":2,"content":"## 1Ô∏è‚É£ Sequence PRODUZIONE (NDG reali)\n\n```sql\r\n-- Sequence per tenant_id (NDG es. TEN00000001000)\r\nCREATE SEQUENCE PORTAL.SEQ_TENANT_ID\r\n    AS INT\r\n    START WITH 1000\r\n    INCREMENT BY 1;\n\n-- Sequence per user_id (NDG es. CDI00000001000)\r\nCREATE SEQUENCE PORTAL.SEQ_USER_ID\r\n    AS INT\r\n    START WITH 1000\r\n    INCREMENT BY 1;\r\n```sql","size_chars":338,"tokens_estimate":84}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"2Ô∏è‚É£ Sequence DEBUG/TEST (codici demo)\r","anchor_slug":"2-sequence-debugtest-codici-demo","chunk_index":3,"content":"## 2Ô∏è‚É£ Sequence DEBUG/TEST (codici demo)\n\n```sql\r\n-- Sequence di debug per tenant_id (codici: TENDEBUG000 ... TENDEBUG999)\r\nCREATE SEQUENCE PORTAL.SEQ_TENANT_ID_DEBUG\r\n    AS INT\r\n    START WITH 0\r\n    INCREMENT BY 1\r\n    MINVALUE 0\r\n    MAXVALUE 999\r\n    CYCLE;\n\n-- Sequence di debug per user_id (codici: CDIDEBUG000 ... CDIDEBUG999)\r\nCREATE SEQUENCE PORTAL.SEQ_USER_ID_DEBUG\r\n    AS INT\r\n    START WITH 0\r\n    INCREMENT BY 1\r\n    MINVALUE 0\r\n    MAXVALUE 999\r\n    CYCLE;\r\n```sql","size_chars":480,"tokens_estimate":120}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":4,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":5,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":6,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  # EasyWay Data Portal ‚Äì SEQUENCE\n\n> **Modello in uso:** Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG univoche, ext_attributes, RLS, auditing).\n\n---","size_chars":289,"tokens_estimate":72}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"‚úÖ Scopo del file\r","anchor_slug":"scopo-del-file","chunk_index":7,"content":"## ‚úÖ Scopo del file\n\nDefinire tutte le **sequence numeriche** utilizzate per la generazione dei codici NDG (tenant, user, ecc.)  \r\nsia in produzione che in debug/test, garantendo tracciabilit√† e nessuna collisione tra dati reali e mock.\n\n---","size_chars":241,"tokens_estimate":60}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"1Ô∏è‚É£ Sequence PRODUZIONE (NDG reali)\r","anchor_slug":"1-sequence-produzione-ndg-reali","chunk_index":8,"content":"## 1Ô∏è‚É£ Sequence PRODUZIONE (NDG reali)\n\n```sql\r\n-- Sequence per tenant_id (NDG es. TEN00000001000)\r\nCREATE SEQUENCE PORTAL.SEQ_TENANT_ID\r\n    AS INT\r\n    START WITH 1000\r\n    INCREMENT BY 1;\n\n-- Sequence per user_id (NDG es. CDI00000001000)\r\nCREATE SEQUENCE PORTAL.SEQ_USER_ID\r\n    AS INT\r\n    START WITH 1000\r\n    INCREMENT BY 1;\r\n```sql","size_chars":338,"tokens_estimate":84}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"2Ô∏è‚É£ Sequence DEBUG/TEST (codici demo)\r","anchor_slug":"2-sequence-debugtest-codici-demo","chunk_index":9,"content":"## 2Ô∏è‚É£ Sequence DEBUG/TEST (codici demo)\n\n```sql\r\n-- Sequence di debug per tenant_id (codici: TENDEBUG000 ... TENDEBUG999)\r\nCREATE SEQUENCE PORTAL.SEQ_TENANT_ID_DEBUG\r\n    AS INT\r\n    START WITH 0\r\n    INCREMENT BY 1\r\n    MINVALUE 0\r\n    MAXVALUE 999\r\n    CYCLE;\n\n-- Sequence di debug per user_id (codici: CDIDEBUG000 ... CDIDEBUG999)\r\nCREATE SEQUENCE PORTAL.SEQ_USER_ID_DEBUG\r\n    AS INT\r\n    START WITH 0\r\n    INCREMENT BY 1\r\n    MINVALUE 0\r\n    MAXVALUE 999\r\n    CYCLE;\r\n```sql","size_chars":480,"tokens_estimate":120}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":10,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":11,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section # EasyWay Data Portal ‚Äì SEQUENCE\n\n> **Modello in uso:** Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG univoche, ext_attributes, RLS, auditing).\n\n---","size_chars":239,"tokens_estimate":60}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"‚úÖ Scopo del file\r","anchor_slug":"scopo-del-file","chunk_index":12,"content":"## ‚úÖ Scopo del file\n\nDefinire tutte le **sequence numeriche** utilizzate per la generazione dei codici NDG (tenant, user, ecc.)  \r\nsia in produzione che in debug/test, garantendo tracciabilit√† e nessuna collisione tra dati reali e mock.\n\n---","size_chars":241,"tokens_estimate":60}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"1Ô∏è‚É£ Sequence PRODUZIONE (NDG reali)\r","anchor_slug":"1-sequence-produzione-ndg-reali","chunk_index":13,"content":"## 1Ô∏è‚É£ Sequence PRODUZIONE (NDG reali)\n\n```sql\r\n-- Sequence per tenant_id (NDG es. TEN00000001000)\r\nCREATE SEQUENCE PORTAL.SEQ_TENANT_ID\r\n    AS INT\r\n    START WITH 1000\r\n    INCREMENT BY 1;\n\n-- Sequence per user_id (NDG es. CDI00000001000)\r\nCREATE SEQUENCE PORTAL.SEQ_USER_ID\r\n    AS INT\r\n    START WITH 1000\r\n    INCREMENT BY 1;\r\n```sql","size_chars":338,"tokens_estimate":84}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"2Ô∏è‚É£ Sequence DEBUG/TEST (codici demo)\r","anchor_slug":"2-sequence-debugtest-codici-demo","chunk_index":14,"content":"## 2Ô∏è‚É£ Sequence DEBUG/TEST (codici demo)\n\n```sql\r\n-- Sequence di debug per tenant_id (codici: TENDEBUG000 ... TENDEBUG999)\r\nCREATE SEQUENCE PORTAL.SEQ_TENANT_ID_DEBUG\r\n    AS INT\r\n    START WITH 0\r\n    INCREMENT BY 1\r\n    MINVALUE 0\r\n    MAXVALUE 999\r\n    CYCLE;\n\n-- Sequence di debug per user_id (codici: CDIDEBUG000 ... CDIDEBUG999)\r\nCREATE SEQUENCE PORTAL.SEQ_USER_ID_DEBUG\r\n    AS INT\r\n    START WITH 0\r\n    INCREMENT BY 1\r\n    MINVALUE 0\r\n    MAXVALUE 999\r\n    CYCLE;\r\n```sql","size_chars":480,"tokens_estimate":120}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":15,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":16,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->","size_chars":125,"tokens_estimate":31}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":17,"content":"## Esempi Query\r\n`sql\r\n-- SELECT ... FROM ...\r\n`\r\n\"@\r\n  # EasyWay Data Portal ‚Äì SEQUENCE\n\n> **Modello in uso:** Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG univoche, ext_attributes, RLS, auditing).\n\n---","size_chars":221,"tokens_estimate":55}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"‚úÖ Scopo del file\r","anchor_slug":"scopo-del-file","chunk_index":18,"content":"## ‚úÖ Scopo del file\n\nDefinire tutte le **sequence numeriche** utilizzate per la generazione dei codici NDG (tenant, user, ecc.)  \r\nsia in produzione che in debug/test, garantendo tracciabilit√† e nessuna collisione tra dati reali e mock.\n\n---","size_chars":241,"tokens_estimate":60}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"1Ô∏è‚É£ Sequence PRODUZIONE (NDG reali)\r","anchor_slug":"1-sequence-produzione-ndg-reali","chunk_index":19,"content":"## 1Ô∏è‚É£ Sequence PRODUZIONE (NDG reali)\n\n```sql\r\n-- Sequence per tenant_id (NDG es. TEN00000001000)\r\nCREATE SEQUENCE PORTAL.SEQ_TENANT_ID\r\n    AS INT\r\n    START WITH 1000\r\n    INCREMENT BY 1;\n\n-- Sequence per user_id (NDG es. CDI00000001000)\r\nCREATE SEQUENCE PORTAL.SEQ_USER_ID\r\n    AS INT\r\n    START WITH 1000\r\n    INCREMENT BY 1;\r\n```sql","size_chars":338,"tokens_estimate":84}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"2Ô∏è‚É£ Sequence DEBUG/TEST (codici demo)\r","anchor_slug":"2-sequence-debugtest-codici-demo","chunk_index":20,"content":"## 2Ô∏è‚É£ Sequence DEBUG/TEST (codici demo)\n\n```sql\r\n-- Sequence di debug per tenant_id (codici: TENDEBUG000 ... TENDEBUG999)\r\nCREATE SEQUENCE PORTAL.SEQ_TENANT_ID_DEBUG\r\n    AS INT\r\n    START WITH 0\r\n    INCREMENT BY 1\r\n    MINVALUE 0\r\n    MAXVALUE 999\r\n    CYCLE;\n\n-- Sequence di debug per user_id (codici: CDIDEBUG000 ... CDIDEBUG999)\r\nCREATE SEQUENCE PORTAL.SEQ_USER_ID_DEBUG\r\n    AS INT\r\n    START WITH 0\r\n    INCREMENT BY 1\r\n    MINVALUE 0\r\n    MAXVALUE 999\r\n    CYCLE;\r\n```sql","size_chars":480,"tokens_estimate":120}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":21,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":22,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":23,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  # EasyWay Data Portal ‚Äì SEQUENCE\n\n> **Modello in uso:** Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG univoche, ext_attributes, RLS, auditing).\n\n---","size_chars":289,"tokens_estimate":72}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"‚úÖ Scopo del file\r","anchor_slug":"scopo-del-file","chunk_index":24,"content":"## ‚úÖ Scopo del file\n\nDefinire tutte le **sequence numeriche** utilizzate per la generazione dei codici NDG (tenant, user, ecc.)  \r\nsia in produzione che in debug/test, garantendo tracciabilit√† e nessuna collisione tra dati reali e mock.\n\n---","size_chars":241,"tokens_estimate":60}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"1Ô∏è‚É£ Sequence PRODUZIONE (NDG reali)\r","anchor_slug":"1-sequence-produzione-ndg-reali","chunk_index":25,"content":"## 1Ô∏è‚É£ Sequence PRODUZIONE (NDG reali)\n\n```sql\r\n-- Sequence per tenant_id (NDG es. TEN00000001000)\r\nCREATE SEQUENCE PORTAL.SEQ_TENANT_ID\r\n    AS INT\r\n    START WITH 1000\r\n    INCREMENT BY 1;\n\n-- Sequence per user_id (NDG es. CDI00000001000)\r\nCREATE SEQUENCE PORTAL.SEQ_USER_ID\r\n    AS INT\r\n    START WITH 1000\r\n    INCREMENT BY 1;\r\n```sql","size_chars":338,"tokens_estimate":84}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"2Ô∏è‚É£ Sequence DEBUG/TEST (codici demo)\r","anchor_slug":"2-sequence-debugtest-codici-demo","chunk_index":26,"content":"## 2Ô∏è‚É£ Sequence DEBUG/TEST (codici demo)\n\n```sql\r\n-- Sequence di debug per tenant_id (codici: TENDEBUG000 ... TENDEBUG999)\r\nCREATE SEQUENCE PORTAL.SEQ_TENANT_ID_DEBUG\r\n    AS INT\r\n    START WITH 0\r\n    INCREMENT BY 1\r\n    MINVALUE 0\r\n    MAXVALUE 999\r\n    CYCLE;\n\n-- Sequence di debug per user_id (codici: CDIDEBUG000 ... CDIDEBUG999)\r\nCREATE SEQUENCE PORTAL.SEQ_USER_ID_DEBUG\r\n    AS INT\r\n    START WITH 0\r\n    INCREMENT BY 1\r\n    MINVALUE 0\r\n    MAXVALUE 999\r\n    CYCLE;\r\n```sql","size_chars":480,"tokens_estimate":120}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":27,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":28,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section # EasyWay Data Portal ‚Äì SEQUENCE\n\n> **Modello in uso:** Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG univoche, ext_attributes, RLS, auditing).\n\n---","size_chars":239,"tokens_estimate":60}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"‚úÖ Scopo del file\r","anchor_slug":"scopo-del-file","chunk_index":29,"content":"## ‚úÖ Scopo del file\n\nDefinire tutte le **sequence numeriche** utilizzate per la generazione dei codici NDG (tenant, user, ecc.)  \r\nsia in produzione che in debug/test, garantendo tracciabilit√† e nessuna collisione tra dati reali e mock.\n\n---","size_chars":241,"tokens_estimate":60}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"1Ô∏è‚É£ Sequence PRODUZIONE (NDG reali)\r","anchor_slug":"1-sequence-produzione-ndg-reali","chunk_index":30,"content":"## 1Ô∏è‚É£ Sequence PRODUZIONE (NDG reali)\n\n```sql\r\n-- Sequence per tenant_id (NDG es. TEN00000001000)\r\nCREATE SEQUENCE PORTAL.SEQ_TENANT_ID\r\n    AS INT\r\n    START WITH 1000\r\n    INCREMENT BY 1;\n\n-- Sequence per user_id (NDG es. CDI00000001000)\r\nCREATE SEQUENCE PORTAL.SEQ_USER_ID\r\n    AS INT\r\n    START WITH 1000\r\n    INCREMENT BY 1;\r\n```sql","size_chars":338,"tokens_estimate":84}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"2Ô∏è‚É£ Sequence DEBUG/TEST (codici demo)\r","anchor_slug":"2-sequence-debugtest-codici-demo","chunk_index":31,"content":"## 2Ô∏è‚É£ Sequence DEBUG/TEST (codici demo)\n\n```sql\r\n-- Sequence di debug per tenant_id (codici: TENDEBUG000 ... TENDEBUG999)\r\nCREATE SEQUENCE PORTAL.SEQ_TENANT_ID_DEBUG\r\n    AS INT\r\n    START WITH 0\r\n    INCREMENT BY 1\r\n    MINVALUE 0\r\n    MAXVALUE 999\r\n    CYCLE;\n\n-- Sequence di debug per user_id (codici: CDIDEBUG000 ... CDIDEBUG999)\r\nCREATE SEQUENCE PORTAL.SEQ_USER_ID_DEBUG\r\n    AS INT\r\n    START WITH 0\r\n    INCREMENT BY 1\r\n    MINVALUE 0\r\n    MAXVALUE 999\r\n    CYCLE;\r\n```sql","size_chars":480,"tokens_estimate":120}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":32,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":33,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n = Ensure-Section # EasyWay Data Portal ‚Äì SEQUENCE\n\n> **Modello in uso:** Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG univoche, ext_attributes, RLS, auditing).\n\n---","size_chars":310,"tokens_estimate":78}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"‚úÖ Scopo del file\r","anchor_slug":"scopo-del-file","chunk_index":34,"content":"## ‚úÖ Scopo del file\n\nDefinire tutte le **sequence numeriche** utilizzate per la generazione dei codici NDG (tenant, user, ecc.)  \r\nsia in produzione che in debug/test, garantendo tracciabilit√† e nessuna collisione tra dati reali e mock.\n\n---","size_chars":241,"tokens_estimate":60}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"1Ô∏è‚É£ Sequence PRODUZIONE (NDG reali)\r","anchor_slug":"1-sequence-produzione-ndg-reali","chunk_index":35,"content":"## 1Ô∏è‚É£ Sequence PRODUZIONE (NDG reali)\n\n```sql\r\n-- Sequence per tenant_id (NDG es. TEN00000001000)\r\nCREATE SEQUENCE PORTAL.SEQ_TENANT_ID\r\n    AS INT\r\n    START WITH 1000\r\n    INCREMENT BY 1;\n\n-- Sequence per user_id (NDG es. CDI00000001000)\r\nCREATE SEQUENCE PORTAL.SEQ_USER_ID\r\n    AS INT\r\n    START WITH 1000\r\n    INCREMENT BY 1;\r\n```sql","size_chars":338,"tokens_estimate":84}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"2Ô∏è‚É£ Sequence DEBUG/TEST (codici demo)\r","anchor_slug":"2-sequence-debugtest-codici-demo","chunk_index":36,"content":"## 2Ô∏è‚É£ Sequence DEBUG/TEST (codici demo)\n\n```sql\r\n-- Sequence di debug per tenant_id (codici: TENDEBUG000 ... TENDEBUG999)\r\nCREATE SEQUENCE PORTAL.SEQ_TENANT_ID_DEBUG\r\n    AS INT\r\n    START WITH 0\r\n    INCREMENT BY 1\r\n    MINVALUE 0\r\n    MAXVALUE 999\r\n    CYCLE;\n\n-- Sequence di debug per user_id (codici: CDIDEBUG000 ... CDIDEBUG999)\r\nCREATE SEQUENCE PORTAL.SEQ_USER_ID_DEBUG\r\n    AS INT\r\n    START WITH 0\r\n    INCREMENT BY 1\r\n    MINVALUE 0\r\n    MAXVALUE 999\r\n    CYCLE;\r\n```sql","size_chars":480,"tokens_estimate":120}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":37,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":38,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":39,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  # EasyWay Data Portal ‚Äì SEQUENCE\n\n> **Modello in uso:** Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG univoche, ext_attributes, RLS, auditing).\n\n---","size_chars":289,"tokens_estimate":72}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"‚úÖ Scopo del file\r","anchor_slug":"scopo-del-file","chunk_index":40,"content":"## ‚úÖ Scopo del file\n\nDefinire tutte le **sequence numeriche** utilizzate per la generazione dei codici NDG (tenant, user, ecc.)  \r\nsia in produzione che in debug/test, garantendo tracciabilit√† e nessuna collisione tra dati reali e mock.\n\n---","size_chars":241,"tokens_estimate":60}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"1Ô∏è‚É£ Sequence PRODUZIONE (NDG reali)\r","anchor_slug":"1-sequence-produzione-ndg-reali","chunk_index":41,"content":"## 1Ô∏è‚É£ Sequence PRODUZIONE (NDG reali)\n\n```sql\r\n-- Sequence per tenant_id (NDG es. TEN00000001000)\r\nCREATE SEQUENCE PORTAL.SEQ_TENANT_ID\r\n    AS INT\r\n    START WITH 1000\r\n    INCREMENT BY 1;\n\n-- Sequence per user_id (NDG es. CDI00000001000)\r\nCREATE SEQUENCE PORTAL.SEQ_USER_ID\r\n    AS INT\r\n    START WITH 1000\r\n    INCREMENT BY 1;\r\n```sql","size_chars":338,"tokens_estimate":84}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"2Ô∏è‚É£ Sequence DEBUG/TEST (codici demo)\r","anchor_slug":"2-sequence-debugtest-codici-demo","chunk_index":42,"content":"## 2Ô∏è‚É£ Sequence DEBUG/TEST (codici demo)\n\n```sql\r\n-- Sequence di debug per tenant_id (codici: TENDEBUG000 ... TENDEBUG999)\r\nCREATE SEQUENCE PORTAL.SEQ_TENANT_ID_DEBUG\r\n    AS INT\r\n    START WITH 0\r\n    INCREMENT BY 1\r\n    MINVALUE 0\r\n    MAXVALUE 999\r\n    CYCLE;\n\n-- Sequence di debug per user_id (codici: CDIDEBUG000 ... CDIDEBUG999)\r\nCREATE SEQUENCE PORTAL.SEQ_USER_ID_DEBUG\r\n    AS INT\r\n    START WITH 0\r\n    INCREMENT BY 1\r\n    MINVALUE 0\r\n    MAXVALUE 999\r\n    CYCLE;\r\n```sql","size_chars":480,"tokens_estimate":120}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":43,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":44,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section # EasyWay Data Portal ‚Äì SEQUENCE\n\n> **Modello in uso:** Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG univoche, ext_attributes, RLS, auditing).\n\n---","size_chars":239,"tokens_estimate":60}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"‚úÖ Scopo del file\r","anchor_slug":"scopo-del-file","chunk_index":45,"content":"## ‚úÖ Scopo del file\n\nDefinire tutte le **sequence numeriche** utilizzate per la generazione dei codici NDG (tenant, user, ecc.)  \r\nsia in produzione che in debug/test, garantendo tracciabilit√† e nessuna collisione tra dati reali e mock.\n\n---","size_chars":241,"tokens_estimate":60}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"1Ô∏è‚É£ Sequence PRODUZIONE (NDG reali)\r","anchor_slug":"1-sequence-produzione-ndg-reali","chunk_index":46,"content":"## 1Ô∏è‚É£ Sequence PRODUZIONE (NDG reali)\n\n```sql\r\n-- Sequence per tenant_id (NDG es. TEN00000001000)\r\nCREATE SEQUENCE PORTAL.SEQ_TENANT_ID\r\n    AS INT\r\n    START WITH 1000\r\n    INCREMENT BY 1;\n\n-- Sequence per user_id (NDG es. CDI00000001000)\r\nCREATE SEQUENCE PORTAL.SEQ_USER_ID\r\n    AS INT\r\n    START WITH 1000\r\n    INCREMENT BY 1;\r\n```sql","size_chars":338,"tokens_estimate":84}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"2Ô∏è‚É£ Sequence DEBUG/TEST (codici demo)\r","anchor_slug":"2-sequence-debugtest-codici-demo","chunk_index":47,"content":"## 2Ô∏è‚É£ Sequence DEBUG/TEST (codici demo)\n\n```sql\r\n-- Sequence di debug per tenant_id (codici: TENDEBUG000 ... TENDEBUG999)\r\nCREATE SEQUENCE PORTAL.SEQ_TENANT_ID_DEBUG\r\n    AS INT\r\n    START WITH 0\r\n    INCREMENT BY 1\r\n    MINVALUE 0\r\n    MAXVALUE 999\r\n    CYCLE;\n\n-- Sequence di debug per user_id (codici: CDIDEBUG000 ... CDIDEBUG999)\r\nCREATE SEQUENCE PORTAL.SEQ_USER_ID_DEBUG\r\n    AS INT\r\n    START WITH 0\r\n    INCREMENT BY 1\r\n    MINVALUE 0\r\n    MAXVALUE 999\r\n    CYCLE;\r\n```sql","size_chars":480,"tokens_estimate":120}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":48,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":49,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n 'Domande a cui risponde' @\"\r\n- Cosa fa?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":281,"tokens_estimate":70}
{"doc_id":"ew-sequence","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/sequence.md","title":"EasyWay Data Portal ‚Äì SEQUENCE","owner":"","tags":["artifact/sequence","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Collegamenti\r","anchor_slug":"collegamenti","chunk_index":50,"content":"## Collegamenti\r\n- [Entities Index](../../../../../entities-index.md)","size_chars":69,"tokens_estimate":17}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"‚úÖ Scopo del documento\r","anchor_slug":"scopo-del-documento","chunk_index":1,"content":"## ‚úÖ Scopo del documento\n\nDefinire e standardizzare la **struttura, i pattern, e le best practice** delle store procedure (SP) per EasyWay Data Portal.  \r\nObiettivo: **nessun dato chiave inserito manualmente**, **tutto tracciato**, massima robustezza per AMS, DevOps, audit.\n\n---","size_chars":279,"tokens_estimate":70}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**Principi generali EasyWay per Store Process**\r","anchor_slug":"principi-generali-easyway-per-store-process","chunk_index":2,"content":"### **Principi generali EasyWay per Store Process**\n\n- **Tutto l‚Äôonboarding, le operazioni DML, e la logica applicativa passano sempre da store procedure.**\r\n- **Nessun insert/update diretto sulle tabelle anagrafiche e di business.**\r\n- **Ogni store procedure aggiorna sempre i campi di auditing (`created_by`, `created_at`, `updated_at`).**\r\n- **Tutte le SP devono scrivere SEMPRE un record su `PORTAL.STATS_EXECUTION_LOG`** con:\r\n    - nome procedura,\r\n    - tenant_id, user_id,\r\n    - righe inserite/aggiornate/cancellate,\r\n    - start_time, end_time, durata,\r\n    - status (`OK`/`ERROR`),\r\n    - error_message se presente,\r\n    - tabelle impattate, tipo operazione, chi ha eseguito.\r\n- **Ogni store procedure importante** (soprattutto quelle richiamate da API/servizi/portale) ha anche la versione `_DEBUG`:\r\n    - Usa sequence e codici di test (es. `TENDEBUG001`)\r\n    - Parametri di default per demo, UAT, sandbox, DevOps\r\n    - Sempre logging su `PORTAL.STATS_EXECUTION_LOG`\r\n- **Gestione errori atomica:** TRY/CATCH, ROLLBACK su errore, transazione sempre chiusa\n\n---","size_chars":1075,"tokens_estimate":269}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"Riferimento agentico (breve)\r","anchor_slug":"riferimento-agentico-breve","chunk_index":3,"content":"### Riferimento agentico (breve)\n\nPer supportare la creazione automatizzata da agenti (LLM/tooling) di DDL/SP conformi agli standard EasyWay:\r\n- Linee guida agentiche: vedere `docs/agentic/AGENTIC_READINESS.md:1`\r\n- Template SQL pronti: `docs/agentic/templates/ddl/template_table.sql:1` e `docs/agentic/templates/sp/*.sql:1`\r\n- Esempi concreti (Users/Onboarding): `EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/agentic-readiness-and-examples.md:1`\n\nGli agenti devono usare template idempotenti (CREATE OR ALTER, IF NOT EXISTS), prevedere variante `_DEBUG`, e garantire logging su `PORTAL.STATS_EXECUTION_LOG` in ogni SP.\n\n---\n\nüö¶ **Roadmap Operativa Store Procedure EasyWay Data Portal**\r\n------------------------------------------------------------","size_chars":763,"tokens_estimate":191}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"1Ô∏è‚É£ **Regole fisse**\r","anchor_slug":"1-regole-fisse","chunk_index":4,"content":"### 1Ô∏è‚É£ **Regole fisse**\n\n*   Tutte le DML su tabelle principali si fanno **SOLO tramite store process**.\r\n    \r\n*   Ogni store process esegue **logging completo su `PORTAL.STATS_EXECUTION_LOG`** (e tabella TABLE_LOG se necessario).\r\n    \r\n*   **DEBUG**: ogni store ha sempre la sua versione di test (sequence e NDG separati).\r\n    \r\n*   La logica NDG (tenant/user) viene sempre generata dentro la store (mai lato API).\r\n    \r\n*   **Gestione atomica (TRY/CATCH + TRANSACTION)** sempre, rollback automatico su errore.\r\n    \r\n*   **`created_by` di default = nome SP** (o servizio/utente passato in input).\r\n    \n\n* * *","size_chars":616,"tokens_estimate":154}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"2Ô∏è‚É£ **Prossimi step e template**\r","anchor_slug":"2-prossimi-step-e-template","chunk_index":5,"content":"### 2Ô∏è‚É£ **Prossimi step e template**\n\nPer ogni tabella chiave di PORTAL (e analoghe in altri schema), fornir√≤:\r\n*   **Store di INSERT** (con NDG, auditing, logging)\r\n    \r\n*   **Store di UPDATE** (per scenari reali, aggiornamento sicuro e tracciato)\r\n    \r\n*   **Store di DELETE ‚Äúsafe‚Äù** (soft delete, flag, o logga tutto)\r\n    \r\n*   **Versione DEBUG per ogni store**\r\n    \r\n*   **Documentazione .md pronta per Wiki**\r\n    \n\n* * *","size_chars":430,"tokens_estimate":108}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"3Ô∏è‚É£ **Esempio template standard INSERT/UPDATE/DELETE**\r","anchor_slug":"3-esempio-template-standard-insertupdatedelete","chunk_index":6,"content":"### 3Ô∏è‚É£ **Esempio template standard INSERT/UPDATE/DELETE**\n\n(gi√† pronto per pipeline, API, batch, ecc.)\n\n#### **a) INSERT (Onboarding/Creazione)**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_[TABLE]     -- parametri tabella... AS BEGIN     SET NOCOUNT ON;     -- transazione, insert, auditing, logging END GO\r\n```sql\n\n#### **b) UPDATE**\n\n```sql \r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_[TABLE]     -- parametri... AS BEGIN     SET NOCOUNT ON;     -- transazione, update, auditing, logging END GO`\r\n```sql\r\n#### **c) DELETE / SOFT DELETE**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_[TABLE]     -- parametri... AS BEGIN     SET NOCOUNT ON;     -- transazione, soft delete (flag), logging END GO\r\n```sql\r\n#### **d) DEBUG**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_[TABLE] AS BEGIN     -- chiama insert con parametri demo/sandbox, usa sequence debug END GO`\r\n```sql\n\n* * *","size_chars":907,"tokens_estimate":227}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"4Ô∏è‚É£ **Automazione della documentazione**\r","anchor_slug":"4-automazione-della-documentazione","chunk_index":7,"content":"### 4Ô∏è‚É£ **Automazione della documentazione**\n\nTutte le SP saranno documentate in **Markdown** pronto per Azure DevOps.  \r\nLe sezioni per ogni store sono sempre:\n\n| Sezione | Contenuto |\r\n| --- | --- |\r\n| Scopo | Cosa fa la store |\r\n| Parametri | Elenco parametri e descrizione |\r\n| Logica Dati | Dettaglio di business (NDG, auditing, ecc.) |\r\n| Logging | Modalit√† di tracking e error handling |\r\n| Debug | Differenze rispetto alla produzione |\r\n| Esempi | Chiamata reale/test |\r\n| Versione | Data, autore, note AMS/DevOps |","size_chars":523,"tokens_estimate":131}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"**Template** ##\r","anchor_slug":"template","chunk_index":8,"content":"## **Template** ##","size_chars":18,"tokens_estimate":4}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":9,"content":"## Template standard EasyWay (produzione)\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_register_tenant_and_user\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @tenant_name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100),\r\n    @surname NVARCHAR(100),\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @rows_updated INT = 0, @rows_deleted INT = 0;\r\n    DECLARE @status NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\n\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\n\n        -- NDG tenant_id se mancante\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n            SET @tenant_id = 'TEN' + RIGHT('000000000' + CAST(@next_seq_tenant AS NVARCHAR), 9);\r\n        END\n\n        -- NDG user_id se mancante\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n            SET @user_id = 'CDI' + RIGHT('000000000' + CAST(@next_seq_user AS NVARCHAR), 9);\r\n        END\n\n        -- Tenant\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.TENANT (tenant_id, name, plan_code, created_by)\r\n            VALUES (@tenant_id, @tenant_name, @plan_code, COALESCE(@created_by, 'sp_register_tenant_and_user'));\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        -- Profilo admin se manca\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = 'TENANT_ADMIN')\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, created_by)\r\n            VALUES ('TENANT_ADMIN', 'Amministratore Tenant', COALESCE(@created_by, 'sp_register_tenant_and_user'));\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END","size_chars":2218,"tokens_estimate":554}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":10,"content":"        -- User admin\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (\r\n                user_id, tenant_id, email, name, surname, password,\r\n                provider, provider_user_id, profile_code, is_tenant_admin, created_by\r\n            )\r\n            VALUES (\r\n                @user_id, @tenant_id, @email, @name, @surname, @password,\r\n                @provider, @provider_user_id, 'TENANT_ADMIN', 1, COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n            );\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        -- Notifiche default\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS (\r\n                tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @user_id, 1, 1, 0, COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n            );\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status = 'ERROR';\r\n        SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    -- Logging obbligatorio\r\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, status, error_message,\r\n        start_time, end_time, duration_ms, affected_tables, operation_types, created_by\r\n    ) VALUES (\r\n        'sp_register_tenant_and_user', @tenant_id, @user_id, @rows_inserted, @rows_updated, @rows_deleted, @status, @error_message,\r\n        @start_time, SYSUTCDATETIME(), DATEDIFF(MILLISECOND, @start_time, SYSUTCDATETIME()),\r\n        'PORTAL.TENANT,PORTAL.PROFILE_DOMAINS,PORTAL.USERS,PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        'INSERT', COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n    );\r\nEND\r\n```sql","size_chars":2054,"tokens_estimate":514}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":11,"content":"3Ô∏è‚É£ Template DEBUG EasyWay\r\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_register_tenant_and_user\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @tenant_name NVARCHAR(255) = 'Demo Tenant Srl',\r\n    @plan_code NVARCHAR(50) = 'BRONZE',\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255) = 'debuguser+demo@easyway.it',\r\n    @name NVARCHAR(100) = 'Mario',\r\n    @surname NVARCHAR(100) = 'Debug',\r\n    @password NVARCHAR(255) = 'HASHED_PASSWORD',\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @created_by NVARCHAR(255) = 'sp_debug_register_tenant_and_user'\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    -- Come sopra, ma sequence di debug e NDG debug\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\n\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n            SET @tenant_id = 'TENDEBUG' + RIGHT('000' + CAST(@next_seq_tenant AS NVARCHAR), 3);\r\n        END\n\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n            SET @user_id = 'CDIDEBUG' + RIGHT('000' + CAST(@next_seq_user AS NVARCHAR), 3);\r\n        END\n\n        -- Logica identica alla store principale...\n\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, status, error_message,\r\n        start_time, end_time, duration_ms, affected_tables, operation_types, created_by\r\n    ) VALUES (\r\n        'sp_debug_register_tenant_and_user', @tenant_id, @user_id, 1, 0, 0, 'OK', NULL,\r\n        SYSUTCDATETIME(), SYSUTCDATETIME(), 0,\r\n        'PORTAL.TENANT,PORTAL.PROFILE_DOMAINS,PORTAL.USERS,PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        'INSERT', 'sp_debug_register_tenant_and_user'\r\n    );\r\nEND\n\n```sql\r\n4Ô∏è‚É£ Best practice operative\r\n---------------------------","size_chars":2109,"tokens_estimate":527}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":12,"content":"*   Tutte le SP usano sempre i parametri NDG e multi-tenant.\r\n    \r\n*   **Gestione logging/statistiche**: ogni esecuzione tracciata.\r\n    \r\n*   **Le versioni DEBUG** usano sempre ID e sequence separate, non ‚Äúsporcano‚Äù la produzione.\r\n    \r\n*   **Nessuna insert manuale** sulle tabelle principali: sempre via SP.\r\n    \r\n*   **Modello pronto per future automazioni (CI/CD, pipeline, audit AMS, etc)**.\r\n    \n\n* * *\n\n5Ô∏è‚É£ Esempio pratico di chiamata\r\n-------------------------------\n\n```sql\r\nEXEC PORTAL.sp_register_tenant_and_user\r\n    @tenant_name = 'Acme Srl',\r\n    @plan_code = 'BRONZE',\r\n    @email = 'admin@acme.it',\r\n    @name = 'Mario',\r\n    @surname = 'Rossi',\r\n    @password = 'HASHED_PASSWORD',\r\n    @created_by = 'API_GATEWAY';\n\n```sql\r\n```sql\r\nEXEC PORTAL.sp_debug_register_tenant_and_user\r\n    @tenant_name = 'Tenant Test',\r\n    @plan_code = 'DEBUG',\r\n    @email = 'debug@easyway.it',\r\n    @name = 'Debug',\r\n    @surname = 'User',\r\n    @password = 'DEBUG_HASH',\r\n    @created_by = 'DEBUG_TOOL';\r\n```sql\n\nüîí Ogni store process nuova/futura dovr√† sempre seguire queste linee guida.","size_chars":1089,"tokens_estimate":272}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":13,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":14,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":15,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  # EasyWay Data Portal ‚Äì STORE PROCEDURE: Linee Guida, Best Practice e Template\n\n> **Modello in uso:** Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG, ext_attributes, auditing, logging automatico).\n\n---","size_chars":341,"tokens_estimate":85}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"‚úÖ Scopo del documento\r","anchor_slug":"scopo-del-documento","chunk_index":16,"content":"## ‚úÖ Scopo del documento\n\nDefinire e standardizzare la **struttura, i pattern, e le best practice** delle store procedure (SP) per EasyWay Data Portal.  \r\nObiettivo: **nessun dato chiave inserito manualmente**, **tutto tracciato**, massima robustezza per AMS, DevOps, audit.\n\n---","size_chars":279,"tokens_estimate":70}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**Principi generali EasyWay per Store Process**\r","anchor_slug":"principi-generali-easyway-per-store-process","chunk_index":17,"content":"### **Principi generali EasyWay per Store Process**\n\n- **Tutto l‚Äôonboarding, le operazioni DML, e la logica applicativa passano sempre da store procedure.**\r\n- **Nessun insert/update diretto sulle tabelle anagrafiche e di business.**\r\n- **Ogni store procedure aggiorna sempre i campi di auditing (`created_by`, `created_at`, `updated_at`).**\r\n- **Tutte le SP devono scrivere SEMPRE un record su `PORTAL.STATS_EXECUTION_LOG`** con:\r\n    - nome procedura,\r\n    - tenant_id, user_id,\r\n    - righe inserite/aggiornate/cancellate,\r\n    - start_time, end_time, durata,\r\n    - status (`OK`/`ERROR`),\r\n    - error_message se presente,\r\n    - tabelle impattate, tipo operazione, chi ha eseguito.\r\n- **Ogni store procedure importante** (soprattutto quelle richiamate da API/servizi/portale) ha anche la versione `_DEBUG`:\r\n    - Usa sequence e codici di test (es. `TENDEBUG001`)\r\n    - Parametri di default per demo, UAT, sandbox, DevOps\r\n    - Sempre logging su `PORTAL.STATS_EXECUTION_LOG`\r\n- **Gestione errori atomica:** TRY/CATCH, ROLLBACK su errore, transazione sempre chiusa\n\n---\n\nüö¶ **Roadmap Operativa Store Procedure EasyWay Data Portal**\r\n------------------------------------------------------------","size_chars":1199,"tokens_estimate":300}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"1Ô∏è‚É£ **Regole fisse**\r","anchor_slug":"1-regole-fisse","chunk_index":18,"content":"### 1Ô∏è‚É£ **Regole fisse**\n\n*   Tutte le DML su tabelle principali si fanno **SOLO tramite store process**.\r\n    \r\n*   Ogni store process esegue **logging completo su `PORTAL.STATS_EXECUTION_LOG`** (e tabella TABLE_LOG se necessario).\r\n    \r\n*   **DEBUG**: ogni store ha sempre la sua versione di test (sequence e NDG separati).\r\n    \r\n*   La logica NDG (tenant/user) viene sempre generata dentro la store (mai lato API).\r\n    \r\n*   **Gestione atomica (TRY/CATCH + TRANSACTION)** sempre, rollback automatico su errore.\r\n    \r\n*   **`created_by` di default = nome SP** (o servizio/utente passato in input).\r\n    \n\n* * *","size_chars":616,"tokens_estimate":154}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"2Ô∏è‚É£ **Prossimi step e template**\r","anchor_slug":"2-prossimi-step-e-template","chunk_index":19,"content":"### 2Ô∏è‚É£ **Prossimi step e template**\n\nPer ogni tabella chiave di PORTAL (e analoghe in altri schema), fornir√≤:\r\n*   **Store di INSERT** (con NDG, auditing, logging)\r\n    \r\n*   **Store di UPDATE** (per scenari reali, aggiornamento sicuro e tracciato)\r\n    \r\n*   **Store di DELETE ‚Äúsafe‚Äù** (soft delete, flag, o logga tutto)\r\n    \r\n*   **Versione DEBUG per ogni store**\r\n    \r\n*   **Documentazione .md pronta per Wiki**\r\n    \n\n* * *","size_chars":430,"tokens_estimate":108}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"3Ô∏è‚É£ **Esempio template standard INSERT/UPDATE/DELETE**\r","anchor_slug":"3-esempio-template-standard-insertupdatedelete","chunk_index":20,"content":"### 3Ô∏è‚É£ **Esempio template standard INSERT/UPDATE/DELETE**\n\n(gi√† pronto per pipeline, API, batch, ecc.)\n\n#### **a) INSERT (Onboarding/Creazione)**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_[TABLE]     -- parametri tabella... AS BEGIN     SET NOCOUNT ON;     -- transazione, insert, auditing, logging END GO\r\n```sql\n\n#### **b) UPDATE**\n\n```sql \r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_[TABLE]     -- parametri... AS BEGIN     SET NOCOUNT ON;     -- transazione, update, auditing, logging END GO`\r\n```sql\r\n#### **c) DELETE / SOFT DELETE**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_[TABLE]     -- parametri... AS BEGIN     SET NOCOUNT ON;     -- transazione, soft delete (flag), logging END GO\r\n```sql\r\n#### **d) DEBUG**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_[TABLE] AS BEGIN     -- chiama insert con parametri demo/sandbox, usa sequence debug END GO`\r\n```sql\n\n* * *","size_chars":907,"tokens_estimate":227}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"4Ô∏è‚É£ **Automazione della documentazione**\r","anchor_slug":"4-automazione-della-documentazione","chunk_index":21,"content":"### 4Ô∏è‚É£ **Automazione della documentazione**\n\nTutte le SP saranno documentate in **Markdown** pronto per Azure DevOps.  \r\nLe sezioni per ogni store sono sempre:\n\n| Sezione | Contenuto |\r\n| --- | --- |\r\n| Scopo | Cosa fa la store |\r\n| Parametri | Elenco parametri e descrizione |\r\n| Logica Dati | Dettaglio di business (NDG, auditing, ecc.) |\r\n| Logging | Modalit√† di tracking e error handling |\r\n| Debug | Differenze rispetto alla produzione |\r\n| Esempi | Chiamata reale/test |\r\n| Versione | Data, autore, note AMS/DevOps |","size_chars":523,"tokens_estimate":131}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"**Template** ##\r","anchor_slug":"template","chunk_index":22,"content":"## **Template** ##","size_chars":18,"tokens_estimate":4}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":23,"content":"## Template standard EasyWay (produzione)\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_register_tenant_and_user\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @tenant_name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100),\r\n    @surname NVARCHAR(100),\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @rows_updated INT = 0, @rows_deleted INT = 0;\r\n    DECLARE @status NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\n\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\n\n        -- NDG tenant_id se mancante\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n            SET @tenant_id = 'TEN' + RIGHT('000000000' + CAST(@next_seq_tenant AS NVARCHAR), 9);\r\n        END\n\n        -- NDG user_id se mancante\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n            SET @user_id = 'CDI' + RIGHT('000000000' + CAST(@next_seq_user AS NVARCHAR), 9);\r\n        END\n\n        -- Tenant\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.TENANT (tenant_id, name, plan_code, created_by)\r\n            VALUES (@tenant_id, @tenant_name, @plan_code, COALESCE(@created_by, 'sp_register_tenant_and_user'));\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        -- Profilo admin se manca\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = 'TENANT_ADMIN')\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, created_by)\r\n            VALUES ('TENANT_ADMIN', 'Amministratore Tenant', COALESCE(@created_by, 'sp_register_tenant_and_user'));\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END","size_chars":2218,"tokens_estimate":554}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":24,"content":"        -- User admin\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (\r\n                user_id, tenant_id, email, name, surname, password,\r\n                provider, provider_user_id, profile_code, is_tenant_admin, created_by\r\n            )\r\n            VALUES (\r\n                @user_id, @tenant_id, @email, @name, @surname, @password,\r\n                @provider, @provider_user_id, 'TENANT_ADMIN', 1, COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n            );\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        -- Notifiche default\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS (\r\n                tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @user_id, 1, 1, 0, COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n            );\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status = 'ERROR';\r\n        SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    -- Logging obbligatorio\r\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, status, error_message,\r\n        start_time, end_time, duration_ms, affected_tables, operation_types, created_by\r\n    ) VALUES (\r\n        'sp_register_tenant_and_user', @tenant_id, @user_id, @rows_inserted, @rows_updated, @rows_deleted, @status, @error_message,\r\n        @start_time, SYSUTCDATETIME(), DATEDIFF(MILLISECOND, @start_time, SYSUTCDATETIME()),\r\n        'PORTAL.TENANT,PORTAL.PROFILE_DOMAINS,PORTAL.USERS,PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        'INSERT', COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n    );\r\nEND\r\n```sql","size_chars":2054,"tokens_estimate":514}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":25,"content":"3Ô∏è‚É£ Template DEBUG EasyWay\r\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_register_tenant_and_user\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @tenant_name NVARCHAR(255) = 'Demo Tenant Srl',\r\n    @plan_code NVARCHAR(50) = 'BRONZE',\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255) = 'debuguser+demo@easyway.it',\r\n    @name NVARCHAR(100) = 'Mario',\r\n    @surname NVARCHAR(100) = 'Debug',\r\n    @password NVARCHAR(255) = 'HASHED_PASSWORD',\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @created_by NVARCHAR(255) = 'sp_debug_register_tenant_and_user'\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    -- Come sopra, ma sequence di debug e NDG debug\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\n\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n            SET @tenant_id = 'TENDEBUG' + RIGHT('000' + CAST(@next_seq_tenant AS NVARCHAR), 3);\r\n        END\n\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n            SET @user_id = 'CDIDEBUG' + RIGHT('000' + CAST(@next_seq_user AS NVARCHAR), 3);\r\n        END\n\n        -- Logica identica alla store principale...\n\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, status, error_message,\r\n        start_time, end_time, duration_ms, affected_tables, operation_types, created_by\r\n    ) VALUES (\r\n        'sp_debug_register_tenant_and_user', @tenant_id, @user_id, 1, 0, 0, 'OK', NULL,\r\n        SYSUTCDATETIME(), SYSUTCDATETIME(), 0,\r\n        'PORTAL.TENANT,PORTAL.PROFILE_DOMAINS,PORTAL.USERS,PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        'INSERT', 'sp_debug_register_tenant_and_user'\r\n    );\r\nEND\n\n```sql\r\n4Ô∏è‚É£ Best practice operative\r\n---------------------------","size_chars":2109,"tokens_estimate":527}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":26,"content":"*   Tutte le SP usano sempre i parametri NDG e multi-tenant.\r\n    \r\n*   **Gestione logging/statistiche**: ogni esecuzione tracciata.\r\n    \r\n*   **Le versioni DEBUG** usano sempre ID e sequence separate, non ‚Äúsporcano‚Äù la produzione.\r\n    \r\n*   **Nessuna insert manuale** sulle tabelle principali: sempre via SP.\r\n    \r\n*   **Modello pronto per future automazioni (CI/CD, pipeline, audit AMS, etc)**.\r\n    \n\n* * *\n\n5Ô∏è‚É£ Esempio pratico di chiamata\r\n-------------------------------\n\n```sql\r\nEXEC PORTAL.sp_register_tenant_and_user\r\n    @tenant_name = 'Acme Srl',\r\n    @plan_code = 'BRONZE',\r\n    @email = 'admin@acme.it',\r\n    @name = 'Mario',\r\n    @surname = 'Rossi',\r\n    @password = 'HASHED_PASSWORD',\r\n    @created_by = 'API_GATEWAY';\n\n```sql\r\n```sql\r\nEXEC PORTAL.sp_debug_register_tenant_and_user\r\n    @tenant_name = 'Tenant Test',\r\n    @plan_code = 'DEBUG',\r\n    @email = 'debug@easyway.it',\r\n    @name = 'Debug',\r\n    @surname = 'User',\r\n    @password = 'DEBUG_HASH',\r\n    @created_by = 'DEBUG_TOOL';\r\n```sql\n\nüîí Ogni store process nuova/futura dovr√† sempre seguire queste linee guida.","size_chars":1089,"tokens_estimate":272}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":27,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":28,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section # EasyWay Data Portal ‚Äì STORE PROCEDURE: Linee Guida, Best Practice e Template\n\n> **Modello in uso:** Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG, ext_attributes, auditing, logging automatico).\n\n---","size_chars":291,"tokens_estimate":73}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"‚úÖ Scopo del documento\r","anchor_slug":"scopo-del-documento","chunk_index":29,"content":"## ‚úÖ Scopo del documento\n\nDefinire e standardizzare la **struttura, i pattern, e le best practice** delle store procedure (SP) per EasyWay Data Portal.  \r\nObiettivo: **nessun dato chiave inserito manualmente**, **tutto tracciato**, massima robustezza per AMS, DevOps, audit.\n\n---","size_chars":279,"tokens_estimate":70}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**Principi generali EasyWay per Store Process**\r","anchor_slug":"principi-generali-easyway-per-store-process","chunk_index":30,"content":"### **Principi generali EasyWay per Store Process**\n\n- **Tutto l‚Äôonboarding, le operazioni DML, e la logica applicativa passano sempre da store procedure.**\r\n- **Nessun insert/update diretto sulle tabelle anagrafiche e di business.**\r\n- **Ogni store procedure aggiorna sempre i campi di auditing (`created_by`, `created_at`, `updated_at`).**\r\n- **Tutte le SP devono scrivere SEMPRE un record su `PORTAL.STATS_EXECUTION_LOG`** con:\r\n    - nome procedura,\r\n    - tenant_id, user_id,\r\n    - righe inserite/aggiornate/cancellate,\r\n    - start_time, end_time, durata,\r\n    - status (`OK`/`ERROR`),\r\n    - error_message se presente,\r\n    - tabelle impattate, tipo operazione, chi ha eseguito.\r\n- **Ogni store procedure importante** (soprattutto quelle richiamate da API/servizi/portale) ha anche la versione `_DEBUG`:\r\n    - Usa sequence e codici di test (es. `TENDEBUG001`)\r\n    - Parametri di default per demo, UAT, sandbox, DevOps\r\n    - Sempre logging su `PORTAL.STATS_EXECUTION_LOG`\r\n- **Gestione errori atomica:** TRY/CATCH, ROLLBACK su errore, transazione sempre chiusa\n\n---\n\nüö¶ **Roadmap Operativa Store Procedure EasyWay Data Portal**\r\n------------------------------------------------------------","size_chars":1199,"tokens_estimate":300}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"1Ô∏è‚É£ **Regole fisse**\r","anchor_slug":"1-regole-fisse","chunk_index":31,"content":"### 1Ô∏è‚É£ **Regole fisse**\n\n*   Tutte le DML su tabelle principali si fanno **SOLO tramite store process**.\r\n    \r\n*   Ogni store process esegue **logging completo su `PORTAL.STATS_EXECUTION_LOG`** (e tabella TABLE_LOG se necessario).\r\n    \r\n*   **DEBUG**: ogni store ha sempre la sua versione di test (sequence e NDG separati).\r\n    \r\n*   La logica NDG (tenant/user) viene sempre generata dentro la store (mai lato API).\r\n    \r\n*   **Gestione atomica (TRY/CATCH + TRANSACTION)** sempre, rollback automatico su errore.\r\n    \r\n*   **`created_by` di default = nome SP** (o servizio/utente passato in input).\r\n    \n\n* * *","size_chars":616,"tokens_estimate":154}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"2Ô∏è‚É£ **Prossimi step e template**\r","anchor_slug":"2-prossimi-step-e-template","chunk_index":32,"content":"### 2Ô∏è‚É£ **Prossimi step e template**\n\nPer ogni tabella chiave di PORTAL (e analoghe in altri schema), fornir√≤:\r\n*   **Store di INSERT** (con NDG, auditing, logging)\r\n    \r\n*   **Store di UPDATE** (per scenari reali, aggiornamento sicuro e tracciato)\r\n    \r\n*   **Store di DELETE ‚Äúsafe‚Äù** (soft delete, flag, o logga tutto)\r\n    \r\n*   **Versione DEBUG per ogni store**\r\n    \r\n*   **Documentazione .md pronta per Wiki**\r\n    \n\n* * *","size_chars":430,"tokens_estimate":108}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"3Ô∏è‚É£ **Esempio template standard INSERT/UPDATE/DELETE**\r","anchor_slug":"3-esempio-template-standard-insertupdatedelete","chunk_index":33,"content":"### 3Ô∏è‚É£ **Esempio template standard INSERT/UPDATE/DELETE**\n\n(gi√† pronto per pipeline, API, batch, ecc.)\n\n#### **a) INSERT (Onboarding/Creazione)**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_[TABLE]     -- parametri tabella... AS BEGIN     SET NOCOUNT ON;     -- transazione, insert, auditing, logging END GO\r\n```sql\n\n#### **b) UPDATE**\n\n```sql \r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_[TABLE]     -- parametri... AS BEGIN     SET NOCOUNT ON;     -- transazione, update, auditing, logging END GO`\r\n```sql\r\n#### **c) DELETE / SOFT DELETE**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_[TABLE]     -- parametri... AS BEGIN     SET NOCOUNT ON;     -- transazione, soft delete (flag), logging END GO\r\n```sql\r\n#### **d) DEBUG**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_[TABLE] AS BEGIN     -- chiama insert con parametri demo/sandbox, usa sequence debug END GO`\r\n```sql\n\n* * *","size_chars":907,"tokens_estimate":227}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"4Ô∏è‚É£ **Automazione della documentazione**\r","anchor_slug":"4-automazione-della-documentazione","chunk_index":34,"content":"### 4Ô∏è‚É£ **Automazione della documentazione**\n\nTutte le SP saranno documentate in **Markdown** pronto per Azure DevOps.  \r\nLe sezioni per ogni store sono sempre:\n\n| Sezione | Contenuto |\r\n| --- | --- |\r\n| Scopo | Cosa fa la store |\r\n| Parametri | Elenco parametri e descrizione |\r\n| Logica Dati | Dettaglio di business (NDG, auditing, ecc.) |\r\n| Logging | Modalit√† di tracking e error handling |\r\n| Debug | Differenze rispetto alla produzione |\r\n| Esempi | Chiamata reale/test |\r\n| Versione | Data, autore, note AMS/DevOps |","size_chars":523,"tokens_estimate":131}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"**Template** ##\r","anchor_slug":"template","chunk_index":35,"content":"## **Template** ##","size_chars":18,"tokens_estimate":4}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":36,"content":"## Template standard EasyWay (produzione)\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_register_tenant_and_user\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @tenant_name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100),\r\n    @surname NVARCHAR(100),\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @rows_updated INT = 0, @rows_deleted INT = 0;\r\n    DECLARE @status NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\n\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\n\n        -- NDG tenant_id se mancante\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n            SET @tenant_id = 'TEN' + RIGHT('000000000' + CAST(@next_seq_tenant AS NVARCHAR), 9);\r\n        END\n\n        -- NDG user_id se mancante\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n            SET @user_id = 'CDI' + RIGHT('000000000' + CAST(@next_seq_user AS NVARCHAR), 9);\r\n        END\n\n        -- Tenant\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.TENANT (tenant_id, name, plan_code, created_by)\r\n            VALUES (@tenant_id, @tenant_name, @plan_code, COALESCE(@created_by, 'sp_register_tenant_and_user'));\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        -- Profilo admin se manca\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = 'TENANT_ADMIN')\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, created_by)\r\n            VALUES ('TENANT_ADMIN', 'Amministratore Tenant', COALESCE(@created_by, 'sp_register_tenant_and_user'));\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END","size_chars":2218,"tokens_estimate":554}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":37,"content":"        -- User admin\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (\r\n                user_id, tenant_id, email, name, surname, password,\r\n                provider, provider_user_id, profile_code, is_tenant_admin, created_by\r\n            )\r\n            VALUES (\r\n                @user_id, @tenant_id, @email, @name, @surname, @password,\r\n                @provider, @provider_user_id, 'TENANT_ADMIN', 1, COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n            );\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        -- Notifiche default\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS (\r\n                tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @user_id, 1, 1, 0, COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n            );\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status = 'ERROR';\r\n        SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    -- Logging obbligatorio\r\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, status, error_message,\r\n        start_time, end_time, duration_ms, affected_tables, operation_types, created_by\r\n    ) VALUES (\r\n        'sp_register_tenant_and_user', @tenant_id, @user_id, @rows_inserted, @rows_updated, @rows_deleted, @status, @error_message,\r\n        @start_time, SYSUTCDATETIME(), DATEDIFF(MILLISECOND, @start_time, SYSUTCDATETIME()),\r\n        'PORTAL.TENANT,PORTAL.PROFILE_DOMAINS,PORTAL.USERS,PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        'INSERT', COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n    );\r\nEND\r\n```sql","size_chars":2054,"tokens_estimate":514}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":38,"content":"3Ô∏è‚É£ Template DEBUG EasyWay\r\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_register_tenant_and_user\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @tenant_name NVARCHAR(255) = 'Demo Tenant Srl',\r\n    @plan_code NVARCHAR(50) = 'BRONZE',\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255) = 'debuguser+demo@easyway.it',\r\n    @name NVARCHAR(100) = 'Mario',\r\n    @surname NVARCHAR(100) = 'Debug',\r\n    @password NVARCHAR(255) = 'HASHED_PASSWORD',\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @created_by NVARCHAR(255) = 'sp_debug_register_tenant_and_user'\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    -- Come sopra, ma sequence di debug e NDG debug\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\n\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n            SET @tenant_id = 'TENDEBUG' + RIGHT('000' + CAST(@next_seq_tenant AS NVARCHAR), 3);\r\n        END\n\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n            SET @user_id = 'CDIDEBUG' + RIGHT('000' + CAST(@next_seq_user AS NVARCHAR), 3);\r\n        END\n\n        -- Logica identica alla store principale...\n\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, status, error_message,\r\n        start_time, end_time, duration_ms, affected_tables, operation_types, created_by\r\n    ) VALUES (\r\n        'sp_debug_register_tenant_and_user', @tenant_id, @user_id, 1, 0, 0, 'OK', NULL,\r\n        SYSUTCDATETIME(), SYSUTCDATETIME(), 0,\r\n        'PORTAL.TENANT,PORTAL.PROFILE_DOMAINS,PORTAL.USERS,PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        'INSERT', 'sp_debug_register_tenant_and_user'\r\n    );\r\nEND\n\n```sql\r\n4Ô∏è‚É£ Best practice operative\r\n---------------------------","size_chars":2109,"tokens_estimate":527}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":39,"content":"*   Tutte le SP usano sempre i parametri NDG e multi-tenant.\r\n    \r\n*   **Gestione logging/statistiche**: ogni esecuzione tracciata.\r\n    \r\n*   **Le versioni DEBUG** usano sempre ID e sequence separate, non ‚Äúsporcano‚Äù la produzione.\r\n    \r\n*   **Nessuna insert manuale** sulle tabelle principali: sempre via SP.\r\n    \r\n*   **Modello pronto per future automazioni (CI/CD, pipeline, audit AMS, etc)**.\r\n    \n\n* * *\n\n5Ô∏è‚É£ Esempio pratico di chiamata\r\n-------------------------------\n\n```sql\r\nEXEC PORTAL.sp_register_tenant_and_user\r\n    @tenant_name = 'Acme Srl',\r\n    @plan_code = 'BRONZE',\r\n    @email = 'admin@acme.it',\r\n    @name = 'Mario',\r\n    @surname = 'Rossi',\r\n    @password = 'HASHED_PASSWORD',\r\n    @created_by = 'API_GATEWAY';\n\n```sql\r\n```sql\r\nEXEC PORTAL.sp_debug_register_tenant_and_user\r\n    @tenant_name = 'Tenant Test',\r\n    @plan_code = 'DEBUG',\r\n    @email = 'debug@easyway.it',\r\n    @name = 'Debug',\r\n    @surname = 'User',\r\n    @password = 'DEBUG_HASH',\r\n    @created_by = 'DEBUG_TOOL';\r\n```sql\n\nüîí Ogni store process nuova/futura dovr√† sempre seguire queste linee guida.","size_chars":1089,"tokens_estimate":272}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":40,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":41,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->","size_chars":125,"tokens_estimate":31}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":42,"content":"## Esempi Query\r\n`sql\r\n-- SELECT ... FROM ...\r\n`\r\n\"@\r\n  # EasyWay Data Portal ‚Äì STORE PROCEDURE: Linee Guida, Best Practice e Template\n\n> **Modello in uso:** Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG, ext_attributes, auditing, logging automatico).\n\n---","size_chars":273,"tokens_estimate":68}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"‚úÖ Scopo del documento\r","anchor_slug":"scopo-del-documento","chunk_index":43,"content":"## ‚úÖ Scopo del documento\n\nDefinire e standardizzare la **struttura, i pattern, e le best practice** delle store procedure (SP) per EasyWay Data Portal.  \r\nObiettivo: **nessun dato chiave inserito manualmente**, **tutto tracciato**, massima robustezza per AMS, DevOps, audit.\n\n---","size_chars":279,"tokens_estimate":70}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**Principi generali EasyWay per Store Process**\r","anchor_slug":"principi-generali-easyway-per-store-process","chunk_index":44,"content":"### **Principi generali EasyWay per Store Process**\n\n- **Tutto l‚Äôonboarding, le operazioni DML, e la logica applicativa passano sempre da store procedure.**\r\n- **Nessun insert/update diretto sulle tabelle anagrafiche e di business.**\r\n- **Ogni store procedure aggiorna sempre i campi di auditing (`created_by`, `created_at`, `updated_at`).**\r\n- **Tutte le SP devono scrivere SEMPRE un record su `PORTAL.STATS_EXECUTION_LOG`** con:\r\n    - nome procedura,\r\n    - tenant_id, user_id,\r\n    - righe inserite/aggiornate/cancellate,\r\n    - start_time, end_time, durata,\r\n    - status (`OK`/`ERROR`),\r\n    - error_message se presente,\r\n    - tabelle impattate, tipo operazione, chi ha eseguito.\r\n- **Ogni store procedure importante** (soprattutto quelle richiamate da API/servizi/portale) ha anche la versione `_DEBUG`:\r\n    - Usa sequence e codici di test (es. `TENDEBUG001`)\r\n    - Parametri di default per demo, UAT, sandbox, DevOps\r\n    - Sempre logging su `PORTAL.STATS_EXECUTION_LOG`\r\n- **Gestione errori atomica:** TRY/CATCH, ROLLBACK su errore, transazione sempre chiusa\n\n---\n\nüö¶ **Roadmap Operativa Store Procedure EasyWay Data Portal**\r\n------------------------------------------------------------","size_chars":1199,"tokens_estimate":300}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"1Ô∏è‚É£ **Regole fisse**\r","anchor_slug":"1-regole-fisse","chunk_index":45,"content":"### 1Ô∏è‚É£ **Regole fisse**\n\n*   Tutte le DML su tabelle principali si fanno **SOLO tramite store process**.\r\n    \r\n*   Ogni store process esegue **logging completo su `PORTAL.STATS_EXECUTION_LOG`** (e tabella TABLE_LOG se necessario).\r\n    \r\n*   **DEBUG**: ogni store ha sempre la sua versione di test (sequence e NDG separati).\r\n    \r\n*   La logica NDG (tenant/user) viene sempre generata dentro la store (mai lato API).\r\n    \r\n*   **Gestione atomica (TRY/CATCH + TRANSACTION)** sempre, rollback automatico su errore.\r\n    \r\n*   **`created_by` di default = nome SP** (o servizio/utente passato in input).\r\n    \n\n* * *","size_chars":616,"tokens_estimate":154}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"2Ô∏è‚É£ **Prossimi step e template**\r","anchor_slug":"2-prossimi-step-e-template","chunk_index":46,"content":"### 2Ô∏è‚É£ **Prossimi step e template**\n\nPer ogni tabella chiave di PORTAL (e analoghe in altri schema), fornir√≤:\r\n*   **Store di INSERT** (con NDG, auditing, logging)\r\n    \r\n*   **Store di UPDATE** (per scenari reali, aggiornamento sicuro e tracciato)\r\n    \r\n*   **Store di DELETE ‚Äúsafe‚Äù** (soft delete, flag, o logga tutto)\r\n    \r\n*   **Versione DEBUG per ogni store**\r\n    \r\n*   **Documentazione .md pronta per Wiki**\r\n    \n\n* * *","size_chars":430,"tokens_estimate":108}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"3Ô∏è‚É£ **Esempio template standard INSERT/UPDATE/DELETE**\r","anchor_slug":"3-esempio-template-standard-insertupdatedelete","chunk_index":47,"content":"### 3Ô∏è‚É£ **Esempio template standard INSERT/UPDATE/DELETE**\n\n(gi√† pronto per pipeline, API, batch, ecc.)\n\n#### **a) INSERT (Onboarding/Creazione)**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_[TABLE]     -- parametri tabella... AS BEGIN     SET NOCOUNT ON;     -- transazione, insert, auditing, logging END GO\r\n```sql\n\n#### **b) UPDATE**\n\n```sql \r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_[TABLE]     -- parametri... AS BEGIN     SET NOCOUNT ON;     -- transazione, update, auditing, logging END GO`\r\n```sql\r\n#### **c) DELETE / SOFT DELETE**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_[TABLE]     -- parametri... AS BEGIN     SET NOCOUNT ON;     -- transazione, soft delete (flag), logging END GO\r\n```sql\r\n#### **d) DEBUG**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_[TABLE] AS BEGIN     -- chiama insert con parametri demo/sandbox, usa sequence debug END GO`\r\n```sql\n\n* * *","size_chars":907,"tokens_estimate":227}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"4Ô∏è‚É£ **Automazione della documentazione**\r","anchor_slug":"4-automazione-della-documentazione","chunk_index":48,"content":"### 4Ô∏è‚É£ **Automazione della documentazione**\n\nTutte le SP saranno documentate in **Markdown** pronto per Azure DevOps.  \r\nLe sezioni per ogni store sono sempre:\n\n| Sezione | Contenuto |\r\n| --- | --- |\r\n| Scopo | Cosa fa la store |\r\n| Parametri | Elenco parametri e descrizione |\r\n| Logica Dati | Dettaglio di business (NDG, auditing, ecc.) |\r\n| Logging | Modalit√† di tracking e error handling |\r\n| Debug | Differenze rispetto alla produzione |\r\n| Esempi | Chiamata reale/test |\r\n| Versione | Data, autore, note AMS/DevOps |","size_chars":523,"tokens_estimate":131}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"**Template** ##\r","anchor_slug":"template","chunk_index":49,"content":"## **Template** ##","size_chars":18,"tokens_estimate":4}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":50,"content":"## Template standard EasyWay (produzione)\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_register_tenant_and_user\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @tenant_name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100),\r\n    @surname NVARCHAR(100),\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @rows_updated INT = 0, @rows_deleted INT = 0;\r\n    DECLARE @status NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\n\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\n\n        -- NDG tenant_id se mancante\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n            SET @tenant_id = 'TEN' + RIGHT('000000000' + CAST(@next_seq_tenant AS NVARCHAR), 9);\r\n        END\n\n        -- NDG user_id se mancante\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n            SET @user_id = 'CDI' + RIGHT('000000000' + CAST(@next_seq_user AS NVARCHAR), 9);\r\n        END\n\n        -- Tenant\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.TENANT (tenant_id, name, plan_code, created_by)\r\n            VALUES (@tenant_id, @tenant_name, @plan_code, COALESCE(@created_by, 'sp_register_tenant_and_user'));\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        -- Profilo admin se manca\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = 'TENANT_ADMIN')\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, created_by)\r\n            VALUES ('TENANT_ADMIN', 'Amministratore Tenant', COALESCE(@created_by, 'sp_register_tenant_and_user'));\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END","size_chars":2218,"tokens_estimate":554}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":51,"content":"        -- User admin\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (\r\n                user_id, tenant_id, email, name, surname, password,\r\n                provider, provider_user_id, profile_code, is_tenant_admin, created_by\r\n            )\r\n            VALUES (\r\n                @user_id, @tenant_id, @email, @name, @surname, @password,\r\n                @provider, @provider_user_id, 'TENANT_ADMIN', 1, COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n            );\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        -- Notifiche default\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS (\r\n                tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @user_id, 1, 1, 0, COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n            );\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status = 'ERROR';\r\n        SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    -- Logging obbligatorio\r\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, status, error_message,\r\n        start_time, end_time, duration_ms, affected_tables, operation_types, created_by\r\n    ) VALUES (\r\n        'sp_register_tenant_and_user', @tenant_id, @user_id, @rows_inserted, @rows_updated, @rows_deleted, @status, @error_message,\r\n        @start_time, SYSUTCDATETIME(), DATEDIFF(MILLISECOND, @start_time, SYSUTCDATETIME()),\r\n        'PORTAL.TENANT,PORTAL.PROFILE_DOMAINS,PORTAL.USERS,PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        'INSERT', COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n    );\r\nEND\r\n```sql","size_chars":2054,"tokens_estimate":514}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":52,"content":"3Ô∏è‚É£ Template DEBUG EasyWay\r\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_register_tenant_and_user\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @tenant_name NVARCHAR(255) = 'Demo Tenant Srl',\r\n    @plan_code NVARCHAR(50) = 'BRONZE',\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255) = 'debuguser+demo@easyway.it',\r\n    @name NVARCHAR(100) = 'Mario',\r\n    @surname NVARCHAR(100) = 'Debug',\r\n    @password NVARCHAR(255) = 'HASHED_PASSWORD',\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @created_by NVARCHAR(255) = 'sp_debug_register_tenant_and_user'\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    -- Come sopra, ma sequence di debug e NDG debug\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\n\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n            SET @tenant_id = 'TENDEBUG' + RIGHT('000' + CAST(@next_seq_tenant AS NVARCHAR), 3);\r\n        END\n\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n            SET @user_id = 'CDIDEBUG' + RIGHT('000' + CAST(@next_seq_user AS NVARCHAR), 3);\r\n        END\n\n        -- Logica identica alla store principale...\n\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, status, error_message,\r\n        start_time, end_time, duration_ms, affected_tables, operation_types, created_by\r\n    ) VALUES (\r\n        'sp_debug_register_tenant_and_user', @tenant_id, @user_id, 1, 0, 0, 'OK', NULL,\r\n        SYSUTCDATETIME(), SYSUTCDATETIME(), 0,\r\n        'PORTAL.TENANT,PORTAL.PROFILE_DOMAINS,PORTAL.USERS,PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        'INSERT', 'sp_debug_register_tenant_and_user'\r\n    );\r\nEND\n\n```sql\r\n4Ô∏è‚É£ Best practice operative\r\n---------------------------","size_chars":2109,"tokens_estimate":527}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":53,"content":"*   Tutte le SP usano sempre i parametri NDG e multi-tenant.\r\n    \r\n*   **Gestione logging/statistiche**: ogni esecuzione tracciata.\r\n    \r\n*   **Le versioni DEBUG** usano sempre ID e sequence separate, non ‚Äúsporcano‚Äù la produzione.\r\n    \r\n*   **Nessuna insert manuale** sulle tabelle principali: sempre via SP.\r\n    \r\n*   **Modello pronto per future automazioni (CI/CD, pipeline, audit AMS, etc)**.\r\n    \n\n* * *\n\n5Ô∏è‚É£ Esempio pratico di chiamata\r\n-------------------------------\n\n```sql\r\nEXEC PORTAL.sp_register_tenant_and_user\r\n    @tenant_name = 'Acme Srl',\r\n    @plan_code = 'BRONZE',\r\n    @email = 'admin@acme.it',\r\n    @name = 'Mario',\r\n    @surname = 'Rossi',\r\n    @password = 'HASHED_PASSWORD',\r\n    @created_by = 'API_GATEWAY';\n\n```sql\r\n```sql\r\nEXEC PORTAL.sp_debug_register_tenant_and_user\r\n    @tenant_name = 'Tenant Test',\r\n    @plan_code = 'DEBUG',\r\n    @email = 'debug@easyway.it',\r\n    @name = 'Debug',\r\n    @surname = 'User',\r\n    @password = 'DEBUG_HASH',\r\n    @created_by = 'DEBUG_TOOL';\r\n```sql\n\nüîí Ogni store process nuova/futura dovr√† sempre seguire queste linee guida.","size_chars":1089,"tokens_estimate":272}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":54,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":55,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":56,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  # EasyWay Data Portal ‚Äì STORE PROCEDURE: Linee Guida, Best Practice e Template\n\n> **Modello in uso:** Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG, ext_attributes, auditing, logging automatico).\n\n---","size_chars":341,"tokens_estimate":85}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"‚úÖ Scopo del documento\r","anchor_slug":"scopo-del-documento","chunk_index":57,"content":"## ‚úÖ Scopo del documento\n\nDefinire e standardizzare la **struttura, i pattern, e le best practice** delle store procedure (SP) per EasyWay Data Portal.  \r\nObiettivo: **nessun dato chiave inserito manualmente**, **tutto tracciato**, massima robustezza per AMS, DevOps, audit.\n\n---","size_chars":279,"tokens_estimate":70}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**Principi generali EasyWay per Store Process**\r","anchor_slug":"principi-generali-easyway-per-store-process","chunk_index":58,"content":"### **Principi generali EasyWay per Store Process**\n\n- **Tutto l‚Äôonboarding, le operazioni DML, e la logica applicativa passano sempre da store procedure.**\r\n- **Nessun insert/update diretto sulle tabelle anagrafiche e di business.**\r\n- **Ogni store procedure aggiorna sempre i campi di auditing (`created_by`, `created_at`, `updated_at`).**\r\n- **Tutte le SP devono scrivere SEMPRE un record su `PORTAL.STATS_EXECUTION_LOG`** con:\r\n    - nome procedura,\r\n    - tenant_id, user_id,\r\n    - righe inserite/aggiornate/cancellate,\r\n    - start_time, end_time, durata,\r\n    - status (`OK`/`ERROR`),\r\n    - error_message se presente,\r\n    - tabelle impattate, tipo operazione, chi ha eseguito.\r\n- **Ogni store procedure importante** (soprattutto quelle richiamate da API/servizi/portale) ha anche la versione `_DEBUG`:\r\n    - Usa sequence e codici di test (es. `TENDEBUG001`)\r\n    - Parametri di default per demo, UAT, sandbox, DevOps\r\n    - Sempre logging su `PORTAL.STATS_EXECUTION_LOG`\r\n- **Gestione errori atomica:** TRY/CATCH, ROLLBACK su errore, transazione sempre chiusa\n\n---\n\nüö¶ **Roadmap Operativa Store Procedure EasyWay Data Portal**\r\n------------------------------------------------------------","size_chars":1199,"tokens_estimate":300}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"1Ô∏è‚É£ **Regole fisse**\r","anchor_slug":"1-regole-fisse","chunk_index":59,"content":"### 1Ô∏è‚É£ **Regole fisse**\n\n*   Tutte le DML su tabelle principali si fanno **SOLO tramite store process**.\r\n    \r\n*   Ogni store process esegue **logging completo su `PORTAL.STATS_EXECUTION_LOG`** (e tabella TABLE_LOG se necessario).\r\n    \r\n*   **DEBUG**: ogni store ha sempre la sua versione di test (sequence e NDG separati).\r\n    \r\n*   La logica NDG (tenant/user) viene sempre generata dentro la store (mai lato API).\r\n    \r\n*   **Gestione atomica (TRY/CATCH + TRANSACTION)** sempre, rollback automatico su errore.\r\n    \r\n*   **`created_by` di default = nome SP** (o servizio/utente passato in input).\r\n    \n\n* * *","size_chars":616,"tokens_estimate":154}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"2Ô∏è‚É£ **Prossimi step e template**\r","anchor_slug":"2-prossimi-step-e-template","chunk_index":60,"content":"### 2Ô∏è‚É£ **Prossimi step e template**\n\nPer ogni tabella chiave di PORTAL (e analoghe in altri schema), fornir√≤:\r\n*   **Store di INSERT** (con NDG, auditing, logging)\r\n    \r\n*   **Store di UPDATE** (per scenari reali, aggiornamento sicuro e tracciato)\r\n    \r\n*   **Store di DELETE ‚Äúsafe‚Äù** (soft delete, flag, o logga tutto)\r\n    \r\n*   **Versione DEBUG per ogni store**\r\n    \r\n*   **Documentazione .md pronta per Wiki**\r\n    \n\n* * *","size_chars":430,"tokens_estimate":108}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"3Ô∏è‚É£ **Esempio template standard INSERT/UPDATE/DELETE**\r","anchor_slug":"3-esempio-template-standard-insertupdatedelete","chunk_index":61,"content":"### 3Ô∏è‚É£ **Esempio template standard INSERT/UPDATE/DELETE**\n\n(gi√† pronto per pipeline, API, batch, ecc.)\n\n#### **a) INSERT (Onboarding/Creazione)**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_[TABLE]     -- parametri tabella... AS BEGIN     SET NOCOUNT ON;     -- transazione, insert, auditing, logging END GO\r\n```sql\n\n#### **b) UPDATE**\n\n```sql \r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_[TABLE]     -- parametri... AS BEGIN     SET NOCOUNT ON;     -- transazione, update, auditing, logging END GO`\r\n```sql\r\n#### **c) DELETE / SOFT DELETE**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_[TABLE]     -- parametri... AS BEGIN     SET NOCOUNT ON;     -- transazione, soft delete (flag), logging END GO\r\n```sql\r\n#### **d) DEBUG**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_[TABLE] AS BEGIN     -- chiama insert con parametri demo/sandbox, usa sequence debug END GO`\r\n```sql\n\n* * *","size_chars":907,"tokens_estimate":227}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"4Ô∏è‚É£ **Automazione della documentazione**\r","anchor_slug":"4-automazione-della-documentazione","chunk_index":62,"content":"### 4Ô∏è‚É£ **Automazione della documentazione**\n\nTutte le SP saranno documentate in **Markdown** pronto per Azure DevOps.  \r\nLe sezioni per ogni store sono sempre:\n\n| Sezione | Contenuto |\r\n| --- | --- |\r\n| Scopo | Cosa fa la store |\r\n| Parametri | Elenco parametri e descrizione |\r\n| Logica Dati | Dettaglio di business (NDG, auditing, ecc.) |\r\n| Logging | Modalit√† di tracking e error handling |\r\n| Debug | Differenze rispetto alla produzione |\r\n| Esempi | Chiamata reale/test |\r\n| Versione | Data, autore, note AMS/DevOps |","size_chars":523,"tokens_estimate":131}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"**Template** ##\r","anchor_slug":"template","chunk_index":63,"content":"## **Template** ##","size_chars":18,"tokens_estimate":4}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":64,"content":"## Template standard EasyWay (produzione)\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_register_tenant_and_user\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @tenant_name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100),\r\n    @surname NVARCHAR(100),\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @rows_updated INT = 0, @rows_deleted INT = 0;\r\n    DECLARE @status NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\n\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\n\n        -- NDG tenant_id se mancante\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n            SET @tenant_id = 'TEN' + RIGHT('000000000' + CAST(@next_seq_tenant AS NVARCHAR), 9);\r\n        END\n\n        -- NDG user_id se mancante\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n            SET @user_id = 'CDI' + RIGHT('000000000' + CAST(@next_seq_user AS NVARCHAR), 9);\r\n        END\n\n        -- Tenant\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.TENANT (tenant_id, name, plan_code, created_by)\r\n            VALUES (@tenant_id, @tenant_name, @plan_code, COALESCE(@created_by, 'sp_register_tenant_and_user'));\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        -- Profilo admin se manca\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = 'TENANT_ADMIN')\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, created_by)\r\n            VALUES ('TENANT_ADMIN', 'Amministratore Tenant', COALESCE(@created_by, 'sp_register_tenant_and_user'));\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END","size_chars":2218,"tokens_estimate":554}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":65,"content":"        -- User admin\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (\r\n                user_id, tenant_id, email, name, surname, password,\r\n                provider, provider_user_id, profile_code, is_tenant_admin, created_by\r\n            )\r\n            VALUES (\r\n                @user_id, @tenant_id, @email, @name, @surname, @password,\r\n                @provider, @provider_user_id, 'TENANT_ADMIN', 1, COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n            );\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        -- Notifiche default\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS (\r\n                tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @user_id, 1, 1, 0, COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n            );\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status = 'ERROR';\r\n        SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    -- Logging obbligatorio\r\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, status, error_message,\r\n        start_time, end_time, duration_ms, affected_tables, operation_types, created_by\r\n    ) VALUES (\r\n        'sp_register_tenant_and_user', @tenant_id, @user_id, @rows_inserted, @rows_updated, @rows_deleted, @status, @error_message,\r\n        @start_time, SYSUTCDATETIME(), DATEDIFF(MILLISECOND, @start_time, SYSUTCDATETIME()),\r\n        'PORTAL.TENANT,PORTAL.PROFILE_DOMAINS,PORTAL.USERS,PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        'INSERT', COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n    );\r\nEND\r\n```sql","size_chars":2054,"tokens_estimate":514}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":66,"content":"3Ô∏è‚É£ Template DEBUG EasyWay\r\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_register_tenant_and_user\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @tenant_name NVARCHAR(255) = 'Demo Tenant Srl',\r\n    @plan_code NVARCHAR(50) = 'BRONZE',\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255) = 'debuguser+demo@easyway.it',\r\n    @name NVARCHAR(100) = 'Mario',\r\n    @surname NVARCHAR(100) = 'Debug',\r\n    @password NVARCHAR(255) = 'HASHED_PASSWORD',\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @created_by NVARCHAR(255) = 'sp_debug_register_tenant_and_user'\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    -- Come sopra, ma sequence di debug e NDG debug\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\n\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n            SET @tenant_id = 'TENDEBUG' + RIGHT('000' + CAST(@next_seq_tenant AS NVARCHAR), 3);\r\n        END\n\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n            SET @user_id = 'CDIDEBUG' + RIGHT('000' + CAST(@next_seq_user AS NVARCHAR), 3);\r\n        END\n\n        -- Logica identica alla store principale...\n\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, status, error_message,\r\n        start_time, end_time, duration_ms, affected_tables, operation_types, created_by\r\n    ) VALUES (\r\n        'sp_debug_register_tenant_and_user', @tenant_id, @user_id, 1, 0, 0, 'OK', NULL,\r\n        SYSUTCDATETIME(), SYSUTCDATETIME(), 0,\r\n        'PORTAL.TENANT,PORTAL.PROFILE_DOMAINS,PORTAL.USERS,PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        'INSERT', 'sp_debug_register_tenant_and_user'\r\n    );\r\nEND\n\n```sql\r\n4Ô∏è‚É£ Best practice operative\r\n---------------------------","size_chars":2109,"tokens_estimate":527}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":67,"content":"*   Tutte le SP usano sempre i parametri NDG e multi-tenant.\r\n    \r\n*   **Gestione logging/statistiche**: ogni esecuzione tracciata.\r\n    \r\n*   **Le versioni DEBUG** usano sempre ID e sequence separate, non ‚Äúsporcano‚Äù la produzione.\r\n    \r\n*   **Nessuna insert manuale** sulle tabelle principali: sempre via SP.\r\n    \r\n*   **Modello pronto per future automazioni (CI/CD, pipeline, audit AMS, etc)**.\r\n    \n\n* * *\n\n5Ô∏è‚É£ Esempio pratico di chiamata\r\n-------------------------------\n\n```sql\r\nEXEC PORTAL.sp_register_tenant_and_user\r\n    @tenant_name = 'Acme Srl',\r\n    @plan_code = 'BRONZE',\r\n    @email = 'admin@acme.it',\r\n    @name = 'Mario',\r\n    @surname = 'Rossi',\r\n    @password = 'HASHED_PASSWORD',\r\n    @created_by = 'API_GATEWAY';\n\n```sql\r\n```sql\r\nEXEC PORTAL.sp_debug_register_tenant_and_user\r\n    @tenant_name = 'Tenant Test',\r\n    @plan_code = 'DEBUG',\r\n    @email = 'debug@easyway.it',\r\n    @name = 'Debug',\r\n    @surname = 'User',\r\n    @password = 'DEBUG_HASH',\r\n    @created_by = 'DEBUG_TOOL';\r\n```sql\n\nüîí Ogni store process nuova/futura dovr√† sempre seguire queste linee guida.","size_chars":1089,"tokens_estimate":272}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":68,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":69,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section # EasyWay Data Portal ‚Äì STORE PROCEDURE: Linee Guida, Best Practice e Template\n\n> **Modello in uso:** Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG, ext_attributes, auditing, logging automatico).\n\n---","size_chars":291,"tokens_estimate":73}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"‚úÖ Scopo del documento\r","anchor_slug":"scopo-del-documento","chunk_index":70,"content":"## ‚úÖ Scopo del documento\n\nDefinire e standardizzare la **struttura, i pattern, e le best practice** delle store procedure (SP) per EasyWay Data Portal.  \r\nObiettivo: **nessun dato chiave inserito manualmente**, **tutto tracciato**, massima robustezza per AMS, DevOps, audit.\n\n---","size_chars":279,"tokens_estimate":70}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**Principi generali EasyWay per Store Process**\r","anchor_slug":"principi-generali-easyway-per-store-process","chunk_index":71,"content":"### **Principi generali EasyWay per Store Process**\n\n- **Tutto l‚Äôonboarding, le operazioni DML, e la logica applicativa passano sempre da store procedure.**\r\n- **Nessun insert/update diretto sulle tabelle anagrafiche e di business.**\r\n- **Ogni store procedure aggiorna sempre i campi di auditing (`created_by`, `created_at`, `updated_at`).**\r\n- **Tutte le SP devono scrivere SEMPRE un record su `PORTAL.STATS_EXECUTION_LOG`** con:\r\n    - nome procedura,\r\n    - tenant_id, user_id,\r\n    - righe inserite/aggiornate/cancellate,\r\n    - start_time, end_time, durata,\r\n    - status (`OK`/`ERROR`),\r\n    - error_message se presente,\r\n    - tabelle impattate, tipo operazione, chi ha eseguito.\r\n- **Ogni store procedure importante** (soprattutto quelle richiamate da API/servizi/portale) ha anche la versione `_DEBUG`:\r\n    - Usa sequence e codici di test (es. `TENDEBUG001`)\r\n    - Parametri di default per demo, UAT, sandbox, DevOps\r\n    - Sempre logging su `PORTAL.STATS_EXECUTION_LOG`\r\n- **Gestione errori atomica:** TRY/CATCH, ROLLBACK su errore, transazione sempre chiusa\n\n---\n\nüö¶ **Roadmap Operativa Store Procedure EasyWay Data Portal**\r\n------------------------------------------------------------","size_chars":1199,"tokens_estimate":300}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"1Ô∏è‚É£ **Regole fisse**\r","anchor_slug":"1-regole-fisse","chunk_index":72,"content":"### 1Ô∏è‚É£ **Regole fisse**\n\n*   Tutte le DML su tabelle principali si fanno **SOLO tramite store process**.\r\n    \r\n*   Ogni store process esegue **logging completo su `PORTAL.STATS_EXECUTION_LOG`** (e tabella TABLE_LOG se necessario).\r\n    \r\n*   **DEBUG**: ogni store ha sempre la sua versione di test (sequence e NDG separati).\r\n    \r\n*   La logica NDG (tenant/user) viene sempre generata dentro la store (mai lato API).\r\n    \r\n*   **Gestione atomica (TRY/CATCH + TRANSACTION)** sempre, rollback automatico su errore.\r\n    \r\n*   **`created_by` di default = nome SP** (o servizio/utente passato in input).\r\n    \n\n* * *","size_chars":616,"tokens_estimate":154}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"2Ô∏è‚É£ **Prossimi step e template**\r","anchor_slug":"2-prossimi-step-e-template","chunk_index":73,"content":"### 2Ô∏è‚É£ **Prossimi step e template**\n\nPer ogni tabella chiave di PORTAL (e analoghe in altri schema), fornir√≤:\r\n*   **Store di INSERT** (con NDG, auditing, logging)\r\n    \r\n*   **Store di UPDATE** (per scenari reali, aggiornamento sicuro e tracciato)\r\n    \r\n*   **Store di DELETE ‚Äúsafe‚Äù** (soft delete, flag, o logga tutto)\r\n    \r\n*   **Versione DEBUG per ogni store**\r\n    \r\n*   **Documentazione .md pronta per Wiki**\r\n    \n\n* * *","size_chars":430,"tokens_estimate":108}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"3Ô∏è‚É£ **Esempio template standard INSERT/UPDATE/DELETE**\r","anchor_slug":"3-esempio-template-standard-insertupdatedelete","chunk_index":74,"content":"### 3Ô∏è‚É£ **Esempio template standard INSERT/UPDATE/DELETE**\n\n(gi√† pronto per pipeline, API, batch, ecc.)\n\n#### **a) INSERT (Onboarding/Creazione)**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_[TABLE]     -- parametri tabella... AS BEGIN     SET NOCOUNT ON;     -- transazione, insert, auditing, logging END GO\r\n```sql\n\n#### **b) UPDATE**\n\n```sql \r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_[TABLE]     -- parametri... AS BEGIN     SET NOCOUNT ON;     -- transazione, update, auditing, logging END GO`\r\n```sql\r\n#### **c) DELETE / SOFT DELETE**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_[TABLE]     -- parametri... AS BEGIN     SET NOCOUNT ON;     -- transazione, soft delete (flag), logging END GO\r\n```sql\r\n#### **d) DEBUG**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_[TABLE] AS BEGIN     -- chiama insert con parametri demo/sandbox, usa sequence debug END GO`\r\n```sql\n\n* * *","size_chars":907,"tokens_estimate":227}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"4Ô∏è‚É£ **Automazione della documentazione**\r","anchor_slug":"4-automazione-della-documentazione","chunk_index":75,"content":"### 4Ô∏è‚É£ **Automazione della documentazione**\n\nTutte le SP saranno documentate in **Markdown** pronto per Azure DevOps.  \r\nLe sezioni per ogni store sono sempre:\n\n| Sezione | Contenuto |\r\n| --- | --- |\r\n| Scopo | Cosa fa la store |\r\n| Parametri | Elenco parametri e descrizione |\r\n| Logica Dati | Dettaglio di business (NDG, auditing, ecc.) |\r\n| Logging | Modalit√† di tracking e error handling |\r\n| Debug | Differenze rispetto alla produzione |\r\n| Esempi | Chiamata reale/test |\r\n| Versione | Data, autore, note AMS/DevOps |","size_chars":523,"tokens_estimate":131}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"**Template** ##\r","anchor_slug":"template","chunk_index":76,"content":"## **Template** ##","size_chars":18,"tokens_estimate":4}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":77,"content":"## Template standard EasyWay (produzione)\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_register_tenant_and_user\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @tenant_name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100),\r\n    @surname NVARCHAR(100),\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @rows_updated INT = 0, @rows_deleted INT = 0;\r\n    DECLARE @status NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\n\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\n\n        -- NDG tenant_id se mancante\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n            SET @tenant_id = 'TEN' + RIGHT('000000000' + CAST(@next_seq_tenant AS NVARCHAR), 9);\r\n        END\n\n        -- NDG user_id se mancante\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n            SET @user_id = 'CDI' + RIGHT('000000000' + CAST(@next_seq_user AS NVARCHAR), 9);\r\n        END\n\n        -- Tenant\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.TENANT (tenant_id, name, plan_code, created_by)\r\n            VALUES (@tenant_id, @tenant_name, @plan_code, COALESCE(@created_by, 'sp_register_tenant_and_user'));\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        -- Profilo admin se manca\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = 'TENANT_ADMIN')\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, created_by)\r\n            VALUES ('TENANT_ADMIN', 'Amministratore Tenant', COALESCE(@created_by, 'sp_register_tenant_and_user'));\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END","size_chars":2218,"tokens_estimate":554}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":78,"content":"        -- User admin\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (\r\n                user_id, tenant_id, email, name, surname, password,\r\n                provider, provider_user_id, profile_code, is_tenant_admin, created_by\r\n            )\r\n            VALUES (\r\n                @user_id, @tenant_id, @email, @name, @surname, @password,\r\n                @provider, @provider_user_id, 'TENANT_ADMIN', 1, COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n            );\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        -- Notifiche default\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS (\r\n                tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @user_id, 1, 1, 0, COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n            );\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status = 'ERROR';\r\n        SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    -- Logging obbligatorio\r\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, status, error_message,\r\n        start_time, end_time, duration_ms, affected_tables, operation_types, created_by\r\n    ) VALUES (\r\n        'sp_register_tenant_and_user', @tenant_id, @user_id, @rows_inserted, @rows_updated, @rows_deleted, @status, @error_message,\r\n        @start_time, SYSUTCDATETIME(), DATEDIFF(MILLISECOND, @start_time, SYSUTCDATETIME()),\r\n        'PORTAL.TENANT,PORTAL.PROFILE_DOMAINS,PORTAL.USERS,PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        'INSERT', COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n    );\r\nEND\r\n```sql","size_chars":2054,"tokens_estimate":514}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":79,"content":"3Ô∏è‚É£ Template DEBUG EasyWay\r\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_register_tenant_and_user\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @tenant_name NVARCHAR(255) = 'Demo Tenant Srl',\r\n    @plan_code NVARCHAR(50) = 'BRONZE',\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255) = 'debuguser+demo@easyway.it',\r\n    @name NVARCHAR(100) = 'Mario',\r\n    @surname NVARCHAR(100) = 'Debug',\r\n    @password NVARCHAR(255) = 'HASHED_PASSWORD',\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @created_by NVARCHAR(255) = 'sp_debug_register_tenant_and_user'\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    -- Come sopra, ma sequence di debug e NDG debug\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\n\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n            SET @tenant_id = 'TENDEBUG' + RIGHT('000' + CAST(@next_seq_tenant AS NVARCHAR), 3);\r\n        END\n\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n            SET @user_id = 'CDIDEBUG' + RIGHT('000' + CAST(@next_seq_user AS NVARCHAR), 3);\r\n        END\n\n        -- Logica identica alla store principale...\n\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, status, error_message,\r\n        start_time, end_time, duration_ms, affected_tables, operation_types, created_by\r\n    ) VALUES (\r\n        'sp_debug_register_tenant_and_user', @tenant_id, @user_id, 1, 0, 0, 'OK', NULL,\r\n        SYSUTCDATETIME(), SYSUTCDATETIME(), 0,\r\n        'PORTAL.TENANT,PORTAL.PROFILE_DOMAINS,PORTAL.USERS,PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        'INSERT', 'sp_debug_register_tenant_and_user'\r\n    );\r\nEND\n\n```sql\r\n4Ô∏è‚É£ Best practice operative\r\n---------------------------","size_chars":2109,"tokens_estimate":527}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":80,"content":"*   Tutte le SP usano sempre i parametri NDG e multi-tenant.\r\n    \r\n*   **Gestione logging/statistiche**: ogni esecuzione tracciata.\r\n    \r\n*   **Le versioni DEBUG** usano sempre ID e sequence separate, non ‚Äúsporcano‚Äù la produzione.\r\n    \r\n*   **Nessuna insert manuale** sulle tabelle principali: sempre via SP.\r\n    \r\n*   **Modello pronto per future automazioni (CI/CD, pipeline, audit AMS, etc)**.\r\n    \n\n* * *\n\n5Ô∏è‚É£ Esempio pratico di chiamata\r\n-------------------------------\n\n```sql\r\nEXEC PORTAL.sp_register_tenant_and_user\r\n    @tenant_name = 'Acme Srl',\r\n    @plan_code = 'BRONZE',\r\n    @email = 'admin@acme.it',\r\n    @name = 'Mario',\r\n    @surname = 'Rossi',\r\n    @password = 'HASHED_PASSWORD',\r\n    @created_by = 'API_GATEWAY';\n\n```sql\r\n```sql\r\nEXEC PORTAL.sp_debug_register_tenant_and_user\r\n    @tenant_name = 'Tenant Test',\r\n    @plan_code = 'DEBUG',\r\n    @email = 'debug@easyway.it',\r\n    @name = 'Debug',\r\n    @surname = 'User',\r\n    @password = 'DEBUG_HASH',\r\n    @created_by = 'DEBUG_TOOL';\r\n```sql\n\nüîí Ogni store process nuova/futura dovr√† sempre seguire queste linee guida.","size_chars":1089,"tokens_estimate":272}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":81,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":82,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n = Ensure-Section # EasyWay Data Portal ‚Äì STORE PROCEDURE: Linee Guida, Best Practice e Template\n\n> **Modello in uso:** Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG, ext_attributes, auditing, logging automatico).\n\n---","size_chars":362,"tokens_estimate":90}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"‚úÖ Scopo del documento\r","anchor_slug":"scopo-del-documento","chunk_index":83,"content":"## ‚úÖ Scopo del documento\n\nDefinire e standardizzare la **struttura, i pattern, e le best practice** delle store procedure (SP) per EasyWay Data Portal.  \r\nObiettivo: **nessun dato chiave inserito manualmente**, **tutto tracciato**, massima robustezza per AMS, DevOps, audit.\n\n---","size_chars":279,"tokens_estimate":70}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**Principi generali EasyWay per Store Process**\r","anchor_slug":"principi-generali-easyway-per-store-process","chunk_index":84,"content":"### **Principi generali EasyWay per Store Process**\n\n- **Tutto l‚Äôonboarding, le operazioni DML, e la logica applicativa passano sempre da store procedure.**\r\n- **Nessun insert/update diretto sulle tabelle anagrafiche e di business.**\r\n- **Ogni store procedure aggiorna sempre i campi di auditing (`created_by`, `created_at`, `updated_at`).**\r\n- **Tutte le SP devono scrivere SEMPRE un record su `PORTAL.STATS_EXECUTION_LOG`** con:\r\n    - nome procedura,\r\n    - tenant_id, user_id,\r\n    - righe inserite/aggiornate/cancellate,\r\n    - start_time, end_time, durata,\r\n    - status (`OK`/`ERROR`),\r\n    - error_message se presente,\r\n    - tabelle impattate, tipo operazione, chi ha eseguito.\r\n- **Ogni store procedure importante** (soprattutto quelle richiamate da API/servizi/portale) ha anche la versione `_DEBUG`:\r\n    - Usa sequence e codici di test (es. `TENDEBUG001`)\r\n    - Parametri di default per demo, UAT, sandbox, DevOps\r\n    - Sempre logging su `PORTAL.STATS_EXECUTION_LOG`\r\n- **Gestione errori atomica:** TRY/CATCH, ROLLBACK su errore, transazione sempre chiusa\n\n---\n\nüö¶ **Roadmap Operativa Store Procedure EasyWay Data Portal**\r\n------------------------------------------------------------","size_chars":1199,"tokens_estimate":300}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"1Ô∏è‚É£ **Regole fisse**\r","anchor_slug":"1-regole-fisse","chunk_index":85,"content":"### 1Ô∏è‚É£ **Regole fisse**\n\n*   Tutte le DML su tabelle principali si fanno **SOLO tramite store process**.\r\n    \r\n*   Ogni store process esegue **logging completo su `PORTAL.STATS_EXECUTION_LOG`** (e tabella TABLE_LOG se necessario).\r\n    \r\n*   **DEBUG**: ogni store ha sempre la sua versione di test (sequence e NDG separati).\r\n    \r\n*   La logica NDG (tenant/user) viene sempre generata dentro la store (mai lato API).\r\n    \r\n*   **Gestione atomica (TRY/CATCH + TRANSACTION)** sempre, rollback automatico su errore.\r\n    \r\n*   **`created_by` di default = nome SP** (o servizio/utente passato in input).\r\n    \n\n* * *","size_chars":616,"tokens_estimate":154}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"2Ô∏è‚É£ **Prossimi step e template**\r","anchor_slug":"2-prossimi-step-e-template","chunk_index":86,"content":"### 2Ô∏è‚É£ **Prossimi step e template**\n\nPer ogni tabella chiave di PORTAL (e analoghe in altri schema), fornir√≤:\r\n*   **Store di INSERT** (con NDG, auditing, logging)\r\n    \r\n*   **Store di UPDATE** (per scenari reali, aggiornamento sicuro e tracciato)\r\n    \r\n*   **Store di DELETE ‚Äúsafe‚Äù** (soft delete, flag, o logga tutto)\r\n    \r\n*   **Versione DEBUG per ogni store**\r\n    \r\n*   **Documentazione .md pronta per Wiki**\r\n    \n\n* * *","size_chars":430,"tokens_estimate":108}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"3Ô∏è‚É£ **Esempio template standard INSERT/UPDATE/DELETE**\r","anchor_slug":"3-esempio-template-standard-insertupdatedelete","chunk_index":87,"content":"### 3Ô∏è‚É£ **Esempio template standard INSERT/UPDATE/DELETE**\n\n(gi√† pronto per pipeline, API, batch, ecc.)\n\n#### **a) INSERT (Onboarding/Creazione)**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_[TABLE]     -- parametri tabella... AS BEGIN     SET NOCOUNT ON;     -- transazione, insert, auditing, logging END GO\r\n```sql\n\n#### **b) UPDATE**\n\n```sql \r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_[TABLE]     -- parametri... AS BEGIN     SET NOCOUNT ON;     -- transazione, update, auditing, logging END GO`\r\n```sql\r\n#### **c) DELETE / SOFT DELETE**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_[TABLE]     -- parametri... AS BEGIN     SET NOCOUNT ON;     -- transazione, soft delete (flag), logging END GO\r\n```sql\r\n#### **d) DEBUG**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_[TABLE] AS BEGIN     -- chiama insert con parametri demo/sandbox, usa sequence debug END GO`\r\n```sql\n\n* * *","size_chars":907,"tokens_estimate":227}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"4Ô∏è‚É£ **Automazione della documentazione**\r","anchor_slug":"4-automazione-della-documentazione","chunk_index":88,"content":"### 4Ô∏è‚É£ **Automazione della documentazione**\n\nTutte le SP saranno documentate in **Markdown** pronto per Azure DevOps.  \r\nLe sezioni per ogni store sono sempre:\n\n| Sezione | Contenuto |\r\n| --- | --- |\r\n| Scopo | Cosa fa la store |\r\n| Parametri | Elenco parametri e descrizione |\r\n| Logica Dati | Dettaglio di business (NDG, auditing, ecc.) |\r\n| Logging | Modalit√† di tracking e error handling |\r\n| Debug | Differenze rispetto alla produzione |\r\n| Esempi | Chiamata reale/test |\r\n| Versione | Data, autore, note AMS/DevOps |","size_chars":523,"tokens_estimate":131}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"**Template** ##\r","anchor_slug":"template","chunk_index":89,"content":"## **Template** ##","size_chars":18,"tokens_estimate":4}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":90,"content":"## Template standard EasyWay (produzione)\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_register_tenant_and_user\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @tenant_name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100),\r\n    @surname NVARCHAR(100),\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @rows_updated INT = 0, @rows_deleted INT = 0;\r\n    DECLARE @status NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\n\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\n\n        -- NDG tenant_id se mancante\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n            SET @tenant_id = 'TEN' + RIGHT('000000000' + CAST(@next_seq_tenant AS NVARCHAR), 9);\r\n        END\n\n        -- NDG user_id se mancante\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n            SET @user_id = 'CDI' + RIGHT('000000000' + CAST(@next_seq_user AS NVARCHAR), 9);\r\n        END\n\n        -- Tenant\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.TENANT (tenant_id, name, plan_code, created_by)\r\n            VALUES (@tenant_id, @tenant_name, @plan_code, COALESCE(@created_by, 'sp_register_tenant_and_user'));\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        -- Profilo admin se manca\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = 'TENANT_ADMIN')\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, created_by)\r\n            VALUES ('TENANT_ADMIN', 'Amministratore Tenant', COALESCE(@created_by, 'sp_register_tenant_and_user'));\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END","size_chars":2218,"tokens_estimate":554}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":91,"content":"        -- User admin\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (\r\n                user_id, tenant_id, email, name, surname, password,\r\n                provider, provider_user_id, profile_code, is_tenant_admin, created_by\r\n            )\r\n            VALUES (\r\n                @user_id, @tenant_id, @email, @name, @surname, @password,\r\n                @provider, @provider_user_id, 'TENANT_ADMIN', 1, COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n            );\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        -- Notifiche default\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS (\r\n                tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @user_id, 1, 1, 0, COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n            );\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status = 'ERROR';\r\n        SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    -- Logging obbligatorio\r\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, status, error_message,\r\n        start_time, end_time, duration_ms, affected_tables, operation_types, created_by\r\n    ) VALUES (\r\n        'sp_register_tenant_and_user', @tenant_id, @user_id, @rows_inserted, @rows_updated, @rows_deleted, @status, @error_message,\r\n        @start_time, SYSUTCDATETIME(), DATEDIFF(MILLISECOND, @start_time, SYSUTCDATETIME()),\r\n        'PORTAL.TENANT,PORTAL.PROFILE_DOMAINS,PORTAL.USERS,PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        'INSERT', COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n    );\r\nEND\r\n```sql","size_chars":2054,"tokens_estimate":514}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":92,"content":"3Ô∏è‚É£ Template DEBUG EasyWay\r\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_register_tenant_and_user\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @tenant_name NVARCHAR(255) = 'Demo Tenant Srl',\r\n    @plan_code NVARCHAR(50) = 'BRONZE',\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255) = 'debuguser+demo@easyway.it',\r\n    @name NVARCHAR(100) = 'Mario',\r\n    @surname NVARCHAR(100) = 'Debug',\r\n    @password NVARCHAR(255) = 'HASHED_PASSWORD',\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @created_by NVARCHAR(255) = 'sp_debug_register_tenant_and_user'\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    -- Come sopra, ma sequence di debug e NDG debug\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\n\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n            SET @tenant_id = 'TENDEBUG' + RIGHT('000' + CAST(@next_seq_tenant AS NVARCHAR), 3);\r\n        END\n\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n            SET @user_id = 'CDIDEBUG' + RIGHT('000' + CAST(@next_seq_user AS NVARCHAR), 3);\r\n        END\n\n        -- Logica identica alla store principale...\n\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, status, error_message,\r\n        start_time, end_time, duration_ms, affected_tables, operation_types, created_by\r\n    ) VALUES (\r\n        'sp_debug_register_tenant_and_user', @tenant_id, @user_id, 1, 0, 0, 'OK', NULL,\r\n        SYSUTCDATETIME(), SYSUTCDATETIME(), 0,\r\n        'PORTAL.TENANT,PORTAL.PROFILE_DOMAINS,PORTAL.USERS,PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        'INSERT', 'sp_debug_register_tenant_and_user'\r\n    );\r\nEND\n\n```sql\r\n4Ô∏è‚É£ Best practice operative\r\n---------------------------","size_chars":2109,"tokens_estimate":527}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":93,"content":"*   Tutte le SP usano sempre i parametri NDG e multi-tenant.\r\n    \r\n*   **Gestione logging/statistiche**: ogni esecuzione tracciata.\r\n    \r\n*   **Le versioni DEBUG** usano sempre ID e sequence separate, non ‚Äúsporcano‚Äù la produzione.\r\n    \r\n*   **Nessuna insert manuale** sulle tabelle principali: sempre via SP.\r\n    \r\n*   **Modello pronto per future automazioni (CI/CD, pipeline, audit AMS, etc)**.\r\n    \n\n* * *\n\n5Ô∏è‚É£ Esempio pratico di chiamata\r\n-------------------------------\n\n```sql\r\nEXEC PORTAL.sp_register_tenant_and_user\r\n    @tenant_name = 'Acme Srl',\r\n    @plan_code = 'BRONZE',\r\n    @email = 'admin@acme.it',\r\n    @name = 'Mario',\r\n    @surname = 'Rossi',\r\n    @password = 'HASHED_PASSWORD',\r\n    @created_by = 'API_GATEWAY';\n\n```sql\r\n```sql\r\nEXEC PORTAL.sp_debug_register_tenant_and_user\r\n    @tenant_name = 'Tenant Test',\r\n    @plan_code = 'DEBUG',\r\n    @email = 'debug@easyway.it',\r\n    @name = 'Debug',\r\n    @surname = 'User',\r\n    @password = 'DEBUG_HASH',\r\n    @created_by = 'DEBUG_TOOL';\r\n```sql\n\nüîí Ogni store process nuova/futura dovr√† sempre seguire queste linee guida.","size_chars":1089,"tokens_estimate":272}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":94,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":95,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":96,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  # EasyWay Data Portal ‚Äì STORE PROCEDURE: Linee Guida, Best Practice e Template\n\n> **Modello in uso:** Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG, ext_attributes, auditing, logging automatico).\n\n---","size_chars":341,"tokens_estimate":85}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"‚úÖ Scopo del documento\r","anchor_slug":"scopo-del-documento","chunk_index":97,"content":"## ‚úÖ Scopo del documento\n\nDefinire e standardizzare la **struttura, i pattern, e le best practice** delle store procedure (SP) per EasyWay Data Portal.  \r\nObiettivo: **nessun dato chiave inserito manualmente**, **tutto tracciato**, massima robustezza per AMS, DevOps, audit.\n\n---","size_chars":279,"tokens_estimate":70}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**Principi generali EasyWay per Store Process**\r","anchor_slug":"principi-generali-easyway-per-store-process","chunk_index":98,"content":"### **Principi generali EasyWay per Store Process**\n\n- **Tutto l‚Äôonboarding, le operazioni DML, e la logica applicativa passano sempre da store procedure.**\r\n- **Nessun insert/update diretto sulle tabelle anagrafiche e di business.**\r\n- **Ogni store procedure aggiorna sempre i campi di auditing (`created_by`, `created_at`, `updated_at`).**\r\n- **Tutte le SP devono scrivere SEMPRE un record su `PORTAL.STATS_EXECUTION_LOG`** con:\r\n    - nome procedura,\r\n    - tenant_id, user_id,\r\n    - righe inserite/aggiornate/cancellate,\r\n    - start_time, end_time, durata,\r\n    - status (`OK`/`ERROR`),\r\n    - error_message se presente,\r\n    - tabelle impattate, tipo operazione, chi ha eseguito.\r\n- **Ogni store procedure importante** (soprattutto quelle richiamate da API/servizi/portale) ha anche la versione `_DEBUG`:\r\n    - Usa sequence e codici di test (es. `TENDEBUG001`)\r\n    - Parametri di default per demo, UAT, sandbox, DevOps\r\n    - Sempre logging su `PORTAL.STATS_EXECUTION_LOG`\r\n- **Gestione errori atomica:** TRY/CATCH, ROLLBACK su errore, transazione sempre chiusa\n\n---\n\nüö¶ **Roadmap Operativa Store Procedure EasyWay Data Portal**\r\n------------------------------------------------------------","size_chars":1199,"tokens_estimate":300}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"1Ô∏è‚É£ **Regole fisse**\r","anchor_slug":"1-regole-fisse","chunk_index":99,"content":"### 1Ô∏è‚É£ **Regole fisse**\n\n*   Tutte le DML su tabelle principali si fanno **SOLO tramite store process**.\r\n    \r\n*   Ogni store process esegue **logging completo su `PORTAL.STATS_EXECUTION_LOG`** (e tabella TABLE_LOG se necessario).\r\n    \r\n*   **DEBUG**: ogni store ha sempre la sua versione di test (sequence e NDG separati).\r\n    \r\n*   La logica NDG (tenant/user) viene sempre generata dentro la store (mai lato API).\r\n    \r\n*   **Gestione atomica (TRY/CATCH + TRANSACTION)** sempre, rollback automatico su errore.\r\n    \r\n*   **`created_by` di default = nome SP** (o servizio/utente passato in input).\r\n    \n\n* * *","size_chars":616,"tokens_estimate":154}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"2Ô∏è‚É£ **Prossimi step e template**\r","anchor_slug":"2-prossimi-step-e-template","chunk_index":100,"content":"### 2Ô∏è‚É£ **Prossimi step e template**\n\nPer ogni tabella chiave di PORTAL (e analoghe in altri schema), fornir√≤:\r\n*   **Store di INSERT** (con NDG, auditing, logging)\r\n    \r\n*   **Store di UPDATE** (per scenari reali, aggiornamento sicuro e tracciato)\r\n    \r\n*   **Store di DELETE ‚Äúsafe‚Äù** (soft delete, flag, o logga tutto)\r\n    \r\n*   **Versione DEBUG per ogni store**\r\n    \r\n*   **Documentazione .md pronta per Wiki**\r\n    \n\n* * *","size_chars":430,"tokens_estimate":108}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"3Ô∏è‚É£ **Esempio template standard INSERT/UPDATE/DELETE**\r","anchor_slug":"3-esempio-template-standard-insertupdatedelete","chunk_index":101,"content":"### 3Ô∏è‚É£ **Esempio template standard INSERT/UPDATE/DELETE**\n\n(gi√† pronto per pipeline, API, batch, ecc.)\n\n#### **a) INSERT (Onboarding/Creazione)**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_[TABLE]     -- parametri tabella... AS BEGIN     SET NOCOUNT ON;     -- transazione, insert, auditing, logging END GO\r\n```sql\n\n#### **b) UPDATE**\n\n```sql \r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_[TABLE]     -- parametri... AS BEGIN     SET NOCOUNT ON;     -- transazione, update, auditing, logging END GO`\r\n```sql\r\n#### **c) DELETE / SOFT DELETE**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_[TABLE]     -- parametri... AS BEGIN     SET NOCOUNT ON;     -- transazione, soft delete (flag), logging END GO\r\n```sql\r\n#### **d) DEBUG**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_[TABLE] AS BEGIN     -- chiama insert con parametri demo/sandbox, usa sequence debug END GO`\r\n```sql\n\n* * *","size_chars":907,"tokens_estimate":227}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"4Ô∏è‚É£ **Automazione della documentazione**\r","anchor_slug":"4-automazione-della-documentazione","chunk_index":102,"content":"### 4Ô∏è‚É£ **Automazione della documentazione**\n\nTutte le SP saranno documentate in **Markdown** pronto per Azure DevOps.  \r\nLe sezioni per ogni store sono sempre:\n\n| Sezione | Contenuto |\r\n| --- | --- |\r\n| Scopo | Cosa fa la store |\r\n| Parametri | Elenco parametri e descrizione |\r\n| Logica Dati | Dettaglio di business (NDG, auditing, ecc.) |\r\n| Logging | Modalit√† di tracking e error handling |\r\n| Debug | Differenze rispetto alla produzione |\r\n| Esempi | Chiamata reale/test |\r\n| Versione | Data, autore, note AMS/DevOps |","size_chars":523,"tokens_estimate":131}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"**Template** ##\r","anchor_slug":"template","chunk_index":103,"content":"## **Template** ##","size_chars":18,"tokens_estimate":4}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":104,"content":"## Template standard EasyWay (produzione)\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_register_tenant_and_user\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @tenant_name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100),\r\n    @surname NVARCHAR(100),\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @rows_updated INT = 0, @rows_deleted INT = 0;\r\n    DECLARE @status NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\n\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\n\n        -- NDG tenant_id se mancante\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n            SET @tenant_id = 'TEN' + RIGHT('000000000' + CAST(@next_seq_tenant AS NVARCHAR), 9);\r\n        END\n\n        -- NDG user_id se mancante\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n            SET @user_id = 'CDI' + RIGHT('000000000' + CAST(@next_seq_user AS NVARCHAR), 9);\r\n        END\n\n        -- Tenant\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.TENANT (tenant_id, name, plan_code, created_by)\r\n            VALUES (@tenant_id, @tenant_name, @plan_code, COALESCE(@created_by, 'sp_register_tenant_and_user'));\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        -- Profilo admin se manca\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = 'TENANT_ADMIN')\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, created_by)\r\n            VALUES ('TENANT_ADMIN', 'Amministratore Tenant', COALESCE(@created_by, 'sp_register_tenant_and_user'));\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END","size_chars":2218,"tokens_estimate":554}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":105,"content":"        -- User admin\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (\r\n                user_id, tenant_id, email, name, surname, password,\r\n                provider, provider_user_id, profile_code, is_tenant_admin, created_by\r\n            )\r\n            VALUES (\r\n                @user_id, @tenant_id, @email, @name, @surname, @password,\r\n                @provider, @provider_user_id, 'TENANT_ADMIN', 1, COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n            );\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        -- Notifiche default\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS (\r\n                tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @user_id, 1, 1, 0, COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n            );\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status = 'ERROR';\r\n        SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    -- Logging obbligatorio\r\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, status, error_message,\r\n        start_time, end_time, duration_ms, affected_tables, operation_types, created_by\r\n    ) VALUES (\r\n        'sp_register_tenant_and_user', @tenant_id, @user_id, @rows_inserted, @rows_updated, @rows_deleted, @status, @error_message,\r\n        @start_time, SYSUTCDATETIME(), DATEDIFF(MILLISECOND, @start_time, SYSUTCDATETIME()),\r\n        'PORTAL.TENANT,PORTAL.PROFILE_DOMAINS,PORTAL.USERS,PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        'INSERT', COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n    );\r\nEND\r\n```sql","size_chars":2054,"tokens_estimate":514}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":106,"content":"3Ô∏è‚É£ Template DEBUG EasyWay\r\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_register_tenant_and_user\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @tenant_name NVARCHAR(255) = 'Demo Tenant Srl',\r\n    @plan_code NVARCHAR(50) = 'BRONZE',\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255) = 'debuguser+demo@easyway.it',\r\n    @name NVARCHAR(100) = 'Mario',\r\n    @surname NVARCHAR(100) = 'Debug',\r\n    @password NVARCHAR(255) = 'HASHED_PASSWORD',\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @created_by NVARCHAR(255) = 'sp_debug_register_tenant_and_user'\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    -- Come sopra, ma sequence di debug e NDG debug\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\n\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n            SET @tenant_id = 'TENDEBUG' + RIGHT('000' + CAST(@next_seq_tenant AS NVARCHAR), 3);\r\n        END\n\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n            SET @user_id = 'CDIDEBUG' + RIGHT('000' + CAST(@next_seq_user AS NVARCHAR), 3);\r\n        END\n\n        -- Logica identica alla store principale...\n\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, status, error_message,\r\n        start_time, end_time, duration_ms, affected_tables, operation_types, created_by\r\n    ) VALUES (\r\n        'sp_debug_register_tenant_and_user', @tenant_id, @user_id, 1, 0, 0, 'OK', NULL,\r\n        SYSUTCDATETIME(), SYSUTCDATETIME(), 0,\r\n        'PORTAL.TENANT,PORTAL.PROFILE_DOMAINS,PORTAL.USERS,PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        'INSERT', 'sp_debug_register_tenant_and_user'\r\n    );\r\nEND\n\n```sql\r\n4Ô∏è‚É£ Best practice operative\r\n---------------------------","size_chars":2109,"tokens_estimate":527}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":107,"content":"*   Tutte le SP usano sempre i parametri NDG e multi-tenant.\r\n    \r\n*   **Gestione logging/statistiche**: ogni esecuzione tracciata.\r\n    \r\n*   **Le versioni DEBUG** usano sempre ID e sequence separate, non ‚Äúsporcano‚Äù la produzione.\r\n    \r\n*   **Nessuna insert manuale** sulle tabelle principali: sempre via SP.\r\n    \r\n*   **Modello pronto per future automazioni (CI/CD, pipeline, audit AMS, etc)**.\r\n    \n\n* * *\n\n5Ô∏è‚É£ Esempio pratico di chiamata\r\n-------------------------------\n\n```sql\r\nEXEC PORTAL.sp_register_tenant_and_user\r\n    @tenant_name = 'Acme Srl',\r\n    @plan_code = 'BRONZE',\r\n    @email = 'admin@acme.it',\r\n    @name = 'Mario',\r\n    @surname = 'Rossi',\r\n    @password = 'HASHED_PASSWORD',\r\n    @created_by = 'API_GATEWAY';\n\n```sql\r\n```sql\r\nEXEC PORTAL.sp_debug_register_tenant_and_user\r\n    @tenant_name = 'Tenant Test',\r\n    @plan_code = 'DEBUG',\r\n    @email = 'debug@easyway.it',\r\n    @name = 'Debug',\r\n    @surname = 'User',\r\n    @password = 'DEBUG_HASH',\r\n    @created_by = 'DEBUG_TOOL';\r\n```sql\n\nüîí Ogni store process nuova/futura dovr√† sempre seguire queste linee guida.","size_chars":1089,"tokens_estimate":272}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":108,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":109,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section # EasyWay Data Portal ‚Äì STORE PROCEDURE: Linee Guida, Best Practice e Template\n\n> **Modello in uso:** Nexus Multi-Tenant (anagrafiche larghe, surrogate key INT, NDG, ext_attributes, auditing, logging automatico).\n\n---","size_chars":291,"tokens_estimate":73}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"‚úÖ Scopo del documento\r","anchor_slug":"scopo-del-documento","chunk_index":110,"content":"## ‚úÖ Scopo del documento\n\nDefinire e standardizzare la **struttura, i pattern, e le best practice** delle store procedure (SP) per EasyWay Data Portal.  \r\nObiettivo: **nessun dato chiave inserito manualmente**, **tutto tracciato**, massima robustezza per AMS, DevOps, audit.\n\n---","size_chars":279,"tokens_estimate":70}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**Principi generali EasyWay per Store Process**\r","anchor_slug":"principi-generali-easyway-per-store-process","chunk_index":111,"content":"### **Principi generali EasyWay per Store Process**\n\n- **Tutto l‚Äôonboarding, le operazioni DML, e la logica applicativa passano sempre da store procedure.**\r\n- **Nessun insert/update diretto sulle tabelle anagrafiche e di business.**\r\n- **Ogni store procedure aggiorna sempre i campi di auditing (`created_by`, `created_at`, `updated_at`).**\r\n- **Tutte le SP devono scrivere SEMPRE un record su `PORTAL.STATS_EXECUTION_LOG`** con:\r\n    - nome procedura,\r\n    - tenant_id, user_id,\r\n    - righe inserite/aggiornate/cancellate,\r\n    - start_time, end_time, durata,\r\n    - status (`OK`/`ERROR`),\r\n    - error_message se presente,\r\n    - tabelle impattate, tipo operazione, chi ha eseguito.\r\n- **Ogni store procedure importante** (soprattutto quelle richiamate da API/servizi/portale) ha anche la versione `_DEBUG`:\r\n    - Usa sequence e codici di test (es. `TENDEBUG001`)\r\n    - Parametri di default per demo, UAT, sandbox, DevOps\r\n    - Sempre logging su `PORTAL.STATS_EXECUTION_LOG`\r\n- **Gestione errori atomica:** TRY/CATCH, ROLLBACK su errore, transazione sempre chiusa\n\n---\n\nüö¶ **Roadmap Operativa Store Procedure EasyWay Data Portal**\r\n------------------------------------------------------------","size_chars":1199,"tokens_estimate":300}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"1Ô∏è‚É£ **Regole fisse**\r","anchor_slug":"1-regole-fisse","chunk_index":112,"content":"### 1Ô∏è‚É£ **Regole fisse**\n\n*   Tutte le DML su tabelle principali si fanno **SOLO tramite store process**.\r\n    \r\n*   Ogni store process esegue **logging completo su `PORTAL.STATS_EXECUTION_LOG`** (e tabella TABLE_LOG se necessario).\r\n    \r\n*   **DEBUG**: ogni store ha sempre la sua versione di test (sequence e NDG separati).\r\n    \r\n*   La logica NDG (tenant/user) viene sempre generata dentro la store (mai lato API).\r\n    \r\n*   **Gestione atomica (TRY/CATCH + TRANSACTION)** sempre, rollback automatico su errore.\r\n    \r\n*   **`created_by` di default = nome SP** (o servizio/utente passato in input).\r\n    \n\n* * *","size_chars":616,"tokens_estimate":154}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"2Ô∏è‚É£ **Prossimi step e template**\r","anchor_slug":"2-prossimi-step-e-template","chunk_index":113,"content":"### 2Ô∏è‚É£ **Prossimi step e template**\n\nPer ogni tabella chiave di PORTAL (e analoghe in altri schema), fornir√≤:\r\n*   **Store di INSERT** (con NDG, auditing, logging)\r\n    \r\n*   **Store di UPDATE** (per scenari reali, aggiornamento sicuro e tracciato)\r\n    \r\n*   **Store di DELETE ‚Äúsafe‚Äù** (soft delete, flag, o logga tutto)\r\n    \r\n*   **Versione DEBUG per ogni store**\r\n    \r\n*   **Documentazione .md pronta per Wiki**\r\n    \n\n* * *","size_chars":430,"tokens_estimate":108}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"3Ô∏è‚É£ **Esempio template standard INSERT/UPDATE/DELETE**\r","anchor_slug":"3-esempio-template-standard-insertupdatedelete","chunk_index":114,"content":"### 3Ô∏è‚É£ **Esempio template standard INSERT/UPDATE/DELETE**\n\n(gi√† pronto per pipeline, API, batch, ecc.)\n\n#### **a) INSERT (Onboarding/Creazione)**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_[TABLE]     -- parametri tabella... AS BEGIN     SET NOCOUNT ON;     -- transazione, insert, auditing, logging END GO\r\n```sql\n\n#### **b) UPDATE**\n\n```sql \r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_[TABLE]     -- parametri... AS BEGIN     SET NOCOUNT ON;     -- transazione, update, auditing, logging END GO`\r\n```sql\r\n#### **c) DELETE / SOFT DELETE**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_[TABLE]     -- parametri... AS BEGIN     SET NOCOUNT ON;     -- transazione, soft delete (flag), logging END GO\r\n```sql\r\n#### **d) DEBUG**\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_[TABLE] AS BEGIN     -- chiama insert con parametri demo/sandbox, usa sequence debug END GO`\r\n```sql\n\n* * *","size_chars":907,"tokens_estimate":227}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"4Ô∏è‚É£ **Automazione della documentazione**\r","anchor_slug":"4-automazione-della-documentazione","chunk_index":115,"content":"### 4Ô∏è‚É£ **Automazione della documentazione**\n\nTutte le SP saranno documentate in **Markdown** pronto per Azure DevOps.  \r\nLe sezioni per ogni store sono sempre:\n\n| Sezione | Contenuto |\r\n| --- | --- |\r\n| Scopo | Cosa fa la store |\r\n| Parametri | Elenco parametri e descrizione |\r\n| Logica Dati | Dettaglio di business (NDG, auditing, ecc.) |\r\n| Logging | Modalit√† di tracking e error handling |\r\n| Debug | Differenze rispetto alla produzione |\r\n| Esempi | Chiamata reale/test |\r\n| Versione | Data, autore, note AMS/DevOps |","size_chars":523,"tokens_estimate":131}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"**Template** ##\r","anchor_slug":"template","chunk_index":116,"content":"## **Template** ##","size_chars":18,"tokens_estimate":4}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":117,"content":"## Template standard EasyWay (produzione)\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_register_tenant_and_user\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @tenant_name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100),\r\n    @surname NVARCHAR(100),\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @rows_updated INT = 0, @rows_deleted INT = 0;\r\n    DECLARE @status NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\n\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\n\n        -- NDG tenant_id se mancante\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n            SET @tenant_id = 'TEN' + RIGHT('000000000' + CAST(@next_seq_tenant AS NVARCHAR), 9);\r\n        END\n\n        -- NDG user_id se mancante\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n            SET @user_id = 'CDI' + RIGHT('000000000' + CAST(@next_seq_user AS NVARCHAR), 9);\r\n        END\n\n        -- Tenant\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.TENANT (tenant_id, name, plan_code, created_by)\r\n            VALUES (@tenant_id, @tenant_name, @plan_code, COALESCE(@created_by, 'sp_register_tenant_and_user'));\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        -- Profilo admin se manca\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = 'TENANT_ADMIN')\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, created_by)\r\n            VALUES ('TENANT_ADMIN', 'Amministratore Tenant', COALESCE(@created_by, 'sp_register_tenant_and_user'));\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END","size_chars":2218,"tokens_estimate":554}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":118,"content":"        -- User admin\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (\r\n                user_id, tenant_id, email, name, surname, password,\r\n                provider, provider_user_id, profile_code, is_tenant_admin, created_by\r\n            )\r\n            VALUES (\r\n                @user_id, @tenant_id, @email, @name, @surname, @password,\r\n                @provider, @provider_user_id, 'TENANT_ADMIN', 1, COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n            );\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        -- Notifiche default\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS (\r\n                tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @user_id, 1, 1, 0, COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n            );\r\n            SET @rows_inserted = @rows_inserted + 1;\r\n        END\n\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status = 'ERROR';\r\n        SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    -- Logging obbligatorio\r\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, status, error_message,\r\n        start_time, end_time, duration_ms, affected_tables, operation_types, created_by\r\n    ) VALUES (\r\n        'sp_register_tenant_and_user', @tenant_id, @user_id, @rows_inserted, @rows_updated, @rows_deleted, @status, @error_message,\r\n        @start_time, SYSUTCDATETIME(), DATEDIFF(MILLISECOND, @start_time, SYSUTCDATETIME()),\r\n        'PORTAL.TENANT,PORTAL.PROFILE_DOMAINS,PORTAL.USERS,PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        'INSERT', COALESCE(@created_by, 'sp_register_tenant_and_user')\r\n    );\r\nEND\r\n```sql","size_chars":2054,"tokens_estimate":514}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":119,"content":"3Ô∏è‚É£ Template DEBUG EasyWay\r\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_register_tenant_and_user\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @tenant_name NVARCHAR(255) = 'Demo Tenant Srl',\r\n    @plan_code NVARCHAR(50) = 'BRONZE',\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255) = 'debuguser+demo@easyway.it',\r\n    @name NVARCHAR(100) = 'Mario',\r\n    @surname NVARCHAR(100) = 'Debug',\r\n    @password NVARCHAR(255) = 'HASHED_PASSWORD',\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @created_by NVARCHAR(255) = 'sp_debug_register_tenant_and_user'\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    -- Come sopra, ma sequence di debug e NDG debug\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\n\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n            SET @tenant_id = 'TENDEBUG' + RIGHT('000' + CAST(@next_seq_tenant AS NVARCHAR), 3);\r\n        END\n\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n            SET @user_id = 'CDIDEBUG' + RIGHT('000' + CAST(@next_seq_user AS NVARCHAR), 3);\r\n        END\n\n        -- Logica identica alla store principale...\n\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, status, error_message,\r\n        start_time, end_time, duration_ms, affected_tables, operation_types, created_by\r\n    ) VALUES (\r\n        'sp_debug_register_tenant_and_user', @tenant_id, @user_id, 1, 0, 0, 'OK', NULL,\r\n        SYSUTCDATETIME(), SYSUTCDATETIME(), 0,\r\n        'PORTAL.TENANT,PORTAL.PROFILE_DOMAINS,PORTAL.USERS,PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        'INSERT', 'sp_debug_register_tenant_and_user'\r\n    );\r\nEND\n\n```sql\r\n4Ô∏è‚É£ Best practice operative\r\n---------------------------","size_chars":2109,"tokens_estimate":527}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Template standard EasyWay (produzione)\r","anchor_slug":"template-standard-easyway-produzione","chunk_index":120,"content":"*   Tutte le SP usano sempre i parametri NDG e multi-tenant.\r\n    \r\n*   **Gestione logging/statistiche**: ogni esecuzione tracciata.\r\n    \r\n*   **Le versioni DEBUG** usano sempre ID e sequence separate, non ‚Äúsporcano‚Äù la produzione.\r\n    \r\n*   **Nessuna insert manuale** sulle tabelle principali: sempre via SP.\r\n    \r\n*   **Modello pronto per future automazioni (CI/CD, pipeline, audit AMS, etc)**.\r\n    \n\n* * *\n\n5Ô∏è‚É£ Esempio pratico di chiamata\r\n-------------------------------\n\n```sql\r\nEXEC PORTAL.sp_register_tenant_and_user\r\n    @tenant_name = 'Acme Srl',\r\n    @plan_code = 'BRONZE',\r\n    @email = 'admin@acme.it',\r\n    @name = 'Mario',\r\n    @surname = 'Rossi',\r\n    @password = 'HASHED_PASSWORD',\r\n    @created_by = 'API_GATEWAY';\n\n```sql\r\n```sql\r\nEXEC PORTAL.sp_debug_register_tenant_and_user\r\n    @tenant_name = 'Tenant Test',\r\n    @plan_code = 'DEBUG',\r\n    @email = 'debug@easyway.it',\r\n    @name = 'Debug',\r\n    @surname = 'User',\r\n    @password = 'DEBUG_HASH',\r\n    @created_by = 'DEBUG_TOOL';\r\n```sql\n\nüîí Ogni store process nuova/futura dovr√† sempre seguire queste linee guida.","size_chars":1089,"tokens_estimate":272}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":121,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":122,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n 'Domande a cui risponde' @\"\r\n- Cosa fa?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":281,"tokens_estimate":70}
{"doc_id":"ew-stored-procedure","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md","title":"EasyWay Data Portal - STORE PROCEDURE: Linee Guida, Best Practice e Template","owner":"","tags":["artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Collegamenti\r","anchor_slug":"collegamenti","chunk_index":123,"content":"## Collegamenti\r\n- [Entities Index](../../../../../entities-index.md)","size_chars":69,"tokens_estimate":17}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"a) **sp_insert_configuration**\r","anchor_slug":"a-spinsertconfiguration","chunk_index":1,"content":"### a) **sp_insert_configuration**\n\n```sql\n\n--INIZIO SEZIONE STORE PROCEDURE CONFIGURATION \r\n--STORE PROCEDURE ‚Äì INSERT CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_configuration\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @config_key NVARCHAR(100),\r\n    @config_value NVARCHAR(MAX),\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = 1,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.CONFIGURATION\r\n            WHERE tenant_id = @tenant_id AND config_key = @config_key\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.CONFIGURATION (\r\n                tenant_id, config_key, config_value, description, is_active, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @config_key, @config_value, @description, @is_active,\r\n                COALESCE(@created_by, 'sp_insert_configuration')\r\n            );\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_configuration',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @config_key AS config_key, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n\r\n```sql","size_chars":2181,"tokens_estimate":545}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_configuration**\r","anchor_slug":"b-spupdateconfiguration","chunk_index":2,"content":"### b) **sp_update_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì UPDATE CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_configuration\r\n    @id INT,\r\n    @config_value NVARCHAR(MAX) = NULL,\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.CONFIGURATION\r\n        SET\r\n            config_value = COALESCE(@config_value, config_value),\r\n            description = COALESCE(@description, description),\r\n            is_active = COALESCE(@is_active, is_active),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_configuration')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_configuration',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":1870,"tokens_estimate":468}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_configuration**\r","anchor_slug":"c-spdeleteconfiguration","chunk_index":3,"content":"### c) **sp_delete_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì UPDATE CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_configuration\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.CONFIGURATION WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_configuration',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql","size_chars":1436,"tokens_estimate":359}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_configuration**\r","anchor_slug":"d-spdebuginsertconfiguration","chunk_index":4,"content":"### d) **sp_debug_insert_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì INSERT DEBUG CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_configuration\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @config_key NVARCHAR(100),\r\n    @config_value NVARCHAR(MAX),\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = 1,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.CONFIGURATION (\r\n            tenant_id, config_key, config_value, description, is_active, created_by\r\n        )\r\n        VALUES (\r\n            @tenant_id, @config_key, @config_value, @description, @is_active,\r\n            COALESCE(@created_by, 'sp_debug_insert_configuration')\r\n        );\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_configuration',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @config_key AS config_key, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n--FINE SEZIONE STORE PROCEDURE CONFIGURATION \n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---\n\nPrompt esempio:\r\n> Imposta per il tenant TEN00000001001 la configurazione MAX_FILE_SIZE_MB a 50\n\n```sql\r\nEXEC PORTAL.sp_insert_configuration @tenant_id = 'TEN00000001001', @config_key = 'MAX_FILE_SIZE_MB', @config_value = '50', @created_by = 'chatbot_ams';\r\n```sql","size_chars":2312,"tokens_estimate":578}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_configuration**\r","anchor_slug":"d-spdebuginsertconfiguration","chunk_index":5,"content":"Risposta bot:\r\n| status | tenant_id | config_key | error_message | rows_inserted |\r\n| --- | --- | --- | --- | --- |\r\n| OK | TEN00000001001 | MAX_FILE_SIZE_MB | NULL | 1 |","size_chars":170,"tokens_estimate":42}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":6,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":7,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":8,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  ### a) **sp_insert_configuration**\n\n```sql\n\n--INIZIO SEZIONE STORE PROCEDURE CONFIGURATION \r\n--STORE PROCEDURE ‚Äì INSERT CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_configuration\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @config_key NVARCHAR(100),\r\n    @config_value NVARCHAR(MAX),\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = 1,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.CONFIGURATION\r\n            WHERE tenant_id = @tenant_id AND config_key = @config_key\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.CONFIGURATION (\r\n                tenant_id, config_key, config_value, description, is_active, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @config_key, @config_value, @description, @is_active,\r\n                COALESCE(@created_by, 'sp_insert_configuration')\r\n            );\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_configuration',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @config_key AS config_key, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n\r\n```sql","size_chars":2305,"tokens_estimate":576}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_configuration**\r","anchor_slug":"b-spupdateconfiguration","chunk_index":9,"content":"### b) **sp_update_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì UPDATE CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_configuration\r\n    @id INT,\r\n    @config_value NVARCHAR(MAX) = NULL,\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.CONFIGURATION\r\n        SET\r\n            config_value = COALESCE(@config_value, config_value),\r\n            description = COALESCE(@description, description),\r\n            is_active = COALESCE(@is_active, is_active),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_configuration')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_configuration',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":1870,"tokens_estimate":468}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_configuration**\r","anchor_slug":"c-spdeleteconfiguration","chunk_index":10,"content":"### c) **sp_delete_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì UPDATE CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_configuration\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.CONFIGURATION WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_configuration',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql","size_chars":1436,"tokens_estimate":359}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_configuration**\r","anchor_slug":"d-spdebuginsertconfiguration","chunk_index":11,"content":"### d) **sp_debug_insert_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì INSERT DEBUG CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_configuration\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @config_key NVARCHAR(100),\r\n    @config_value NVARCHAR(MAX),\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = 1,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.CONFIGURATION (\r\n            tenant_id, config_key, config_value, description, is_active, created_by\r\n        )\r\n        VALUES (\r\n            @tenant_id, @config_key, @config_value, @description, @is_active,\r\n            COALESCE(@created_by, 'sp_debug_insert_configuration')\r\n        );\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_configuration',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @config_key AS config_key, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n--FINE SEZIONE STORE PROCEDURE CONFIGURATION \n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---\n\nPrompt esempio:\r\n> Imposta per il tenant TEN00000001001 la configurazione MAX_FILE_SIZE_MB a 50\n\n```sql\r\nEXEC PORTAL.sp_insert_configuration @tenant_id = 'TEN00000001001', @config_key = 'MAX_FILE_SIZE_MB', @config_value = '50', @created_by = 'chatbot_ams';\r\n```sql","size_chars":2312,"tokens_estimate":578}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_configuration**\r","anchor_slug":"d-spdebuginsertconfiguration","chunk_index":12,"content":"Risposta bot:\r\n| status | tenant_id | config_key | error_message | rows_inserted |\r\n| --- | --- | --- | --- | --- |\r\n| OK | TEN00000001001 | MAX_FILE_SIZE_MB | NULL | 1 |","size_chars":170,"tokens_estimate":42}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":13,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":14,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section ### a) **sp_insert_configuration**\n\n```sql\n\n--INIZIO SEZIONE STORE PROCEDURE CONFIGURATION \r\n--STORE PROCEDURE ‚Äì INSERT CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_configuration\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @config_key NVARCHAR(100),\r\n    @config_value NVARCHAR(MAX),\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = 1,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.CONFIGURATION\r\n            WHERE tenant_id = @tenant_id AND config_key = @config_key\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.CONFIGURATION (\r\n                tenant_id, config_key, config_value, description, is_active, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @config_key, @config_value, @description, @is_active,\r\n                COALESCE(@created_by, 'sp_insert_configuration')\r\n            );\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_configuration',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @config_key AS config_key, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n\r\n```sql","size_chars":2255,"tokens_estimate":564}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_configuration**\r","anchor_slug":"b-spupdateconfiguration","chunk_index":15,"content":"### b) **sp_update_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì UPDATE CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_configuration\r\n    @id INT,\r\n    @config_value NVARCHAR(MAX) = NULL,\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.CONFIGURATION\r\n        SET\r\n            config_value = COALESCE(@config_value, config_value),\r\n            description = COALESCE(@description, description),\r\n            is_active = COALESCE(@is_active, is_active),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_configuration')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_configuration',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":1870,"tokens_estimate":468}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_configuration**\r","anchor_slug":"c-spdeleteconfiguration","chunk_index":16,"content":"### c) **sp_delete_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì UPDATE CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_configuration\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.CONFIGURATION WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_configuration',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql","size_chars":1436,"tokens_estimate":359}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_configuration**\r","anchor_slug":"d-spdebuginsertconfiguration","chunk_index":17,"content":"### d) **sp_debug_insert_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì INSERT DEBUG CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_configuration\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @config_key NVARCHAR(100),\r\n    @config_value NVARCHAR(MAX),\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = 1,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.CONFIGURATION (\r\n            tenant_id, config_key, config_value, description, is_active, created_by\r\n        )\r\n        VALUES (\r\n            @tenant_id, @config_key, @config_value, @description, @is_active,\r\n            COALESCE(@created_by, 'sp_debug_insert_configuration')\r\n        );\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_configuration',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @config_key AS config_key, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n--FINE SEZIONE STORE PROCEDURE CONFIGURATION \n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---\n\nPrompt esempio:\r\n> Imposta per il tenant TEN00000001001 la configurazione MAX_FILE_SIZE_MB a 50\n\n```sql\r\nEXEC PORTAL.sp_insert_configuration @tenant_id = 'TEN00000001001', @config_key = 'MAX_FILE_SIZE_MB', @config_value = '50', @created_by = 'chatbot_ams';\r\n```sql","size_chars":2312,"tokens_estimate":578}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_configuration**\r","anchor_slug":"d-spdebuginsertconfiguration","chunk_index":18,"content":"Risposta bot:\r\n| status | tenant_id | config_key | error_message | rows_inserted |\r\n| --- | --- | --- | --- | --- |\r\n| OK | TEN00000001001 | MAX_FILE_SIZE_MB | NULL | 1 |","size_chars":170,"tokens_estimate":42}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":19,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":20,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->","size_chars":125,"tokens_estimate":31}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":21,"content":"## Esempi Query\r\n`sql\r\n-- SELECT ... FROM ...\r\n`\r\n\"@\r\n  ### a) **sp_insert_configuration**\n\n```sql\n\n--INIZIO SEZIONE STORE PROCEDURE CONFIGURATION \r\n--STORE PROCEDURE ‚Äì INSERT CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_configuration\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @config_key NVARCHAR(100),\r\n    @config_value NVARCHAR(MAX),\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = 1,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.CONFIGURATION\r\n            WHERE tenant_id = @tenant_id AND config_key = @config_key\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.CONFIGURATION (\r\n                tenant_id, config_key, config_value, description, is_active, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @config_key, @config_value, @description, @is_active,\r\n                COALESCE(@created_by, 'sp_insert_configuration')\r\n            );\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_configuration',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @config_key AS config_key, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n\r\n```sql","size_chars":2237,"tokens_estimate":559}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_configuration**\r","anchor_slug":"b-spupdateconfiguration","chunk_index":22,"content":"### b) **sp_update_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì UPDATE CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_configuration\r\n    @id INT,\r\n    @config_value NVARCHAR(MAX) = NULL,\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.CONFIGURATION\r\n        SET\r\n            config_value = COALESCE(@config_value, config_value),\r\n            description = COALESCE(@description, description),\r\n            is_active = COALESCE(@is_active, is_active),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_configuration')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_configuration',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":1870,"tokens_estimate":468}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_configuration**\r","anchor_slug":"c-spdeleteconfiguration","chunk_index":23,"content":"### c) **sp_delete_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì UPDATE CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_configuration\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.CONFIGURATION WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_configuration',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql","size_chars":1436,"tokens_estimate":359}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_configuration**\r","anchor_slug":"d-spdebuginsertconfiguration","chunk_index":24,"content":"### d) **sp_debug_insert_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì INSERT DEBUG CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_configuration\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @config_key NVARCHAR(100),\r\n    @config_value NVARCHAR(MAX),\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = 1,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.CONFIGURATION (\r\n            tenant_id, config_key, config_value, description, is_active, created_by\r\n        )\r\n        VALUES (\r\n            @tenant_id, @config_key, @config_value, @description, @is_active,\r\n            COALESCE(@created_by, 'sp_debug_insert_configuration')\r\n        );\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_configuration',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @config_key AS config_key, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n--FINE SEZIONE STORE PROCEDURE CONFIGURATION \n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---\n\nPrompt esempio:\r\n> Imposta per il tenant TEN00000001001 la configurazione MAX_FILE_SIZE_MB a 50\n\n```sql\r\nEXEC PORTAL.sp_insert_configuration @tenant_id = 'TEN00000001001', @config_key = 'MAX_FILE_SIZE_MB', @config_value = '50', @created_by = 'chatbot_ams';\r\n```sql","size_chars":2312,"tokens_estimate":578}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_configuration**\r","anchor_slug":"d-spdebuginsertconfiguration","chunk_index":25,"content":"Risposta bot:\r\n| status | tenant_id | config_key | error_message | rows_inserted |\r\n| --- | --- | --- | --- | --- |\r\n| OK | TEN00000001001 | MAX_FILE_SIZE_MB | NULL | 1 |","size_chars":170,"tokens_estimate":42}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":26,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":27,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":28,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  ### a) **sp_insert_configuration**\n\n```sql\n\n--INIZIO SEZIONE STORE PROCEDURE CONFIGURATION \r\n--STORE PROCEDURE ‚Äì INSERT CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_configuration\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @config_key NVARCHAR(100),\r\n    @config_value NVARCHAR(MAX),\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = 1,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.CONFIGURATION\r\n            WHERE tenant_id = @tenant_id AND config_key = @config_key\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.CONFIGURATION (\r\n                tenant_id, config_key, config_value, description, is_active, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @config_key, @config_value, @description, @is_active,\r\n                COALESCE(@created_by, 'sp_insert_configuration')\r\n            );\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_configuration',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @config_key AS config_key, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n\r\n```sql","size_chars":2305,"tokens_estimate":576}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_configuration**\r","anchor_slug":"b-spupdateconfiguration","chunk_index":29,"content":"### b) **sp_update_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì UPDATE CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_configuration\r\n    @id INT,\r\n    @config_value NVARCHAR(MAX) = NULL,\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.CONFIGURATION\r\n        SET\r\n            config_value = COALESCE(@config_value, config_value),\r\n            description = COALESCE(@description, description),\r\n            is_active = COALESCE(@is_active, is_active),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_configuration')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_configuration',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":1870,"tokens_estimate":468}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_configuration**\r","anchor_slug":"c-spdeleteconfiguration","chunk_index":30,"content":"### c) **sp_delete_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì UPDATE CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_configuration\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.CONFIGURATION WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_configuration',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql","size_chars":1436,"tokens_estimate":359}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_configuration**\r","anchor_slug":"d-spdebuginsertconfiguration","chunk_index":31,"content":"### d) **sp_debug_insert_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì INSERT DEBUG CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_configuration\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @config_key NVARCHAR(100),\r\n    @config_value NVARCHAR(MAX),\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = 1,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.CONFIGURATION (\r\n            tenant_id, config_key, config_value, description, is_active, created_by\r\n        )\r\n        VALUES (\r\n            @tenant_id, @config_key, @config_value, @description, @is_active,\r\n            COALESCE(@created_by, 'sp_debug_insert_configuration')\r\n        );\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_configuration',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @config_key AS config_key, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n--FINE SEZIONE STORE PROCEDURE CONFIGURATION \n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---\n\nPrompt esempio:\r\n> Imposta per il tenant TEN00000001001 la configurazione MAX_FILE_SIZE_MB a 50\n\n```sql\r\nEXEC PORTAL.sp_insert_configuration @tenant_id = 'TEN00000001001', @config_key = 'MAX_FILE_SIZE_MB', @config_value = '50', @created_by = 'chatbot_ams';\r\n```sql","size_chars":2312,"tokens_estimate":578}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_configuration**\r","anchor_slug":"d-spdebuginsertconfiguration","chunk_index":32,"content":"Risposta bot:\r\n| status | tenant_id | config_key | error_message | rows_inserted |\r\n| --- | --- | --- | --- | --- |\r\n| OK | TEN00000001001 | MAX_FILE_SIZE_MB | NULL | 1 |","size_chars":170,"tokens_estimate":42}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":33,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":34,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section ### a) **sp_insert_configuration**\n\n```sql\n\n--INIZIO SEZIONE STORE PROCEDURE CONFIGURATION \r\n--STORE PROCEDURE ‚Äì INSERT CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_configuration\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @config_key NVARCHAR(100),\r\n    @config_value NVARCHAR(MAX),\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = 1,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.CONFIGURATION\r\n            WHERE tenant_id = @tenant_id AND config_key = @config_key\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.CONFIGURATION (\r\n                tenant_id, config_key, config_value, description, is_active, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @config_key, @config_value, @description, @is_active,\r\n                COALESCE(@created_by, 'sp_insert_configuration')\r\n            );\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_configuration',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @config_key AS config_key, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n\r\n```sql","size_chars":2255,"tokens_estimate":564}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_configuration**\r","anchor_slug":"b-spupdateconfiguration","chunk_index":35,"content":"### b) **sp_update_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì UPDATE CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_configuration\r\n    @id INT,\r\n    @config_value NVARCHAR(MAX) = NULL,\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.CONFIGURATION\r\n        SET\r\n            config_value = COALESCE(@config_value, config_value),\r\n            description = COALESCE(@description, description),\r\n            is_active = COALESCE(@is_active, is_active),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_configuration')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_configuration',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":1870,"tokens_estimate":468}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_configuration**\r","anchor_slug":"c-spdeleteconfiguration","chunk_index":36,"content":"### c) **sp_delete_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì UPDATE CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_configuration\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.CONFIGURATION WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_configuration',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql","size_chars":1436,"tokens_estimate":359}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_configuration**\r","anchor_slug":"d-spdebuginsertconfiguration","chunk_index":37,"content":"### d) **sp_debug_insert_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì INSERT DEBUG CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_configuration\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @config_key NVARCHAR(100),\r\n    @config_value NVARCHAR(MAX),\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = 1,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.CONFIGURATION (\r\n            tenant_id, config_key, config_value, description, is_active, created_by\r\n        )\r\n        VALUES (\r\n            @tenant_id, @config_key, @config_value, @description, @is_active,\r\n            COALESCE(@created_by, 'sp_debug_insert_configuration')\r\n        );\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_configuration',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @config_key AS config_key, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n--FINE SEZIONE STORE PROCEDURE CONFIGURATION \n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---\n\nPrompt esempio:\r\n> Imposta per il tenant TEN00000001001 la configurazione MAX_FILE_SIZE_MB a 50\n\n```sql\r\nEXEC PORTAL.sp_insert_configuration @tenant_id = 'TEN00000001001', @config_key = 'MAX_FILE_SIZE_MB', @config_value = '50', @created_by = 'chatbot_ams';\r\n```sql","size_chars":2312,"tokens_estimate":578}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_configuration**\r","anchor_slug":"d-spdebuginsertconfiguration","chunk_index":38,"content":"Risposta bot:\r\n| status | tenant_id | config_key | error_message | rows_inserted |\r\n| --- | --- | --- | --- | --- |\r\n| OK | TEN00000001001 | MAX_FILE_SIZE_MB | NULL | 1 |","size_chars":170,"tokens_estimate":42}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":39,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":40,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n = Ensure-Section ### a) **sp_insert_configuration**\n\n```sql\n\n--INIZIO SEZIONE STORE PROCEDURE CONFIGURATION \r\n--STORE PROCEDURE ‚Äì INSERT CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_configuration\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @config_key NVARCHAR(100),\r\n    @config_value NVARCHAR(MAX),\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = 1,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.CONFIGURATION\r\n            WHERE tenant_id = @tenant_id AND config_key = @config_key\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.CONFIGURATION (\r\n                tenant_id, config_key, config_value, description, is_active, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @config_key, @config_value, @description, @is_active,\r\n                COALESCE(@created_by, 'sp_insert_configuration')\r\n            );\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_configuration',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @config_key AS config_key, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n\r\n```sql","size_chars":2326,"tokens_estimate":582}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_configuration**\r","anchor_slug":"b-spupdateconfiguration","chunk_index":41,"content":"### b) **sp_update_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì UPDATE CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_configuration\r\n    @id INT,\r\n    @config_value NVARCHAR(MAX) = NULL,\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.CONFIGURATION\r\n        SET\r\n            config_value = COALESCE(@config_value, config_value),\r\n            description = COALESCE(@description, description),\r\n            is_active = COALESCE(@is_active, is_active),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_configuration')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_configuration',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":1870,"tokens_estimate":468}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_configuration**\r","anchor_slug":"c-spdeleteconfiguration","chunk_index":42,"content":"### c) **sp_delete_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì UPDATE CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_configuration\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.CONFIGURATION WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_configuration',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql","size_chars":1436,"tokens_estimate":359}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_configuration**\r","anchor_slug":"d-spdebuginsertconfiguration","chunk_index":43,"content":"### d) **sp_debug_insert_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì INSERT DEBUG CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_configuration\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @config_key NVARCHAR(100),\r\n    @config_value NVARCHAR(MAX),\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = 1,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.CONFIGURATION (\r\n            tenant_id, config_key, config_value, description, is_active, created_by\r\n        )\r\n        VALUES (\r\n            @tenant_id, @config_key, @config_value, @description, @is_active,\r\n            COALESCE(@created_by, 'sp_debug_insert_configuration')\r\n        );\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_configuration',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @config_key AS config_key, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n--FINE SEZIONE STORE PROCEDURE CONFIGURATION \n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---\n\nPrompt esempio:\r\n> Imposta per il tenant TEN00000001001 la configurazione MAX_FILE_SIZE_MB a 50\n\n```sql\r\nEXEC PORTAL.sp_insert_configuration @tenant_id = 'TEN00000001001', @config_key = 'MAX_FILE_SIZE_MB', @config_value = '50', @created_by = 'chatbot_ams';\r\n```sql","size_chars":2312,"tokens_estimate":578}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_configuration**\r","anchor_slug":"d-spdebuginsertconfiguration","chunk_index":44,"content":"Risposta bot:\r\n| status | tenant_id | config_key | error_message | rows_inserted |\r\n| --- | --- | --- | --- | --- |\r\n| OK | TEN00000001001 | MAX_FILE_SIZE_MB | NULL | 1 |","size_chars":170,"tokens_estimate":42}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":45,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":46,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":47,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  ### a) **sp_insert_configuration**\n\n```sql\n\n--INIZIO SEZIONE STORE PROCEDURE CONFIGURATION \r\n--STORE PROCEDURE ‚Äì INSERT CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_configuration\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @config_key NVARCHAR(100),\r\n    @config_value NVARCHAR(MAX),\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = 1,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.CONFIGURATION\r\n            WHERE tenant_id = @tenant_id AND config_key = @config_key\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.CONFIGURATION (\r\n                tenant_id, config_key, config_value, description, is_active, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @config_key, @config_value, @description, @is_active,\r\n                COALESCE(@created_by, 'sp_insert_configuration')\r\n            );\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_configuration',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @config_key AS config_key, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n\r\n```sql","size_chars":2305,"tokens_estimate":576}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_configuration**\r","anchor_slug":"b-spupdateconfiguration","chunk_index":48,"content":"### b) **sp_update_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì UPDATE CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_configuration\r\n    @id INT,\r\n    @config_value NVARCHAR(MAX) = NULL,\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.CONFIGURATION\r\n        SET\r\n            config_value = COALESCE(@config_value, config_value),\r\n            description = COALESCE(@description, description),\r\n            is_active = COALESCE(@is_active, is_active),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_configuration')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_configuration',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":1870,"tokens_estimate":468}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_configuration**\r","anchor_slug":"c-spdeleteconfiguration","chunk_index":49,"content":"### c) **sp_delete_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì UPDATE CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_configuration\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.CONFIGURATION WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_configuration',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql","size_chars":1436,"tokens_estimate":359}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_configuration**\r","anchor_slug":"d-spdebuginsertconfiguration","chunk_index":50,"content":"### d) **sp_debug_insert_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì INSERT DEBUG CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_configuration\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @config_key NVARCHAR(100),\r\n    @config_value NVARCHAR(MAX),\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = 1,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.CONFIGURATION (\r\n            tenant_id, config_key, config_value, description, is_active, created_by\r\n        )\r\n        VALUES (\r\n            @tenant_id, @config_key, @config_value, @description, @is_active,\r\n            COALESCE(@created_by, 'sp_debug_insert_configuration')\r\n        );\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_configuration',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @config_key AS config_key, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n--FINE SEZIONE STORE PROCEDURE CONFIGURATION \n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---\n\nPrompt esempio:\r\n> Imposta per il tenant TEN00000001001 la configurazione MAX_FILE_SIZE_MB a 50\n\n```sql\r\nEXEC PORTAL.sp_insert_configuration @tenant_id = 'TEN00000001001', @config_key = 'MAX_FILE_SIZE_MB', @config_value = '50', @created_by = 'chatbot_ams';\r\n```sql","size_chars":2312,"tokens_estimate":578}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_configuration**\r","anchor_slug":"d-spdebuginsertconfiguration","chunk_index":51,"content":"Risposta bot:\r\n| status | tenant_id | config_key | error_message | rows_inserted |\r\n| --- | --- | --- | --- | --- |\r\n| OK | TEN00000001001 | MAX_FILE_SIZE_MB | NULL | 1 |","size_chars":170,"tokens_estimate":42}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":52,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":53,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section ### a) **sp_insert_configuration**\n\n```sql\n\n--INIZIO SEZIONE STORE PROCEDURE CONFIGURATION \r\n--STORE PROCEDURE ‚Äì INSERT CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_configuration\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @config_key NVARCHAR(100),\r\n    @config_value NVARCHAR(MAX),\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = 1,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.CONFIGURATION\r\n            WHERE tenant_id = @tenant_id AND config_key = @config_key\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.CONFIGURATION (\r\n                tenant_id, config_key, config_value, description, is_active, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @config_key, @config_value, @description, @is_active,\r\n                COALESCE(@created_by, 'sp_insert_configuration')\r\n            );\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_configuration',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @config_key AS config_key, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n\r\n```sql","size_chars":2255,"tokens_estimate":564}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_configuration**\r","anchor_slug":"b-spupdateconfiguration","chunk_index":54,"content":"### b) **sp_update_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì UPDATE CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_configuration\r\n    @id INT,\r\n    @config_value NVARCHAR(MAX) = NULL,\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.CONFIGURATION\r\n        SET\r\n            config_value = COALESCE(@config_value, config_value),\r\n            description = COALESCE(@description, description),\r\n            is_active = COALESCE(@is_active, is_active),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_configuration')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_configuration',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":1870,"tokens_estimate":468}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_configuration**\r","anchor_slug":"c-spdeleteconfiguration","chunk_index":55,"content":"### c) **sp_delete_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì UPDATE CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_configuration\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.CONFIGURATION WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_configuration',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql","size_chars":1436,"tokens_estimate":359}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_configuration**\r","anchor_slug":"d-spdebuginsertconfiguration","chunk_index":56,"content":"### d) **sp_debug_insert_configuration**\n\n```sql\r\n--STORE PROCEDURE ‚Äì INSERT DEBUG CONFIGURATION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_configuration\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @config_key NVARCHAR(100),\r\n    @config_value NVARCHAR(MAX),\r\n    @description NVARCHAR(255) = NULL,\r\n    @is_active BIT = 1,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.CONFIGURATION (\r\n            tenant_id, config_key, config_value, description, is_active, created_by\r\n        )\r\n        VALUES (\r\n            @tenant_id, @config_key, @config_value, @description, @is_active,\r\n            COALESCE(@created_by, 'sp_debug_insert_configuration')\r\n        );\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_configuration');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_configuration',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.CONFIGURATION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @config_key AS config_key, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n--FINE SEZIONE STORE PROCEDURE CONFIGURATION \n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---\n\nPrompt esempio:\r\n> Imposta per il tenant TEN00000001001 la configurazione MAX_FILE_SIZE_MB a 50\n\n```sql\r\nEXEC PORTAL.sp_insert_configuration @tenant_id = 'TEN00000001001', @config_key = 'MAX_FILE_SIZE_MB', @config_value = '50', @created_by = 'chatbot_ams';\r\n```sql","size_chars":2312,"tokens_estimate":578}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_configuration**\r","anchor_slug":"d-spdebuginsertconfiguration","chunk_index":57,"content":"Risposta bot:\r\n| status | tenant_id | config_key | error_message | rows_inserted |\r\n| --- | --- | --- | --- | --- |\r\n| OK | TEN00000001001 | MAX_FILE_SIZE_MB | NULL | 1 |","size_chars":170,"tokens_estimate":42}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":58,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":59,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n 'Domande a cui risponde' @\"\r\n- Cosa fa?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":281,"tokens_estimate":70}
{"doc_id":"ew-configuration","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/configuration.md","title":"a) **sp_insert_configuration**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Collegamenti\r","anchor_slug":"collegamenti","chunk_index":60,"content":"## Collegamenti\r\n- [Entities Index](../../../../../../entities-index.md)","size_chars":72,"tokens_estimate":18}
{"doc_id":"index","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/index.md","title":"Indice","owner":"team-data","tags":["artifact/stored-procedure","layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":1,"content":"## Domande a cui risponde\r\n- Quali stored procedure sono disponibili nello schema PORTAL?\r\n- Dove trovare la firma, gli input/output e gli esempi di invocazione?\r\n- Come sono gestiti idempotenza, indici/FK/check e rollback?\r\n- Dove verificare policy, logging e collegamenti a entit√† correlate?","size_chars":293,"tokens_estimate":73}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"a) **sp_insert_profile_domain**\r","anchor_slug":"a-spinsertprofiledomain","chunk_index":1,"content":"### a) **sp_insert_profile_domain**\n\n```sql\r\n-- INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code)\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, ext_attributes, created_by)\r\n            VALUES (@profile_code, @description, @ext_attributes, COALESCE(@created_by, 'sp_insert_profile_domain'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_profile_domain',\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":1824,"tokens_estimate":456}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"a) **sp_insert_profile_domain**\r","anchor_slug":"a-spinsertprofiledomain","chunk_index":2,"content":"\r\n```sql\r\n-- UPDATE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.PROFILE_DOMAINS\r\n        SET\r\n            description = COALESCE(@description, description),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_profile_domain')\r\n        WHERE profile_code = @profile_code;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_profile_domain',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\r\n```sql","size_chars":1794,"tokens_estimate":448}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"a) **sp_insert_profile_domain**\r","anchor_slug":"a-spinsertprofiledomain","chunk_index":3,"content":"```sql\r\n-- DELETE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_profile_domain',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql\n\n```sql\r\n-- DEBUG (inserimento di profilo ACL per test/debug)\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code)\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, ext_attributes, created_by)\r\n            VALUES (@profile_code, @description, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_profile_domain'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN C","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"a) **sp_insert_profile_domain**\r","anchor_slug":"a-spinsertprofiledomain","chunk_index":4,"content":"ATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_profile_domain',\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql\n\n* * *","size_chars":898,"tokens_estimate":224}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":5,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":6,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":7,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  ### a) **sp_insert_profile_domain**\n\n```sql\r\n-- INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code)\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, ext_attributes, created_by)\r\n            VALUES (@profile_code, @description, @ext_attributes, COALESCE(@created_by, 'sp_insert_profile_domain'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_profile_domain',\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":1948,"tokens_estimate":487}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":8,"content":"\r\n```sql\r\n-- UPDATE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.PROFILE_DOMAINS\r\n        SET\r\n            description = COALESCE(@description, description),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_profile_domain')\r\n        WHERE profile_code = @profile_code;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_profile_domain',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\r\n```sql","size_chars":1794,"tokens_estimate":448}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":9,"content":"```sql\r\n-- DELETE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_profile_domain',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql\n\n```sql\r\n-- DEBUG (inserimento di profilo ACL per test/debug)\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code)\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, ext_attributes, created_by)\r\n            VALUES (@profile_code, @description, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_profile_domain'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN C","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":10,"content":"ATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_profile_domain',\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql\n\n* * *","size_chars":898,"tokens_estimate":224}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":11,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":12,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section ### a) **sp_insert_profile_domain**\n\n```sql\r\n-- INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code)\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, ext_attributes, created_by)\r\n            VALUES (@profile_code, @description, @ext_attributes, COALESCE(@created_by, 'sp_insert_profile_domain'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_profile_domain',\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":1898,"tokens_estimate":474}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":13,"content":"\r\n```sql\r\n-- UPDATE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.PROFILE_DOMAINS\r\n        SET\r\n            description = COALESCE(@description, description),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_profile_domain')\r\n        WHERE profile_code = @profile_code;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_profile_domain',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\r\n```sql","size_chars":1794,"tokens_estimate":448}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":14,"content":"```sql\r\n-- DELETE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_profile_domain',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql\n\n```sql\r\n-- DEBUG (inserimento di profilo ACL per test/debug)\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code)\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, ext_attributes, created_by)\r\n            VALUES (@profile_code, @description, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_profile_domain'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN C","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":15,"content":"ATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_profile_domain',\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql\n\n* * *","size_chars":898,"tokens_estimate":224}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":16,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":17,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->","size_chars":125,"tokens_estimate":31}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":18,"content":"## Esempi Query\r\n`sql\r\n-- SELECT ... FROM ...\r\n`\r\n\"@\r\n  ### a) **sp_insert_profile_domain**\n\n```sql\r\n-- INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code)\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, ext_attributes, created_by)\r\n            VALUES (@profile_code, @description, @ext_attributes, COALESCE(@created_by, 'sp_insert_profile_domain'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_profile_domain',\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":1880,"tokens_estimate":470}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":19,"content":"\r\n```sql\r\n-- UPDATE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.PROFILE_DOMAINS\r\n        SET\r\n            description = COALESCE(@description, description),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_profile_domain')\r\n        WHERE profile_code = @profile_code;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_profile_domain',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\r\n```sql","size_chars":1794,"tokens_estimate":448}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":20,"content":"```sql\r\n-- DELETE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_profile_domain',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql\n\n```sql\r\n-- DEBUG (inserimento di profilo ACL per test/debug)\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code)\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, ext_attributes, created_by)\r\n            VALUES (@profile_code, @description, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_profile_domain'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN C","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":21,"content":"ATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_profile_domain',\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql\n\n* * *","size_chars":898,"tokens_estimate":224}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":22,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":23,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":24,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  ### a) **sp_insert_profile_domain**\n\n```sql\r\n-- INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code)\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, ext_attributes, created_by)\r\n            VALUES (@profile_code, @description, @ext_attributes, COALESCE(@created_by, 'sp_insert_profile_domain'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_profile_domain',\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":1948,"tokens_estimate":487}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":25,"content":"\r\n```sql\r\n-- UPDATE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.PROFILE_DOMAINS\r\n        SET\r\n            description = COALESCE(@description, description),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_profile_domain')\r\n        WHERE profile_code = @profile_code;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_profile_domain',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\r\n```sql","size_chars":1794,"tokens_estimate":448}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":26,"content":"```sql\r\n-- DELETE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_profile_domain',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql\n\n```sql\r\n-- DEBUG (inserimento di profilo ACL per test/debug)\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code)\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, ext_attributes, created_by)\r\n            VALUES (@profile_code, @description, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_profile_domain'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN C","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":27,"content":"ATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_profile_domain',\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql\n\n* * *","size_chars":898,"tokens_estimate":224}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":28,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":29,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section ### a) **sp_insert_profile_domain**\n\n```sql\r\n-- INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code)\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, ext_attributes, created_by)\r\n            VALUES (@profile_code, @description, @ext_attributes, COALESCE(@created_by, 'sp_insert_profile_domain'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_profile_domain',\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":1898,"tokens_estimate":474}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":30,"content":"\r\n```sql\r\n-- UPDATE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.PROFILE_DOMAINS\r\n        SET\r\n            description = COALESCE(@description, description),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_profile_domain')\r\n        WHERE profile_code = @profile_code;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_profile_domain',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\r\n```sql","size_chars":1794,"tokens_estimate":448}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":31,"content":"```sql\r\n-- DELETE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_profile_domain',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql\n\n```sql\r\n-- DEBUG (inserimento di profilo ACL per test/debug)\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code)\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, ext_attributes, created_by)\r\n            VALUES (@profile_code, @description, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_profile_domain'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN C","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":32,"content":"ATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_profile_domain',\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql\n\n* * *","size_chars":898,"tokens_estimate":224}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":33,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":34,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n = Ensure-Section ### a) **sp_insert_profile_domain**\n\n```sql\r\n-- INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code)\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, ext_attributes, created_by)\r\n            VALUES (@profile_code, @description, @ext_attributes, COALESCE(@created_by, 'sp_insert_profile_domain'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_profile_domain',\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":1969,"tokens_estimate":492}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":35,"content":"\r\n```sql\r\n-- UPDATE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.PROFILE_DOMAINS\r\n        SET\r\n            description = COALESCE(@description, description),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_profile_domain')\r\n        WHERE profile_code = @profile_code;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_profile_domain',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\r\n```sql","size_chars":1794,"tokens_estimate":448}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":36,"content":"```sql\r\n-- DELETE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_profile_domain',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql\n\n```sql\r\n-- DEBUG (inserimento di profilo ACL per test/debug)\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code)\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, ext_attributes, created_by)\r\n            VALUES (@profile_code, @description, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_profile_domain'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN C","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":37,"content":"ATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_profile_domain',\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql\n\n* * *","size_chars":898,"tokens_estimate":224}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":38,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":39,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":40,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  ### a) **sp_insert_profile_domain**\n\n```sql\r\n-- INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code)\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, ext_attributes, created_by)\r\n            VALUES (@profile_code, @description, @ext_attributes, COALESCE(@created_by, 'sp_insert_profile_domain'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_profile_domain',\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":1948,"tokens_estimate":487}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":41,"content":"\r\n```sql\r\n-- UPDATE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.PROFILE_DOMAINS\r\n        SET\r\n            description = COALESCE(@description, description),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_profile_domain')\r\n        WHERE profile_code = @profile_code;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_profile_domain',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\r\n```sql","size_chars":1794,"tokens_estimate":448}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":42,"content":"```sql\r\n-- DELETE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_profile_domain',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql\n\n```sql\r\n-- DEBUG (inserimento di profilo ACL per test/debug)\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code)\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, ext_attributes, created_by)\r\n            VALUES (@profile_code, @description, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_profile_domain'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN C","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":43,"content":"ATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_profile_domain',\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql\n\n* * *","size_chars":898,"tokens_estimate":224}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":44,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":45,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section ### a) **sp_insert_profile_domain**\n\n```sql\r\n-- INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code)\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, ext_attributes, created_by)\r\n            VALUES (@profile_code, @description, @ext_attributes, COALESCE(@created_by, 'sp_insert_profile_domain'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_profile_domain',\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":1898,"tokens_estimate":474}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":46,"content":"\r\n```sql\r\n-- UPDATE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.PROFILE_DOMAINS\r\n        SET\r\n            description = COALESCE(@description, description),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_profile_domain')\r\n        WHERE profile_code = @profile_code;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_profile_domain',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\r\n```sql","size_chars":1794,"tokens_estimate":448}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":47,"content":"```sql\r\n-- DELETE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_profile_domain',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql\n\n```sql\r\n-- DEBUG (inserimento di profilo ACL per test/debug)\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_profile_domain\r\n    @profile_code NVARCHAR(50),\r\n    @description NVARCHAR(255) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.PROFILE_DOMAINS WHERE profile_code = @profile_code)\r\n        BEGIN\r\n            INSERT INTO PORTAL.PROFILE_DOMAINS (profile_code, description, ext_attributes, created_by)\r\n            VALUES (@profile_code, @description, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_profile_domain'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN C","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":48,"content":"ATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_profile_domain');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_profile_domain',\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @profile_code AS profile_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql\n\n* * *","size_chars":898,"tokens_estimate":224}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":49,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":50,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n 'Domande a cui risponde' @\"\r\n- Cosa fa?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":281,"tokens_estimate":70}
{"doc_id":"ew-profile-domains","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/profile-domains.md","title":"a) **sp_insert_profile_domain**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Collegamenti\r","anchor_slug":"collegamenti","chunk_index":51,"content":"## Collegamenti\r\n- [Entities Index](../../../../../../entities-index.md)","size_chars":72,"tokens_estimate":18}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"a) **sp_insert_section_access**\r","anchor_slug":"a-spinsertsectionaccess","chunk_index":1,"content":"### a) **sp_insert_section_access**\n\n```sql\r\n-- INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_section_access\r\n    @tenant_id NVARCHAR(50),\r\n    @section_code NVARCHAR(50),\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @is_enabled BIT,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SECTION_ACCESS (tenant_id, section_code, profile_code, user_id, is_enabled, valid_from, valid_to, ext_attributes, created_by)\r\n        VALUES (@tenant_id, @section_code, @profile_code, @user_id, @is_enabled, @valid_from, @valid_to, @ext_attributes, COALESCE(@created_by, 'sp_insert_section_access'));\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_section_access',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\r\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @section_code AS section_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":2014,"tokens_estimate":504}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_section_access**\r","anchor_slug":"b-spupdatesectionaccess","chunk_index":2,"content":"### b) **sp_update_section_access**\n\n```sql\r\n-- UPDATE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_section_access\r\n    @id INT,\r\n    @is_enabled BIT = NULL,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.SECTION_ACCESS\r\n        SET\r\n            is_enabled = COALESCE(@is_enabled, is_enabled),\r\n            valid_from = COALESCE(@valid_from, valid_from),\r\n            valid_to = COALESCE(@valid_to, valid_to),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_section_access')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_section_access',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\r\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":1938,"tokens_estimate":484}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_section_access**\r","anchor_slug":"c-spdeletesectionaccess","chunk_index":3,"content":"### c) **sp_delete_section_access**\n\n```sql\r\n-- DELETE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_section_access\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.SECTION_ACCESS WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_section_access',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\r\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql","size_chars":1411,"tokens_estimate":353}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_section_access**\r","anchor_slug":"d-spdebuginsertsectionaccess","chunk_index":4,"content":"### d) **sp_debug_insert_section_access**\n\n```sql\r\n-- DEBUG INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_section_access\r\n    @tenant_id NVARCHAR(50),\r\n    @section_code NVARCHAR(50),\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @is_enabled BIT,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SECTION_ACCESS (tenant_id, section_code, profile_code, user_id, is_enabled, valid_from, valid_to, ext_attributes, created_by)\r\n        VALUES (@tenant_id, @section_code, @profile_code, @user_id, @is_enabled, @valid_from, @valid_to, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_section_access'));\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_section_access',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\r\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @section_code AS section_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql","size_chars":2050,"tokens_estimate":512}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":5,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":6,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":7,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  ### a) **sp_insert_section_access**\n\n```sql\r\n-- INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_section_access\r\n    @tenant_id NVARCHAR(50),\r\n    @section_code NVARCHAR(50),\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @is_enabled BIT,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SECTION_ACCESS (tenant_id, section_code, profile_code, user_id, is_enabled, valid_from, valid_to, ext_attributes, created_by)\r\n        VALUES (@tenant_id, @section_code, @profile_code, @user_id, @is_enabled, @valid_from, @valid_to, @ext_attributes, COALESCE(@created_by, 'sp_insert_section_access'));\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_section_access',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\r\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @section_code AS section_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":2138,"tokens_estimate":534}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_section_access**\r","anchor_slug":"b-spupdatesectionaccess","chunk_index":8,"content":"### b) **sp_update_section_access**\n\n```sql\r\n-- UPDATE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_section_access\r\n    @id INT,\r\n    @is_enabled BIT = NULL,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.SECTION_ACCESS\r\n        SET\r\n            is_enabled = COALESCE(@is_enabled, is_enabled),\r\n            valid_from = COALESCE(@valid_from, valid_from),\r\n            valid_to = COALESCE(@valid_to, valid_to),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_section_access')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_section_access',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\r\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":1938,"tokens_estimate":484}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_section_access**\r","anchor_slug":"c-spdeletesectionaccess","chunk_index":9,"content":"### c) **sp_delete_section_access**\n\n```sql\r\n-- DELETE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_section_access\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.SECTION_ACCESS WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_section_access',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\r\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql","size_chars":1411,"tokens_estimate":353}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_section_access**\r","anchor_slug":"d-spdebuginsertsectionaccess","chunk_index":10,"content":"### d) **sp_debug_insert_section_access**\n\n```sql\r\n-- DEBUG INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_section_access\r\n    @tenant_id NVARCHAR(50),\r\n    @section_code NVARCHAR(50),\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @is_enabled BIT,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SECTION_ACCESS (tenant_id, section_code, profile_code, user_id, is_enabled, valid_from, valid_to, ext_attributes, created_by)\r\n        VALUES (@tenant_id, @section_code, @profile_code, @user_id, @is_enabled, @valid_from, @valid_to, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_section_access'));\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_section_access',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\r\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @section_code AS section_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql","size_chars":2050,"tokens_estimate":512}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":11,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":12,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section ### a) **sp_insert_section_access**\n\n```sql\r\n-- INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_section_access\r\n    @tenant_id NVARCHAR(50),\r\n    @section_code NVARCHAR(50),\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @is_enabled BIT,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SECTION_ACCESS (tenant_id, section_code, profile_code, user_id, is_enabled, valid_from, valid_to, ext_attributes, created_by)\r\n        VALUES (@tenant_id, @section_code, @profile_code, @user_id, @is_enabled, @valid_from, @valid_to, @ext_attributes, COALESCE(@created_by, 'sp_insert_section_access'));\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_section_access',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\r\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @section_code AS section_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":2088,"tokens_estimate":522}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_section_access**\r","anchor_slug":"b-spupdatesectionaccess","chunk_index":13,"content":"### b) **sp_update_section_access**\n\n```sql\r\n-- UPDATE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_section_access\r\n    @id INT,\r\n    @is_enabled BIT = NULL,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.SECTION_ACCESS\r\n        SET\r\n            is_enabled = COALESCE(@is_enabled, is_enabled),\r\n            valid_from = COALESCE(@valid_from, valid_from),\r\n            valid_to = COALESCE(@valid_to, valid_to),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_section_access')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_section_access',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\r\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":1938,"tokens_estimate":484}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_section_access**\r","anchor_slug":"c-spdeletesectionaccess","chunk_index":14,"content":"### c) **sp_delete_section_access**\n\n```sql\r\n-- DELETE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_section_access\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.SECTION_ACCESS WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_section_access',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\r\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql","size_chars":1411,"tokens_estimate":353}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_section_access**\r","anchor_slug":"d-spdebuginsertsectionaccess","chunk_index":15,"content":"### d) **sp_debug_insert_section_access**\n\n```sql\r\n-- DEBUG INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_section_access\r\n    @tenant_id NVARCHAR(50),\r\n    @section_code NVARCHAR(50),\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @is_enabled BIT,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SECTION_ACCESS (tenant_id, section_code, profile_code, user_id, is_enabled, valid_from, valid_to, ext_attributes, created_by)\r\n        VALUES (@tenant_id, @section_code, @profile_code, @user_id, @is_enabled, @valid_from, @valid_to, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_section_access'));\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_section_access',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\r\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @section_code AS section_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql","size_chars":2050,"tokens_estimate":512}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":16,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":17,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->","size_chars":125,"tokens_estimate":31}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":18,"content":"## Esempi Query\r\n`sql\r\n-- SELECT ... FROM ...\r\n`\r\n\"@\r\n  ### a) **sp_insert_section_access**\n\n```sql\r\n-- INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_section_access\r\n    @tenant_id NVARCHAR(50),\r\n    @section_code NVARCHAR(50),\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @is_enabled BIT,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SECTION_ACCESS (tenant_id, section_code, profile_code, user_id, is_enabled, valid_from, valid_to, ext_attributes, created_by)\r\n        VALUES (@tenant_id, @section_code, @profile_code, @user_id, @is_enabled, @valid_from, @valid_to, @ext_attributes, COALESCE(@created_by, 'sp_insert_section_access'));\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_section_access',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\r\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @section_code AS section_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":2070,"tokens_estimate":518}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_section_access**\r","anchor_slug":"b-spupdatesectionaccess","chunk_index":19,"content":"### b) **sp_update_section_access**\n\n```sql\r\n-- UPDATE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_section_access\r\n    @id INT,\r\n    @is_enabled BIT = NULL,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.SECTION_ACCESS\r\n        SET\r\n            is_enabled = COALESCE(@is_enabled, is_enabled),\r\n            valid_from = COALESCE(@valid_from, valid_from),\r\n            valid_to = COALESCE(@valid_to, valid_to),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_section_access')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_section_access',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\r\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":1938,"tokens_estimate":484}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_section_access**\r","anchor_slug":"c-spdeletesectionaccess","chunk_index":20,"content":"### c) **sp_delete_section_access**\n\n```sql\r\n-- DELETE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_section_access\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.SECTION_ACCESS WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_section_access',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\r\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql","size_chars":1411,"tokens_estimate":353}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_section_access**\r","anchor_slug":"d-spdebuginsertsectionaccess","chunk_index":21,"content":"### d) **sp_debug_insert_section_access**\n\n```sql\r\n-- DEBUG INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_section_access\r\n    @tenant_id NVARCHAR(50),\r\n    @section_code NVARCHAR(50),\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @is_enabled BIT,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SECTION_ACCESS (tenant_id, section_code, profile_code, user_id, is_enabled, valid_from, valid_to, ext_attributes, created_by)\r\n        VALUES (@tenant_id, @section_code, @profile_code, @user_id, @is_enabled, @valid_from, @valid_to, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_section_access'));\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_section_access',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\r\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @section_code AS section_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql","size_chars":2050,"tokens_estimate":512}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":22,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":23,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":24,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  ### a) **sp_insert_section_access**\n\n```sql\r\n-- INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_section_access\r\n    @tenant_id NVARCHAR(50),\r\n    @section_code NVARCHAR(50),\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @is_enabled BIT,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SECTION_ACCESS (tenant_id, section_code, profile_code, user_id, is_enabled, valid_from, valid_to, ext_attributes, created_by)\r\n        VALUES (@tenant_id, @section_code, @profile_code, @user_id, @is_enabled, @valid_from, @valid_to, @ext_attributes, COALESCE(@created_by, 'sp_insert_section_access'));\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_section_access',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\r\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @section_code AS section_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":2138,"tokens_estimate":534}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_section_access**\r","anchor_slug":"b-spupdatesectionaccess","chunk_index":25,"content":"### b) **sp_update_section_access**\n\n```sql\r\n-- UPDATE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_section_access\r\n    @id INT,\r\n    @is_enabled BIT = NULL,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.SECTION_ACCESS\r\n        SET\r\n            is_enabled = COALESCE(@is_enabled, is_enabled),\r\n            valid_from = COALESCE(@valid_from, valid_from),\r\n            valid_to = COALESCE(@valid_to, valid_to),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_section_access')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_section_access',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\r\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":1938,"tokens_estimate":484}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_section_access**\r","anchor_slug":"c-spdeletesectionaccess","chunk_index":26,"content":"### c) **sp_delete_section_access**\n\n```sql\r\n-- DELETE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_section_access\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.SECTION_ACCESS WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_section_access',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\r\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql","size_chars":1411,"tokens_estimate":353}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_section_access**\r","anchor_slug":"d-spdebuginsertsectionaccess","chunk_index":27,"content":"### d) **sp_debug_insert_section_access**\n\n```sql\r\n-- DEBUG INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_section_access\r\n    @tenant_id NVARCHAR(50),\r\n    @section_code NVARCHAR(50),\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @is_enabled BIT,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SECTION_ACCESS (tenant_id, section_code, profile_code, user_id, is_enabled, valid_from, valid_to, ext_attributes, created_by)\r\n        VALUES (@tenant_id, @section_code, @profile_code, @user_id, @is_enabled, @valid_from, @valid_to, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_section_access'));\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_section_access',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\r\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @section_code AS section_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql","size_chars":2050,"tokens_estimate":512}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":28,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":29,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section ### a) **sp_insert_section_access**\n\n```sql\r\n-- INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_section_access\r\n    @tenant_id NVARCHAR(50),\r\n    @section_code NVARCHAR(50),\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @is_enabled BIT,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SECTION_ACCESS (tenant_id, section_code, profile_code, user_id, is_enabled, valid_from, valid_to, ext_attributes, created_by)\r\n        VALUES (@tenant_id, @section_code, @profile_code, @user_id, @is_enabled, @valid_from, @valid_to, @ext_attributes, COALESCE(@created_by, 'sp_insert_section_access'));\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_section_access',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\r\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @section_code AS section_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":2088,"tokens_estimate":522}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_section_access**\r","anchor_slug":"b-spupdatesectionaccess","chunk_index":30,"content":"### b) **sp_update_section_access**\n\n```sql\r\n-- UPDATE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_section_access\r\n    @id INT,\r\n    @is_enabled BIT = NULL,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.SECTION_ACCESS\r\n        SET\r\n            is_enabled = COALESCE(@is_enabled, is_enabled),\r\n            valid_from = COALESCE(@valid_from, valid_from),\r\n            valid_to = COALESCE(@valid_to, valid_to),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_section_access')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_section_access',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\r\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":1938,"tokens_estimate":484}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_section_access**\r","anchor_slug":"c-spdeletesectionaccess","chunk_index":31,"content":"### c) **sp_delete_section_access**\n\n```sql\r\n-- DELETE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_section_access\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.SECTION_ACCESS WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_section_access',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\r\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql","size_chars":1411,"tokens_estimate":353}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_section_access**\r","anchor_slug":"d-spdebuginsertsectionaccess","chunk_index":32,"content":"### d) **sp_debug_insert_section_access**\n\n```sql\r\n-- DEBUG INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_section_access\r\n    @tenant_id NVARCHAR(50),\r\n    @section_code NVARCHAR(50),\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @is_enabled BIT,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SECTION_ACCESS (tenant_id, section_code, profile_code, user_id, is_enabled, valid_from, valid_to, ext_attributes, created_by)\r\n        VALUES (@tenant_id, @section_code, @profile_code, @user_id, @is_enabled, @valid_from, @valid_to, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_section_access'));\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_section_access',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\r\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @section_code AS section_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql","size_chars":2050,"tokens_estimate":512}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":33,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":34,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n = Ensure-Section ### a) **sp_insert_section_access**\n\n```sql\r\n-- INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_section_access\r\n    @tenant_id NVARCHAR(50),\r\n    @section_code NVARCHAR(50),\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @is_enabled BIT,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SECTION_ACCESS (tenant_id, section_code, profile_code, user_id, is_enabled, valid_from, valid_to, ext_attributes, created_by)\r\n        VALUES (@tenant_id, @section_code, @profile_code, @user_id, @is_enabled, @valid_from, @valid_to, @ext_attributes, COALESCE(@created_by, 'sp_insert_section_access'));\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_section_access',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\r\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @section_code AS section_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":2159,"tokens_estimate":540}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_section_access**\r","anchor_slug":"b-spupdatesectionaccess","chunk_index":35,"content":"### b) **sp_update_section_access**\n\n```sql\r\n-- UPDATE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_section_access\r\n    @id INT,\r\n    @is_enabled BIT = NULL,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.SECTION_ACCESS\r\n        SET\r\n            is_enabled = COALESCE(@is_enabled, is_enabled),\r\n            valid_from = COALESCE(@valid_from, valid_from),\r\n            valid_to = COALESCE(@valid_to, valid_to),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_section_access')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_section_access',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\r\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":1938,"tokens_estimate":484}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_section_access**\r","anchor_slug":"c-spdeletesectionaccess","chunk_index":36,"content":"### c) **sp_delete_section_access**\n\n```sql\r\n-- DELETE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_section_access\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.SECTION_ACCESS WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_section_access',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\r\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql","size_chars":1411,"tokens_estimate":353}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_section_access**\r","anchor_slug":"d-spdebuginsertsectionaccess","chunk_index":37,"content":"### d) **sp_debug_insert_section_access**\n\n```sql\r\n-- DEBUG INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_section_access\r\n    @tenant_id NVARCHAR(50),\r\n    @section_code NVARCHAR(50),\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @is_enabled BIT,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SECTION_ACCESS (tenant_id, section_code, profile_code, user_id, is_enabled, valid_from, valid_to, ext_attributes, created_by)\r\n        VALUES (@tenant_id, @section_code, @profile_code, @user_id, @is_enabled, @valid_from, @valid_to, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_section_access'));\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_section_access',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\r\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @section_code AS section_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql","size_chars":2050,"tokens_estimate":512}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":38,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":39,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":40,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  ### a) **sp_insert_section_access**\n\n```sql\r\n-- INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_section_access\r\n    @tenant_id NVARCHAR(50),\r\n    @section_code NVARCHAR(50),\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @is_enabled BIT,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SECTION_ACCESS (tenant_id, section_code, profile_code, user_id, is_enabled, valid_from, valid_to, ext_attributes, created_by)\r\n        VALUES (@tenant_id, @section_code, @profile_code, @user_id, @is_enabled, @valid_from, @valid_to, @ext_attributes, COALESCE(@created_by, 'sp_insert_section_access'));\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_section_access',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\r\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @section_code AS section_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":2138,"tokens_estimate":534}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_section_access**\r","anchor_slug":"b-spupdatesectionaccess","chunk_index":41,"content":"### b) **sp_update_section_access**\n\n```sql\r\n-- UPDATE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_section_access\r\n    @id INT,\r\n    @is_enabled BIT = NULL,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.SECTION_ACCESS\r\n        SET\r\n            is_enabled = COALESCE(@is_enabled, is_enabled),\r\n            valid_from = COALESCE(@valid_from, valid_from),\r\n            valid_to = COALESCE(@valid_to, valid_to),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_section_access')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_section_access',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\r\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":1938,"tokens_estimate":484}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_section_access**\r","anchor_slug":"c-spdeletesectionaccess","chunk_index":42,"content":"### c) **sp_delete_section_access**\n\n```sql\r\n-- DELETE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_section_access\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.SECTION_ACCESS WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_section_access',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\r\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql","size_chars":1411,"tokens_estimate":353}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_section_access**\r","anchor_slug":"d-spdebuginsertsectionaccess","chunk_index":43,"content":"### d) **sp_debug_insert_section_access**\n\n```sql\r\n-- DEBUG INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_section_access\r\n    @tenant_id NVARCHAR(50),\r\n    @section_code NVARCHAR(50),\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @is_enabled BIT,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SECTION_ACCESS (tenant_id, section_code, profile_code, user_id, is_enabled, valid_from, valid_to, ext_attributes, created_by)\r\n        VALUES (@tenant_id, @section_code, @profile_code, @user_id, @is_enabled, @valid_from, @valid_to, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_section_access'));\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_section_access',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\r\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @section_code AS section_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql","size_chars":2050,"tokens_estimate":512}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":44,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":45,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section ### a) **sp_insert_section_access**\n\n```sql\r\n-- INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_section_access\r\n    @tenant_id NVARCHAR(50),\r\n    @section_code NVARCHAR(50),\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @is_enabled BIT,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SECTION_ACCESS (tenant_id, section_code, profile_code, user_id, is_enabled, valid_from, valid_to, ext_attributes, created_by)\r\n        VALUES (@tenant_id, @section_code, @profile_code, @user_id, @is_enabled, @valid_from, @valid_to, @ext_attributes, COALESCE(@created_by, 'sp_insert_section_access'));\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_section_access',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\r\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @section_code AS section_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":2088,"tokens_estimate":522}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_section_access**\r","anchor_slug":"b-spupdatesectionaccess","chunk_index":46,"content":"### b) **sp_update_section_access**\n\n```sql\r\n-- UPDATE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_section_access\r\n    @id INT,\r\n    @is_enabled BIT = NULL,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.SECTION_ACCESS\r\n        SET\r\n            is_enabled = COALESCE(@is_enabled, is_enabled),\r\n            valid_from = COALESCE(@valid_from, valid_from),\r\n            valid_to = COALESCE(@valid_to, valid_to),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_section_access')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_section_access',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\r\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":1938,"tokens_estimate":484}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_section_access**\r","anchor_slug":"c-spdeletesectionaccess","chunk_index":47,"content":"### c) **sp_delete_section_access**\n\n```sql\r\n-- DELETE\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_section_access\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.SECTION_ACCESS WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_section_access',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\r\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql","size_chars":1411,"tokens_estimate":353}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_section_access**\r","anchor_slug":"d-spdebuginsertsectionaccess","chunk_index":48,"content":"### d) **sp_debug_insert_section_access**\n\n```sql\r\n-- DEBUG INSERT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_section_access\r\n    @tenant_id NVARCHAR(50),\r\n    @section_code NVARCHAR(50),\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @is_enabled BIT,\r\n    @valid_from DATETIME2 = NULL,\r\n    @valid_to DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SECTION_ACCESS (tenant_id, section_code, profile_code, user_id, is_enabled, valid_from, valid_to, ext_attributes, created_by)\r\n        VALUES (@tenant_id, @section_code, @profile_code, @user_id, @is_enabled, @valid_from, @valid_to, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_section_access'));\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\r\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_section_access');\r\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_section_access',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SECTION_ACCESS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\r\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @section_code AS section_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql","size_chars":2050,"tokens_estimate":512}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":49,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":50,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n 'Domande a cui risponde' @\"\r\n- Cosa fa?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":281,"tokens_estimate":70}
{"doc_id":"ew-section-access","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/section-access.md","title":"a) **sp_insert_section_access**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Collegamenti\r","anchor_slug":"collegamenti","chunk_index":51,"content":"## Collegamenti\r\n- [Entities Index](../../../../../../entities-index.md)","size_chars":72,"tokens_estimate":18}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":1,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":2,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":3,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  * Abbiamo definito una SP,  `sp_log_stats_execution`, con tutti i parametri necessari (proc_name, rows, status, etc).\r\n    \r\n*   Nelle altre store process, al posto dell‚Äô`INSERT INTO ...` metti solo la chiamata a questa SP.\r\n    \r\n*   Se domani aggiungi colonne o cambi qualcosa nel log, lo cambi in una sola SP.\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_log_stats_execution\r\n    @proc_name NVARCHAR(200),\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @rows_inserted INT = 0,\r\n    @rows_updated INT = 0,\r\n    @rows_deleted INT = 0,\r\n    @rows_total INT = 0,\r\n    @status NVARCHAR(50) = 'OK',\r\n    @error_message NVARCHAR(2000) = NULL,\r\n    @start_time DATETIME2 = NULL,\r\n    @end_time DATETIME2 = NULL,\r\n    @affected_tables NVARCHAR(500) = NULL,\r\n    @operation_types NVARCHAR(100) = NULL,\r\n    @payload NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, rows_total,\r\n        status, error_message, start_time, end_time, duration_ms,\r\n        affected_tables, operation_types, payload, created_by, created_at\r\n    )\r\n    VALUES (\r\n        @proc_name, @tenant_id, @user_id, @rows_inserted, @rows_updated, @rows_deleted, @rows_total,\r\n        @status, @error_message, @start_time, @end_time, \r\n        DATEDIFF(MILLISECOND, @start_time, @end_time),\r\n        @affected_tables, @operation_types, @payload,\r\n        COALESCE(@created_by, @proc_name), SYSUTCDATETIME()\r\n    );\r\nEND\r\nGO\r\n```sql\n\n2Ô∏è‚É£ **Nuovo template di chiamata nelle altre SP**\r\n-------------------------------------------------\n\n**Esempio, nella tua SP di update:**\n\n```sql\r\n-- Dopo il TRY/CATCH, al posto del vecchio INSERT:\r\nEXEC PORTAL.sp_log_stats_execution\r\n    @proc_name = 'sp_update_profile_domain',\r\n    @tenant_id = NULL,\r\n    @user_id = NULL,\r\n    @rows_updated = @rows_updated,\r\n    @status = @status,\r\n    @error_message = @error_message,\r\n    @start_time = @start_time,\r\n    @end_time = SYSUTCDATETIME(),\r\n    @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n    @operation_types = 'UPDATE',\r\n    @payload = NULL,\r\n    @created_by = COALESCE(@updated_by, 'sp_update_profile_domain');\r\n```sql","size_chars":2393,"tokens_estimate":598}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":4,"content":"**PS:**\r\n*   Puoi usare lo stesso pattern per **insert, delete, debug** (cambiando i parametri per il tipo di operazione).\r\n    \r\n*   Se ti serve loggare info extra (payload JSON, nome tabella, ecc.), basta passarlo nei parametri.\r\n    \r\n*   Se vuoi logging anche sulle tabelle di dettaglio (STATS_EXECUTION_TABLE_LOG) basta aggiungere un‚Äôulteriore SP analoga.","size_chars":360,"tokens_estimate":90}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":5,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":6,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section * Abbiamo definito una SP,  `sp_log_stats_execution`, con tutti i parametri necessari (proc_name, rows, status, etc).\r\n    \r\n*   Nelle altre store process, al posto dell‚Äô`INSERT INTO ...` metti solo la chiamata a questa SP.\r\n    \r\n*   Se domani aggiungi colonne o cambi qualcosa nel log, lo cambi in una sola SP.\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_log_stats_execution\r\n    @proc_name NVARCHAR(200),\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @rows_inserted INT = 0,\r\n    @rows_updated INT = 0,\r\n    @rows_deleted INT = 0,\r\n    @rows_total INT = 0,\r\n    @status NVARCHAR(50) = 'OK',\r\n    @error_message NVARCHAR(2000) = NULL,\r\n    @start_time DATETIME2 = NULL,\r\n    @end_time DATETIME2 = NULL,\r\n    @affected_tables NVARCHAR(500) = NULL,\r\n    @operation_types NVARCHAR(100) = NULL,\r\n    @payload NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, rows_total,\r\n        status, error_message, start_time, end_time, duration_ms,\r\n        affected_tables, operation_types, payload, created_by, created_at\r\n    )\r\n    VALUES (\r\n        @proc_name, @tenant_id, @user_id, @rows_inserted, @rows_updated, @rows_deleted, @rows_total,\r\n        @status, @error_message, @start_time, @end_time, \r\n        DATEDIFF(MILLISECOND, @start_time, @end_time),\r\n        @affected_tables, @operation_types, @payload,\r\n        COALESCE(@created_by, @proc_name), SYSUTCDATETIME()\r\n    );\r\nEND\r\nGO\r\n```sql\n\n2Ô∏è‚É£ **Nuovo template di chiamata nelle altre SP**\r\n-------------------------------------------------\n\n**Esempio, nella tua SP di update:**\n\n```sql\r\n-- Dopo il TRY/CATCH, al posto del vecchio INSERT:\r\nEXEC PORTAL.sp_log_stats_execution\r\n    @proc_name = 'sp_update_profile_domain',\r\n    @tenant_id = NULL,\r\n    @user_id = NULL,\r\n    @rows_updated = @rows_updated,\r\n    @status = @status,\r\n    @error_message = @error_message,\r\n    @start_time = @start_time,\r\n    @end_time = SYSUTCDATETIME(),\r\n    @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n    @operation_types = 'UPDATE',\r\n    @payload = NULL,\r\n    @created_by = COALESCE(@updated_by, 'sp_update_profile_domain');\r\n```sql","size_chars":2343,"tokens_estimate":586}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":7,"content":"**PS:**\r\n*   Puoi usare lo stesso pattern per **insert, delete, debug** (cambiando i parametri per il tipo di operazione).\r\n    \r\n*   Se ti serve loggare info extra (payload JSON, nome tabella, ecc.), basta passarlo nei parametri.\r\n    \r\n*   Se vuoi logging anche sulle tabelle di dettaglio (STATS_EXECUTION_TABLE_LOG) basta aggiungere un‚Äôulteriore SP analoga.","size_chars":360,"tokens_estimate":90}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":8,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":9,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->","size_chars":125,"tokens_estimate":31}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":10,"content":"## Esempi Query\r\n`sql\r\n-- SELECT ... FROM ...\r\n`\r\n\"@\r\n  * Abbiamo definito una SP,  `sp_log_stats_execution`, con tutti i parametri necessari (proc_name, rows, status, etc).\r\n    \r\n*   Nelle altre store process, al posto dell‚Äô`INSERT INTO ...` metti solo la chiamata a questa SP.\r\n    \r\n*   Se domani aggiungi colonne o cambi qualcosa nel log, lo cambi in una sola SP.\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_log_stats_execution\r\n    @proc_name NVARCHAR(200),\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @rows_inserted INT = 0,\r\n    @rows_updated INT = 0,\r\n    @rows_deleted INT = 0,\r\n    @rows_total INT = 0,\r\n    @status NVARCHAR(50) = 'OK',\r\n    @error_message NVARCHAR(2000) = NULL,\r\n    @start_time DATETIME2 = NULL,\r\n    @end_time DATETIME2 = NULL,\r\n    @affected_tables NVARCHAR(500) = NULL,\r\n    @operation_types NVARCHAR(100) = NULL,\r\n    @payload NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, rows_total,\r\n        status, error_message, start_time, end_time, duration_ms,\r\n        affected_tables, operation_types, payload, created_by, created_at\r\n    )\r\n    VALUES (\r\n        @proc_name, @tenant_id, @user_id, @rows_inserted, @rows_updated, @rows_deleted, @rows_total,\r\n        @status, @error_message, @start_time, @end_time, \r\n        DATEDIFF(MILLISECOND, @start_time, @end_time),\r\n        @affected_tables, @operation_types, @payload,\r\n        COALESCE(@created_by, @proc_name), SYSUTCDATETIME()\r\n    );\r\nEND\r\nGO\r\n```sql\n\n2Ô∏è‚É£ **Nuovo template di chiamata nelle altre SP**\r\n-------------------------------------------------\n\n**Esempio, nella tua SP di update:**\n\n```sql\r\n-- Dopo il TRY/CATCH, al posto del vecchio INSERT:\r\nEXEC PORTAL.sp_log_stats_execution\r\n    @proc_name = 'sp_update_profile_domain',\r\n    @tenant_id = NULL,\r\n    @user_id = NULL,\r\n    @rows_updated = @rows_updated,\r\n    @status = @status,\r\n    @error_message = @error_message,\r\n    @start_time = @start_time,\r\n    @end_time = SYSUTCDATETIME(),\r\n    @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n    @operation_types = 'UPDATE',\r\n    @payload = NULL,\r\n    @created_by = COALESCE(@updated_by, 'sp_update_profile_domain');\r\n```sql","size_chars":2325,"tokens_estimate":581}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":11,"content":"**PS:**\r\n*   Puoi usare lo stesso pattern per **insert, delete, debug** (cambiando i parametri per il tipo di operazione).\r\n    \r\n*   Se ti serve loggare info extra (payload JSON, nome tabella, ecc.), basta passarlo nei parametri.\r\n    \r\n*   Se vuoi logging anche sulle tabelle di dettaglio (STATS_EXECUTION_TABLE_LOG) basta aggiungere un‚Äôulteriore SP analoga.","size_chars":360,"tokens_estimate":90}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":12,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":13,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":14,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  * Abbiamo definito una SP,  `sp_log_stats_execution`, con tutti i parametri necessari (proc_name, rows, status, etc).\r\n    \r\n*   Nelle altre store process, al posto dell‚Äô`INSERT INTO ...` metti solo la chiamata a questa SP.\r\n    \r\n*   Se domani aggiungi colonne o cambi qualcosa nel log, lo cambi in una sola SP.\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_log_stats_execution\r\n    @proc_name NVARCHAR(200),\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @rows_inserted INT = 0,\r\n    @rows_updated INT = 0,\r\n    @rows_deleted INT = 0,\r\n    @rows_total INT = 0,\r\n    @status NVARCHAR(50) = 'OK',\r\n    @error_message NVARCHAR(2000) = NULL,\r\n    @start_time DATETIME2 = NULL,\r\n    @end_time DATETIME2 = NULL,\r\n    @affected_tables NVARCHAR(500) = NULL,\r\n    @operation_types NVARCHAR(100) = NULL,\r\n    @payload NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, rows_total,\r\n        status, error_message, start_time, end_time, duration_ms,\r\n        affected_tables, operation_types, payload, created_by, created_at\r\n    )\r\n    VALUES (\r\n        @proc_name, @tenant_id, @user_id, @rows_inserted, @rows_updated, @rows_deleted, @rows_total,\r\n        @status, @error_message, @start_time, @end_time, \r\n        DATEDIFF(MILLISECOND, @start_time, @end_time),\r\n        @affected_tables, @operation_types, @payload,\r\n        COALESCE(@created_by, @proc_name), SYSUTCDATETIME()\r\n    );\r\nEND\r\nGO\r\n```sql\n\n2Ô∏è‚É£ **Nuovo template di chiamata nelle altre SP**\r\n-------------------------------------------------\n\n**Esempio, nella tua SP di update:**\n\n```sql\r\n-- Dopo il TRY/CATCH, al posto del vecchio INSERT:\r\nEXEC PORTAL.sp_log_stats_execution\r\n    @proc_name = 'sp_update_profile_domain',\r\n    @tenant_id = NULL,\r\n    @user_id = NULL,\r\n    @rows_updated = @rows_updated,\r\n    @status = @status,\r\n    @error_message = @error_message,\r\n    @start_time = @start_time,\r\n    @end_time = SYSUTCDATETIME(),\r\n    @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n    @operation_types = 'UPDATE',\r\n    @payload = NULL,\r\n    @created_by = COALESCE(@updated_by, 'sp_update_profile_domain');\r\n```sql","size_chars":2393,"tokens_estimate":598}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":15,"content":"**PS:**\r\n*   Puoi usare lo stesso pattern per **insert, delete, debug** (cambiando i parametri per il tipo di operazione).\r\n    \r\n*   Se ti serve loggare info extra (payload JSON, nome tabella, ecc.), basta passarlo nei parametri.\r\n    \r\n*   Se vuoi logging anche sulle tabelle di dettaglio (STATS_EXECUTION_TABLE_LOG) basta aggiungere un‚Äôulteriore SP analoga.","size_chars":360,"tokens_estimate":90}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":16,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":17,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section * Abbiamo definito una SP,  `sp_log_stats_execution`, con tutti i parametri necessari (proc_name, rows, status, etc).\r\n    \r\n*   Nelle altre store process, al posto dell‚Äô`INSERT INTO ...` metti solo la chiamata a questa SP.\r\n    \r\n*   Se domani aggiungi colonne o cambi qualcosa nel log, lo cambi in una sola SP.\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_log_stats_execution\r\n    @proc_name NVARCHAR(200),\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @rows_inserted INT = 0,\r\n    @rows_updated INT = 0,\r\n    @rows_deleted INT = 0,\r\n    @rows_total INT = 0,\r\n    @status NVARCHAR(50) = 'OK',\r\n    @error_message NVARCHAR(2000) = NULL,\r\n    @start_time DATETIME2 = NULL,\r\n    @end_time DATETIME2 = NULL,\r\n    @affected_tables NVARCHAR(500) = NULL,\r\n    @operation_types NVARCHAR(100) = NULL,\r\n    @payload NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, rows_total,\r\n        status, error_message, start_time, end_time, duration_ms,\r\n        affected_tables, operation_types, payload, created_by, created_at\r\n    )\r\n    VALUES (\r\n        @proc_name, @tenant_id, @user_id, @rows_inserted, @rows_updated, @rows_deleted, @rows_total,\r\n        @status, @error_message, @start_time, @end_time, \r\n        DATEDIFF(MILLISECOND, @start_time, @end_time),\r\n        @affected_tables, @operation_types, @payload,\r\n        COALESCE(@created_by, @proc_name), SYSUTCDATETIME()\r\n    );\r\nEND\r\nGO\r\n```sql\n\n2Ô∏è‚É£ **Nuovo template di chiamata nelle altre SP**\r\n-------------------------------------------------\n\n**Esempio, nella tua SP di update:**\n\n```sql\r\n-- Dopo il TRY/CATCH, al posto del vecchio INSERT:\r\nEXEC PORTAL.sp_log_stats_execution\r\n    @proc_name = 'sp_update_profile_domain',\r\n    @tenant_id = NULL,\r\n    @user_id = NULL,\r\n    @rows_updated = @rows_updated,\r\n    @status = @status,\r\n    @error_message = @error_message,\r\n    @start_time = @start_time,\r\n    @end_time = SYSUTCDATETIME(),\r\n    @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n    @operation_types = 'UPDATE',\r\n    @payload = NULL,\r\n    @created_by = COALESCE(@updated_by, 'sp_update_profile_domain');\r\n```sql","size_chars":2343,"tokens_estimate":586}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":18,"content":"**PS:**\r\n*   Puoi usare lo stesso pattern per **insert, delete, debug** (cambiando i parametri per il tipo di operazione).\r\n    \r\n*   Se ti serve loggare info extra (payload JSON, nome tabella, ecc.), basta passarlo nei parametri.\r\n    \r\n*   Se vuoi logging anche sulle tabelle di dettaglio (STATS_EXECUTION_TABLE_LOG) basta aggiungere un‚Äôulteriore SP analoga.","size_chars":360,"tokens_estimate":90}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":19,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":20,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n = Ensure-Section * Abbiamo definito una SP,  `sp_log_stats_execution`, con tutti i parametri necessari (proc_name, rows, status, etc).\r\n    \r\n*   Nelle altre store process, al posto dell‚Äô`INSERT INTO ...` metti solo la chiamata a questa SP.\r\n    \r\n*   Se domani aggiungi colonne o cambi qualcosa nel log, lo cambi in una sola SP.\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_log_stats_execution\r\n    @proc_name NVARCHAR(200),\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @rows_inserted INT = 0,\r\n    @rows_updated INT = 0,\r\n    @rows_deleted INT = 0,\r\n    @rows_total INT = 0,\r\n    @status NVARCHAR(50) = 'OK',\r\n    @error_message NVARCHAR(2000) = NULL,\r\n    @start_time DATETIME2 = NULL,\r\n    @end_time DATETIME2 = NULL,\r\n    @affected_tables NVARCHAR(500) = NULL,\r\n    @operation_types NVARCHAR(100) = NULL,\r\n    @payload NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, rows_total,\r\n        status, error_message, start_time, end_time, duration_ms,\r\n        affected_tables, operation_types, payload, created_by, created_at\r\n    )\r\n    VALUES (\r\n        @proc_name, @tenant_id, @user_id, @rows_inserted, @rows_updated, @rows_deleted, @rows_total,\r\n        @status, @error_message, @start_time, @end_time, \r\n        DATEDIFF(MILLISECOND, @start_time, @end_time),\r\n        @affected_tables, @operation_types, @payload,\r\n        COALESCE(@created_by, @proc_name), SYSUTCDATETIME()\r\n    );\r\nEND\r\nGO\r\n```sql\n\n2Ô∏è‚É£ **Nuovo template di chiamata nelle altre SP**\r\n-------------------------------------------------\n\n**Esempio, nella tua SP di update:**","size_chars":1877,"tokens_estimate":469}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":21,"content":"```sql\r\n-- Dopo il TRY/CATCH, al posto del vecchio INSERT:\r\nEXEC PORTAL.sp_log_stats_execution\r\n    @proc_name = 'sp_update_profile_domain',\r\n    @tenant_id = NULL,\r\n    @user_id = NULL,\r\n    @rows_updated = @rows_updated,\r\n    @status = @status,\r\n    @error_message = @error_message,\r\n    @start_time = @start_time,\r\n    @end_time = SYSUTCDATETIME(),\r\n    @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n    @operation_types = 'UPDATE',\r\n    @payload = NULL,\r\n    @created_by = COALESCE(@updated_by, 'sp_update_profile_domain');\r\n```sql\n\n**PS:**\r\n*   Puoi usare lo stesso pattern per **insert, delete, debug** (cambiando i parametri per il tipo di operazione).\r\n    \r\n*   Se ti serve loggare info extra (payload JSON, nome tabella, ecc.), basta passarlo nei parametri.\r\n    \r\n*   Se vuoi logging anche sulle tabelle di dettaglio (STATS_EXECUTION_TABLE_LOG) basta aggiungere un‚Äôulteriore SP analoga.","size_chars":897,"tokens_estimate":224}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":22,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":23,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":24,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  * Abbiamo definito una SP,  `sp_log_stats_execution`, con tutti i parametri necessari (proc_name, rows, status, etc).\r\n    \r\n*   Nelle altre store process, al posto dell‚Äô`INSERT INTO ...` metti solo la chiamata a questa SP.\r\n    \r\n*   Se domani aggiungi colonne o cambi qualcosa nel log, lo cambi in una sola SP.\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_log_stats_execution\r\n    @proc_name NVARCHAR(200),\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @rows_inserted INT = 0,\r\n    @rows_updated INT = 0,\r\n    @rows_deleted INT = 0,\r\n    @rows_total INT = 0,\r\n    @status NVARCHAR(50) = 'OK',\r\n    @error_message NVARCHAR(2000) = NULL,\r\n    @start_time DATETIME2 = NULL,\r\n    @end_time DATETIME2 = NULL,\r\n    @affected_tables NVARCHAR(500) = NULL,\r\n    @operation_types NVARCHAR(100) = NULL,\r\n    @payload NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, rows_total,\r\n        status, error_message, start_time, end_time, duration_ms,\r\n        affected_tables, operation_types, payload, created_by, created_at\r\n    )\r\n    VALUES (\r\n        @proc_name, @tenant_id, @user_id, @rows_inserted, @rows_updated, @rows_deleted, @rows_total,\r\n        @status, @error_message, @start_time, @end_time, \r\n        DATEDIFF(MILLISECOND, @start_time, @end_time),\r\n        @affected_tables, @operation_types, @payload,\r\n        COALESCE(@created_by, @proc_name), SYSUTCDATETIME()\r\n    );\r\nEND\r\nGO\r\n```sql\n\n2Ô∏è‚É£ **Nuovo template di chiamata nelle altre SP**\r\n-------------------------------------------------\n\n**Esempio, nella tua SP di update:**\n\n```sql\r\n-- Dopo il TRY/CATCH, al posto del vecchio INSERT:\r\nEXEC PORTAL.sp_log_stats_execution\r\n    @proc_name = 'sp_update_profile_domain',\r\n    @tenant_id = NULL,\r\n    @user_id = NULL,\r\n    @rows_updated = @rows_updated,\r\n    @status = @status,\r\n    @error_message = @error_message,\r\n    @start_time = @start_time,\r\n    @end_time = SYSUTCDATETIME(),\r\n    @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n    @operation_types = 'UPDATE',\r\n    @payload = NULL,\r\n    @created_by = COALESCE(@updated_by, 'sp_update_profile_domain');\r\n```sql","size_chars":2393,"tokens_estimate":598}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":25,"content":"**PS:**\r\n*   Puoi usare lo stesso pattern per **insert, delete, debug** (cambiando i parametri per il tipo di operazione).\r\n    \r\n*   Se ti serve loggare info extra (payload JSON, nome tabella, ecc.), basta passarlo nei parametri.\r\n    \r\n*   Se vuoi logging anche sulle tabelle di dettaglio (STATS_EXECUTION_TABLE_LOG) basta aggiungere un‚Äôulteriore SP analoga.","size_chars":360,"tokens_estimate":90}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":26,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":27,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section * Abbiamo definito una SP,  `sp_log_stats_execution`, con tutti i parametri necessari (proc_name, rows, status, etc).\r\n    \r\n*   Nelle altre store process, al posto dell‚Äô`INSERT INTO ...` metti solo la chiamata a questa SP.\r\n    \r\n*   Se domani aggiungi colonne o cambi qualcosa nel log, lo cambi in una sola SP.\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_log_stats_execution\r\n    @proc_name NVARCHAR(200),\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @rows_inserted INT = 0,\r\n    @rows_updated INT = 0,\r\n    @rows_deleted INT = 0,\r\n    @rows_total INT = 0,\r\n    @status NVARCHAR(50) = 'OK',\r\n    @error_message NVARCHAR(2000) = NULL,\r\n    @start_time DATETIME2 = NULL,\r\n    @end_time DATETIME2 = NULL,\r\n    @affected_tables NVARCHAR(500) = NULL,\r\n    @operation_types NVARCHAR(100) = NULL,\r\n    @payload NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    INSERT INTO PORTAL.STATS_EXECUTION_LOG (\r\n        proc_name, tenant_id, user_id, rows_inserted, rows_updated, rows_deleted, rows_total,\r\n        status, error_message, start_time, end_time, duration_ms,\r\n        affected_tables, operation_types, payload, created_by, created_at\r\n    )\r\n    VALUES (\r\n        @proc_name, @tenant_id, @user_id, @rows_inserted, @rows_updated, @rows_deleted, @rows_total,\r\n        @status, @error_message, @start_time, @end_time, \r\n        DATEDIFF(MILLISECOND, @start_time, @end_time),\r\n        @affected_tables, @operation_types, @payload,\r\n        COALESCE(@created_by, @proc_name), SYSUTCDATETIME()\r\n    );\r\nEND\r\nGO\r\n```sql\n\n2Ô∏è‚É£ **Nuovo template di chiamata nelle altre SP**\r\n-------------------------------------------------\n\n**Esempio, nella tua SP di update:**\n\n```sql\r\n-- Dopo il TRY/CATCH, al posto del vecchio INSERT:\r\nEXEC PORTAL.sp_log_stats_execution\r\n    @proc_name = 'sp_update_profile_domain',\r\n    @tenant_id = NULL,\r\n    @user_id = NULL,\r\n    @rows_updated = @rows_updated,\r\n    @status = @status,\r\n    @error_message = @error_message,\r\n    @start_time = @start_time,\r\n    @end_time = SYSUTCDATETIME(),\r\n    @affected_tables = 'PORTAL.PROFILE_DOMAINS',\r\n    @operation_types = 'UPDATE',\r\n    @payload = NULL,\r\n    @created_by = COALESCE(@updated_by, 'sp_update_profile_domain');\r\n```sql","size_chars":2343,"tokens_estimate":586}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":28,"content":"**PS:**\r\n*   Puoi usare lo stesso pattern per **insert, delete, debug** (cambiando i parametri per il tipo di operazione).\r\n    \r\n*   Se ti serve loggare info extra (payload JSON, nome tabella, ecc.), basta passarlo nei parametri.\r\n    \r\n*   Se vuoi logging anche sulle tabelle di dettaglio (STATS_EXECUTION_TABLE_LOG) basta aggiungere un‚Äôulteriore SP analoga.","size_chars":360,"tokens_estimate":90}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":29,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":30,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n 'Domande a cui risponde' @\"\r\n- Cosa fa?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":281,"tokens_estimate":70}
{"doc_id":"ew-stats-execution-log","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/stats-execution-log.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Collegamenti\r","anchor_slug":"collegamenti","chunk_index":31,"content":"## Collegamenti\r\n- [Entities Index](../../../../../../entities-index.md)","size_chars":72,"tokens_estimate":18}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"a) **sp_insert_subscription**\r","anchor_slug":"a-spinsertsubscription","chunk_index":1,"content":"### a) **sp_insert_subscription**\n\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE SUBSCRIPTION \r\n--STORE PROCEDURE ‚Äì  INSERT SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_subscription\r\n    @tenant_id NVARCHAR(50),\r\n    @plan_code NVARCHAR(50),\r\n    @status NVARCHAR(50) = 'ACTIVE',\r\n    @start_date DATETIME2,\r\n    @end_date DATETIME2,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.SUBSCRIPTION WHERE tenant_id = @tenant_id\r\n              AND plan_code = @plan_code AND start_date = @start_date\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.SUBSCRIPTION (\r\n                tenant_id, plan_code, status, start_date, end_date, external_payment_id,\r\n                payment_provider, last_payment_date, ext_attributes, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @plan_code, @status, @start_date, @end_date,\r\n                @external_payment_id, @payment_provider, @last_payment_date,\r\n                @ext_attributes, COALESCE(@created_by, 'sp_insert_subscription')\r\n            );\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_subscription',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;","size_chars":2358,"tokens_estimate":590}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"a) **sp_insert_subscription**\r","anchor_slug":"a-spinsertsubscription","chunk_index":2,"content":"    SELECT @status_out AS status, @tenant_id AS tenant_id, @plan_code AS plan_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql","size_chars":166,"tokens_estimate":42}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_subscription**\r","anchor_slug":"b-spupdatesubscription","chunk_index":3,"content":"### b) **sp_update_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  UPDATE SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_subscription\r\n    @id INT,\r\n    @plan_code NVARCHAR(50) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @start_date DATETIME2 = NULL,\r\n    @end_date DATETIME2 = NULL,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.SUBSCRIPTION\r\n        SET\r\n            plan_code = COALESCE(@plan_code, plan_code),\r\n            status = COALESCE(@status, status),\r\n            start_date = COALESCE(@start_date, start_date),\r\n            end_date = COALESCE(@end_date, end_date),\r\n            external_payment_id = COALESCE(@external_payment_id, external_payment_id),\r\n            payment_provider = COALESCE(@payment_provider, payment_provider),\r\n            last_payment_date = COALESCE(@last_payment_date, last_payment_date),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_subscription')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_subscription',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;","size_chars":2299,"tokens_estimate":575}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_subscription**\r","anchor_slug":"b-spupdatesubscription","chunk_index":4,"content":"    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":125,"tokens_estimate":31}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_subscription**\r","anchor_slug":"c-spdeletesubscription","chunk_index":5,"content":"### c) **sp_delete_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  DELETE SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_subscription\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.SUBSCRIPTION WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_subscription',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql","size_chars":1430,"tokens_estimate":358}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_subscription**\r","anchor_slug":"d-spdebuginsertsubscription","chunk_index":6,"content":"### d) **sp_debug_insert_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  INSERT DEBUG SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_subscription\r\n    @tenant_id NVARCHAR(50),\r\n    @plan_code NVARCHAR(50),\r\n    @status NVARCHAR(50) = 'ACTIVE',\r\n    @start_date DATETIME2,\r\n    @end_date DATETIME2,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SUBSCRIPTION (\r\n            tenant_id, plan_code, status, start_date, end_date, external_payment_id,\r\n            payment_provider, last_payment_date, ext_attributes, created_by\r\n        )\r\n        VALUES (\r\n            @tenant_id, @plan_code, @status, @start_date, @end_date,\r\n            @external_payment_id, @payment_provider, @last_payment_date,\r\n            @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_subscription')\r\n        );\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_subscription',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @plan_code AS plan_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n--FINE SEZIONE STORE PROCEDURE SUBSCRIPTION\n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---","size_chars":2356,"tokens_estimate":589}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_subscription**\r","anchor_slug":"d-spdebuginsertsubscription","chunk_index":7,"content":"Prompt esempio:\r\n> Inserisci una nuova subscription GOLD per il tenant TEN00000001001 dal 2025-01-01 al 2026-01-01\n\n```sql\r\nEXEC PORTAL.sp_insert_subscription\r\n    @tenant_id = 'TEN00000001001',\r\n    @plan_code = 'GOLD',\r\n    @start_date = '2025-01-01',\r\n    @end_date = '2026-01-01',\r\n    @created_by = 'chatbot_ams';","size_chars":318,"tokens_estimate":80}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":8,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":9,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":10,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  ### a) **sp_insert_subscription**\n\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE SUBSCRIPTION \r\n--STORE PROCEDURE ‚Äì  INSERT SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_subscription\r\n    @tenant_id NVARCHAR(50),\r\n    @plan_code NVARCHAR(50),\r\n    @status NVARCHAR(50) = 'ACTIVE',\r\n    @start_date DATETIME2,\r\n    @end_date DATETIME2,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.SUBSCRIPTION WHERE tenant_id = @tenant_id\r\n              AND plan_code = @plan_code AND start_date = @start_date\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.SUBSCRIPTION (\r\n                tenant_id, plan_code, status, start_date, end_date, external_payment_id,\r\n                payment_provider, last_payment_date, ext_attributes, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @plan_code, @status, @start_date, @end_date,\r\n                @external_payment_id, @payment_provider, @last_payment_date,\r\n                @ext_attributes, COALESCE(@created_by, 'sp_insert_subscription')\r\n            );\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_subscription');","size_chars":2045,"tokens_estimate":511}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":11,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_subscription',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @plan_code AS plan_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql","size_chars":603,"tokens_estimate":151}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_subscription**\r","anchor_slug":"b-spupdatesubscription","chunk_index":12,"content":"### b) **sp_update_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  UPDATE SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_subscription\r\n    @id INT,\r\n    @plan_code NVARCHAR(50) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @start_date DATETIME2 = NULL,\r\n    @end_date DATETIME2 = NULL,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.SUBSCRIPTION\r\n        SET\r\n            plan_code = COALESCE(@plan_code, plan_code),\r\n            status = COALESCE(@status, status),\r\n            start_date = COALESCE(@start_date, start_date),\r\n            end_date = COALESCE(@end_date, end_date),\r\n            external_payment_id = COALESCE(@external_payment_id, external_payment_id),\r\n            payment_provider = COALESCE(@payment_provider, payment_provider),\r\n            last_payment_date = COALESCE(@last_payment_date, last_payment_date),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_subscription')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_subscription',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;","size_chars":2299,"tokens_estimate":575}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_subscription**\r","anchor_slug":"b-spupdatesubscription","chunk_index":13,"content":"    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":125,"tokens_estimate":31}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_subscription**\r","anchor_slug":"c-spdeletesubscription","chunk_index":14,"content":"### c) **sp_delete_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  DELETE SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_subscription\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.SUBSCRIPTION WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_subscription',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql","size_chars":1430,"tokens_estimate":358}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_subscription**\r","anchor_slug":"d-spdebuginsertsubscription","chunk_index":15,"content":"### d) **sp_debug_insert_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  INSERT DEBUG SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_subscription\r\n    @tenant_id NVARCHAR(50),\r\n    @plan_code NVARCHAR(50),\r\n    @status NVARCHAR(50) = 'ACTIVE',\r\n    @start_date DATETIME2,\r\n    @end_date DATETIME2,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SUBSCRIPTION (\r\n            tenant_id, plan_code, status, start_date, end_date, external_payment_id,\r\n            payment_provider, last_payment_date, ext_attributes, created_by\r\n        )\r\n        VALUES (\r\n            @tenant_id, @plan_code, @status, @start_date, @end_date,\r\n            @external_payment_id, @payment_provider, @last_payment_date,\r\n            @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_subscription')\r\n        );\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_subscription',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @plan_code AS plan_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n--FINE SEZIONE STORE PROCEDURE SUBSCRIPTION\n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---","size_chars":2356,"tokens_estimate":589}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_subscription**\r","anchor_slug":"d-spdebuginsertsubscription","chunk_index":16,"content":"Prompt esempio:\r\n> Inserisci una nuova subscription GOLD per il tenant TEN00000001001 dal 2025-01-01 al 2026-01-01\n\n```sql\r\nEXEC PORTAL.sp_insert_subscription\r\n    @tenant_id = 'TEN00000001001',\r\n    @plan_code = 'GOLD',\r\n    @start_date = '2025-01-01',\r\n    @end_date = '2026-01-01',\r\n    @created_by = 'chatbot_ams';","size_chars":318,"tokens_estimate":80}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":17,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":18,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section ### a) **sp_insert_subscription**\n\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE SUBSCRIPTION \r\n--STORE PROCEDURE ‚Äì  INSERT SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_subscription\r\n    @tenant_id NVARCHAR(50),\r\n    @plan_code NVARCHAR(50),\r\n    @status NVARCHAR(50) = 'ACTIVE',\r\n    @start_date DATETIME2,\r\n    @end_date DATETIME2,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.SUBSCRIPTION WHERE tenant_id = @tenant_id\r\n              AND plan_code = @plan_code AND start_date = @start_date\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.SUBSCRIPTION (\r\n                tenant_id, plan_code, status, start_date, end_date, external_payment_id,\r\n                payment_provider, last_payment_date, ext_attributes, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @plan_code, @status, @start_date, @end_date,\r\n                @external_payment_id, @payment_provider, @last_payment_date,\r\n                @ext_attributes, COALESCE(@created_by, 'sp_insert_subscription')\r\n            );\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_subscription');","size_chars":1995,"tokens_estimate":499}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":19,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_subscription',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @plan_code AS plan_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql","size_chars":603,"tokens_estimate":151}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_subscription**\r","anchor_slug":"b-spupdatesubscription","chunk_index":20,"content":"### b) **sp_update_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  UPDATE SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_subscription\r\n    @id INT,\r\n    @plan_code NVARCHAR(50) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @start_date DATETIME2 = NULL,\r\n    @end_date DATETIME2 = NULL,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.SUBSCRIPTION\r\n        SET\r\n            plan_code = COALESCE(@plan_code, plan_code),\r\n            status = COALESCE(@status, status),\r\n            start_date = COALESCE(@start_date, start_date),\r\n            end_date = COALESCE(@end_date, end_date),\r\n            external_payment_id = COALESCE(@external_payment_id, external_payment_id),\r\n            payment_provider = COALESCE(@payment_provider, payment_provider),\r\n            last_payment_date = COALESCE(@last_payment_date, last_payment_date),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_subscription')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_subscription',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;","size_chars":2299,"tokens_estimate":575}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_subscription**\r","anchor_slug":"b-spupdatesubscription","chunk_index":21,"content":"    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":125,"tokens_estimate":31}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_subscription**\r","anchor_slug":"c-spdeletesubscription","chunk_index":22,"content":"### c) **sp_delete_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  DELETE SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_subscription\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.SUBSCRIPTION WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_subscription',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql","size_chars":1430,"tokens_estimate":358}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_subscription**\r","anchor_slug":"d-spdebuginsertsubscription","chunk_index":23,"content":"### d) **sp_debug_insert_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  INSERT DEBUG SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_subscription\r\n    @tenant_id NVARCHAR(50),\r\n    @plan_code NVARCHAR(50),\r\n    @status NVARCHAR(50) = 'ACTIVE',\r\n    @start_date DATETIME2,\r\n    @end_date DATETIME2,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SUBSCRIPTION (\r\n            tenant_id, plan_code, status, start_date, end_date, external_payment_id,\r\n            payment_provider, last_payment_date, ext_attributes, created_by\r\n        )\r\n        VALUES (\r\n            @tenant_id, @plan_code, @status, @start_date, @end_date,\r\n            @external_payment_id, @payment_provider, @last_payment_date,\r\n            @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_subscription')\r\n        );\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_subscription',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @plan_code AS plan_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n--FINE SEZIONE STORE PROCEDURE SUBSCRIPTION\n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---","size_chars":2356,"tokens_estimate":589}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_subscription**\r","anchor_slug":"d-spdebuginsertsubscription","chunk_index":24,"content":"Prompt esempio:\r\n> Inserisci una nuova subscription GOLD per il tenant TEN00000001001 dal 2025-01-01 al 2026-01-01\n\n```sql\r\nEXEC PORTAL.sp_insert_subscription\r\n    @tenant_id = 'TEN00000001001',\r\n    @plan_code = 'GOLD',\r\n    @start_date = '2025-01-01',\r\n    @end_date = '2026-01-01',\r\n    @created_by = 'chatbot_ams';","size_chars":318,"tokens_estimate":80}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":25,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":26,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->","size_chars":125,"tokens_estimate":31}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":27,"content":"## Esempi Query\r\n`sql\r\n-- SELECT ... FROM ...\r\n`\r\n\"@\r\n  ### a) **sp_insert_subscription**\n\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE SUBSCRIPTION \r\n--STORE PROCEDURE ‚Äì  INSERT SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_subscription\r\n    @tenant_id NVARCHAR(50),\r\n    @plan_code NVARCHAR(50),\r\n    @status NVARCHAR(50) = 'ACTIVE',\r\n    @start_date DATETIME2,\r\n    @end_date DATETIME2,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.SUBSCRIPTION WHERE tenant_id = @tenant_id\r\n              AND plan_code = @plan_code AND start_date = @start_date\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.SUBSCRIPTION (\r\n                tenant_id, plan_code, status, start_date, end_date, external_payment_id,\r\n                payment_provider, last_payment_date, ext_attributes, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @plan_code, @status, @start_date, @end_date,\r\n                @external_payment_id, @payment_provider, @last_payment_date,\r\n                @ext_attributes, COALESCE(@created_by, 'sp_insert_subscription')\r\n            );\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_subscription');","size_chars":1977,"tokens_estimate":494}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":28,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_subscription',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @plan_code AS plan_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql","size_chars":603,"tokens_estimate":151}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_subscription**\r","anchor_slug":"b-spupdatesubscription","chunk_index":29,"content":"### b) **sp_update_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  UPDATE SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_subscription\r\n    @id INT,\r\n    @plan_code NVARCHAR(50) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @start_date DATETIME2 = NULL,\r\n    @end_date DATETIME2 = NULL,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.SUBSCRIPTION\r\n        SET\r\n            plan_code = COALESCE(@plan_code, plan_code),\r\n            status = COALESCE(@status, status),\r\n            start_date = COALESCE(@start_date, start_date),\r\n            end_date = COALESCE(@end_date, end_date),\r\n            external_payment_id = COALESCE(@external_payment_id, external_payment_id),\r\n            payment_provider = COALESCE(@payment_provider, payment_provider),\r\n            last_payment_date = COALESCE(@last_payment_date, last_payment_date),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_subscription')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_subscription',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;","size_chars":2299,"tokens_estimate":575}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_subscription**\r","anchor_slug":"b-spupdatesubscription","chunk_index":30,"content":"    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":125,"tokens_estimate":31}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_subscription**\r","anchor_slug":"c-spdeletesubscription","chunk_index":31,"content":"### c) **sp_delete_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  DELETE SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_subscription\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.SUBSCRIPTION WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_subscription',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql","size_chars":1430,"tokens_estimate":358}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_subscription**\r","anchor_slug":"d-spdebuginsertsubscription","chunk_index":32,"content":"### d) **sp_debug_insert_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  INSERT DEBUG SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_subscription\r\n    @tenant_id NVARCHAR(50),\r\n    @plan_code NVARCHAR(50),\r\n    @status NVARCHAR(50) = 'ACTIVE',\r\n    @start_date DATETIME2,\r\n    @end_date DATETIME2,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SUBSCRIPTION (\r\n            tenant_id, plan_code, status, start_date, end_date, external_payment_id,\r\n            payment_provider, last_payment_date, ext_attributes, created_by\r\n        )\r\n        VALUES (\r\n            @tenant_id, @plan_code, @status, @start_date, @end_date,\r\n            @external_payment_id, @payment_provider, @last_payment_date,\r\n            @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_subscription')\r\n        );\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_subscription',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @plan_code AS plan_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n--FINE SEZIONE STORE PROCEDURE SUBSCRIPTION\n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---","size_chars":2356,"tokens_estimate":589}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_subscription**\r","anchor_slug":"d-spdebuginsertsubscription","chunk_index":33,"content":"Prompt esempio:\r\n> Inserisci una nuova subscription GOLD per il tenant TEN00000001001 dal 2025-01-01 al 2026-01-01\n\n```sql\r\nEXEC PORTAL.sp_insert_subscription\r\n    @tenant_id = 'TEN00000001001',\r\n    @plan_code = 'GOLD',\r\n    @start_date = '2025-01-01',\r\n    @end_date = '2026-01-01',\r\n    @created_by = 'chatbot_ams';","size_chars":318,"tokens_estimate":80}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":34,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":35,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":36,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  ### a) **sp_insert_subscription**\n\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE SUBSCRIPTION \r\n--STORE PROCEDURE ‚Äì  INSERT SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_subscription\r\n    @tenant_id NVARCHAR(50),\r\n    @plan_code NVARCHAR(50),\r\n    @status NVARCHAR(50) = 'ACTIVE',\r\n    @start_date DATETIME2,\r\n    @end_date DATETIME2,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.SUBSCRIPTION WHERE tenant_id = @tenant_id\r\n              AND plan_code = @plan_code AND start_date = @start_date\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.SUBSCRIPTION (\r\n                tenant_id, plan_code, status, start_date, end_date, external_payment_id,\r\n                payment_provider, last_payment_date, ext_attributes, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @plan_code, @status, @start_date, @end_date,\r\n                @external_payment_id, @payment_provider, @last_payment_date,\r\n                @ext_attributes, COALESCE(@created_by, 'sp_insert_subscription')\r\n            );\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_subscription');","size_chars":2045,"tokens_estimate":511}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":37,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_subscription',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @plan_code AS plan_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql","size_chars":603,"tokens_estimate":151}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_subscription**\r","anchor_slug":"b-spupdatesubscription","chunk_index":38,"content":"### b) **sp_update_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  UPDATE SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_subscription\r\n    @id INT,\r\n    @plan_code NVARCHAR(50) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @start_date DATETIME2 = NULL,\r\n    @end_date DATETIME2 = NULL,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.SUBSCRIPTION\r\n        SET\r\n            plan_code = COALESCE(@plan_code, plan_code),\r\n            status = COALESCE(@status, status),\r\n            start_date = COALESCE(@start_date, start_date),\r\n            end_date = COALESCE(@end_date, end_date),\r\n            external_payment_id = COALESCE(@external_payment_id, external_payment_id),\r\n            payment_provider = COALESCE(@payment_provider, payment_provider),\r\n            last_payment_date = COALESCE(@last_payment_date, last_payment_date),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_subscription')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_subscription',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;","size_chars":2299,"tokens_estimate":575}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_subscription**\r","anchor_slug":"b-spupdatesubscription","chunk_index":39,"content":"    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":125,"tokens_estimate":31}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_subscription**\r","anchor_slug":"c-spdeletesubscription","chunk_index":40,"content":"### c) **sp_delete_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  DELETE SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_subscription\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.SUBSCRIPTION WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_subscription',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql","size_chars":1430,"tokens_estimate":358}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_subscription**\r","anchor_slug":"d-spdebuginsertsubscription","chunk_index":41,"content":"### d) **sp_debug_insert_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  INSERT DEBUG SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_subscription\r\n    @tenant_id NVARCHAR(50),\r\n    @plan_code NVARCHAR(50),\r\n    @status NVARCHAR(50) = 'ACTIVE',\r\n    @start_date DATETIME2,\r\n    @end_date DATETIME2,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SUBSCRIPTION (\r\n            tenant_id, plan_code, status, start_date, end_date, external_payment_id,\r\n            payment_provider, last_payment_date, ext_attributes, created_by\r\n        )\r\n        VALUES (\r\n            @tenant_id, @plan_code, @status, @start_date, @end_date,\r\n            @external_payment_id, @payment_provider, @last_payment_date,\r\n            @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_subscription')\r\n        );\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_subscription',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @plan_code AS plan_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n--FINE SEZIONE STORE PROCEDURE SUBSCRIPTION\n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---","size_chars":2356,"tokens_estimate":589}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_subscription**\r","anchor_slug":"d-spdebuginsertsubscription","chunk_index":42,"content":"Prompt esempio:\r\n> Inserisci una nuova subscription GOLD per il tenant TEN00000001001 dal 2025-01-01 al 2026-01-01\n\n```sql\r\nEXEC PORTAL.sp_insert_subscription\r\n    @tenant_id = 'TEN00000001001',\r\n    @plan_code = 'GOLD',\r\n    @start_date = '2025-01-01',\r\n    @end_date = '2026-01-01',\r\n    @created_by = 'chatbot_ams';","size_chars":318,"tokens_estimate":80}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":43,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":44,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section ### a) **sp_insert_subscription**\n\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE SUBSCRIPTION \r\n--STORE PROCEDURE ‚Äì  INSERT SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_subscription\r\n    @tenant_id NVARCHAR(50),\r\n    @plan_code NVARCHAR(50),\r\n    @status NVARCHAR(50) = 'ACTIVE',\r\n    @start_date DATETIME2,\r\n    @end_date DATETIME2,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.SUBSCRIPTION WHERE tenant_id = @tenant_id\r\n              AND plan_code = @plan_code AND start_date = @start_date\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.SUBSCRIPTION (\r\n                tenant_id, plan_code, status, start_date, end_date, external_payment_id,\r\n                payment_provider, last_payment_date, ext_attributes, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @plan_code, @status, @start_date, @end_date,\r\n                @external_payment_id, @payment_provider, @last_payment_date,\r\n                @ext_attributes, COALESCE(@created_by, 'sp_insert_subscription')\r\n            );\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_subscription');","size_chars":1995,"tokens_estimate":499}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":45,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_subscription',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @plan_code AS plan_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql","size_chars":603,"tokens_estimate":151}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_subscription**\r","anchor_slug":"b-spupdatesubscription","chunk_index":46,"content":"### b) **sp_update_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  UPDATE SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_subscription\r\n    @id INT,\r\n    @plan_code NVARCHAR(50) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @start_date DATETIME2 = NULL,\r\n    @end_date DATETIME2 = NULL,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.SUBSCRIPTION\r\n        SET\r\n            plan_code = COALESCE(@plan_code, plan_code),\r\n            status = COALESCE(@status, status),\r\n            start_date = COALESCE(@start_date, start_date),\r\n            end_date = COALESCE(@end_date, end_date),\r\n            external_payment_id = COALESCE(@external_payment_id, external_payment_id),\r\n            payment_provider = COALESCE(@payment_provider, payment_provider),\r\n            last_payment_date = COALESCE(@last_payment_date, last_payment_date),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_subscription')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_subscription',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;","size_chars":2299,"tokens_estimate":575}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_subscription**\r","anchor_slug":"b-spupdatesubscription","chunk_index":47,"content":"    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":125,"tokens_estimate":31}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_subscription**\r","anchor_slug":"c-spdeletesubscription","chunk_index":48,"content":"### c) **sp_delete_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  DELETE SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_subscription\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.SUBSCRIPTION WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_subscription',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql","size_chars":1430,"tokens_estimate":358}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_subscription**\r","anchor_slug":"d-spdebuginsertsubscription","chunk_index":49,"content":"### d) **sp_debug_insert_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  INSERT DEBUG SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_subscription\r\n    @tenant_id NVARCHAR(50),\r\n    @plan_code NVARCHAR(50),\r\n    @status NVARCHAR(50) = 'ACTIVE',\r\n    @start_date DATETIME2,\r\n    @end_date DATETIME2,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SUBSCRIPTION (\r\n            tenant_id, plan_code, status, start_date, end_date, external_payment_id,\r\n            payment_provider, last_payment_date, ext_attributes, created_by\r\n        )\r\n        VALUES (\r\n            @tenant_id, @plan_code, @status, @start_date, @end_date,\r\n            @external_payment_id, @payment_provider, @last_payment_date,\r\n            @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_subscription')\r\n        );\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_subscription',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @plan_code AS plan_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n--FINE SEZIONE STORE PROCEDURE SUBSCRIPTION\n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---","size_chars":2356,"tokens_estimate":589}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_subscription**\r","anchor_slug":"d-spdebuginsertsubscription","chunk_index":50,"content":"Prompt esempio:\r\n> Inserisci una nuova subscription GOLD per il tenant TEN00000001001 dal 2025-01-01 al 2026-01-01\n\n```sql\r\nEXEC PORTAL.sp_insert_subscription\r\n    @tenant_id = 'TEN00000001001',\r\n    @plan_code = 'GOLD',\r\n    @start_date = '2025-01-01',\r\n    @end_date = '2026-01-01',\r\n    @created_by = 'chatbot_ams';","size_chars":318,"tokens_estimate":80}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":51,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":52,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n = Ensure-Section ### a) **sp_insert_subscription**\n\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE SUBSCRIPTION \r\n--STORE PROCEDURE ‚Äì  INSERT SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_subscription\r\n    @tenant_id NVARCHAR(50),\r\n    @plan_code NVARCHAR(50),\r\n    @status NVARCHAR(50) = 'ACTIVE',\r\n    @start_date DATETIME2,\r\n    @end_date DATETIME2,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.SUBSCRIPTION WHERE tenant_id = @tenant_id\r\n              AND plan_code = @plan_code AND start_date = @start_date\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.SUBSCRIPTION (\r\n                tenant_id, plan_code, status, start_date, end_date, external_payment_id,\r\n                payment_provider, last_payment_date, ext_attributes, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @plan_code, @status, @start_date, @end_date,\r\n                @external_payment_id, @payment_provider, @last_payment_date,\r\n                @ext_attributes, COALESCE(@created_by, 'sp_insert_subscription')\r\n            );\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_subscription');","size_chars":2066,"tokens_estimate":516}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":53,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_subscription',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @plan_code AS plan_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql","size_chars":603,"tokens_estimate":151}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_subscription**\r","anchor_slug":"b-spupdatesubscription","chunk_index":54,"content":"### b) **sp_update_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  UPDATE SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_subscription\r\n    @id INT,\r\n    @plan_code NVARCHAR(50) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @start_date DATETIME2 = NULL,\r\n    @end_date DATETIME2 = NULL,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.SUBSCRIPTION\r\n        SET\r\n            plan_code = COALESCE(@plan_code, plan_code),\r\n            status = COALESCE(@status, status),\r\n            start_date = COALESCE(@start_date, start_date),\r\n            end_date = COALESCE(@end_date, end_date),\r\n            external_payment_id = COALESCE(@external_payment_id, external_payment_id),\r\n            payment_provider = COALESCE(@payment_provider, payment_provider),\r\n            last_payment_date = COALESCE(@last_payment_date, last_payment_date),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_subscription')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_subscription',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;","size_chars":2299,"tokens_estimate":575}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_subscription**\r","anchor_slug":"b-spupdatesubscription","chunk_index":55,"content":"    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":125,"tokens_estimate":31}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_subscription**\r","anchor_slug":"c-spdeletesubscription","chunk_index":56,"content":"### c) **sp_delete_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  DELETE SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_subscription\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.SUBSCRIPTION WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_subscription',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql","size_chars":1430,"tokens_estimate":358}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_subscription**\r","anchor_slug":"d-spdebuginsertsubscription","chunk_index":57,"content":"### d) **sp_debug_insert_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  INSERT DEBUG SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_subscription\r\n    @tenant_id NVARCHAR(50),\r\n    @plan_code NVARCHAR(50),\r\n    @status NVARCHAR(50) = 'ACTIVE',\r\n    @start_date DATETIME2,\r\n    @end_date DATETIME2,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SUBSCRIPTION (\r\n            tenant_id, plan_code, status, start_date, end_date, external_payment_id,\r\n            payment_provider, last_payment_date, ext_attributes, created_by\r\n        )\r\n        VALUES (\r\n            @tenant_id, @plan_code, @status, @start_date, @end_date,\r\n            @external_payment_id, @payment_provider, @last_payment_date,\r\n            @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_subscription')\r\n        );\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_subscription',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @plan_code AS plan_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n--FINE SEZIONE STORE PROCEDURE SUBSCRIPTION\n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---","size_chars":2356,"tokens_estimate":589}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_subscription**\r","anchor_slug":"d-spdebuginsertsubscription","chunk_index":58,"content":"Prompt esempio:\r\n> Inserisci una nuova subscription GOLD per il tenant TEN00000001001 dal 2025-01-01 al 2026-01-01\n\n```sql\r\nEXEC PORTAL.sp_insert_subscription\r\n    @tenant_id = 'TEN00000001001',\r\n    @plan_code = 'GOLD',\r\n    @start_date = '2025-01-01',\r\n    @end_date = '2026-01-01',\r\n    @created_by = 'chatbot_ams';","size_chars":318,"tokens_estimate":80}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":59,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":60,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":61,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  ### a) **sp_insert_subscription**\n\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE SUBSCRIPTION \r\n--STORE PROCEDURE ‚Äì  INSERT SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_subscription\r\n    @tenant_id NVARCHAR(50),\r\n    @plan_code NVARCHAR(50),\r\n    @status NVARCHAR(50) = 'ACTIVE',\r\n    @start_date DATETIME2,\r\n    @end_date DATETIME2,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.SUBSCRIPTION WHERE tenant_id = @tenant_id\r\n              AND plan_code = @plan_code AND start_date = @start_date\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.SUBSCRIPTION (\r\n                tenant_id, plan_code, status, start_date, end_date, external_payment_id,\r\n                payment_provider, last_payment_date, ext_attributes, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @plan_code, @status, @start_date, @end_date,\r\n                @external_payment_id, @payment_provider, @last_payment_date,\r\n                @ext_attributes, COALESCE(@created_by, 'sp_insert_subscription')\r\n            );\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_subscription');","size_chars":2045,"tokens_estimate":511}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":62,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_subscription',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @plan_code AS plan_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql","size_chars":603,"tokens_estimate":151}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_subscription**\r","anchor_slug":"b-spupdatesubscription","chunk_index":63,"content":"### b) **sp_update_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  UPDATE SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_subscription\r\n    @id INT,\r\n    @plan_code NVARCHAR(50) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @start_date DATETIME2 = NULL,\r\n    @end_date DATETIME2 = NULL,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.SUBSCRIPTION\r\n        SET\r\n            plan_code = COALESCE(@plan_code, plan_code),\r\n            status = COALESCE(@status, status),\r\n            start_date = COALESCE(@start_date, start_date),\r\n            end_date = COALESCE(@end_date, end_date),\r\n            external_payment_id = COALESCE(@external_payment_id, external_payment_id),\r\n            payment_provider = COALESCE(@payment_provider, payment_provider),\r\n            last_payment_date = COALESCE(@last_payment_date, last_payment_date),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_subscription')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_subscription',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;","size_chars":2299,"tokens_estimate":575}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_subscription**\r","anchor_slug":"b-spupdatesubscription","chunk_index":64,"content":"    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":125,"tokens_estimate":31}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_subscription**\r","anchor_slug":"c-spdeletesubscription","chunk_index":65,"content":"### c) **sp_delete_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  DELETE SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_subscription\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.SUBSCRIPTION WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_subscription',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql","size_chars":1430,"tokens_estimate":358}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_subscription**\r","anchor_slug":"d-spdebuginsertsubscription","chunk_index":66,"content":"### d) **sp_debug_insert_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  INSERT DEBUG SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_subscription\r\n    @tenant_id NVARCHAR(50),\r\n    @plan_code NVARCHAR(50),\r\n    @status NVARCHAR(50) = 'ACTIVE',\r\n    @start_date DATETIME2,\r\n    @end_date DATETIME2,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SUBSCRIPTION (\r\n            tenant_id, plan_code, status, start_date, end_date, external_payment_id,\r\n            payment_provider, last_payment_date, ext_attributes, created_by\r\n        )\r\n        VALUES (\r\n            @tenant_id, @plan_code, @status, @start_date, @end_date,\r\n            @external_payment_id, @payment_provider, @last_payment_date,\r\n            @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_subscription')\r\n        );\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_subscription',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @plan_code AS plan_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n--FINE SEZIONE STORE PROCEDURE SUBSCRIPTION\n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---","size_chars":2356,"tokens_estimate":589}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_subscription**\r","anchor_slug":"d-spdebuginsertsubscription","chunk_index":67,"content":"Prompt esempio:\r\n> Inserisci una nuova subscription GOLD per il tenant TEN00000001001 dal 2025-01-01 al 2026-01-01\n\n```sql\r\nEXEC PORTAL.sp_insert_subscription\r\n    @tenant_id = 'TEN00000001001',\r\n    @plan_code = 'GOLD',\r\n    @start_date = '2025-01-01',\r\n    @end_date = '2026-01-01',\r\n    @created_by = 'chatbot_ams';","size_chars":318,"tokens_estimate":80}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":68,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":69,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section ### a) **sp_insert_subscription**\n\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE SUBSCRIPTION \r\n--STORE PROCEDURE ‚Äì  INSERT SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_subscription\r\n    @tenant_id NVARCHAR(50),\r\n    @plan_code NVARCHAR(50),\r\n    @status NVARCHAR(50) = 'ACTIVE',\r\n    @start_date DATETIME2,\r\n    @end_date DATETIME2,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.SUBSCRIPTION WHERE tenant_id = @tenant_id\r\n              AND plan_code = @plan_code AND start_date = @start_date\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.SUBSCRIPTION (\r\n                tenant_id, plan_code, status, start_date, end_date, external_payment_id,\r\n                payment_provider, last_payment_date, ext_attributes, created_by\r\n            )\r\n            VALUES (\r\n                @tenant_id, @plan_code, @status, @start_date, @end_date,\r\n                @external_payment_id, @payment_provider, @last_payment_date,\r\n                @ext_attributes, COALESCE(@created_by, 'sp_insert_subscription')\r\n            );\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_subscription');","size_chars":1995,"tokens_estimate":499}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":70,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_subscription',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @plan_code AS plan_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql","size_chars":603,"tokens_estimate":151}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_subscription**\r","anchor_slug":"b-spupdatesubscription","chunk_index":71,"content":"### b) **sp_update_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  UPDATE SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_subscription\r\n    @id INT,\r\n    @plan_code NVARCHAR(50) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @start_date DATETIME2 = NULL,\r\n    @end_date DATETIME2 = NULL,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.SUBSCRIPTION\r\n        SET\r\n            plan_code = COALESCE(@plan_code, plan_code),\r\n            status = COALESCE(@status, status),\r\n            start_date = COALESCE(@start_date, start_date),\r\n            end_date = COALESCE(@end_date, end_date),\r\n            external_payment_id = COALESCE(@external_payment_id, external_payment_id),\r\n            payment_provider = COALESCE(@payment_provider, payment_provider),\r\n            last_payment_date = COALESCE(@last_payment_date, last_payment_date),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_subscription')\r\n        WHERE id = @id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_subscription',\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;","size_chars":2299,"tokens_estimate":575}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_subscription**\r","anchor_slug":"b-spupdatesubscription","chunk_index":72,"content":"    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":125,"tokens_estimate":31}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_subscription**\r","anchor_slug":"c-spdeletesubscription","chunk_index":73,"content":"### c) **sp_delete_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  DELETE SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_subscription\r\n    @id INT,\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.SUBSCRIPTION WHERE id = @id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_subscription',\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @id AS id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql","size_chars":1430,"tokens_estimate":358}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_subscription**\r","anchor_slug":"d-spdebuginsertsubscription","chunk_index":74,"content":"### d) **sp_debug_insert_subscription**\n\n```sql\r\n--STORE PROCEDURE ‚Äì  INSERT DEBUG SUBSCRIPTION\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_subscription\r\n    @tenant_id NVARCHAR(50),\r\n    @plan_code NVARCHAR(50),\r\n    @status NVARCHAR(50) = 'ACTIVE',\r\n    @start_date DATETIME2,\r\n    @end_date DATETIME2,\r\n    @external_payment_id NVARCHAR(100) = NULL,\r\n    @payment_provider NVARCHAR(50) = NULL,\r\n    @last_payment_date DATETIME2 = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        INSERT INTO PORTAL.SUBSCRIPTION (\r\n            tenant_id, plan_code, status, start_date, end_date, external_payment_id,\r\n            payment_provider, last_payment_date, ext_attributes, created_by\r\n        )\r\n        VALUES (\r\n            @tenant_id, @plan_code, @status, @start_date, @end_date,\r\n            @external_payment_id, @payment_provider, @last_payment_date,\r\n            @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_subscription')\r\n        );\r\n        SET @rows_inserted = 1;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_subscription');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_subscription',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.SUBSCRIPTION',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @plan_code AS plan_code, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n--FINE SEZIONE STORE PROCEDURE SUBSCRIPTION\n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---","size_chars":2356,"tokens_estimate":589}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_subscription**\r","anchor_slug":"d-spdebuginsertsubscription","chunk_index":75,"content":"Prompt esempio:\r\n> Inserisci una nuova subscription GOLD per il tenant TEN00000001001 dal 2025-01-01 al 2026-01-01\n\n```sql\r\nEXEC PORTAL.sp_insert_subscription\r\n    @tenant_id = 'TEN00000001001',\r\n    @plan_code = 'GOLD',\r\n    @start_date = '2025-01-01',\r\n    @end_date = '2026-01-01',\r\n    @created_by = 'chatbot_ams';","size_chars":318,"tokens_estimate":80}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":76,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":77,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n 'Domande a cui risponde' @\"\r\n- Cosa fa?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":281,"tokens_estimate":70}
{"doc_id":"ew-subscription","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/subscription.md","title":"a) **sp_insert_subscription**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Collegamenti\r","anchor_slug":"collegamenti","chunk_index":78,"content":"## Collegamenti\r\n- [Entities Index](../../../../../../entities-index.md)","size_chars":72,"tokens_estimate":18}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"sp_insert_tenant\r","anchor_slug":"spinserttenant","chunk_index":1,"content":"### sp_insert_tenant\n\n| Parametro      | Tipo           | Descrizione                  |\r\n|----------------|----------------|------------------------------|\r\n| tenant_id      | NVARCHAR(50)   | Codice NDG (auto se NULL)    |\r\n| name           | NVARCHAR(255)  | Ragione sociale/nome tenant  |\r\n| plan_code      | NVARCHAR(50)   | Piano EasyWay                |\r\n| ext_attributes | NVARCHAR(MAX)  | Estensioni JSON custom       |\r\n| created_by     | NVARCHAR(255)  | Utente/SP di creazione       |\n\n- Logging automatico su STATS_EXECUTION_LOG.\r\n- Gestione NDG e transazione atomica.\r\n- Versione DEBUG disponibile.","size_chars":612,"tokens_estimate":153}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":2,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":3,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":4,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  **Di seguito troverai:**\r\n----------------------------\n\n*   Store **INSERT** (con NDG, logging, auditing)\r\n    \r\n*   Store **UPDATE** (update fields, logging, auditing)\r\n    \r\n*   Store **DELETE** (soft delete o hard, logging, auditing)\r\n    \r\n*   Versione **DEBUG** per ogni store process\n\n\r\n1Ô∏è‚É£ `sp_insert_tenant`\r\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE USERS \r\n--STORE PROCEDURE ‚Äì INSERIMENTO TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_tenant\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n            SET @tenant_id = 'TEN' + RIGHT('000000000' + CAST(@next_seq_tenant AS NVARCHAR), 9);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.TENANT (tenant_id, name, plan_code, ext_attributes, created_by)\r\n            VALUES (@tenant_id, @name, @plan_code, @ext_attributes, COALESCE(@created_by, 'sp_insert_tenant'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_tenant');","size_chars":2008,"tokens_estimate":502}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":5,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql\n\n2Ô∏è‚É£ `sp_update_tenant`\n\n```sql\r\n--STORE PROCEDURE ‚Äì AGGIORNA TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_tenant\r\n    @tenant_id NVARCHAR(50),\r\n    @name NVARCHAR(255) = NULL,\r\n    @plan_code NVARCHAR(50) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.TENANT\r\n        SET\r\n            name = COALESCE(@name, name),\r\n            plan_code = COALESCE(@plan_code, plan_code),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_tenant')\r\n        WHERE tenant_id = @tenant_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;","size_chars":2305,"tokens_estimate":576}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":6,"content":"    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\r\n```sql\n\n3Ô∏è‚É£ `sp_delete_tenant`\n\n```sql\r\n--STORE PROCEDURE ‚Äì CANCELLA TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_tenant\r\n    @tenant_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.TENANT WHERE tenant_id = @tenant_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql\n\n5Ô∏è‚É£ `sp_debug_insert_tenant`","size_chars":1633,"tokens_estimate":408}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":7,"content":"```sql\r\n--STORE PROCEDURE ‚Äì DEBUG INSERT TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_tenant\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n            SET @tenant_id = 'TENDEBUG' + RIGHT('000' + CAST(@next_seq_tenant AS NVARCHAR), 3);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.TENANT (tenant_id, name, plan_code, ext_attributes, created_by)\r\n            VALUES (@tenant_id, @name, @plan_code, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_tenant'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql\n\n\r\nüìë **Documentazione .md**\r\n-------------------------\n\nPer ogni store procedure avrai la sezione .md standard cos√¨:","size_chars":2242,"tokens_estimate":560}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"sp_insert_tenant\r","anchor_slug":"spinserttenant","chunk_index":8,"content":"### sp_insert_tenant\n\n| Parametro      | Tipo           | Descrizione                  |\r\n|----------------|----------------|------------------------------|\r\n| tenant_id      | NVARCHAR(50)   | Codice NDG (auto se NULL)    |\r\n| name           | NVARCHAR(255)  | Ragione sociale/nome tenant  |\r\n| plan_code      | NVARCHAR(50)   | Piano EasyWay                |\r\n| ext_attributes | NVARCHAR(MAX)  | Estensioni JSON custom       |\r\n| created_by     | NVARCHAR(255)  | Utente/SP di creazione       |\n\n- Logging automatico su STATS_EXECUTION_LOG.\r\n- Gestione NDG e transazione atomica.\r\n- Versione DEBUG disponibile.","size_chars":612,"tokens_estimate":153}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":9,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":10,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section **Di seguito troverai:**\r\n----------------------------\n\n*   Store **INSERT** (con NDG, logging, auditing)\r\n    \r\n*   Store **UPDATE** (update fields, logging, auditing)\r\n    \r\n*   Store **DELETE** (soft delete o hard, logging, auditing)\r\n    \r\n*   Versione **DEBUG** per ogni store process\n\n\r\n1Ô∏è‚É£ `sp_insert_tenant`\r\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE USERS \r\n--STORE PROCEDURE ‚Äì INSERIMENTO TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_tenant\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n            SET @tenant_id = 'TEN' + RIGHT('000000000' + CAST(@next_seq_tenant AS NVARCHAR), 9);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.TENANT (tenant_id, name, plan_code, ext_attributes, created_by)\r\n            VALUES (@tenant_id, @name, @plan_code, @ext_attributes, COALESCE(@created_by, 'sp_insert_tenant'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;","size_chars":2383,"tokens_estimate":596}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":11,"content":"    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql\n\n2Ô∏è‚É£ `sp_update_tenant`\n\n```sql\r\n--STORE PROCEDURE ‚Äì AGGIORNA TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_tenant\r\n    @tenant_id NVARCHAR(50),\r\n    @name NVARCHAR(255) = NULL,\r\n    @plan_code NVARCHAR(50) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.TENANT\r\n        SET\r\n            name = COALESCE(@name, name),\r\n            plan_code = COALESCE(@plan_code, plan_code),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_tenant')\r\n        WHERE tenant_id = @tenant_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\r\n```sql\n\n3Ô∏è‚É£ `sp_delete_tenant`","size_chars":2045,"tokens_estimate":511}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":12,"content":"```sql\r\n--STORE PROCEDURE ‚Äì CANCELLA TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_tenant\r\n    @tenant_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.TENANT WHERE tenant_id = @tenant_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql\n\n5Ô∏è‚É£ `sp_debug_insert_tenant`\n\n```sql\r\n--STORE PROCEDURE ‚Äì DEBUG INSERT TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_tenant\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n            SET @tenant_id = 'TENDEBUG' + RIGHT('000' + CAST(@next_seq_tenant AS NVARCHAR), 3);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":13,"content":"INTO PORTAL.TENANT (tenant_id, name, plan_code, ext_attributes, created_by)\r\n            VALUES (@tenant_id, @name, @plan_code, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_tenant'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql\n\n\r\nüìë **Documentazione .md**\r\n-------------------------\n\nPer ogni store procedure avrai la sezione .md standard cos√¨:","size_chars":1311,"tokens_estimate":328}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"sp_insert_tenant\r","anchor_slug":"spinserttenant","chunk_index":14,"content":"### sp_insert_tenant\n\n| Parametro      | Tipo           | Descrizione                  |\r\n|----------------|----------------|------------------------------|\r\n| tenant_id      | NVARCHAR(50)   | Codice NDG (auto se NULL)    |\r\n| name           | NVARCHAR(255)  | Ragione sociale/nome tenant  |\r\n| plan_code      | NVARCHAR(50)   | Piano EasyWay                |\r\n| ext_attributes | NVARCHAR(MAX)  | Estensioni JSON custom       |\r\n| created_by     | NVARCHAR(255)  | Utente/SP di creazione       |\n\n- Logging automatico su STATS_EXECUTION_LOG.\r\n- Gestione NDG e transazione atomica.\r\n- Versione DEBUG disponibile.","size_chars":612,"tokens_estimate":153}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":15,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":16,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->","size_chars":125,"tokens_estimate":31}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":17,"content":"## Esempi Query\r\n`sql\r\n-- SELECT ... FROM ...\r\n`\r\n\"@\r\n  **Di seguito troverai:**\r\n----------------------------\n\n*   Store **INSERT** (con NDG, logging, auditing)\r\n    \r\n*   Store **UPDATE** (update fields, logging, auditing)\r\n    \r\n*   Store **DELETE** (soft delete o hard, logging, auditing)\r\n    \r\n*   Versione **DEBUG** per ogni store process\n\n\r\n1Ô∏è‚É£ `sp_insert_tenant`\r\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE USERS \r\n--STORE PROCEDURE ‚Äì INSERIMENTO TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_tenant\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n            SET @tenant_id = 'TEN' + RIGHT('000000000' + CAST(@next_seq_tenant AS NVARCHAR), 9);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.TENANT (tenant_id, name, plan_code, ext_attributes, created_by)\r\n            VALUES (@tenant_id, @name, @plan_code, @ext_attributes, COALESCE(@created_by, 'sp_insert_tenant'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;","size_chars":2365,"tokens_estimate":591}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":18,"content":"    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql\n\n2Ô∏è‚É£ `sp_update_tenant`\n\n```sql\r\n--STORE PROCEDURE ‚Äì AGGIORNA TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_tenant\r\n    @tenant_id NVARCHAR(50),\r\n    @name NVARCHAR(255) = NULL,\r\n    @plan_code NVARCHAR(50) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.TENANT\r\n        SET\r\n            name = COALESCE(@name, name),\r\n            plan_code = COALESCE(@plan_code, plan_code),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_tenant')\r\n        WHERE tenant_id = @tenant_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\r\n```sql\n\n3Ô∏è‚É£ `sp_delete_tenant`","size_chars":2045,"tokens_estimate":511}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":19,"content":"```sql\r\n--STORE PROCEDURE ‚Äì CANCELLA TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_tenant\r\n    @tenant_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.TENANT WHERE tenant_id = @tenant_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql\n\n5Ô∏è‚É£ `sp_debug_insert_tenant`\n\n```sql\r\n--STORE PROCEDURE ‚Äì DEBUG INSERT TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_tenant\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n            SET @tenant_id = 'TENDEBUG' + RIGHT('000' + CAST(@next_seq_tenant AS NVARCHAR), 3);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":20,"content":"INTO PORTAL.TENANT (tenant_id, name, plan_code, ext_attributes, created_by)\r\n            VALUES (@tenant_id, @name, @plan_code, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_tenant'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql\n\n\r\nüìë **Documentazione .md**\r\n-------------------------\n\nPer ogni store procedure avrai la sezione .md standard cos√¨:","size_chars":1311,"tokens_estimate":328}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"sp_insert_tenant\r","anchor_slug":"spinserttenant","chunk_index":21,"content":"### sp_insert_tenant\n\n| Parametro      | Tipo           | Descrizione                  |\r\n|----------------|----------------|------------------------------|\r\n| tenant_id      | NVARCHAR(50)   | Codice NDG (auto se NULL)    |\r\n| name           | NVARCHAR(255)  | Ragione sociale/nome tenant  |\r\n| plan_code      | NVARCHAR(50)   | Piano EasyWay                |\r\n| ext_attributes | NVARCHAR(MAX)  | Estensioni JSON custom       |\r\n| created_by     | NVARCHAR(255)  | Utente/SP di creazione       |\n\n- Logging automatico su STATS_EXECUTION_LOG.\r\n- Gestione NDG e transazione atomica.\r\n- Versione DEBUG disponibile.","size_chars":612,"tokens_estimate":153}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":22,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":23,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":24,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  **Di seguito troverai:**\r\n----------------------------\n\n*   Store **INSERT** (con NDG, logging, auditing)\r\n    \r\n*   Store **UPDATE** (update fields, logging, auditing)\r\n    \r\n*   Store **DELETE** (soft delete o hard, logging, auditing)\r\n    \r\n*   Versione **DEBUG** per ogni store process\n\n\r\n1Ô∏è‚É£ `sp_insert_tenant`\r\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE USERS \r\n--STORE PROCEDURE ‚Äì INSERIMENTO TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_tenant\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n            SET @tenant_id = 'TEN' + RIGHT('000000000' + CAST(@next_seq_tenant AS NVARCHAR), 9);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.TENANT (tenant_id, name, plan_code, ext_attributes, created_by)\r\n            VALUES (@tenant_id, @name, @plan_code, @ext_attributes, COALESCE(@created_by, 'sp_insert_tenant'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_tenant');","size_chars":2008,"tokens_estimate":502}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":25,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql\n\n2Ô∏è‚É£ `sp_update_tenant`\n\n```sql\r\n--STORE PROCEDURE ‚Äì AGGIORNA TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_tenant\r\n    @tenant_id NVARCHAR(50),\r\n    @name NVARCHAR(255) = NULL,\r\n    @plan_code NVARCHAR(50) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.TENANT\r\n        SET\r\n            name = COALESCE(@name, name),\r\n            plan_code = COALESCE(@plan_code, plan_code),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_tenant')\r\n        WHERE tenant_id = @tenant_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;","size_chars":2305,"tokens_estimate":576}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":26,"content":"    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\r\n```sql\n\n3Ô∏è‚É£ `sp_delete_tenant`\n\n```sql\r\n--STORE PROCEDURE ‚Äì CANCELLA TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_tenant\r\n    @tenant_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.TENANT WHERE tenant_id = @tenant_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql\n\n5Ô∏è‚É£ `sp_debug_insert_tenant`","size_chars":1633,"tokens_estimate":408}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":27,"content":"```sql\r\n--STORE PROCEDURE ‚Äì DEBUG INSERT TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_tenant\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n            SET @tenant_id = 'TENDEBUG' + RIGHT('000' + CAST(@next_seq_tenant AS NVARCHAR), 3);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.TENANT (tenant_id, name, plan_code, ext_attributes, created_by)\r\n            VALUES (@tenant_id, @name, @plan_code, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_tenant'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql\n\n\r\nüìë **Documentazione .md**\r\n-------------------------\n\nPer ogni store procedure avrai la sezione .md standard cos√¨:","size_chars":2242,"tokens_estimate":560}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"sp_insert_tenant\r","anchor_slug":"spinserttenant","chunk_index":28,"content":"### sp_insert_tenant\n\n| Parametro      | Tipo           | Descrizione                  |\r\n|----------------|----------------|------------------------------|\r\n| tenant_id      | NVARCHAR(50)   | Codice NDG (auto se NULL)    |\r\n| name           | NVARCHAR(255)  | Ragione sociale/nome tenant  |\r\n| plan_code      | NVARCHAR(50)   | Piano EasyWay                |\r\n| ext_attributes | NVARCHAR(MAX)  | Estensioni JSON custom       |\r\n| created_by     | NVARCHAR(255)  | Utente/SP di creazione       |\n\n- Logging automatico su STATS_EXECUTION_LOG.\r\n- Gestione NDG e transazione atomica.\r\n- Versione DEBUG disponibile.","size_chars":612,"tokens_estimate":153}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":29,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":30,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section **Di seguito troverai:**\r\n----------------------------\n\n*   Store **INSERT** (con NDG, logging, auditing)\r\n    \r\n*   Store **UPDATE** (update fields, logging, auditing)\r\n    \r\n*   Store **DELETE** (soft delete o hard, logging, auditing)\r\n    \r\n*   Versione **DEBUG** per ogni store process\n\n\r\n1Ô∏è‚É£ `sp_insert_tenant`\r\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE USERS \r\n--STORE PROCEDURE ‚Äì INSERIMENTO TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_tenant\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n            SET @tenant_id = 'TEN' + RIGHT('000000000' + CAST(@next_seq_tenant AS NVARCHAR), 9);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.TENANT (tenant_id, name, plan_code, ext_attributes, created_by)\r\n            VALUES (@tenant_id, @name, @plan_code, @ext_attributes, COALESCE(@created_by, 'sp_insert_tenant'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;","size_chars":2383,"tokens_estimate":596}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":31,"content":"    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql\n\n2Ô∏è‚É£ `sp_update_tenant`\n\n```sql\r\n--STORE PROCEDURE ‚Äì AGGIORNA TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_tenant\r\n    @tenant_id NVARCHAR(50),\r\n    @name NVARCHAR(255) = NULL,\r\n    @plan_code NVARCHAR(50) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.TENANT\r\n        SET\r\n            name = COALESCE(@name, name),\r\n            plan_code = COALESCE(@plan_code, plan_code),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_tenant')\r\n        WHERE tenant_id = @tenant_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\r\n```sql\n\n3Ô∏è‚É£ `sp_delete_tenant`","size_chars":2045,"tokens_estimate":511}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":32,"content":"```sql\r\n--STORE PROCEDURE ‚Äì CANCELLA TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_tenant\r\n    @tenant_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.TENANT WHERE tenant_id = @tenant_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql\n\n5Ô∏è‚É£ `sp_debug_insert_tenant`\n\n```sql\r\n--STORE PROCEDURE ‚Äì DEBUG INSERT TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_tenant\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n            SET @tenant_id = 'TENDEBUG' + RIGHT('000' + CAST(@next_seq_tenant AS NVARCHAR), 3);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":33,"content":"INTO PORTAL.TENANT (tenant_id, name, plan_code, ext_attributes, created_by)\r\n            VALUES (@tenant_id, @name, @plan_code, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_tenant'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql\n\n\r\nüìë **Documentazione .md**\r\n-------------------------\n\nPer ogni store procedure avrai la sezione .md standard cos√¨:","size_chars":1311,"tokens_estimate":328}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"sp_insert_tenant\r","anchor_slug":"spinserttenant","chunk_index":34,"content":"### sp_insert_tenant\n\n| Parametro      | Tipo           | Descrizione                  |\r\n|----------------|----------------|------------------------------|\r\n| tenant_id      | NVARCHAR(50)   | Codice NDG (auto se NULL)    |\r\n| name           | NVARCHAR(255)  | Ragione sociale/nome tenant  |\r\n| plan_code      | NVARCHAR(50)   | Piano EasyWay                |\r\n| ext_attributes | NVARCHAR(MAX)  | Estensioni JSON custom       |\r\n| created_by     | NVARCHAR(255)  | Utente/SP di creazione       |\n\n- Logging automatico su STATS_EXECUTION_LOG.\r\n- Gestione NDG e transazione atomica.\r\n- Versione DEBUG disponibile.","size_chars":612,"tokens_estimate":153}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":35,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":36,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n = Ensure-Section **Di seguito troverai:**\r\n----------------------------\n\n*   Store **INSERT** (con NDG, logging, auditing)\r\n    \r\n*   Store **UPDATE** (update fields, logging, auditing)\r\n    \r\n*   Store **DELETE** (soft delete o hard, logging, auditing)\r\n    \r\n*   Versione **DEBUG** per ogni store process\n\n\r\n1Ô∏è‚É£ `sp_insert_tenant`\r\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE USERS \r\n--STORE PROCEDURE ‚Äì INSERIMENTO TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_tenant\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n            SET @tenant_id = 'TEN' + RIGHT('000000000' + CAST(@next_seq_tenant AS NVARCHAR), 9);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.TENANT (tenant_id, name, plan_code, ext_attributes, created_by)\r\n            VALUES (@tenant_id, @name, @plan_code, @ext_attributes, COALESCE(@created_by, 'sp_insert_tenant'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_tenant');","size_chars":2029,"tokens_estimate":507}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":37,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql\n\n2Ô∏è‚É£ `sp_update_tenant`\n\n```sql\r\n--STORE PROCEDURE ‚Äì AGGIORNA TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_tenant\r\n    @tenant_id NVARCHAR(50),\r\n    @name NVARCHAR(255) = NULL,\r\n    @plan_code NVARCHAR(50) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.TENANT\r\n        SET\r\n            name = COALESCE(@name, name),\r\n            plan_code = COALESCE(@plan_code, plan_code),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_tenant')\r\n        WHERE tenant_id = @tenant_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;","size_chars":2305,"tokens_estimate":576}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":38,"content":"    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\r\n```sql\n\n3Ô∏è‚É£ `sp_delete_tenant`\n\n```sql\r\n--STORE PROCEDURE ‚Äì CANCELLA TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_tenant\r\n    @tenant_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.TENANT WHERE tenant_id = @tenant_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql\n\n5Ô∏è‚É£ `sp_debug_insert_tenant`","size_chars":1633,"tokens_estimate":408}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":39,"content":"```sql\r\n--STORE PROCEDURE ‚Äì DEBUG INSERT TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_tenant\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n            SET @tenant_id = 'TENDEBUG' + RIGHT('000' + CAST(@next_seq_tenant AS NVARCHAR), 3);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.TENANT (tenant_id, name, plan_code, ext_attributes, created_by)\r\n            VALUES (@tenant_id, @name, @plan_code, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_tenant'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql\n\n\r\nüìë **Documentazione .md**\r\n-------------------------\n\nPer ogni store procedure avrai la sezione .md standard cos√¨:","size_chars":2242,"tokens_estimate":560}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"sp_insert_tenant\r","anchor_slug":"spinserttenant","chunk_index":40,"content":"### sp_insert_tenant\n\n| Parametro      | Tipo           | Descrizione                  |\r\n|----------------|----------------|------------------------------|\r\n| tenant_id      | NVARCHAR(50)   | Codice NDG (auto se NULL)    |\r\n| name           | NVARCHAR(255)  | Ragione sociale/nome tenant  |\r\n| plan_code      | NVARCHAR(50)   | Piano EasyWay                |\r\n| ext_attributes | NVARCHAR(MAX)  | Estensioni JSON custom       |\r\n| created_by     | NVARCHAR(255)  | Utente/SP di creazione       |\n\n- Logging automatico su STATS_EXECUTION_LOG.\r\n- Gestione NDG e transazione atomica.\r\n- Versione DEBUG disponibile.","size_chars":612,"tokens_estimate":153}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":41,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":42,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":43,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  **Di seguito troverai:**\r\n----------------------------\n\n*   Store **INSERT** (con NDG, logging, auditing)\r\n    \r\n*   Store **UPDATE** (update fields, logging, auditing)\r\n    \r\n*   Store **DELETE** (soft delete o hard, logging, auditing)\r\n    \r\n*   Versione **DEBUG** per ogni store process\n\n\r\n1Ô∏è‚É£ `sp_insert_tenant`\r\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE USERS \r\n--STORE PROCEDURE ‚Äì INSERIMENTO TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_tenant\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n            SET @tenant_id = 'TEN' + RIGHT('000000000' + CAST(@next_seq_tenant AS NVARCHAR), 9);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.TENANT (tenant_id, name, plan_code, ext_attributes, created_by)\r\n            VALUES (@tenant_id, @name, @plan_code, @ext_attributes, COALESCE(@created_by, 'sp_insert_tenant'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_tenant');","size_chars":2008,"tokens_estimate":502}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":44,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql\n\n2Ô∏è‚É£ `sp_update_tenant`\n\n```sql\r\n--STORE PROCEDURE ‚Äì AGGIORNA TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_tenant\r\n    @tenant_id NVARCHAR(50),\r\n    @name NVARCHAR(255) = NULL,\r\n    @plan_code NVARCHAR(50) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.TENANT\r\n        SET\r\n            name = COALESCE(@name, name),\r\n            plan_code = COALESCE(@plan_code, plan_code),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_tenant')\r\n        WHERE tenant_id = @tenant_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;","size_chars":2305,"tokens_estimate":576}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":45,"content":"    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\r\n```sql\n\n3Ô∏è‚É£ `sp_delete_tenant`\n\n```sql\r\n--STORE PROCEDURE ‚Äì CANCELLA TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_tenant\r\n    @tenant_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.TENANT WHERE tenant_id = @tenant_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql\n\n5Ô∏è‚É£ `sp_debug_insert_tenant`","size_chars":1633,"tokens_estimate":408}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":46,"content":"```sql\r\n--STORE PROCEDURE ‚Äì DEBUG INSERT TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_tenant\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n            SET @tenant_id = 'TENDEBUG' + RIGHT('000' + CAST(@next_seq_tenant AS NVARCHAR), 3);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.TENANT (tenant_id, name, plan_code, ext_attributes, created_by)\r\n            VALUES (@tenant_id, @name, @plan_code, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_tenant'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql\n\n\r\nüìë **Documentazione .md**\r\n-------------------------\n\nPer ogni store procedure avrai la sezione .md standard cos√¨:","size_chars":2242,"tokens_estimate":560}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"sp_insert_tenant\r","anchor_slug":"spinserttenant","chunk_index":47,"content":"### sp_insert_tenant\n\n| Parametro      | Tipo           | Descrizione                  |\r\n|----------------|----------------|------------------------------|\r\n| tenant_id      | NVARCHAR(50)   | Codice NDG (auto se NULL)    |\r\n| name           | NVARCHAR(255)  | Ragione sociale/nome tenant  |\r\n| plan_code      | NVARCHAR(50)   | Piano EasyWay                |\r\n| ext_attributes | NVARCHAR(MAX)  | Estensioni JSON custom       |\r\n| created_by     | NVARCHAR(255)  | Utente/SP di creazione       |\n\n- Logging automatico su STATS_EXECUTION_LOG.\r\n- Gestione NDG e transazione atomica.\r\n- Versione DEBUG disponibile.","size_chars":612,"tokens_estimate":153}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":48,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":49,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section **Di seguito troverai:**\r\n----------------------------\n\n*   Store **INSERT** (con NDG, logging, auditing)\r\n    \r\n*   Store **UPDATE** (update fields, logging, auditing)\r\n    \r\n*   Store **DELETE** (soft delete o hard, logging, auditing)\r\n    \r\n*   Versione **DEBUG** per ogni store process\n\n\r\n1Ô∏è‚É£ `sp_insert_tenant`\r\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE USERS \r\n--STORE PROCEDURE ‚Äì INSERIMENTO TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_tenant\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID;\r\n            SET @tenant_id = 'TEN' + RIGHT('000000000' + CAST(@next_seq_tenant AS NVARCHAR), 9);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.TENANT (tenant_id, name, plan_code, ext_attributes, created_by)\r\n            VALUES (@tenant_id, @name, @plan_code, @ext_attributes, COALESCE(@created_by, 'sp_insert_tenant'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;","size_chars":2383,"tokens_estimate":596}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":50,"content":"    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql\n\n2Ô∏è‚É£ `sp_update_tenant`\n\n```sql\r\n--STORE PROCEDURE ‚Äì AGGIORNA TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_tenant\r\n    @tenant_id NVARCHAR(50),\r\n    @name NVARCHAR(255) = NULL,\r\n    @plan_code NVARCHAR(50) = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.TENANT\r\n        SET\r\n            name = COALESCE(@name, name),\r\n            plan_code = COALESCE(@plan_code, plan_code),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_tenant')\r\n        WHERE tenant_id = @tenant_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\r\n```sql\n\n3Ô∏è‚É£ `sp_delete_tenant`","size_chars":2045,"tokens_estimate":511}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":51,"content":"```sql\r\n--STORE PROCEDURE ‚Äì CANCELLA TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_tenant\r\n    @tenant_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.TENANT WHERE tenant_id = @tenant_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\r\n```sql\n\n5Ô∏è‚É£ `sp_debug_insert_tenant`\n\n```sql\r\n--STORE PROCEDURE ‚Äì DEBUG INSERT TENANT\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_tenant\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @name NVARCHAR(255),\r\n    @plan_code NVARCHAR(50),\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @tenant_id IS NULL OR @tenant_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_tenant INT;\r\n            SET @next_seq_tenant = NEXT VALUE FOR PORTAL.SEQ_TENANT_ID_DEBUG;\r\n            SET @tenant_id = 'TENDEBUG' + RIGHT('000' + CAST(@next_seq_tenant AS NVARCHAR), 3);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.TENANT WHERE tenant_id = @tenant_id)\r\n        BEGIN\r\n            INSERT","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":52,"content":"INTO PORTAL.TENANT (tenant_id, name, plan_code, ext_attributes, created_by)\r\n            VALUES (@tenant_id, @name, @plan_code, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_tenant'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_tenant');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_tenant',\r\n        @tenant_id = @tenant_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.TENANT',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql\n\n\r\nüìë **Documentazione .md**\r\n-------------------------\n\nPer ogni store procedure avrai la sezione .md standard cos√¨:","size_chars":1311,"tokens_estimate":328}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"sp_insert_tenant\r","anchor_slug":"spinserttenant","chunk_index":53,"content":"### sp_insert_tenant\n\n| Parametro      | Tipo           | Descrizione                  |\r\n|----------------|----------------|------------------------------|\r\n| tenant_id      | NVARCHAR(50)   | Codice NDG (auto se NULL)    |\r\n| name           | NVARCHAR(255)  | Ragione sociale/nome tenant  |\r\n| plan_code      | NVARCHAR(50)   | Piano EasyWay                |\r\n| ext_attributes | NVARCHAR(MAX)  | Estensioni JSON custom       |\r\n| created_by     | NVARCHAR(255)  | Utente/SP di creazione       |\n\n- Logging automatico su STATS_EXECUTION_LOG.\r\n- Gestione NDG e transazione atomica.\r\n- Versione DEBUG disponibile.","size_chars":612,"tokens_estimate":153}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":54,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":55,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n 'Domande a cui risponde' @\"\r\n- Cosa fa?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":281,"tokens_estimate":70}
{"doc_id":"ew-tenant","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/tenant.md","title":"sp_insert_tenant","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Collegamenti\r","anchor_slug":"collegamenti","chunk_index":56,"content":"## Collegamenti\r\n- [Entities Index](../../../../../../entities-index.md)","size_chars":72,"tokens_estimate":18}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"a) **sp_insert_user_notification_settings**\r","anchor_slug":"a-spinsertusernotificationsettings","chunk_index":1,"content":"### a) **sp_insert_user_notification_settings**\n\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE SECTION_ACCESS \r\n--STORE PROCEDURE ‚Äì  INSERT SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = 0,\r\n    @notify_on_alert BIT = 0,\r\n    @notify_on_digest BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS\r\n            WHERE tenant_id = @tenant_id AND user_id = @user_id\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS\r\n                (tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, ext_attributes, created_by)\r\n            VALUES\r\n                (@tenant_id, @user_id, @notify_on_upload, @notify_on_alert, @notify_on_digest, @ext_attributes, COALESCE(@created_by, 'sp_insert_user_notification_setting'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":2338,"tokens_estimate":584}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_user_notification_settings**\r","anchor_slug":"b-spupdateusernotificationsettings","chunk_index":2,"content":"### b) **sp_update_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  UPDATE SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = NULL,\r\n    @notify_on_alert BIT = NULL,\r\n    @notify_on_digest BIT = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.USER_NOTIFICATION_SETTINGS\r\n        SET\r\n            notify_on_upload = COALESCE(@notify_on_upload, notify_on_upload),\r\n            notify_on_alert = COALESCE(@notify_on_alert, notify_on_alert),\r\n            notify_on_digest = COALESCE(@notify_on_digest, notify_on_digest),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_user_notification_setting')\r\n        WHERE tenant_id = @tenant_id AND user_id = @user_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":2297,"tokens_estimate":574}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_user_notification_settings**\r","anchor_slug":"c-spdeleteusernotificationsettings","chunk_index":3,"content":"### c) **sp_delete_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  DELETE SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.USER_NOTIFICATION_SETTINGS WHERE tenant_id = @tenant_id AND user_id = @user_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql","size_chars":1695,"tokens_estimate":424}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_user_notification_settings**\r","anchor_slug":"d-spdebuginsertusernotificationsettings","chunk_index":4,"content":"### d) **sp_debug_insert_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  INSERT DEBUG SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = 0,\r\n    @notify_on_alert BIT = 0,\r\n    @notify_on_digest BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS\r\n            WHERE tenant_id = @tenant_id AND user_id = @user_id\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS\r\n                (tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, ext_attributes, created_by)\r\n            VALUES\r\n                (@tenant_id, @user_id, @notify_on_upload, @notify_on_alert, @notify_on_digest, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_user_notification_setting'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n--FINE SEZIONE STORE PROCEDURE SECTION_ACCESS\r\n```sql","size_chars":2373,"tokens_estimate":593}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":5,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":6,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":7,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  ### a) **sp_insert_user_notification_settings**\n\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE SECTION_ACCESS \r\n--STORE PROCEDURE ‚Äì  INSERT SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = 0,\r\n    @notify_on_alert BIT = 0,\r\n    @notify_on_digest BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS\r\n            WHERE tenant_id = @tenant_id AND user_id = @user_id\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS\r\n                (tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, ext_attributes, created_by)\r\n            VALUES\r\n                (@tenant_id, @user_id, @notify_on_upload, @notify_on_alert, @notify_on_digest, @ext_attributes, COALESCE(@created_by, 'sp_insert_user_notification_setting'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;","size_chars":2298,"tokens_estimate":574}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":8,"content":"    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":162,"tokens_estimate":40}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_user_notification_settings**\r","anchor_slug":"b-spupdateusernotificationsettings","chunk_index":9,"content":"### b) **sp_update_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  UPDATE SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = NULL,\r\n    @notify_on_alert BIT = NULL,\r\n    @notify_on_digest BIT = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.USER_NOTIFICATION_SETTINGS\r\n        SET\r\n            notify_on_upload = COALESCE(@notify_on_upload, notify_on_upload),\r\n            notify_on_alert = COALESCE(@notify_on_alert, notify_on_alert),\r\n            notify_on_digest = COALESCE(@notify_on_digest, notify_on_digest),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_user_notification_setting')\r\n        WHERE tenant_id = @tenant_id AND user_id = @user_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":2297,"tokens_estimate":574}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_user_notification_settings**\r","anchor_slug":"c-spdeleteusernotificationsettings","chunk_index":10,"content":"### c) **sp_delete_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  DELETE SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.USER_NOTIFICATION_SETTINGS WHERE tenant_id = @tenant_id AND user_id = @user_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql","size_chars":1695,"tokens_estimate":424}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_user_notification_settings**\r","anchor_slug":"d-spdebuginsertusernotificationsettings","chunk_index":11,"content":"### d) **sp_debug_insert_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  INSERT DEBUG SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = 0,\r\n    @notify_on_alert BIT = 0,\r\n    @notify_on_digest BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS\r\n            WHERE tenant_id = @tenant_id AND user_id = @user_id\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS\r\n                (tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, ext_attributes, created_by)\r\n            VALUES\r\n                (@tenant_id, @user_id, @notify_on_upload, @notify_on_alert, @notify_on_digest, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_user_notification_setting'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n--FINE SEZIONE STORE PROCEDURE SECTION_ACCESS\r\n```sql","size_chars":2373,"tokens_estimate":593}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":12,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":13,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section ### a) **sp_insert_user_notification_settings**\n\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE SECTION_ACCESS \r\n--STORE PROCEDURE ‚Äì  INSERT SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = 0,\r\n    @notify_on_alert BIT = 0,\r\n    @notify_on_digest BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS\r\n            WHERE tenant_id = @tenant_id AND user_id = @user_id\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS\r\n                (tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, ext_attributes, created_by)\r\n            VALUES\r\n                (@tenant_id, @user_id, @notify_on_upload, @notify_on_alert, @notify_on_digest, @ext_attributes, COALESCE(@created_by, 'sp_insert_user_notification_setting'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;","size_chars":2248,"tokens_estimate":562}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":14,"content":"    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":162,"tokens_estimate":40}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_user_notification_settings**\r","anchor_slug":"b-spupdateusernotificationsettings","chunk_index":15,"content":"### b) **sp_update_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  UPDATE SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = NULL,\r\n    @notify_on_alert BIT = NULL,\r\n    @notify_on_digest BIT = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.USER_NOTIFICATION_SETTINGS\r\n        SET\r\n            notify_on_upload = COALESCE(@notify_on_upload, notify_on_upload),\r\n            notify_on_alert = COALESCE(@notify_on_alert, notify_on_alert),\r\n            notify_on_digest = COALESCE(@notify_on_digest, notify_on_digest),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_user_notification_setting')\r\n        WHERE tenant_id = @tenant_id AND user_id = @user_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":2297,"tokens_estimate":574}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_user_notification_settings**\r","anchor_slug":"c-spdeleteusernotificationsettings","chunk_index":16,"content":"### c) **sp_delete_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  DELETE SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.USER_NOTIFICATION_SETTINGS WHERE tenant_id = @tenant_id AND user_id = @user_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql","size_chars":1695,"tokens_estimate":424}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_user_notification_settings**\r","anchor_slug":"d-spdebuginsertusernotificationsettings","chunk_index":17,"content":"### d) **sp_debug_insert_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  INSERT DEBUG SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = 0,\r\n    @notify_on_alert BIT = 0,\r\n    @notify_on_digest BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS\r\n            WHERE tenant_id = @tenant_id AND user_id = @user_id\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS\r\n                (tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, ext_attributes, created_by)\r\n            VALUES\r\n                (@tenant_id, @user_id, @notify_on_upload, @notify_on_alert, @notify_on_digest, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_user_notification_setting'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n--FINE SEZIONE STORE PROCEDURE SECTION_ACCESS\r\n```sql","size_chars":2373,"tokens_estimate":593}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":18,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":19,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->","size_chars":125,"tokens_estimate":31}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":20,"content":"## Esempi Query\r\n`sql\r\n-- SELECT ... FROM ...\r\n`\r\n\"@\r\n  ### a) **sp_insert_user_notification_settings**\n\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE SECTION_ACCESS \r\n--STORE PROCEDURE ‚Äì  INSERT SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = 0,\r\n    @notify_on_alert BIT = 0,\r\n    @notify_on_digest BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS\r\n            WHERE tenant_id = @tenant_id AND user_id = @user_id\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS\r\n                (tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, ext_attributes, created_by)\r\n            VALUES\r\n                (@tenant_id, @user_id, @notify_on_upload, @notify_on_alert, @notify_on_digest, @ext_attributes, COALESCE(@created_by, 'sp_insert_user_notification_setting'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":2394,"tokens_estimate":598}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_user_notification_settings**\r","anchor_slug":"b-spupdateusernotificationsettings","chunk_index":21,"content":"### b) **sp_update_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  UPDATE SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = NULL,\r\n    @notify_on_alert BIT = NULL,\r\n    @notify_on_digest BIT = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.USER_NOTIFICATION_SETTINGS\r\n        SET\r\n            notify_on_upload = COALESCE(@notify_on_upload, notify_on_upload),\r\n            notify_on_alert = COALESCE(@notify_on_alert, notify_on_alert),\r\n            notify_on_digest = COALESCE(@notify_on_digest, notify_on_digest),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_user_notification_setting')\r\n        WHERE tenant_id = @tenant_id AND user_id = @user_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":2297,"tokens_estimate":574}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_user_notification_settings**\r","anchor_slug":"c-spdeleteusernotificationsettings","chunk_index":22,"content":"### c) **sp_delete_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  DELETE SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.USER_NOTIFICATION_SETTINGS WHERE tenant_id = @tenant_id AND user_id = @user_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql","size_chars":1695,"tokens_estimate":424}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_user_notification_settings**\r","anchor_slug":"d-spdebuginsertusernotificationsettings","chunk_index":23,"content":"### d) **sp_debug_insert_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  INSERT DEBUG SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = 0,\r\n    @notify_on_alert BIT = 0,\r\n    @notify_on_digest BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS\r\n            WHERE tenant_id = @tenant_id AND user_id = @user_id\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS\r\n                (tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, ext_attributes, created_by)\r\n            VALUES\r\n                (@tenant_id, @user_id, @notify_on_upload, @notify_on_alert, @notify_on_digest, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_user_notification_setting'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n--FINE SEZIONE STORE PROCEDURE SECTION_ACCESS\r\n```sql","size_chars":2373,"tokens_estimate":593}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":24,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":25,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":26,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  ### a) **sp_insert_user_notification_settings**\n\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE SECTION_ACCESS \r\n--STORE PROCEDURE ‚Äì  INSERT SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = 0,\r\n    @notify_on_alert BIT = 0,\r\n    @notify_on_digest BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS\r\n            WHERE tenant_id = @tenant_id AND user_id = @user_id\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS\r\n                (tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, ext_attributes, created_by)\r\n            VALUES\r\n                (@tenant_id, @user_id, @notify_on_upload, @notify_on_alert, @notify_on_digest, @ext_attributes, COALESCE(@created_by, 'sp_insert_user_notification_setting'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;","size_chars":2298,"tokens_estimate":574}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":27,"content":"    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":162,"tokens_estimate":40}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_user_notification_settings**\r","anchor_slug":"b-spupdateusernotificationsettings","chunk_index":28,"content":"### b) **sp_update_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  UPDATE SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = NULL,\r\n    @notify_on_alert BIT = NULL,\r\n    @notify_on_digest BIT = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.USER_NOTIFICATION_SETTINGS\r\n        SET\r\n            notify_on_upload = COALESCE(@notify_on_upload, notify_on_upload),\r\n            notify_on_alert = COALESCE(@notify_on_alert, notify_on_alert),\r\n            notify_on_digest = COALESCE(@notify_on_digest, notify_on_digest),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_user_notification_setting')\r\n        WHERE tenant_id = @tenant_id AND user_id = @user_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":2297,"tokens_estimate":574}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_user_notification_settings**\r","anchor_slug":"c-spdeleteusernotificationsettings","chunk_index":29,"content":"### c) **sp_delete_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  DELETE SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.USER_NOTIFICATION_SETTINGS WHERE tenant_id = @tenant_id AND user_id = @user_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql","size_chars":1695,"tokens_estimate":424}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_user_notification_settings**\r","anchor_slug":"d-spdebuginsertusernotificationsettings","chunk_index":30,"content":"### d) **sp_debug_insert_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  INSERT DEBUG SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = 0,\r\n    @notify_on_alert BIT = 0,\r\n    @notify_on_digest BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS\r\n            WHERE tenant_id = @tenant_id AND user_id = @user_id\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS\r\n                (tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, ext_attributes, created_by)\r\n            VALUES\r\n                (@tenant_id, @user_id, @notify_on_upload, @notify_on_alert, @notify_on_digest, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_user_notification_setting'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n--FINE SEZIONE STORE PROCEDURE SECTION_ACCESS\r\n```sql","size_chars":2373,"tokens_estimate":593}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":31,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":32,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section ### a) **sp_insert_user_notification_settings**\n\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE SECTION_ACCESS \r\n--STORE PROCEDURE ‚Äì  INSERT SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = 0,\r\n    @notify_on_alert BIT = 0,\r\n    @notify_on_digest BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS\r\n            WHERE tenant_id = @tenant_id AND user_id = @user_id\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS\r\n                (tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, ext_attributes, created_by)\r\n            VALUES\r\n                (@tenant_id, @user_id, @notify_on_upload, @notify_on_alert, @notify_on_digest, @ext_attributes, COALESCE(@created_by, 'sp_insert_user_notification_setting'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;","size_chars":2248,"tokens_estimate":562}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":33,"content":"    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":162,"tokens_estimate":40}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_user_notification_settings**\r","anchor_slug":"b-spupdateusernotificationsettings","chunk_index":34,"content":"### b) **sp_update_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  UPDATE SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = NULL,\r\n    @notify_on_alert BIT = NULL,\r\n    @notify_on_digest BIT = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.USER_NOTIFICATION_SETTINGS\r\n        SET\r\n            notify_on_upload = COALESCE(@notify_on_upload, notify_on_upload),\r\n            notify_on_alert = COALESCE(@notify_on_alert, notify_on_alert),\r\n            notify_on_digest = COALESCE(@notify_on_digest, notify_on_digest),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_user_notification_setting')\r\n        WHERE tenant_id = @tenant_id AND user_id = @user_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":2297,"tokens_estimate":574}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_user_notification_settings**\r","anchor_slug":"c-spdeleteusernotificationsettings","chunk_index":35,"content":"### c) **sp_delete_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  DELETE SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.USER_NOTIFICATION_SETTINGS WHERE tenant_id = @tenant_id AND user_id = @user_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql","size_chars":1695,"tokens_estimate":424}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_user_notification_settings**\r","anchor_slug":"d-spdebuginsertusernotificationsettings","chunk_index":36,"content":"### d) **sp_debug_insert_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  INSERT DEBUG SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = 0,\r\n    @notify_on_alert BIT = 0,\r\n    @notify_on_digest BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS\r\n            WHERE tenant_id = @tenant_id AND user_id = @user_id\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS\r\n                (tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, ext_attributes, created_by)\r\n            VALUES\r\n                (@tenant_id, @user_id, @notify_on_upload, @notify_on_alert, @notify_on_digest, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_user_notification_setting'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n--FINE SEZIONE STORE PROCEDURE SECTION_ACCESS\r\n```sql","size_chars":2373,"tokens_estimate":593}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":37,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":38,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n = Ensure-Section ### a) **sp_insert_user_notification_settings**\n\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE SECTION_ACCESS \r\n--STORE PROCEDURE ‚Äì  INSERT SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = 0,\r\n    @notify_on_alert BIT = 0,\r\n    @notify_on_digest BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS\r\n            WHERE tenant_id = @tenant_id AND user_id = @user_id\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS\r\n                (tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, ext_attributes, created_by)\r\n            VALUES\r\n                (@tenant_id, @user_id, @notify_on_upload, @notify_on_alert, @notify_on_digest, @ext_attributes, COALESCE(@created_by, 'sp_insert_user_notification_setting'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;","size_chars":2319,"tokens_estimate":580}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":39,"content":"    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":162,"tokens_estimate":40}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_user_notification_settings**\r","anchor_slug":"b-spupdateusernotificationsettings","chunk_index":40,"content":"### b) **sp_update_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  UPDATE SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = NULL,\r\n    @notify_on_alert BIT = NULL,\r\n    @notify_on_digest BIT = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.USER_NOTIFICATION_SETTINGS\r\n        SET\r\n            notify_on_upload = COALESCE(@notify_on_upload, notify_on_upload),\r\n            notify_on_alert = COALESCE(@notify_on_alert, notify_on_alert),\r\n            notify_on_digest = COALESCE(@notify_on_digest, notify_on_digest),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_user_notification_setting')\r\n        WHERE tenant_id = @tenant_id AND user_id = @user_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":2297,"tokens_estimate":574}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_user_notification_settings**\r","anchor_slug":"c-spdeleteusernotificationsettings","chunk_index":41,"content":"### c) **sp_delete_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  DELETE SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.USER_NOTIFICATION_SETTINGS WHERE tenant_id = @tenant_id AND user_id = @user_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql","size_chars":1695,"tokens_estimate":424}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_user_notification_settings**\r","anchor_slug":"d-spdebuginsertusernotificationsettings","chunk_index":42,"content":"### d) **sp_debug_insert_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  INSERT DEBUG SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = 0,\r\n    @notify_on_alert BIT = 0,\r\n    @notify_on_digest BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS\r\n            WHERE tenant_id = @tenant_id AND user_id = @user_id\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS\r\n                (tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, ext_attributes, created_by)\r\n            VALUES\r\n                (@tenant_id, @user_id, @notify_on_upload, @notify_on_alert, @notify_on_digest, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_user_notification_setting'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n--FINE SEZIONE STORE PROCEDURE SECTION_ACCESS\r\n```sql","size_chars":2373,"tokens_estimate":593}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":43,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":44,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":45,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  ### a) **sp_insert_user_notification_settings**\n\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE SECTION_ACCESS \r\n--STORE PROCEDURE ‚Äì  INSERT SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = 0,\r\n    @notify_on_alert BIT = 0,\r\n    @notify_on_digest BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS\r\n            WHERE tenant_id = @tenant_id AND user_id = @user_id\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS\r\n                (tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, ext_attributes, created_by)\r\n            VALUES\r\n                (@tenant_id, @user_id, @notify_on_upload, @notify_on_alert, @notify_on_digest, @ext_attributes, COALESCE(@created_by, 'sp_insert_user_notification_setting'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;","size_chars":2298,"tokens_estimate":574}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":46,"content":"    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":162,"tokens_estimate":40}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_user_notification_settings**\r","anchor_slug":"b-spupdateusernotificationsettings","chunk_index":47,"content":"### b) **sp_update_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  UPDATE SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = NULL,\r\n    @notify_on_alert BIT = NULL,\r\n    @notify_on_digest BIT = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.USER_NOTIFICATION_SETTINGS\r\n        SET\r\n            notify_on_upload = COALESCE(@notify_on_upload, notify_on_upload),\r\n            notify_on_alert = COALESCE(@notify_on_alert, notify_on_alert),\r\n            notify_on_digest = COALESCE(@notify_on_digest, notify_on_digest),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_user_notification_setting')\r\n        WHERE tenant_id = @tenant_id AND user_id = @user_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":2297,"tokens_estimate":574}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_user_notification_settings**\r","anchor_slug":"c-spdeleteusernotificationsettings","chunk_index":48,"content":"### c) **sp_delete_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  DELETE SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.USER_NOTIFICATION_SETTINGS WHERE tenant_id = @tenant_id AND user_id = @user_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql","size_chars":1695,"tokens_estimate":424}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_user_notification_settings**\r","anchor_slug":"d-spdebuginsertusernotificationsettings","chunk_index":49,"content":"### d) **sp_debug_insert_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  INSERT DEBUG SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = 0,\r\n    @notify_on_alert BIT = 0,\r\n    @notify_on_digest BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS\r\n            WHERE tenant_id = @tenant_id AND user_id = @user_id\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS\r\n                (tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, ext_attributes, created_by)\r\n            VALUES\r\n                (@tenant_id, @user_id, @notify_on_upload, @notify_on_alert, @notify_on_digest, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_user_notification_setting'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n--FINE SEZIONE STORE PROCEDURE SECTION_ACCESS\r\n```sql","size_chars":2373,"tokens_estimate":593}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":50,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":51,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section ### a) **sp_insert_user_notification_settings**\n\n```sql\r\n--INIZIO SEZIONE STORE PROCEDURE SECTION_ACCESS \r\n--STORE PROCEDURE ‚Äì  INSERT SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = 0,\r\n    @notify_on_alert BIT = 0,\r\n    @notify_on_digest BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS\r\n            WHERE tenant_id = @tenant_id AND user_id = @user_id\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS\r\n                (tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, ext_attributes, created_by)\r\n            VALUES\r\n                (@tenant_id, @user_id, @notify_on_upload, @notify_on_alert, @notify_on_digest, @ext_attributes, COALESCE(@created_by, 'sp_insert_user_notification_setting'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;","size_chars":2248,"tokens_estimate":562}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":52,"content":"    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\r\n```sql","size_chars":162,"tokens_estimate":40}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"b) **sp_update_user_notification_settings**\r","anchor_slug":"b-spupdateusernotificationsettings","chunk_index":53,"content":"### b) **sp_update_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  UPDATE SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = NULL,\r\n    @notify_on_alert BIT = NULL,\r\n    @notify_on_digest BIT = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.USER_NOTIFICATION_SETTINGS\r\n        SET\r\n            notify_on_upload = COALESCE(@notify_on_upload, notify_on_upload),\r\n            notify_on_alert = COALESCE(@notify_on_alert, notify_on_alert),\r\n            notify_on_digest = COALESCE(@notify_on_digest, notify_on_digest),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_user_notification_setting')\r\n        WHERE tenant_id = @tenant_id AND user_id = @user_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n```sql","size_chars":2297,"tokens_estimate":574}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"c) **sp_delete_user_notification_settings**\r","anchor_slug":"c-spdeleteusernotificationsettings","chunk_index":54,"content":"### c) **sp_delete_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  DELETE SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.USER_NOTIFICATION_SETTINGS WHERE tenant_id = @tenant_id AND user_id = @user_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n```sql","size_chars":1695,"tokens_estimate":424}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"d) **sp_debug_insert_user_notification_settings**\r","anchor_slug":"d-spdebuginsertusernotificationsettings","chunk_index":55,"content":"### d) **sp_debug_insert_user_notification_settings**\n\n\r\n```sql\r\n--STORE PROCEDURE ‚Äì  INSERT DEBUG SECTION_ACCESS\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_user_notification_setting\r\n    @tenant_id NVARCHAR(50),\r\n    @user_id NVARCHAR(50),\r\n    @notify_on_upload BIT = 0,\r\n    @notify_on_alert BIT = 0,\r\n    @notify_on_digest BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF NOT EXISTS (\r\n            SELECT 1 FROM PORTAL.USER_NOTIFICATION_SETTINGS\r\n            WHERE tenant_id = @tenant_id AND user_id = @user_id\r\n        )\r\n        BEGIN\r\n            INSERT INTO PORTAL.USER_NOTIFICATION_SETTINGS\r\n                (tenant_id, user_id, notify_on_upload, notify_on_alert, notify_on_digest, ext_attributes, created_by)\r\n            VALUES\r\n                (@tenant_id, @user_id, @notify_on_upload, @notify_on_alert, @notify_on_digest, @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_user_notification_setting'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_user_notification_setting');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_user_notification_setting',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USER_NOTIFICATION_SETTINGS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @tenant_id AS tenant_id, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n--FINE SEZIONE STORE PROCEDURE SECTION_ACCESS\r\n```sql","size_chars":2373,"tokens_estimate":593}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":56,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":57,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n 'Domande a cui risponde' @\"\r\n- Cosa fa?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":281,"tokens_estimate":70}
{"doc_id":"ew-user-notification-settings","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/user-notification-settings.md","title":"a) **sp_insert_user_notification_settings**","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Collegamenti\r","anchor_slug":"collegamenti","chunk_index":58,"content":"## Collegamenti\r\n- [Entities Index](../../../../../../entities-index.md)","size_chars":72,"tokens_estimate":18}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":1,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":2,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":3,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  a) **sp_insert_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_user\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @tenant_id NVARCHAR(50),\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50),\r\n    @is_tenant_admin BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n            SET @user_id = 'CDI' + RIGHT('000000000' + CAST(@next_seq_user AS NVARCHAR), 9);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (user_id, tenant_id, email, name, surname, password,\r\n                                      provider, provider_user_id, status, profile_code, is_tenant_admin,\r\n                                      ext_attributes, created_by)\r\n            VALUES (@user_id, @tenant_id, @email, @name, @surname, @password,\r\n                    @provider, @provider_user_id, @status, @profile_code, @is_tenant_admin,\r\n                    @ext_attributes, COALESCE(@created_by, 'sp_insert_user'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_user');","size_chars":2224,"tokens_estimate":556}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":4,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    -- **Conversational Intelligence output**\r\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql\n\n\r\nb) **sp_update_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_user\r\n    @user_id NVARCHAR(50),\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255) = NULL,\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @is_tenant_admin BIT = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.USERS\r\n        SET\r\n            tenant_id = COALESCE(@tenant_id, tenant_id),\r\n            email = COALESCE(@email, email),\r\n            name = COALESCE(@name, name),\r\n            surname = COALESCE(@surname, surname),\r\n            password = COALESCE(@password, password),\r\n            provider = COALESCE(@provider, provider),\r\n            provider_user_id = COALESCE(@provider_user_id, provider_user_id),\r\n            status = COALESCE(@status, status),\r\n            profile_code = COALESCE(@profile_code, profile_code),\r\n            is_tenant_admin = COALESCE(@is_tenant_admin, is_tenant_admin),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_user')\r\n        WHERE user_id = @user_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n     ","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":5,"content":"SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_user');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n\r\n```sql\n\n\r\nc) **sp_delete_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_user\r\n    @user_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.USERS WHERE user_id = @user_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_user');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_user',\r\n        @user_id = @user_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n\r\n```sql\n\n\r\nd) **sp_debug_insert_user**\r\n---------------------------","size_chars":2378,"tokens_estimate":594}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":6,"content":"```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_user\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @tenant_id NVARCHAR(50),\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50),\r\n    @is_tenant_admin BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n            SET @user_id = 'CDIDEBUG' + RIGHT('000' + CAST(@next_seq_user AS NVARCHAR), 3);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (user_id, tenant_id, email, name, surname, password,\r\n                                      provider, provider_user_id, status, profile_code, is_tenant_admin,\r\n                                      ext_attributes, created_by)\r\n            VALUES (@user_id, @tenant_id, @email, @name, @surname, @password,\r\n                    @provider, @provider_user_id, @status, @profile_code, @is_tenant_admin,\r\n                    @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_user'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_user');","size_chars":2077,"tokens_estimate":519}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":7,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\nGO\n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---\n\nPrompt di esempio chatbot:\r\n> Crea utente ‚Äúluca@azienda.it‚Äù per tenant TEN00000001001, profilo ADMIN\n\n```sql\r\nEXEC PORTAL.sp_insert_user @tenant_id='TEN00000001001', @email='luca@azienda.it', @profile_code='ADMIN', @created_by='chatbot_ams';\r\n```sql\n\nRisposta bot:\n\n| status | user_id | error_message | rows_inserted |\r\n| --- | --- | --- | --- |\r\n| OK | CDI00000001001 | NULL | 1 |","size_chars":1030,"tokens_estimate":258}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":8,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":9,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section a) **sp_insert_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_user\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @tenant_id NVARCHAR(50),\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50),\r\n    @is_tenant_admin BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n            SET @user_id = 'CDI' + RIGHT('000000000' + CAST(@next_seq_user AS NVARCHAR), 9);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (user_id, tenant_id, email, name, surname, password,\r\n                                      provider, provider_user_id, status, profile_code, is_tenant_admin,\r\n                                      ext_attributes, created_by)\r\n            VALUES (@user_id, @tenant_id, @email, @name, @surname, @password,\r\n                    @provider, @provider_user_id, @status, @profile_code, @is_tenant_admin,\r\n                    @ext_attributes, COALESCE(@created_by, 'sp_insert_user'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_user');","size_chars":2174,"tokens_estimate":544}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":10,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    -- **Conversational Intelligence output**\r\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql\n\n\r\nb) **sp_update_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_user\r\n    @user_id NVARCHAR(50),\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255) = NULL,\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @is_tenant_admin BIT = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.USERS\r\n        SET\r\n            tenant_id = COALESCE(@tenant_id, tenant_id),\r\n            email = COALESCE(@email, email),\r\n            name = COALESCE(@name, name),\r\n            surname = COALESCE(@surname, surname),\r\n            password = COALESCE(@password, password),\r\n            provider = COALESCE(@provider, provider),\r\n            provider_user_id = COALESCE(@provider_user_id, provider_user_id),\r\n            status = COALESCE(@status, status),\r\n            profile_code = COALESCE(@profile_code, profile_code),\r\n            is_tenant_admin = COALESCE(@is_tenant_admin, is_tenant_admin),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_user')\r\n        WHERE user_id = @user_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n     ","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":11,"content":"SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_user');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n\r\n```sql\n\n\r\nc) **sp_delete_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_user\r\n    @user_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.USERS WHERE user_id = @user_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_user');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_user',\r\n        @user_id = @user_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n\r\n```sql\n\n\r\nd) **sp_debug_insert_user**\r\n---------------------------","size_chars":2378,"tokens_estimate":594}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":12,"content":"```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_user\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @tenant_id NVARCHAR(50),\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50),\r\n    @is_tenant_admin BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n            SET @user_id = 'CDIDEBUG' + RIGHT('000' + CAST(@next_seq_user AS NVARCHAR), 3);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (user_id, tenant_id, email, name, surname, password,\r\n                                      provider, provider_user_id, status, profile_code, is_tenant_admin,\r\n                                      ext_attributes, created_by)\r\n            VALUES (@user_id, @tenant_id, @email, @name, @surname, @password,\r\n                    @provider, @provider_user_id, @status, @profile_code, @is_tenant_admin,\r\n                    @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_user'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_user');","size_chars":2077,"tokens_estimate":519}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":13,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\nGO\n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---\n\nPrompt di esempio chatbot:\r\n> Crea utente ‚Äúluca@azienda.it‚Äù per tenant TEN00000001001, profilo ADMIN\n\n```sql\r\nEXEC PORTAL.sp_insert_user @tenant_id='TEN00000001001', @email='luca@azienda.it', @profile_code='ADMIN', @created_by='chatbot_ams';\r\n```sql\n\nRisposta bot:\n\n| status | user_id | error_message | rows_inserted |\r\n| --- | --- | --- | --- |\r\n| OK | CDI00000001001 | NULL | 1 |","size_chars":1030,"tokens_estimate":258}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":14,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":15,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->","size_chars":125,"tokens_estimate":31}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":16,"content":"## Esempi Query\r\n`sql\r\n-- SELECT ... FROM ...\r\n`\r\n\"@\r\n  a) **sp_insert_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_user\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @tenant_id NVARCHAR(50),\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50),\r\n    @is_tenant_admin BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n            SET @user_id = 'CDI' + RIGHT('000000000' + CAST(@next_seq_user AS NVARCHAR), 9);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (user_id, tenant_id, email, name, surname, password,\r\n                                      provider, provider_user_id, status, profile_code, is_tenant_admin,\r\n                                      ext_attributes, created_by)\r\n            VALUES (@user_id, @tenant_id, @email, @name, @surname, @password,\r\n                    @provider, @provider_user_id, @status, @profile_code, @is_tenant_admin,\r\n                    @ext_attributes, COALESCE(@created_by, 'sp_insert_user'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_user');","size_chars":2156,"tokens_estimate":539}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":17,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    -- **Conversational Intelligence output**\r\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql\n\n\r\nb) **sp_update_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_user\r\n    @user_id NVARCHAR(50),\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255) = NULL,\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @is_tenant_admin BIT = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.USERS\r\n        SET\r\n            tenant_id = COALESCE(@tenant_id, tenant_id),\r\n            email = COALESCE(@email, email),\r\n            name = COALESCE(@name, name),\r\n            surname = COALESCE(@surname, surname),\r\n            password = COALESCE(@password, password),\r\n            provider = COALESCE(@provider, provider),\r\n            provider_user_id = COALESCE(@provider_user_id, provider_user_id),\r\n            status = COALESCE(@status, status),\r\n            profile_code = COALESCE(@profile_code, profile_code),\r\n            is_tenant_admin = COALESCE(@is_tenant_admin, is_tenant_admin),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_user')\r\n        WHERE user_id = @user_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n     ","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":18,"content":"SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_user');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n\r\n```sql\n\n\r\nc) **sp_delete_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_user\r\n    @user_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.USERS WHERE user_id = @user_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_user');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_user',\r\n        @user_id = @user_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n\r\n```sql\n\n\r\nd) **sp_debug_insert_user**\r\n---------------------------","size_chars":2378,"tokens_estimate":594}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":19,"content":"```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_user\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @tenant_id NVARCHAR(50),\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50),\r\n    @is_tenant_admin BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n            SET @user_id = 'CDIDEBUG' + RIGHT('000' + CAST(@next_seq_user AS NVARCHAR), 3);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (user_id, tenant_id, email, name, surname, password,\r\n                                      provider, provider_user_id, status, profile_code, is_tenant_admin,\r\n                                      ext_attributes, created_by)\r\n            VALUES (@user_id, @tenant_id, @email, @name, @surname, @password,\r\n                    @provider, @provider_user_id, @status, @profile_code, @is_tenant_admin,\r\n                    @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_user'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_user');","size_chars":2077,"tokens_estimate":519}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempi Query\r","anchor_slug":"esempi-query","chunk_index":20,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\nGO\n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---\n\nPrompt di esempio chatbot:\r\n> Crea utente ‚Äúluca@azienda.it‚Äù per tenant TEN00000001001, profilo ADMIN\n\n```sql\r\nEXEC PORTAL.sp_insert_user @tenant_id='TEN00000001001', @email='luca@azienda.it', @profile_code='ADMIN', @created_by='chatbot_ams';\r\n```sql\n\nRisposta bot:\n\n| status | user_id | error_message | rows_inserted |\r\n| --- | --- | --- | --- |\r\n| OK | CDI00000001001 | NULL | 1 |","size_chars":1030,"tokens_estimate":258}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":21,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":22,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":23,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  a) **sp_insert_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_user\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @tenant_id NVARCHAR(50),\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50),\r\n    @is_tenant_admin BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n            SET @user_id = 'CDI' + RIGHT('000000000' + CAST(@next_seq_user AS NVARCHAR), 9);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (user_id, tenant_id, email, name, surname, password,\r\n                                      provider, provider_user_id, status, profile_code, is_tenant_admin,\r\n                                      ext_attributes, created_by)\r\n            VALUES (@user_id, @tenant_id, @email, @name, @surname, @password,\r\n                    @provider, @provider_user_id, @status, @profile_code, @is_tenant_admin,\r\n                    @ext_attributes, COALESCE(@created_by, 'sp_insert_user'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_user');","size_chars":2224,"tokens_estimate":556}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":24,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    -- **Conversational Intelligence output**\r\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql\n\n\r\nb) **sp_update_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_user\r\n    @user_id NVARCHAR(50),\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255) = NULL,\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @is_tenant_admin BIT = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.USERS\r\n        SET\r\n            tenant_id = COALESCE(@tenant_id, tenant_id),\r\n            email = COALESCE(@email, email),\r\n            name = COALESCE(@name, name),\r\n            surname = COALESCE(@surname, surname),\r\n            password = COALESCE(@password, password),\r\n            provider = COALESCE(@provider, provider),\r\n            provider_user_id = COALESCE(@provider_user_id, provider_user_id),\r\n            status = COALESCE(@status, status),\r\n            profile_code = COALESCE(@profile_code, profile_code),\r\n            is_tenant_admin = COALESCE(@is_tenant_admin, is_tenant_admin),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_user')\r\n        WHERE user_id = @user_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n     ","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":25,"content":"SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_user');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n\r\n```sql\n\n\r\nc) **sp_delete_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_user\r\n    @user_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.USERS WHERE user_id = @user_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_user');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_user',\r\n        @user_id = @user_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n\r\n```sql\n\n\r\nd) **sp_debug_insert_user**\r\n---------------------------","size_chars":2378,"tokens_estimate":594}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":26,"content":"```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_user\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @tenant_id NVARCHAR(50),\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50),\r\n    @is_tenant_admin BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n            SET @user_id = 'CDIDEBUG' + RIGHT('000' + CAST(@next_seq_user AS NVARCHAR), 3);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (user_id, tenant_id, email, name, surname, password,\r\n                                      provider, provider_user_id, status, profile_code, is_tenant_admin,\r\n                                      ext_attributes, created_by)\r\n            VALUES (@user_id, @tenant_id, @email, @name, @surname, @password,\r\n                    @provider, @provider_user_id, @status, @profile_code, @is_tenant_admin,\r\n                    @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_user'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_user');","size_chars":2077,"tokens_estimate":519}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":27,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\nGO\n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---\n\nPrompt di esempio chatbot:\r\n> Crea utente ‚Äúluca@azienda.it‚Äù per tenant TEN00000001001, profilo ADMIN\n\n```sql\r\nEXEC PORTAL.sp_insert_user @tenant_id='TEN00000001001', @email='luca@azienda.it', @profile_code='ADMIN', @created_by='chatbot_ams';\r\n```sql\n\nRisposta bot:\n\n| status | user_id | error_message | rows_inserted |\r\n| --- | --- | --- | --- |\r\n| OK | CDI00000001001 | NULL | 1 |","size_chars":1030,"tokens_estimate":258}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":28,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":29,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section a) **sp_insert_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_user\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @tenant_id NVARCHAR(50),\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50),\r\n    @is_tenant_admin BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n            SET @user_id = 'CDI' + RIGHT('000000000' + CAST(@next_seq_user AS NVARCHAR), 9);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (user_id, tenant_id, email, name, surname, password,\r\n                                      provider, provider_user_id, status, profile_code, is_tenant_admin,\r\n                                      ext_attributes, created_by)\r\n            VALUES (@user_id, @tenant_id, @email, @name, @surname, @password,\r\n                    @provider, @provider_user_id, @status, @profile_code, @is_tenant_admin,\r\n                    @ext_attributes, COALESCE(@created_by, 'sp_insert_user'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_user');","size_chars":2174,"tokens_estimate":544}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":30,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    -- **Conversational Intelligence output**\r\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql\n\n\r\nb) **sp_update_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_user\r\n    @user_id NVARCHAR(50),\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255) = NULL,\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @is_tenant_admin BIT = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.USERS\r\n        SET\r\n            tenant_id = COALESCE(@tenant_id, tenant_id),\r\n            email = COALESCE(@email, email),\r\n            name = COALESCE(@name, name),\r\n            surname = COALESCE(@surname, surname),\r\n            password = COALESCE(@password, password),\r\n            provider = COALESCE(@provider, provider),\r\n            provider_user_id = COALESCE(@provider_user_id, provider_user_id),\r\n            status = COALESCE(@status, status),\r\n            profile_code = COALESCE(@profile_code, profile_code),\r\n            is_tenant_admin = COALESCE(@is_tenant_admin, is_tenant_admin),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_user')\r\n        WHERE user_id = @user_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n     ","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":31,"content":"SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_user');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n\r\n```sql\n\n\r\nc) **sp_delete_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_user\r\n    @user_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.USERS WHERE user_id = @user_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_user');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_user',\r\n        @user_id = @user_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n\r\n```sql\n\n\r\nd) **sp_debug_insert_user**\r\n---------------------------","size_chars":2378,"tokens_estimate":594}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":32,"content":"```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_user\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @tenant_id NVARCHAR(50),\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50),\r\n    @is_tenant_admin BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n            SET @user_id = 'CDIDEBUG' + RIGHT('000' + CAST(@next_seq_user AS NVARCHAR), 3);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (user_id, tenant_id, email, name, surname, password,\r\n                                      provider, provider_user_id, status, profile_code, is_tenant_admin,\r\n                                      ext_attributes, created_by)\r\n            VALUES (@user_id, @tenant_id, @email, @name, @surname, @password,\r\n                    @provider, @provider_user_id, @status, @profile_code, @is_tenant_admin,\r\n                    @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_user'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_user');","size_chars":2077,"tokens_estimate":519}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":33,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\nGO\n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---\n\nPrompt di esempio chatbot:\r\n> Crea utente ‚Äúluca@azienda.it‚Äù per tenant TEN00000001001, profilo ADMIN\n\n```sql\r\nEXEC PORTAL.sp_insert_user @tenant_id='TEN00000001001', @email='luca@azienda.it', @profile_code='ADMIN', @created_by='chatbot_ams';\r\n```sql\n\nRisposta bot:\n\n| status | user_id | error_message | rows_inserted |\r\n| --- | --- | --- | --- |\r\n| OK | CDI00000001001 | NULL | 1 |","size_chars":1030,"tokens_estimate":258}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":34,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":35,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n = Ensure-Section a) **sp_insert_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_user\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @tenant_id NVARCHAR(50),\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50),\r\n    @is_tenant_admin BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n            SET @user_id = 'CDI' + RIGHT('000000000' + CAST(@next_seq_user AS NVARCHAR), 9);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (user_id, tenant_id, email, name, surname, password,\r\n                                      provider, provider_user_id, status, profile_code, is_tenant_admin,\r\n                                      ext_attributes, created_by)\r\n            VALUES (@user_id, @tenant_id, @email, @name, @surname, @password,\r\n                    @provider, @provider_user_id, @status, @profile_code, @is_tenant_admin,\r\n                    @ext_attributes, COALESCE(@created_by, 'sp_insert_user'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_user');","size_chars":2245,"tokens_estimate":561}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":36,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    -- **Conversational Intelligence output**\r\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql\n\n\r\nb) **sp_update_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_user\r\n    @user_id NVARCHAR(50),\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255) = NULL,\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @is_tenant_admin BIT = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.USERS\r\n        SET\r\n            tenant_id = COALESCE(@tenant_id, tenant_id),\r\n            email = COALESCE(@email, email),\r\n            name = COALESCE(@name, name),\r\n            surname = COALESCE(@surname, surname),\r\n            password = COALESCE(@password, password),\r\n            provider = COALESCE(@provider, provider),\r\n            provider_user_id = COALESCE(@provider_user_id, provider_user_id),\r\n            status = COALESCE(@status, status),\r\n            profile_code = COALESCE(@profile_code, profile_code),\r\n            is_tenant_admin = COALESCE(@is_tenant_admin, is_tenant_admin),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_user')\r\n        WHERE user_id = @user_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n     ","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":37,"content":"SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_user');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n\r\n```sql\n\n\r\nc) **sp_delete_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_user\r\n    @user_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.USERS WHERE user_id = @user_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_user');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_user',\r\n        @user_id = @user_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n\r\n```sql\n\n\r\nd) **sp_debug_insert_user**\r\n---------------------------","size_chars":2378,"tokens_estimate":594}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":38,"content":"```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_user\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @tenant_id NVARCHAR(50),\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50),\r\n    @is_tenant_admin BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n            SET @user_id = 'CDIDEBUG' + RIGHT('000' + CAST(@next_seq_user AS NVARCHAR), 3);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (user_id, tenant_id, email, name, surname, password,\r\n                                      provider, provider_user_id, status, profile_code, is_tenant_admin,\r\n                                      ext_attributes, created_by)\r\n            VALUES (@user_id, @tenant_id, @email, @name, @surname, @password,\r\n                    @provider, @provider_user_id, @status, @profile_code, @is_tenant_admin,\r\n                    @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_user'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_user');","size_chars":2077,"tokens_estimate":519}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":39,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\nGO\n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---\n\nPrompt di esempio chatbot:\r\n> Crea utente ‚Äúluca@azienda.it‚Äù per tenant TEN00000001001, profilo ADMIN\n\n```sql\r\nEXEC PORTAL.sp_insert_user @tenant_id='TEN00000001001', @email='luca@azienda.it', @profile_code='ADMIN', @created_by='chatbot_ams';\r\n```sql\n\nRisposta bot:\n\n| status | user_id | error_message | rows_inserted |\r\n| --- | --- | --- | --- |\r\n| OK | CDI00000001001 | NULL | 1 |","size_chars":1030,"tokens_estimate":258}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":40,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":41,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.","size_chars":54,"tokens_estimate":14}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":42,"content":"## Schema/DDL\r\n<!-- Inserire DDL idempotente (IF NOT EXISTS ... CREATE ...) -->\r\n`sql\r\n-- Esempio DDL idempotente\r\n`\r\n\"@\r\n  a) **sp_insert_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_user\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @tenant_id NVARCHAR(50),\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50),\r\n    @is_tenant_admin BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n            SET @user_id = 'CDI' + RIGHT('000000000' + CAST(@next_seq_user AS NVARCHAR), 9);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (user_id, tenant_id, email, name, surname, password,\r\n                                      provider, provider_user_id, status, profile_code, is_tenant_admin,\r\n                                      ext_attributes, created_by)\r\n            VALUES (@user_id, @tenant_id, @email, @name, @surname, @password,\r\n                    @provider, @provider_user_id, @status, @profile_code, @is_tenant_admin,\r\n                    @ext_attributes, COALESCE(@created_by, 'sp_insert_user'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_user');","size_chars":2224,"tokens_estimate":556}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":43,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    -- **Conversational Intelligence output**\r\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql\n\n\r\nb) **sp_update_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_user\r\n    @user_id NVARCHAR(50),\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255) = NULL,\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @is_tenant_admin BIT = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.USERS\r\n        SET\r\n            tenant_id = COALESCE(@tenant_id, tenant_id),\r\n            email = COALESCE(@email, email),\r\n            name = COALESCE(@name, name),\r\n            surname = COALESCE(@surname, surname),\r\n            password = COALESCE(@password, password),\r\n            provider = COALESCE(@provider, provider),\r\n            provider_user_id = COALESCE(@provider_user_id, provider_user_id),\r\n            status = COALESCE(@status, status),\r\n            profile_code = COALESCE(@profile_code, profile_code),\r\n            is_tenant_admin = COALESCE(@is_tenant_admin, is_tenant_admin),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_user')\r\n        WHERE user_id = @user_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n     ","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":44,"content":"SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_user');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n\r\n```sql\n\n\r\nc) **sp_delete_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_user\r\n    @user_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.USERS WHERE user_id = @user_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_user');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_user',\r\n        @user_id = @user_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n\r\n```sql\n\n\r\nd) **sp_debug_insert_user**\r\n---------------------------","size_chars":2378,"tokens_estimate":594}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":45,"content":"```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_user\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @tenant_id NVARCHAR(50),\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50),\r\n    @is_tenant_admin BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n            SET @user_id = 'CDIDEBUG' + RIGHT('000' + CAST(@next_seq_user AS NVARCHAR), 3);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (user_id, tenant_id, email, name, surname, password,\r\n                                      provider, provider_user_id, status, profile_code, is_tenant_admin,\r\n                                      ext_attributes, created_by)\r\n            VALUES (@user_id, @tenant_id, @email, @name, @surname, @password,\r\n                    @provider, @provider_user_id, @status, @profile_code, @is_tenant_admin,\r\n                    @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_user'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_user');","size_chars":2077,"tokens_estimate":519}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Schema/DDL\r","anchor_slug":"schemaddl","chunk_index":46,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\nGO\n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---\n\nPrompt di esempio chatbot:\r\n> Crea utente ‚Äúluca@azienda.it‚Äù per tenant TEN00000001001, profilo ADMIN\n\n```sql\r\nEXEC PORTAL.sp_insert_user @tenant_id='TEN00000001001', @email='luca@azienda.it', @profile_code='ADMIN', @created_by='chatbot_ams';\r\n```sql\n\nRisposta bot:\n\n| status | user_id | error_message | rows_inserted |\r\n| --- | --- | --- | --- |\r\n| OK | CDI00000001001 | NULL | 1 |","size_chars":1030,"tokens_estimate":258}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":47,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":48,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n = Ensure-Section a) **sp_insert_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_insert_user\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @tenant_id NVARCHAR(50),\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50),\r\n    @is_tenant_admin BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID;\r\n            SET @user_id = 'CDI' + RIGHT('000000000' + CAST(@next_seq_user AS NVARCHAR), 9);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (user_id, tenant_id, email, name, surname, password,\r\n                                      provider, provider_user_id, status, profile_code, is_tenant_admin,\r\n                                      ext_attributes, created_by)\r\n            VALUES (@user_id, @tenant_id, @email, @name, @surname, @password,\r\n                    @provider, @provider_user_id, @status, @profile_code, @is_tenant_admin,\r\n                    @ext_attributes, COALESCE(@created_by, 'sp_insert_user'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_insert_user');","size_chars":2174,"tokens_estimate":544}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":49,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_insert_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    -- **Conversational Intelligence output**\r\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\n```sql\n\n\r\nb) **sp_update_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_update_user\r\n    @user_id NVARCHAR(50),\r\n    @tenant_id NVARCHAR(50) = NULL,\r\n    @email NVARCHAR(255) = NULL,\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50) = NULL,\r\n    @is_tenant_admin BIT = NULL,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @updated_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_updated INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        UPDATE PORTAL.USERS\r\n        SET\r\n            tenant_id = COALESCE(@tenant_id, tenant_id),\r\n            email = COALESCE(@email, email),\r\n            name = COALESCE(@name, name),\r\n            surname = COALESCE(@surname, surname),\r\n            password = COALESCE(@password, password),\r\n            provider = COALESCE(@provider, provider),\r\n            provider_user_id = COALESCE(@provider_user_id, provider_user_id),\r\n            status = COALESCE(@status, status),\r\n            profile_code = COALESCE(@profile_code, profile_code),\r\n            is_tenant_admin = COALESCE(@is_tenant_admin, is_tenant_admin),\r\n            ext_attributes = COALESCE(@ext_attributes, ext_attributes),\r\n            updated_at = SYSUTCDATETIME(),\r\n            created_by = COALESCE(@updated_by, 'sp_update_user')\r\n        WHERE user_id = @user_id;\r\n        SET @rows_updated = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n     ","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":50,"content":"SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @updated_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @updated_by_final = COALESCE(@updated_by, 'sp_update_user');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_update_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_updated = @rows_updated,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'UPDATE',\r\n        @created_by = @updated_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_updated AS rows_updated;\r\nEND\r\nGO\n\n\r\n```sql\n\n\r\nc) **sp_delete_user**\r\n---------------------\n\n```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_delete_user\r\n    @user_id NVARCHAR(50),\r\n    @deleted_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_deleted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        DELETE FROM PORTAL.USERS WHERE user_id = @user_id;\r\n        SET @rows_deleted = @@ROWCOUNT;\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @deleted_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @deleted_by_final = COALESCE(@deleted_by, 'sp_delete_user');\n\n    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_delete_user',\r\n        @user_id = @user_id,\r\n        @rows_deleted = @rows_deleted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'DELETE',\r\n        @created_by = @deleted_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_deleted AS rows_deleted;\r\nEND\r\nGO\n\n\r\n```sql\n\n\r\nd) **sp_debug_insert_user**\r\n---------------------------","size_chars":2378,"tokens_estimate":594}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":51,"content":"```sql\r\nCREATE OR ALTER PROCEDURE PORTAL.sp_debug_insert_user\r\n    @user_id NVARCHAR(50) = NULL,\r\n    @tenant_id NVARCHAR(50),\r\n    @email NVARCHAR(255),\r\n    @name NVARCHAR(100) = NULL,\r\n    @surname NVARCHAR(100) = NULL,\r\n    @password NVARCHAR(255) = NULL,\r\n    @provider NVARCHAR(50) = NULL,\r\n    @provider_user_id NVARCHAR(255) = NULL,\r\n    @status NVARCHAR(50) = NULL,\r\n    @profile_code NVARCHAR(50),\r\n    @is_tenant_admin BIT = 0,\r\n    @ext_attributes NVARCHAR(MAX) = NULL,\r\n    @created_by NVARCHAR(255) = NULL\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @start_time DATETIME2 = SYSUTCDATETIME();\r\n    DECLARE @rows_inserted INT = 0, @status_out NVARCHAR(50) = 'OK', @error_message NVARCHAR(2000) = NULL;\r\n    BEGIN TRY\r\n        BEGIN TRANSACTION;\r\n        IF @user_id IS NULL OR @user_id = ''\r\n        BEGIN\r\n            DECLARE @next_seq_user INT;\r\n            SET @next_seq_user = NEXT VALUE FOR PORTAL.SEQ_USER_ID_DEBUG;\r\n            SET @user_id = 'CDIDEBUG' + RIGHT('000' + CAST(@next_seq_user AS NVARCHAR), 3);\r\n        END\r\n        IF NOT EXISTS (SELECT 1 FROM PORTAL.USERS WHERE user_id = @user_id)\r\n        BEGIN\r\n            INSERT INTO PORTAL.USERS (user_id, tenant_id, email, name, surname, password,\r\n                                      provider, provider_user_id, status, profile_code, is_tenant_admin,\r\n                                      ext_attributes, created_by)\r\n            VALUES (@user_id, @tenant_id, @email, @name, @surname, @password,\r\n                    @provider, @provider_user_id, @status, @profile_code, @is_tenant_admin,\r\n                    @ext_attributes, COALESCE(@created_by, 'sp_debug_insert_user'));\r\n            SET @rows_inserted = 1;\r\n        END\r\n        COMMIT TRANSACTION;\r\n    END TRY\r\n    BEGIN CATCH\r\n        SET @status_out = 'ERROR'; SET @error_message = ERROR_MESSAGE();\r\n        IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION;\r\n    END CATCH\n\n    DECLARE @created_by_final NVARCHAR(255);\r\n    DECLARE @end_time DATETIME2 = SYSUTCDATETIME();\r\n    SET @created_by_final = COALESCE(@created_by, 'sp_debug_insert_user');","size_chars":2077,"tokens_estimate":519}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":52,"content":"    EXEC PORTAL.sp_log_stats_execution\r\n        @proc_name = 'sp_debug_insert_user',\r\n        @tenant_id = @tenant_id,\r\n        @user_id = @user_id,\r\n        @rows_inserted = @rows_inserted,\r\n        @status = @status_out,\r\n        @error_message = @error_message,\r\n        @start_time = @start_time,\r\n        @end_time = @end_time,\r\n        @affected_tables = 'PORTAL.USERS',\r\n        @operation_types = 'INSERT',\r\n        @created_by = @created_by_final;\n\n    SELECT @status_out AS status, @user_id AS user_id, @error_message AS error_message, @rows_inserted AS rows_inserted;\r\nEND\r\nGO\n\nGO\n\n```sql\r\n---\r\nüëæ Conversational Intelligence Ready\r\n---\n\nPrompt di esempio chatbot:\r\n> Crea utente ‚Äúluca@azienda.it‚Äù per tenant TEN00000001001, profilo ADMIN\n\n```sql\r\nEXEC PORTAL.sp_insert_user @tenant_id='TEN00000001001', @email='luca@azienda.it', @profile_code='ADMIN', @created_by='chatbot_ams';\r\n```sql\n\nRisposta bot:\n\n| status | user_id | error_message | rows_inserted |\r\n| --- | --- | --- | --- |\r\n| OK | CDI00000001001 | NULL | 1 |","size_chars":1030,"tokens_estimate":258}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":53,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":54,"content":"## Scopo\r\nBreve descrizione dello scopo del documento.\r\n 'Vincoli e Indici' @\"\r\n<!-- Elencare PK, FK, IDX, CHECK, DEFAULT -->\r\n 'Domande a cui risponde' @\"\r\n- Cosa fa?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":281,"tokens_estimate":70}
{"doc_id":"ew-users","path":"EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure/users.md","title":"Domande a cui risponde","owner":"","tags":["layer/reference","artifact/stored-procedure","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Collegamenti\r","anchor_slug":"collegamenti","chunk_index":55,"content":"## Collegamenti\r\n- [Entities Index](../../../../../../entities-index.md)","size_chars":72,"tokens_estimate":18}
{"doc_id":"ew-api-esterne-integrazione","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione.md","title":"Integrazione API Esterne ‚Äì EasyWay Data Portal","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Lookup ‚Äì Integrazione API Esterne\r","anchor_slug":"lookup-integrazione-api-esterne","chunk_index":1,"content":"## Lookup ‚Äì Integrazione API Esterne\n\n| Cosa vuoi                      | Cosa devi scrivere                       | Dammi il .md                                      | Stato    |\r\n|---------------------------------|------------------------------------------|---------------------------------------------------|----------|\r\n| Tabella integrazioni API        | Dammi tabella integrazioni API           | Dammi il .md tabella integrazioni API             | IN BOZZA |\r\n| Dettaglio API Microsoft Graph   | Dammi dettaglio API Microsoft Graph      | Dammi il .md dettaglio API Microsoft Graph        | IN BOZZA |\r\n| Dettaglio API Shopify           | Dammi dettaglio API Shopify              | Dammi il .md dettaglio API Shopify                | IN BOZZA |\r\n| Dettaglio API Fatture in Cloud  | Dammi dettaglio API Fatture in Cloud     | Dammi il .md dettaglio API Fatture in Cloud       | IN BOZZA |\r\n| Dettaglio API Amazon            | Dammi dettaglio API Amazon               | Dammi il .md dettaglio API Amazon                 | IN BOZZA |\r\n| Policy sicurezza/gestione key   | Dammi policy API key security            | Dammi il .md policy API key security              | IN BOZZA |\r\n| Flusso esempio chiamata esterna | Dammi esempio flusso chiamata API esterna| Dammi il .md esempio flusso chiamata API esterna  | IN BOZZA |\n\n---","size_chars":1327,"tokens_estimate":332}
{"doc_id":"ew-api-esterne-integrazione","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione.md","title":"Integrazione API Esterne ‚Äì EasyWay Data Portal","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Tabella Integrazioni API Esterne\r","anchor_slug":"tabella-integrazioni-api-esterne","chunk_index":2,"content":"## Tabella Integrazioni API Esterne\n\n| Servizio/API           | Scopo integrazione                         | Endpoint principali         | Autenticazione         | Frequenza / Modalit√†     | Note operative                                  |\r\n|------------------------|--------------------------------------------|----------------------------|------------------------|--------------------------|-------------------------------------------------|\r\n| Microsoft Graph API    | Identity, Teams, Calendari, utenti, email  | /me, /users, /groups, /mail| OAuth2, Entra ID       | Real-time, scheduled     | Gestione deleghe, permessi granulari            |\r\n| Shopify                | Sync ordini, prodotti, clienti             | /orders, /products, /customers| OAuth2, API Key     | Batch, webhooks          | Gestione multi-shop, mapping tenant             |\r\n| Fatture in Cloud       | Import/export fatture, clienti, documenti  | /invoices, /clients, /products| OAuth2, API Key     | Batch, schedulato        | Gestione errori e validazione dati              |\r\n| Amazon Seller API      | Sync ordini, stock, prezzi                 | /orders, /inventory, /products | OAuth2, AWS IAM     | Batch, polling           | Attenzione limiti rate API                      |\r\n| Altri SaaS             | CRM, analytics, storage, ecc.              | Vari                        | Vari                   | Da valutare              | Architettura plug-in, versioning API            |\n\n---","size_chars":1471,"tokens_estimate":368}
{"doc_id":"ew-api-esterne-integrazione","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione.md","title":"Integrazione API Esterne ‚Äì EasyWay Data Portal","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Policy Sicurezza & Gestione Key/API\r","anchor_slug":"policy-sicurezza-gestione-keyapi","chunk_index":3,"content":"## Policy Sicurezza & Gestione Key/API\n\n- **Gestione centralizzata key e segreti:**  \r\n  Tutte le API Key/token OAuth sono salvate in Azure Key Vault, MAI in chiaro nel codice o config file.\r\n- **Token rotation:**  \r\n  Pianificare la rotazione periodica dei token/key secondo policy vendor.\r\n- **Scope e permessi minimi:**  \r\n  Ogni integrazione riceve solo i permessi realmente necessari (principio di least privilege).\r\n- **Audit e logging:**  \r\n  Tutte le chiamate a API esterne vanno loggate con dettaglio (successo, errore, payload minimale).\r\n- **Gestione errori e fallback:**  \r\n  Implementare retry, alerting e circuit breaker su errori ripetuti o API non disponibili.\n\n---","size_chars":681,"tokens_estimate":170}
{"doc_id":"ew-api-esterne-integrazione","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione.md","title":"Integrazione API Esterne ‚Äì EasyWay Data Portal","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Best Practice Integrazione API Esterne\r","anchor_slug":"best-practice-integrazione-api-esterne","chunk_index":4,"content":"## Best Practice Integrazione API Esterne\n\n- **Architettura plug-in/microservizio dedicato**:  \r\n  Ogni integrazione vive in un proprio microservizio/container, gestibile e scalabile indipendentemente.\r\n- **Versioning e backward compatibility:**  \r\n  Adattare logica e mapping dati per gestire evoluzioni API vendor senza rompere i flussi esistenti.\r\n- **Gestione mapping tenant:**  \r\n  Ogni chiamata esterna √® sempre associata a uno specifico tenant_id, per evitare mix dati tra clienti.\r\n- **Mock e sandbox:**  \r\n  Testare sempre su ambienti sandbox/dev forniti dai vendor prima di passare in produzione.\n\n---","size_chars":611,"tokens_estimate":153}
{"doc_id":"ew-api-esterne-integrazione","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione.md","title":"Integrazione API Esterne ‚Äì EasyWay Data Portal","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Esempio Flusso Chiamat\r","anchor_slug":"esempio-flusso-chiamat","chunk_index":5,"content":"## Esempio Flusso Chiamat","size_chars":25,"tokens_estimate":6}
{"doc_id":"ew-api-esterne-integrazione","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione.md","title":"Integrazione API Esterne ‚Äì EasyWay Data Portal","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":6,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-best-practice-naming-and-scalability","path":"EasyWay_WebApp/02_logiche_easyway/best-practice-naming-and-scalability.md","title":"Lookup ‚Äì Best Practice Naming & Scalabilit√†","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Tabella Naming Convention (macro overview)\r","anchor_slug":"tabella-naming-convention-macro-overview","chunk_index":1,"content":"## Tabella Naming Convention (macro overview)\n\n| Oggetto             | Esempio                               | Regola/Base                                   | Note Operative                            |\r\n|---------------------|---------------------------------------|-----------------------------------------------|-------------------------------------------|\r\n| Resource Group      | ew-rg-portal-dev                      | ew-rg-[modulo]-[env]                          | Un RG per ogni ambiente/app principale    |\r\n| Storage Account     | ewdatalakedev                         | ew[datalake][env] (no caratteri speciali)     | Massimo 24 caratteri                      |\r\n| App Service         | ew-app-portal-dev                     | ew-app-[modulo]-[env]                         | Unica entrypoint web/app per microservizi |\r\n| Container/Microserv.| ew-user-mgmt-svc-dev                  | ew-[dominio]-svc-[env]                        | Nome breve, chiaro, dominio funzione      |\r\n| Key Vault           | ew-kv-portal-dev                      | ew-kv-[modulo]-[env]                          | Un vault per ogni ambiente/app            |\r\n| SQL DB              | easyway_portal_dev                    | easyway_portal_[env]                          | Senza trattini/breve/descrittivo          |\r\n| Datalake Folder     | landing/, staging/, official/         | landing/, staging/, official/, ...            | Come da schema dati                       |\r\n| API endpoint        | /api/users, /api/notifications        | /api/[dominio]                                | Seguire naming RESTful                    |\r\n| Service Principal   | portal.datalake.read                  | [modulo].[ambito].[permesso]                  | Come da policy sicurezza                  |\r\n| Slot Azure          | ew-app-portal-dev-slot                | ew-app-[modulo]-[env]-slot                    | Usare solo per test/blue-green            |\n\n---","size_chars":1934,"tokens_estimate":484}
{"doc_id":"ew-best-practice-naming-and-scalability","path":"EasyWay_WebApp/02_logiche_easyway/best-practice-naming-and-scalability.md","title":"Lookup ‚Äì Best Practice Naming & Scalabilit√†","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Best Practice Scalabilit√†\r","anchor_slug":"best-practice-scalabilit","chunk_index":2,"content":"## Best Practice Scalabilit√†\n\n- **Scalabilit√† orizzontale:**  \r\n  Ogni microservizio/container va deployato per supportare scaling orizzontale (pi√π istanze), anche in App Service Plan Basic.\r\n- **No monoliti:**  \r\n  Ogni dominio funzionale separato (user, notifiche, DQ, e-commerce‚Ä¶).\r\n- **API Gateway unico:**  \r\n  Tutte le chiamate passano da Gateway, che pu√≤ scalare indipendentemente dai servizi.\r\n- **Slot di staging/blue-green deploy:**  \r\n  Usa slot per zero downtime deploy, rollback rapido, ambienti test/prod separati.\r\n- **Resource group per ambiente:**  \r\n  Un RG per dev, test, prod: facilita cleanup, governance e gestione costi.\r\n- **Naming standard uniforme:**  \r\n  Tutte le risorse devono seguire lo standard tabellare per evitare conflitti e automatizzare script/pipeline.\n\n---","size_chars":795,"tokens_estimate":199}
{"doc_id":"ew-best-practice-naming-and-scalability","path":"EasyWay_WebApp/02_logiche_easyway/best-practice-naming-and-scalability.md","title":"Lookup ‚Äì Best Practice Naming & Scalabilit√†","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Checklist Naming & Scalabilit√†\r","anchor_slug":"checklist-naming-scalabilit","chunk_index":3,"content":"## Checklist Naming & Scalabilit√†\n\n| ID   | Controllo                                | Obbligatorio | Note/Best Practice                                       | Stato  |\r\n|------|------------------------------------------|--------------|----------------------------------------------------------|--------|\r\n| 1    | Tutte le risorse seguono naming standard | S√¨           | Consultare tabella naming prima di creare risorse        |        |\r\n| 2    | Scaling microservizi/slot                | S√¨           | Minimo 2 istanze per servizi core, usare slot per deploy |        |\r\n| 3    | Un RG per ogni ambiente                  | S√¨           | Facilita gestione costi/policy e clean-up                |        |\r\n| 4    | Naming chiaro su API/endpoint            | S√¨           | /api/[dominio], no ambiguit√† nei percorsi                |        |\r\n| 5    | Service Principal chiari e segregati     | S√¨           | Uno per dominio/permesso, niente permessi eccessivi      |        |\r\n| 6    | Naming versionato in pipeline/script     | S√¨           | Variabili/env/nome parametrici in ogni script            |        |\n\n---","size_chars":1126,"tokens_estimate":282}
{"doc_id":"ew-best-practice-naming-and-scalability","path":"EasyWay_WebApp/02_logiche_easyway/best-practice-naming-and-scalability.md","title":"Lookup ‚Äì Best Practice Naming & Scalabilit√†","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Nota operativa\r","anchor_slug":"nota-operativa","chunk_index":4,"content":"## Nota operativa\n\n- **La tabella naming va aggiornata e consultata prima di creare qualunque risorsa, script o pipeline.**\r\n- **Le pipeline di provisioning (IaC) devono sempre applicare queste regole.**\r\n- **Eventuali eccezioni/naming legacy vanno documentate in README di progetto.**\n\n---","size_chars":290,"tokens_estimate":72}
{"doc_id":"ew-best-practice-naming-and-scalability","path":"EasyWay_WebApp/02_logiche_easyway/best-practice-naming-and-scalability.md","title":"Lookup ‚Äì Best Practice Naming & Scalabilit√†","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":5,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"index","path":"EasyWay_WebApp/02_logiche_easyway/index.md","title":"Indice","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:31:54+02:00","section_level":2,"anchor_text":"Indice","anchor_slug":"indice","chunk_index":1,"content":"# Indice\n- [api-esterne-integrazione.md](./api-esterne-integrazione.md) - Integrazione API Esterne ‚Äì EasyWay Data Portal\n- [best-practice-naming-and-scalability.md](./best-practice-naming-and-scalability.md) - Lookup ‚Äì Best Practice Naming & Scalabilit√†\n- [index.md](./index.md) - Indice\n- [logging-and-audit.md](./logging-and-audit.md) - Logging & Audit ‚Äì EasyWay Data Portal\n- [login-flussi-onboarding.md](./login-flussi-onboarding.md) - Lookup ‚Äì Flussi Onboarding/Login\n- [notifiche-gestione.md](./notifiche-gestione.md) - Lookup ‚Äì Gestione Notifiche\n- [policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway.md](./policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway.md) - Policy di Configurazione & Sicurezza ‚Äì Microservizi e API Gateway\n- [raccomandazione-architetturale-easyway-data-portal.md](./raccomandazione-architetturale-easyway-data-portal.md) - **Dalle chat emerge chiaramente che:**","size_chars":922,"tokens_estimate":230}
{"doc_id":"ew-logging-and-audit","path":"EasyWay_WebApp/02_logiche_easyway/logging-and-audit.md","title":"Logging & Audit ‚Äì EasyWay Data Portal","owner":"","tags":["policy/logging","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Lookup Logging & Audit ‚Äì Microservizi & API Gateway\r","anchor_slug":"lookup-logging-audit-microservizi-api-gateway","chunk_index":1,"content":"## Lookup Logging & Audit ‚Äì Microservizi & API Gateway\n\n| Cosa vuoi                   | Cosa devi scrivere                 | Dammi il .md                          | Stato    |\r\n|-----------------------------|------------------------------------|---------------------------------------|----------|\r\n| Overview logging & audit    | Dammi overview logging audit       | Dammi il .md overview logging audit   | IN BOZZA |\r\n| Tabella eventi da tracciare | Dammi tabella eventi audit         | Dammi il .md tabella eventi audit     | IN BOZZA |\r\n| Best practice monitoring    | Dammi best practice monitoring     | Dammi il .md best practice monitoring | IN BOZZA |\r\n| Esempio flusso log/audit    | Dammi esempio flusso audit         | Dammi il .md esempio flusso audit     | IN BOZZA |\n\n---","size_chars":785,"tokens_estimate":196}
{"doc_id":"ew-logging-and-audit","path":"EasyWay_WebApp/02_logiche_easyway/logging-and-audit.md","title":"Logging & Audit ‚Äì EasyWay Data Portal","owner":"","tags":["policy/logging","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Tabella Eventi/Audit da Tracciare\r","anchor_slug":"tabella-eventiaudit-da-tracciare","chunk_index":2,"content":"## Tabella Eventi/Audit da Tracciare\n\n| Ambito                   | Evento/Azione da tracciare                         | Dove si traccia         | Livello Criticit√† | Retention Policy     | Note Operative                                   |\r\n|--------------------------|----------------------------------------------------|-------------------------|-------------------|----------------------|--------------------------------------------------|\r\n| Login                    | Successo, errore, tentativi anomali                | API Gateway, Auth Svc   | Alto              | 12 mesi (min)        | Alert su 5+ tentativi falliti da stesso IP/user  |\r\n| Accesso dati sensibili   | Query, export, download, mascheramento             | Microservizi, DB        | Alto              | 12 mesi (min)        | Masking attivo, log dettagliato                  |\r\n| Modifica ACL/permessi    | Cambio ruolo, aggiunta/rimozione accessi           | User Mgmt, DB           | Alto              | 24 mesi (min)        | Alert a owner tenant/admin                       |\r\n| Modifica configurazioni  | Cambi su parametri, segreti, environment           | Config Svc, Key Vault   | Medio             | 12 mesi (min)        | Notifica automatica se variazione critica        |\r\n| Flusso onboarding        | Creazione utente, validazione, rifiuto             | User Mgmt, Notifiche    | Medio             | 6 mesi               | Log workflow step by step                        |\r\n| Job ETL / Pipeline dati  | Avvio, successo, errore, righe scartate            | Data Quality, ETL Svc   | Alto/Medio        | 12 mesi              | Log su portal-audit e technical storage          |\r\n| Accesso amministrativo   | Login admin, accesso via SSH/CLI/Portal            | Portal, Storage, DB     | Alto              | 24 mesi              | Accesso consentito solo a identity approvate     |\r\n| Anomalie e alert         | Rilevazione attivit√† anomale, superamento soglie   | Tutti i servizi         | Alto              | 24 mesi              | Alert automatico via email/Teams                 |\n\n---","size_chars":2071,"tokens_estimate":518}
{"doc_id":"ew-logging-and-audit","path":"EasyWay_WebApp/02_logiche_easyway/logging-and-audit.md","title":"Logging & Audit ‚Äì EasyWay Data Portal","owner":"","tags":["policy/logging","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Best Practice Monitoring & Audit\r","anchor_slug":"best-practice-monitoring-audit","chunk_index":3,"content":"## Best Practice Monitoring & Audit\n\n- **Log centralizzato**: tutti i log vanno su Log Analytics (Azure) o su una cartella dedicata (`portal-audit`) nello storage Datalake.\r\n- **Retention policy**: minima di 12 mesi (24 mesi per ACL/permessi/amministrazione).\r\n- **Alert automatici**: attivati su pattern anomali, errori di login, cambi ACL, accesso a dati sensibili.\r\n- **Log masking**: mai salvare password/token; mascherare dati sensibili anche nei log.\r\n- **Audit trail DB**: usare funzioni native (SQL Server Audit, triggers) per tracciare accessi e modifiche critiche.\r\n- **Notifica owner/admin**: ogni modifica ACL, accesso admin o variazione parametri critici notifica i responsabili tenant e/o owner globale.\n\n---","size_chars":722,"tokens_estimate":180}
{"doc_id":"ew-logging-and-audit","path":"EasyWay_WebApp/02_logiche_easyway/logging-and-audit.md","title":"Logging & Audit ‚Äì EasyWay Data Portal","owner":"","tags":["policy/logging","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Esempio di Flusso Audit (testuale)\r","anchor_slug":"esempio-di-flusso-audit-testuale","chunk_index":4,"content":"## Esempio di Flusso Audit (testuale)\n\n[Utente] ‚Üí [API Gateway] ‚Üí [Microservizio] ‚Üí [DB/Storage]  \r\n|  \r\nv  \r\n[Logging/Audit centralizzato: evento, user_id, tenant_id, timestamp, dettaglio, outcome]  \r\n|  \r\n+--> [Alert se evento critico/anomalia]  \r\n+--> [Retention e archiviazione audit trail]\n\n\n\n---\n\n> **Nota**: Tutte le policy di logging & audit sono ‚ÄúPRONTE PER CODICE‚Äù dopo validazione e saranno recepite in ogni script, template e implementazione.","size_chars":454,"tokens_estimate":114}
{"doc_id":"ew-logging-and-audit","path":"EasyWay_WebApp/02_logiche_easyway/logging-and-audit.md","title":"Logging & Audit ‚Äì EasyWay Data Portal","owner":"","tags":["policy/logging","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":5,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-login-flussi-onboarding","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding.md","title":"Lookup ‚Äì Flussi Onboarding/Login","owner":"","tags":["layer/how-to","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Tabella Flussi Utente\r","anchor_slug":"tabella-flussi-utente","chunk_index":1,"content":"## Tabella Flussi Utente\n\n| Flusso                     | Attori              | Step Principali                                                  | Security/ACL                 | Note Operative                       |\r\n|----------------------------|---------------------|------------------------------------------------------------------|------------------------------|--------------------------------------|\r\n| Onboarding locale          | Utente finale       | Registrazione, conferma email, creazione credenziali, primo login| Policy password/MFA, ACL     | Utente collegato a tenant_id         |\r\n| Onboarding federato        | Utente azienda/partner | SSO via Entra ID, mappatura tenant, mapping ruoli                | SSO Entra ID, ACL mapping    | Auto-provisioning se abilitato       |\r\n| Onboarding prospect/demo   | Nuovo cliente       | Richiesta accesso, validazione, assegnazione tenant, invito      | Validazione manuale/admin    | Flusso semplificato, accesso limitato|\r\n| Login locale               | Utente finale       | Inserimento credenziali, validazione, MFA se richiesto           | Token JWT, MFA opzionale     | Tentativi falliti loggati            |\r\n| Login federato             | Utente azienda      | SSO redirect, validazione token, mapping ruoli                   | Token Entra ID, ACL mapping  | Timeout/session management           |\r\n| Recupero credenziali       | Utente finale       | Reset password, verifica identit√†, set nuova password            | Link one-time, scadenza      | Alert admin su troppi reset          |\n\n---","size_chars":1560,"tokens_estimate":390}
{"doc_id":"ew-login-flussi-onboarding","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding.md","title":"Lookup ‚Äì Flussi Onboarding/Login","owner":"","tags":["layer/how-to","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Best Practice Onboarding/Login\r","anchor_slug":"best-practice-onboardinglogin","chunk_index":2,"content":"## Best Practice Onboarding/Login\n\n- **Sempre richiesta conferma email o SSO validato prima accesso**\r\n- **Ogni utente associato a tenant_id e profilo (ruolo/ACL)**\r\n- **Password policy forte + MFA per admin/superuser**\r\n- **Log di ogni tentativo di login, reset e modifica profilo**\r\n- **Flusso prospect/demo: separato e ‚Äúsandboxato‚Äù rispetto a clienti reali**\r\n- **Timeout sessione e refresh token configurabili**\r\n- **Processo di disabilitazione/reactivation gestito da admin tenant**\n\n---","size_chars":492,"tokens_estimate":123}
{"doc_id":"ew-login-flussi-onboarding","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding.md","title":"Lookup ‚Äì Flussi Onboarding/Login","owner":"","tags":["layer/how-to","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Esempio Flusso Step-by-Step ‚Äì Onboarding Locale\r","anchor_slug":"esempio-flusso-step-by-step-onboarding-locale","chunk_index":3,"content":"## Esempio Flusso Step-by-Step ‚Äì Onboarding Locale\n\n1. Utente apre pagina di registrazione e inserisce dati (email, nome, azienda‚Ä¶)\r\n2. Sistema invia email di conferma con link ‚Äúone-time‚Äù\r\n3. Utente clicca link, crea password e completa registrazione\r\n4. Primo login, viene assegnato a tenant/azienda e ruolo di default\r\n5. System logga ogni passaggio e invia welcome email/alert admin tenant\n\n---\n\n> **Nota:**  \r\n> Ogni step deve essere tracciato nei log/audit e gestito secondo policy di sicurezza (tentativi, token, scadenze, MFA‚Ä¶).","size_chars":535,"tokens_estimate":134}
{"doc_id":"ew-login-flussi-onboarding","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding.md","title":"Lookup ‚Äì Flussi Onboarding/Login","owner":"","tags":["layer/how-to","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":4,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-notifiche-gestione","path":"EasyWay_WebApp/02_logiche_easyway/notifiche-gestione.md","title":"Lookup ‚Äì Gestione Notifiche","owner":"","tags":["layer/how-to","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Tabella Tipologia Notifiche\r","anchor_slug":"tabella-tipologia-notifiche","chunk_index":1,"content":"## Tabella Tipologia Notifiche\n\n| Tipo Notifica           | Scopo/Trigger                         | Canale        | Configurabile da utente | Note Operative                          |\r\n|-------------------------|---------------------------------------|---------------|------------------------|-----------------------------------------|\r\n| Onboarding/Welcome      | Primo accesso, registrazione completata| Email         | No                     | Obbligatoria, template standard         |\r\n| Cambio password/MFA     | Reset credenziali, abilitazione MFA   | Email, SMS    | No                     | Alert immediato, link one-time          |\r\n| Alert sicurezza         | Accesso anomalo, tentativi falliti    | Email, Teams  | No                     | Alert ad admin e utente, logging obbl.  |\r\n| Notifiche sistema       | Errori ETL, esito batch, job completato| Email, Teams  | S√¨                     | Configurabile da profilo/ruolo          |\r\n| Notifiche billing       | Scadenza servizio, fattura disponibile| Email         | S√¨                     | Solo owner/admin tenant                 |\r\n| Reminder scadenze       | Token/API in scadenza, task da completare| Email      | S√¨                     | Alert automatico, scheduling            |\r\n| Notifiche personalizzate| Eventi business, comunicazioni custom | Email, Teams  | S√¨                     | Gestite da admin tenant/prodotto        |\n\n---","size_chars":1406,"tokens_estimate":352}
{"doc_id":"ew-notifiche-gestione","path":"EasyWay_WebApp/02_logiche_easyway/notifiche-gestione.md","title":"Lookup ‚Äì Gestione Notifiche","owner":"","tags":["layer/how-to","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Gestione Preferenze Notifica Utente\r","anchor_slug":"gestione-preferenze-notifica-utente","chunk_index":2,"content":"## Gestione Preferenze Notifica Utente\n\n- **Ogni utente pu√≤ configurare** su quali canali ricevere le notifiche (email, Teams, solo dashboard, ecc.) e quali categorie attivare/disattivare.\r\n- Le **preferenze sono salvate** su tabella `user_notification_settings` (schema PORTAL).\r\n- **Notifiche obbligatorie** (onboarding, alert sicurezza) **non sono disattivabili**.\r\n- **Modifica preferenze** tracciata in audit log (timestamp, chi ha modificato, vecchio e nuovo stato).\r\n- **Template multilingua** e personalizzabili (per tenant/ruolo).\n\n---","size_chars":544,"tokens_estimate":136}
{"doc_id":"ew-notifiche-gestione","path":"EasyWay_WebApp/02_logiche_easyway/notifiche-gestione.md","title":"Lookup ‚Äì Gestione Notifiche","owner":"","tags":["layer/how-to","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Flusso Invio Notifiche (step-by-step)\r","anchor_slug":"flusso-invio-notifiche-step-by-step","chunk_index":3,"content":"## Flusso Invio Notifiche (step-by-step)\n\n1. Microservizio/interfaccia rileva evento che richiede notifica (es: job ETL fallito, nuovo login)\r\n2. Recupera preferenze notifica utente/tenant (canale, categoria)\r\n3. Costruisce messaggio usando template predefinito (con merge dati dinamici)\r\n4. Invia tramite canale selezionato (SMTP, Teams webhook, SMS gateway‚Ä¶)\r\n5. Logga evento di invio (stato: consegnato, errore, retry)\r\n6. Se fallisce, tenta retry secondo policy e allerta admin se errore persistente\n\n---","size_chars":508,"tokens_estimate":127}
{"doc_id":"ew-notifiche-gestione","path":"EasyWay_WebApp/02_logiche_easyway/notifiche-gestione.md","title":"Lookup ‚Äì Gestione Notifiche","owner":"","tags":["layer/how-to","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Best Practice Notifiche Multi-tenant\r","anchor_slug":"best-practice-notifiche-multi-tenant","chunk_index":4,"content":"## Best Practice Notifiche Multi-tenant\n\n- **Tutte le notifiche devono sempre essere riferite a tenant_id e user_id**, per garantire isolamento dati.\r\n- **Canali separati per ambiente** (dev/test/prod):  \r\n  in dev/test, le notifiche vanno solo a indirizzi di test (mai clienti reali!).\r\n- **Configurazione dinamica canali e template** per ogni tenant (supporto white-label).\r\n- **Audit logging attivo** per tutte le notifiche inviate/non consegnate.\r\n- **Retry automatico** per canali non disponibili, con alert escalation.\r\n- **Conservazione log invio** almeno 6 mesi, con dettaglio messaggio, stato, destinatario.\n\n---","size_chars":621,"tokens_estimate":155}
{"doc_id":"ew-notifiche-gestione","path":"EasyWay_WebApp/02_logiche_easyway/notifiche-gestione.md","title":"Lookup ‚Äì Gestione Notifiche","owner":"","tags":["layer/how-to","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Logging/Audit Notifiche\r","anchor_slug":"loggingaudit-notifiche","chunk_index":5,"content":"## Logging/Audit Notifiche\n\n- Tutte le notifiche inviate sono registrate su tabella `notification_log` (tenant_id, user_id, tipo, canale, timestamp, stato).\r\n- Errori di invio tracciati con motivo, tentativi e outcome finale.\r\n- Modifica preferenze sempre loggata (vecchio e nuovo valore, chi e quando).\r\n- Integrazione con flussi di audit centrale (`portal-audit`), per compliance.\n\n---","size_chars":387,"tokens_estimate":97}
{"doc_id":"ew-notifiche-gestione","path":"EasyWay_WebApp/02_logiche_easyway/notifiche-gestione.md","title":"Lookup ‚Äì Gestione Notifiche","owner":"","tags":["layer/how-to","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Nota operativa\r","anchor_slug":"nota-operativa","chunk_index":6,"content":"## Nota operativa\n\n- Prima di attivare notifiche verso clienti/utenti reali, testare canali e template su ambiente sandbox/dev.\r\n- I template email/notifica devono essere versionati e gestiti come asset del portale (cartella portal-assets).","size_chars":240,"tokens_estimate":60}
{"doc_id":"ew-notifiche-gestione","path":"EasyWay_WebApp/02_logiche_easyway/notifiche-gestione.md","title":"Lookup ‚Äì Gestione Notifiche","owner":"","tags":["layer/how-to","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":7,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway","path":"EasyWay_WebApp/02_logiche_easyway/policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway.md","title":"Policy di Configurazione & Sicurezza ‚Äì Microservizi e API Gateway","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Dettaglio Implementativo Policy Chiave\r","anchor_slug":"dettaglio-implementativo-policy-chiave","chunk_index":1,"content":"## Dettaglio Implementativo Policy Chiave","size_chars":41,"tokens_estimate":10}
{"doc_id":"ew-policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway","path":"EasyWay_WebApp/02_logiche_easyway/policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway.md","title":"Policy di Configurazione & Sicurezza ‚Äì Microservizi e API Gateway","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"1. Isolation Tenant & Row-Level Security\r","anchor_slug":"1-isolation-tenant-row-level-security","chunk_index":2,"content":"### 1. Isolation Tenant & Row-Level Security\r\n- Ogni richiesta (API Gateway ‚Üí microservizio ‚Üí DB) **porta sempre il tenant_id**.\r\n- Le query DB usano filtri su tenant_id (e profilo/ruolo se necessario).\r\n- Implementazione RLS su tutte le tabelle multi-tenant.\r\n- **Refuso da evitare:** mai lasciare endpoint senza validazione tenant/ruolo.","size_chars":339,"tokens_estimate":85}
{"doc_id":"ew-policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway","path":"EasyWay_WebApp/02_logiche_easyway/policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway.md","title":"Policy di Configurazione & Sicurezza ‚Äì Microservizi e API Gateway","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"2. Identity Tecnica\r","anchor_slug":"2-identity-tecnica","chunk_index":3,"content":"### 2. Identity Tecnica\r\n- Ogni microservizio/container **usa un Managed Identity Azure** oppure uno specifico Service Principal.\r\n- Le identity hanno **solo i permessi strettamente necessari** (least privilege).\r\n- Accesso a Key Vault, storage e DB solo tramite queste identity.","size_chars":279,"tokens_estimate":70}
{"doc_id":"ew-policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway","path":"EasyWay_WebApp/02_logiche_easyway/policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway.md","title":"Policy di Configurazione & Sicurezza ‚Äì Microservizi e API Gateway","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"3. Gestione Segreti e Parametri\r","anchor_slug":"3-gestione-segreti-e-parametri","chunk_index":4,"content":"### 3. Gestione Segreti e Parametri\r\n- Nessuna password/chiave hardcoded nel codice o pipeline.\r\n- Tutte le connessioni, segreti, token API sono su **Azure Key Vault** o (in locale) file `.env` cifrati/versionati.\r\n- Ogni accesso ai segreti viene loggato/auditato e ruotato periodicamente.","size_chars":289,"tokens_estimate":72}
{"doc_id":"ew-policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway","path":"EasyWay_WebApp/02_logiche_easyway/policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway.md","title":"Policy di Configurazione & Sicurezza ‚Äì Microservizi e API Gateway","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"4. Networking Sicuro\r","anchor_slug":"4-networking-sicuro","chunk_index":5,"content":"### 4. Networking Sicuro\r\n- Ogni microservizio √® raggiungibile **solo via VNet interna** o Private Endpoint.\r\n- Accesso pubblico solo all‚ÄôAPI Gateway.\r\n- Nessun database o storage esposto su Internet.\r\n- Firewall e NSG su ogni subnet/container group.","size_chars":250,"tokens_estimate":62}
{"doc_id":"ew-policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway","path":"EasyWay_WebApp/02_logiche_easyway/policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway.md","title":"Policy di Configurazione & Sicurezza ‚Äì Microservizi e API Gateway","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"5. Policy Config Versionabile\r","anchor_slug":"5-policy-config-versionabile","chunk_index":6,"content":"### 5. Policy Config Versionabile\r\n- Tutte le configurazioni sono mantenute come **Infrastructure as Code** (Bicep, ARM, Terraform) o in repository YAML/GitOps.\r\n- Ogni modifica/configurazione ambientale √® storicizzata.\r\n- Niente ‚Äúparametri manuali‚Äù inseriti a mano su Azure Portal.","size_chars":282,"tokens_estimate":70}
{"doc_id":"ew-policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway","path":"EasyWay_WebApp/02_logiche_easyway/policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway.md","title":"Policy di Configurazione & Sicurezza ‚Äì Microservizi e API Gateway","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"6. Audit & Logging\r","anchor_slug":"6-audit-logging","chunk_index":7,"content":"### 6. Audit & Logging\r\n- Ogni richiesta critica (login, cambio ACL, accesso dati sensibili, errore auth) √® tracciata in modo centralizzato.\r\n- Log e audit trail con retention policy e alert su accessi/anomalie.\r\n- Tutto lo storico a disposizione per compliance e troubleshooting.\n\n---","size_chars":285,"tokens_estimate":71}
{"doc_id":"ew-policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway","path":"EasyWay_WebApp/02_logiche_easyway/policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway.md","title":"Policy di Configurazione & Sicurezza ‚Äì Microservizi e API Gateway","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"**Best Practice Operativa**\r","anchor_slug":"best-practice-operativa","chunk_index":8,"content":"## **Best Practice Operativa**\r\n> Ogni script, template o codice dovr√† SEMPRE:\r\n> - Integrare queste policy come requisito base\r\n> - Indicare (in README/commenti) che le configurazioni vanno versionate e i segreti gestiti fuori dal codice\r\n> - Prevedere auditing/logging centralizzato per qualsiasi azione rilevante\n\n---\n\n**Se questa sezione va bene, la segno come ‚ÄúPRONTA PER CODICE‚Äù e passo alla prossima macro-sezione che vuoi tu.**\r\nVuoi aggiungere o dettagliare una specifica policy?  \r\nOppure proseguiamo con la prossima sezione (es: ‚ÄúGestione logging & audit‚Äù, ‚ÄúBest practice naming e scaling‚Äù, ecc.)?","size_chars":608,"tokens_estimate":152}
{"doc_id":"ew-policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway","path":"EasyWay_WebApp/02_logiche_easyway/policy-di-configurazione-and-sicurezza-microservizi-e-api-gateway.md","title":"Policy di Configurazione & Sicurezza ‚Äì Microservizi e API Gateway","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":9,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-raccomandazione-architetturale-easyway-data-portal","path":"EasyWay_WebApp/02_logiche_easyway/raccomandazione-architetturale-easyway-data-portal.md","title":"**Dalle chat emerge chiaramente che:**","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**Dalle chat emerge chiaramente che:**\r","anchor_slug":"dalle-chat-emerge-chiaramente-che","chunk_index":1,"content":"### **Dalle chat emerge chiaramente che:**\n\n*   EasyWay Data Portal √® un **SaaS B2B multi-tenant** moderno, orientato a:\r\n    *   **Data platform** e dashboard multi-dominio (economics, sostenibilit√†, data quality, e-commerce, integrazione API esterne‚Ä¶)\r\n        \r\n    *   **Accesso controllato e segregato per tenant/cliente** (e per ruoli/profili/gruppi ACL)\r\n        \r\n    *   **Sicurezza, compliance (GDPR/SOC2/DORA), tracciabilit√†, versioning e audit trail** a livello enterprise\r\n        \r\n    *   **Alta configurabilit√†**, template e workflow personalizzabili, onboarding flessibile, policy gestite via DB/parametri\r\n        \r\n*   Vuoi una piattaforma **‚Äúfuture proof‚Äù**: pronta per nuove estensioni, microservizi, federazione, API, crescita dei dati\r\n    \r\n*   **Centralit√† di:**\r\n    *   DB relazionale strutturato (SQL Server, modelli GOLD/BRONZE/PORTAL‚Ä¶)\r\n        \r\n    *   Storage Datalake (Azure)\r\n        \r\n    *   Microservizi/Container come logica di servizio (gestione domini, ACL, integrazione API)\r\n        \r\n    *   Provisioning e gestione accessi via Azure Entra ID, policy IAM strutturata, naming convenzionato\r\n        \r\n*   Vuoi evitare ‚Äúmonoliti‚Äù e preferisci una **Web App composta da microservizi/container**,  \r\n    ma con governance semplice, sicurezza top, e capacit√† di deployment e test anche su ambiente dev/local\r\n    \n\n* * *\n\n**2. Che alternative architetturali abbiamo su Azure?**\r\n-------------------------------------------------------","size_chars":1473,"tokens_estimate":368}
{"doc_id":"ew-raccomandazione-architetturale-easyway-data-portal","path":"EasyWay_WebApp/02_logiche_easyway/raccomandazione-architetturale-easyway-data-portal.md","title":"**Dalle chat emerge chiaramente che:**","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**A. Azure App Service Plan + Container**\r","anchor_slug":"a-azure-app-service-plan-container","chunk_index":2,"content":"### **A. Azure App Service Plan + Container**\n\n*   Containerizzando i microservizi ma deployando su istanze PaaS, con scaling gestito da Azure\r\n    \r\n*   **Pro:**\r\n    *   Semplicit√† di setup, costi prevedibili, nessuna gestione cluster/VM\r\n        \r\n    *   Perfetto per MVP, PoC e piccoli team\r\n        \r\n    *   Facile da integrare con pipeline Azure DevOps/GitHub Actions\r\n        \r\n*   **Contro:**\r\n    *   Limitato nel clustering avanzato, scaling multi-regione, service mesh, gestione segreti evoluta\r\n        \r\n    *   Pi√π ‚Äúmonolitico‚Äù in gestione release: meno adatto per decine di microservizi indipendenti","size_chars":616,"tokens_estimate":154}
{"doc_id":"ew-raccomandazione-architetturale-easyway-data-portal","path":"EasyWay_WebApp/02_logiche_easyway/raccomandazione-architetturale-easyway-data-portal.md","title":"**Dalle chat emerge chiaramente che:**","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**B. Azure Container Apps**\r","anchor_slug":"b-azure-container-apps","chunk_index":3,"content":"### **B. Azure Container Apps**\n\n*   Un‚Äôevoluzione tra App Service e AKS: gestisce il deployment di container, scaling on demand, senza dover gestire un cluster AKS\r\n    \r\n*   **Pro:**\r\n    *   Molta elasticit√†, auto-scaling anche su eventi/kafka\r\n        \r\n    *   Pi√π economico di AKS per carichi fluttuanti/batch\r\n        \r\n    *   Perfetto per microservizi indipendenti, senza overhead di cluster management\r\n        \r\n*   **Contro:**\r\n    *   Pi√π nuovo/meno maturo di App Service o AKS (meno documentazione, meno automazioni enterprise)\r\n        \r\n    *   Limiti su networking avanzato rispetto ad AKS puro","size_chars":611,"tokens_estimate":153}
{"doc_id":"ew-raccomandazione-architetturale-easyway-data-portal","path":"EasyWay_WebApp/02_logiche_easyway/raccomandazione-architetturale-easyway-data-portal.md","title":"**Dalle chat emerge chiaramente che:**","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**C. AKS ‚Äì Azure Kubernetes Service (full cluster Kubernetes)**\r","anchor_slug":"c-aks-azure-kubernetes-service-full-cluster-kubernetes","chunk_index":4,"content":"### **C. AKS ‚Äì Azure Kubernetes Service (full cluster Kubernetes)**\n\n*   Il top della flessibilit√†, ma anche della complessit√† gestionale\r\n    \r\n*   **Pro:**\r\n    *   Standard de facto per microservizi/container a livello enterprise, multi-cloud, multi-region\r\n        \r\n    *   Gestione service mesh, ingress, segreti, RBAC, operator, custom CRD, rolling update, canary deploy, blue/green‚Ä¶\r\n        \r\n    *   Pronto per federazioni, evoluzioni architetturali, orchestrazione avanzata\r\n        \r\n*   **Contro:**\r\n    *   Curva di apprendimento, overhead gestionale (patch, backup, monitoring, logging cluster)\r\n        \r\n    *   Costi fissi (minimo 1-3 VM sempre attive, anche a carico zero)\r\n        \r\n    *   Pipeline CI/CD pi√π complesse, pi√π error-prone se il team non √® gi√† formato su Kubernetes\r\n        \n\n* * *\n\n**3. Quale scegliere per EasyWay Data Portal?**\r\n-----------------------------------------------\n\n**La tua vision** (dalle chat) indica una piattaforma che:\r\n*   Deve **scalare e federarsi** in futuro, ma che **vuoi lanciare in modo rapido e ordinato** oggi\r\n    \r\n*   Prevede tanti microservizi, ma con processi chiari di audit, naming, e gestione template\r\n    \r\n*   Vuole essere sempre pronta a ‚Äúmigrare di livello‚Äù senza bloccare il delivery","size_chars":1263,"tokens_estimate":316}
{"doc_id":"ew-raccomandazione-architetturale-easyway-data-portal","path":"EasyWay_WebApp/02_logiche_easyway/raccomandazione-architetturale-easyway-data-portal.md","title":"**Dalle chat emerge chiaramente che:**","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**La mia raccomandazione pratica:**\r","anchor_slug":"la-mia-raccomandazione-pratica","chunk_index":5,"content":"### **La mia raccomandazione pratica:**","size_chars":39,"tokens_estimate":10}
{"doc_id":"ew-raccomandazione-architetturale-easyway-data-portal","path":"EasyWay_WebApp/02_logiche_easyway/raccomandazione-architetturale-easyway-data-portal.md","title":"**Dalle chat emerge chiaramente che:**","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**Fase 1 (MVP, primo go-live, delivery rapido):**\r","anchor_slug":"fase-1-mvp-primo-go-live-delivery-rapido","chunk_index":6,"content":"### **Fase 1 (MVP, primo go-live, delivery rapido):**\n\n*   **App Service Plan + Container Apps**\r\n    *   Sfrutta i microservizi come container (con Azure Container Registry)\r\n        \r\n    *   Deploy su App Service Plan o Azure Container Apps\r\n        \r\n    *   Governa routing via Azure API Management Developer (per dev) o Standard (per prod)\r\n        \r\n    *   **PRO:**\r\n        *   Semplicit√†, rapidit√† di sviluppo, test locale immediato, costi bassi (vedi sotto)\r\n            \r\n        *   Governance IAM, naming, logging gi√† allineati a quanto progettato","size_chars":561,"tokens_estimate":140}
{"doc_id":"ew-raccomandazione-architetturale-easyway-data-portal","path":"EasyWay_WebApp/02_logiche_easyway/raccomandazione-architetturale-easyway-data-portal.md","title":"**Dalle chat emerge chiaramente che:**","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**Fase 2 (Crescita, enterprise, federazione, multi-region):**\r","anchor_slug":"fase-2-crescita-enterprise-federazione-multi-region","chunk_index":7,"content":"### **Fase 2 (Crescita, enterprise, federazione, multi-region):**\n\n*   **Migrazione graduale ad AKS**\r\n    *   Una volta consolidati processi, security, pipeline, si pu√≤ spostare (anche uno alla volta) i microservizi/container su AKS\r\n        \r\n    *   Permette di scalare, isolare, federare a piacere, e aggiungere advanced features (service mesh, autoscaling, multi-cloud ecc.)\r\n        \n\n* * *\n\n**4. Forecast costi (2025)**\r\n----------------------------","size_chars":456,"tokens_estimate":114}
{"doc_id":"ew-raccomandazione-architetturale-easyway-data-portal","path":"EasyWay_WebApp/02_logiche_easyway/raccomandazione-architetturale-easyway-data-portal.md","title":"**Dalle chat emerge chiaramente che:**","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**Scenario 1 ‚Äì App Service Plan + Container Apps + Dev API Management**\r","anchor_slug":"scenario-1-app-service-plan-container-apps-dev-api-management","chunk_index":8,"content":"### **Scenario 1 ‚Äì App Service Plan + Container Apps + Dev API Management**\n\n*   **App Service Plan S1**: ~65 ‚Ç¨/mese per app (scalabile, ma puoi partire anche con meno)\r\n    \r\n*   **Azure Container Registry**: ~4 ‚Ç¨/mese (Basic, storage immagini)\r\n    \r\n*   **Container Apps**: pay-per-use, costi bassi per microservizi ‚Äúsleeping‚Äù\r\n    \r\n*   **API Management Developer**: 45 ‚Ç¨/mese (dev/test, nessun SLA)\r\n    \r\n*   **Storage Account (LRS)**: ~20 ‚Ç¨/mese (datalake dev, prezzi variabili)\r\n    \r\n*   **DB SQL Server**: da ~15-80 ‚Ç¨/mese (dev/test, si adatta a carico, DTU/Managed Instance)\r\n    \n\n> **Stima costi DEV/PoC**:  \r\n> ~150-250 ‚Ç¨/mese per tutto il core, **se tieni poche risorse attive** e spegni/elimini quelle non usate (es. API Mgmt).\n\n> **Stima costi PROD primo go-live**:  \r\n> 250-400 ‚Ç¨/mese se attivi almeno 2-3 microservizi/container, API Mgmt Standard, storage + DB SQL, scaling base.\n\n* * *","size_chars":905,"tokens_estimate":226}
{"doc_id":"ew-raccomandazione-architetturale-easyway-data-portal","path":"EasyWay_WebApp/02_logiche_easyway/raccomandazione-architetturale-easyway-data-portal.md","title":"**Dalle chat emerge chiaramente che:**","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**Scenario 2 ‚Äì AKS (Kubernetes Full)**\r","anchor_slug":"scenario-2-aks-kubernetes-full","chunk_index":9,"content":"### **Scenario 2 ‚Äì AKS (Kubernetes Full)**\n\n*   **AKS cluster**: almeno 2 nodi VM (B2s): ~50 ‚Ç¨/mese per nodo = 100 ‚Ç¨/mese\r\n    \r\n*   **Load balancer pubblico AKS**: ~18 ‚Ç¨/mese\r\n    \r\n*   **Container Registry**: 4 ‚Ç¨/mese\r\n    \r\n*   **API Mgmt Standard**: 700 ‚Ç¨/mese (se vuoi alta disponibilit√†, proxy, multi-tenant)\r\n    \r\n*   **Storage + DB**: come sopra (~20 + 80 ‚Ç¨/mese)\r\n    \n\n> **Stima minima mensile, anche a risorse spente:**  \r\n> AKS+API Mgmt Standard: **~900-1.000 ‚Ç¨/mese** per ambiente produzione  \r\n> (con opzione di abbassare i costi solo riducendo i nodi o scegliendo API Mgmt Basic).\n\n* * *","size_chars":603,"tokens_estimate":151}
{"doc_id":"ew-raccomandazione-architetturale-easyway-data-portal","path":"EasyWay_WebApp/02_logiche_easyway/raccomandazione-architetturale-easyway-data-portal.md","title":"**Dalle chat emerge chiaramente che:**","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**Scenario 3 ‚Äì Hybrid/Container Apps**\r","anchor_slug":"scenario-3-hybridcontainer-apps","chunk_index":10,"content":"### **Scenario 3 ‚Äì Hybrid/Container Apps**\n\n*   **Container Apps**: se usi scaling su eventi, batch, lavori saltuari\r\n    \r\n*   Costi elastici (scali a zero se nessun traffico)\r\n    \r\n*   Perfetto per ambienti dev, test, PoC, e per servizi accessori\r\n    \n\n* * *\n\n**5. PRO/CONTRO ‚Äì Tabella pratica**\r\n-----------------------------------\n\n| Approccio | PRO | CONTRO | Quando preferirlo |\r\n| --- | --- | --- | --- |\r\n| App Service Plan | Semplicit√†, costi bassi, poco setup, start veloce | Meno custom/scalabile di AKS | MVP, go-live veloce, team piccolo |\r\n| Container Apps | Scalabilit√† elastica, poco management, pay per use | Meno maturo, meno networking avanzato | Batch, microservizi separati, PoC |\r\n| AKS (Kubernetes) | Enterprise, massima flessibilit√†, standard de facto | Costi fissi, curva learning, pi√π devops | Espansione, federazione, grandi volumi |\n\n* * *\n\n**6. Visione d‚Äôinsieme / Best Practice finale**\r\n-----------------------------------------------\n\n**Iniziare con App Service Plan/Container Apps** √® la scelta migliore per EasyWay Data Portal ora:\r\n*   Delivery rapido, costi sotto controllo, possibilit√† di test locale\r\n    \r\n*   Puoi implementare TUTTE le best practice gi√† progettate (ACL, logging, security, onboarding, API Mgmt)\r\n    \r\n*   **Quando (e se) crescerai**: potrai fare ‚Äúlift & shift‚Äù su AKS gradualmente,  \r\n    riutilizzando pipeline, container, policy e naming (gi√† standardizzato)\r\n    \r\n**AKS sar√† lo step naturale appena serviranno:**\r\n*   Multi-region\r\n    \r\n*   Migliaia di utenti/concurrency elevata\r\n    \r\n*   Custom routing/networking/mesh avanzate\r\n    \r\n*   Federation/multi-cloud\r\n    \n\n* * *","size_chars":1642,"tokens_estimate":410}
{"doc_id":"ew-raccomandazione-architetturale-easyway-data-portal","path":"EasyWay_WebApp/02_logiche_easyway/raccomandazione-architetturale-easyway-data-portal.md","title":"**Dalle chat emerge chiaramente che:**","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**Azioni pratiche immediate**\r","anchor_slug":"azioni-pratiche-immediate","chunk_index":11,"content":"### **Azioni pratiche immediate**\n\n*   Prepara i manifest/container e pipeline **in modo che siano gi√† ‚Äúportabili‚Äù** (Dockerfile, IaC, template versionati)\r\n    \r\n*   Centralizza policy e naming in repository/Key Vault, come gi√† previsto\r\n    \r\n*   **Non fossilizzarti ora su AKS**: √® la naturale evoluzione, ma puoi starci dopo con calma e senza ansie di lock-in\r\n    \n\n* * *\n\n**7. Forecast futuro**\r\n----------------------\n\n*   **Dev/test:** puoi mantenere costi <200‚Ç¨/mese\r\n    \r\n*   **Prod**: per tutto il portale ‚Äúbase‚Äù, stimerei **300-500‚Ç¨/mese** in modalit√† PaaS/container,  \r\n    salendo a >900‚Ç¨/mese solo scegliendo full AKS con API Mgmt Standard/Premium.","size_chars":664,"tokens_estimate":166}
{"doc_id":"ew-raccomandazione-architetturale-easyway-data-portal","path":"EasyWay_WebApp/02_logiche_easyway/raccomandazione-architetturale-easyway-data-portal.md","title":"**Dalle chat emerge chiaramente che:**","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":12,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-api-invio-notifica","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-invio-notifica.md","title":"**1. Schema di validazione**","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**1. Schema di validazione**\r","anchor_slug":"1-schema-di-validazione","chunk_index":1,"content":"### **1. Schema di validazione**\n\n`src/validators/notificationValidator.ts`\n\n```sql\r\nexport const sendNotificationSchema = z.object({\r\n  recipients: z.array(z.string().min(6).max(64)), // array di user_id\r\n  category: z.string().min(3).max(32),   // es: \"ALERT\"\r\n  channel: z.string().min(3).max(16),    // es: \"EMAIL\", \"SMS\"\r\n  message: z.string().min(1).max(1024),\r\n  ext_attributes: z.record(z.any()).optional()\r\n});\n\n```sql","size_chars":427,"tokens_estimate":107}
{"doc_id":"ew-api-invio-notifica","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-invio-notifica.md","title":"**1. Schema di validazione**","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**2. Controller**\r","anchor_slug":"2-controller","chunk_index":2,"content":"### **2. Controller**\n\n`src/controllers/notificationsController.ts`\n\n```sql\r\nimport { Request, Response } from \"express\";\r\nimport sql from \"mssql\";\r\nimport { logger } from \"../utils/logger\";\n\nexport async function sendNotification(req: Request, res: Response) {\r\n  const pool = await sql.connect(process.env.DB_CONN_STRING!);\r\n  const tenantId = (req as any).tenantId;\r\n  const { recipients, category, channel, message, ext_attributes = {} } = req.body;\n\n  try {\r\n    // Per ogni destinatario, chiama la SP (o batch, secondo design DB)\r\n    for (const user_id of recipients) {\r\n      await pool.request()\r\n        .input(\"tenant_id\", sql.NVarChar, tenantId)\r\n        .input(\"user_id\", sql.NVarChar, user_id)\r\n        .input(\"category\", sql.NVarChar, category)\r\n        .input(\"channel\", sql.NVarChar, channel)\r\n        .input(\"message\", sql.NVarChar, message)\r\n        .input(\"ext_attributes\", sql.NVarChar, JSON.stringify(ext_attributes))\r\n        .execute(\"PORTAL.sp_send_notification\");\r\n    }\n\n    logger.info(\"Notification sent\", {\r\n      tenantId,\r\n      recipientsCount: recipients.length,\r\n      category,\r\n      channel,\r\n      event: \"NOTIFY_SEND\",\r\n      time: new Date().toISOString()\r\n    });\n\n    res.status(200).json({ ok: true, sent: recipients.length });\n\n  } catch (err: any) {\r\n    logger.error(\"Send notification failed\", {\r\n      tenantId,\r\n      error: err.message,\r\n      event: \"NOTIFY_SEND_ERROR\",\r\n      time: new Date().toISOString()\r\n    });\r\n    res.status(500).json({ error: err.message });\r\n  }\r\n}\n\n```sql","size_chars":1536,"tokens_estimate":384}
{"doc_id":"ew-api-invio-notifica","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-invio-notifica.md","title":"**1. Schema di validazione**","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**3. Rotta**\r","anchor_slug":"3-rotta","chunk_index":3,"content":"### **3. Rotta**\n\n`src/routes/notifications.ts`  \r\n_(aggiungi accanto a subscribe)_\n\n```sql\r\nimport { sendNotification } from \"../controllers/notificationsController\";\r\nimport { sendNotificationSchema } from \"../validators/notificationValidator\";\n\nrouter.post(\"/send\", validateBody(sendNotificationSchema), sendNotification);\n\n```sql","size_chars":333,"tokens_estimate":83}
{"doc_id":"ew-api-invio-notifica","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-invio-notifica.md","title":"**1. Schema di validazione**","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"ENDPOINT: POST `/api/notifications/send`\r","anchor_slug":"endpoint-post-apinotificationssend","chunk_index":4,"content":"### ENDPOINT: POST `/api/notifications/send`\n\n**Descrizione**  \r\nInvia (o simula l‚Äôinvio) una notifica a uno o pi√π utenti,  \r\nmappando la chiamata alla store procedure `PORTAL.sp_send_notification`.\n\n**Validazione**  \r\n- recipients: array di user_id, obbligatorio\r\n- category, channel, message: obbligatori, validati per lunghezza/formato\n\n**Logging**\r\n- Log business su file/console (event: NOTIFY_SEND)\r\n- Errori loggati, mai dati sensibili\n\n**Test**\r\n- POST `/api/notifications/send`  \r\n  Body:\r\n  ```json\r\n  {\r\n    \"recipients\": [\"USR000001\", \"USR000002\"],\r\n    \"category\": \"ALERT\",\r\n    \"channel\": \"EMAIL\",\r\n    \"message\": \"Messaggio di esempio\",\r\n    \"ext_attributes\": { \"source\": \"system\" }\r\n  }\r\n  ```\r\nRisposta 200 OK, o 500 in caso di errore","size_chars":751,"tokens_estimate":188}
{"doc_id":"ew-api-invio-notifica","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-invio-notifica.md","title":"**1. Schema di validazione**","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":5,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-api-notifiche","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-notifiche.md","title":"**1. Schema di validazione**","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**1. Schema di validazione**\r","anchor_slug":"1-schema-di-validazione","chunk_index":1,"content":"### **1. Schema di validazione**\n\n`src/validators/notificationValidator.ts`\n\n\r\n```sql\r\nimport { z } from \"zod\";\n\nexport const subscribeSchema = z.object({\r\n  user_id: z.string().min(6).max(64),\r\n  category: z.string().min(3).max(32),   // es: \"NEWS\", \"ALERT\", \"BILLING\"\r\n  channel: z.string().min(3).max(16)     // es: \"EMAIL\", \"SMS\", \"PUSH\"\r\n});\n\n```sql","size_chars":354,"tokens_estimate":88}
{"doc_id":"ew-api-notifiche","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-notifiche.md","title":"**1. Schema di validazione**","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**2. Controller**\r","anchor_slug":"2-controller","chunk_index":2,"content":"### **2. Controller**\n\n`src/controllers/notificationsController.ts`\n\n```sql\r\nimport { Request, Response } from \"express\";\r\nimport sql from \"mssql\";\r\nimport { logger } from \"../utils/logger\";\n\nexport async function subscribeNotification(req: Request, res: Response) {\r\n  const pool = await sql.connect(process.env.DB_CONN_STRING!);\r\n  const { user_id, category, channel } = req.body;\r\n  const tenantId = (req as any).tenantId;\n\n  try {\r\n    // Chiama la stored procedure di subscription (nome conforme a EasyWay DB)\r\n    await pool.request()\r\n      .input(\"tenant_id\", sql.NVarChar, tenantId)\r\n      .input(\"user_id\", sql.NVarChar, user_id)\r\n      .input(\"category\", sql.NVarChar, category)\r\n      .input(\"channel\", sql.NVarChar, channel)\r\n      .execute(\"PORTAL.sp_subscribe_notification\");\n\n    // Log business (no dati sensibili)\r\n    logger.info(\"User subscribed to notification\", {\r\n      tenantId,\r\n      userId: user_id,\r\n      category,\r\n      channel,\r\n      event: \"NOTIFY_SUBSCRIBE\",\r\n      time: new Date().toISOString()\r\n    });\n\n    res.status(200).json({ ok: true });\r\n  } catch (err: any) {\r\n    logger.error(\"Subscription failed\", {\r\n      tenantId,\r\n      userId: user_id,\r\n      error: err.message,\r\n      event: \"NOTIFY_SUBSCRIBE_ERROR\",\r\n      time: new Date().toISOString()\r\n    });\r\n    res.status(500).json({ error: err.message });\r\n  }\r\n}\n\n```sql","size_chars":1370,"tokens_estimate":342}
{"doc_id":"ew-api-notifiche","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-notifiche.md","title":"**1. Schema di validazione**","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"**3. Rotta**\r","anchor_slug":"3-rotta","chunk_index":3,"content":"### **3. Rotta**\n\n`src/routes/notifications.ts`\n\n```sql\r\nimport { Router } from \"express\";\r\nimport { subscribeNotification } from \"../controllers/notificationsController\";\r\nimport { validateBody } from \"../middleware/validate\";\r\nimport { subscribeSchema } from \"../validators/notificationValidator\";\n\nconst router = Router();\n\nrouter.post(\"/subscribe\", validateBody(subscribeSchema), subscribeNotification);\n\nexport default router;\n\n```sql\n\nAggiungi in `app.ts`:\n\n```sql\r\nimport notificationsRoutes from \"./routes/notifications\";\r\napp.use(\"/api/notifications\", notificationsRoutes);\r\n```sql","size_chars":590,"tokens_estimate":148}
{"doc_id":"ew-api-notifiche","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-notifiche.md","title":"**1. Schema di validazione**","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":4,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-api-onboarding","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-onboarding.md","title":"ENDPOINT: POST `/api/onboarding`","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":3,"anchor_text":"ENDPOINT: POST `/api/onboarding`\r","anchor_slug":"endpoint-post-apionboarding","chunk_index":1,"content":"### ENDPOINT: POST `/api/onboarding`\n\n**Descrizione**  \r\nPermette di registrare un nuovo tenant + user in un colpo solo.  \r\nChiamata REST che mappa la store procedure core di onboarding (`PORTAL.sp_debug_register_tenant_and_user`).\n\n**Best Practice**\r\n- Input sempre validato (zod, middleware)\r\n- Log in `PORTAL.STATS_EXECUTION_LOG` (via SP) con esito, tempi, parametri, eventuale errore\r\n- Logging applicativo solo info chiave (mai dati sensibili)\n\n**Come si testa**\r\n- POST `/api/onboarding` con JSON body:\r\n  ```json\r\n  {\r\n    \"tenant_name\": \"Nuovo Cliente Srl\",\r\n    \"user_email\": \"amministratore@nuovocliente.it\",\r\n    \"display_name\": \"Mario Rossi\",\r\n    \"profile_id\": \"ADMIN\",\r\n    \"ext_attributes\": { \"source\": \"web\", \"ip\": \"1.2.3.4\" }\r\n  }\r\n  ```\r\n*   Risposta 201 OK con result.\r\n    \r\n*   In caso di errore: 500 + messaggio.\r\n    \n\nyaml\n\nCopyEdit\n\n`---  ### **STOP**`","size_chars":877,"tokens_estimate":219}
{"doc_id":"ew-api-onboarding","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/api-onboarding.md","title":"ENDPOINT: POST `/api/onboarding`","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":2,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-checklist-di-test-api","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/checklist-di-test-api.md","title":"Checklist di test API (EasyWay Data Portal)","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Checklist di test API (EasyWay Data Portal)\r","anchor_slug":"checklist-di-test-api-easyway-data-portal","chunk_index":1,"content":"## Checklist di test API (EasyWay Data Portal)\n\n1. **Validazione input**\r\n   - ‚ùë Richiesta con dati validi restituisce 2xx e il risultato atteso\r\n   - ‚ùë Richiesta con dati non validi restituisce errore 400 con dettaglio chiaro\n\n2. **Multi-tenant enforced**\r\n   - ‚ùë Senza header `X-Tenant-Id` ‚Üí errore 400\r\n   - ‚ùë Con tenant valido ‚Üí solo dati del tenant\n\n3. **Chiamata Store Procedure**\r\n   - ‚ùë L‚ÄôAPI chiama effettivamente la SP core (log presente su DB)\r\n   - ‚ùë Parametri REST mappati 1:1 su parametri SP\r\n   - ‚ùë Ogni default, NDG, validazione logica √® rispettata come da DB\n\n4. **Logging**\r\n   - ‚ùë Ogni chiamata √® loggata su `PORTAL.STATS_EXECUTION_LOG` (SP + errori)\r\n   - ‚ùë Log in file JSON `business.log.json` (privo di dati sensibili)\r\n   - ‚ùë Eventuali errori sono loggati (sia su file che su tabella)\n\n5. **Edge case / errori**\r\n   - ‚ùë Parametri mancanti, invalidi, valori ai limiti\r\n   - ‚ùë Errori della SP correttamente gestiti (500 o messaggio specifico)\r\n   - ‚ùë Nessuna informazione sensibile in risposta o log\n\n6. **Sicurezza**\r\n   - ‚ùë Nessun dato sensibile in chiaro nei log/esportazioni\r\n   - ‚ùë Accessi e permessi sempre validati via ACL/profili\n\n7. **Automazione**\r\n   - ‚ùë Test automatici o collection Postman eseguibili e versionate\r\n   - ‚ùë Pipeline DevOps verifica successo/fallimento\n\n8. **Documentazione**\r\n   - ‚ùë Endpoint, input/output, errori, logica sempre documentati nella Wiki\r\n   - ‚ùë Eventuali deviazioni, workaround, edge case riportati subito in doc\n\n---","size_chars":1481,"tokens_estimate":370}
{"doc_id":"ew-checklist-di-test-api","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/checklist-di-test-api.md","title":"Checklist di test API (EasyWay Data Portal)","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":2,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-convenzioni-rest-e-naming","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/convenzioni-rest-e-naming.md","title":"Convenzioni REST EasyWay","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Convenzioni REST EasyWay\r","anchor_slug":"convenzioni-rest-easyway","chunk_index":1,"content":"## Convenzioni REST EasyWay\n\n- **Path sempre in minuscolo**, separatore trattino\r\n  - Es: `/api/onboarding`, `/api/users/:user_id`, `/api/profiles`\r\n- **Verbi HTTP standard**\r\n  - GET ‚Üí lettura\r\n  - POST ‚Üí creazione\r\n  - PUT ‚Üí modifica/aggiornamento\r\n  - DELETE ‚Üí soft delete/disattivazione\r\n- **Parametri path sempre dopo `/api/` e prima delle azioni**\r\n  - `/api/user/:user_id/profiles`\r\n- **Header custom sempre con ‚ÄúX-‚Äù**\r\n  - `X-Tenant-Id`, `X-Request-Id`\r\n- **Body sempre JSON**\r\n- **Errori sempre con struttura coerente:**\r\n  ```json\r\n  {\r\n    \"error\": \"Messaggio chiaro\",\r\n    \"details\": [ ... ] // opzionale\r\n  }\r\n   ```\n\n*   **Nessun dato sensibile nei body o log**\r\n    \r\n*   **Input/output tipizzato e validato con schema TypeScript/Zod**\r\n    \r\n*   **Ogni endpoint REST mappa direttamente una SP core**","size_chars":815,"tokens_estimate":204}
{"doc_id":"ew-convenzioni-rest-e-naming","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/convenzioni-rest-e-naming.md","title":"Convenzioni REST EasyWay","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:49+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":2,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-esempio-integrazione-shopify","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/esempio-integrazione-shopify.md","title":"Integrazione Shopify ‚Äì Dettaglio & Esempio Pratico","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Overview\r","anchor_slug":"overview","chunk_index":1,"content":"## Overview\n\nL‚Äôintegrazione Shopify permette di:\r\n- Sincronizzare ordini, prodotti e clienti dal marketplace Shopify al portale (analisi, arricchimento, dashboard)\r\n- Automatizzare workflow (import dati, notifiche, arricchimento profili)\r\n- Supportare pi√π negozi/tenant, mantenendo separazione logica tra clienti\n\n---","size_chars":317,"tokens_estimate":79}
{"doc_id":"ew-esempio-integrazione-shopify","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/esempio-integrazione-shopify.md","title":"Integrazione Shopify ‚Äì Dettaglio & Esempio Pratico","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Tabella Integrazione Shopify\r","anchor_slug":"tabella-integrazione-shopify","chunk_index":2,"content":"## Tabella Integrazione Shopify\n\n| Aspetto            | Descrizione                                                      |\r\n|--------------------|------------------------------------------------------------------|\r\n| Endpoint principali| /admin/api/2024-04/orders.json, /products.json, /customers.json  |\r\n| Autenticazione     | OAuth2 (consigliato), oppure API Key e password (solo legacy)    |\r\n| Modalit√†           | Batch sync (periodico), real-time via Webhook, manual trigger    |\r\n| Mapping tenant     | Ogni chiamata √® legata a tenant_id/negozio specifico             |\r\n| Policy sicurezza   | Token/API key solo in Key Vault, logging chiamate e errori       |\r\n| Rate limit         | 2 requests/sec per endpoint (Shopify), backoff su errore 429     |\r\n| Sandbox            | Usare dev store Shopify per test, mai fare prove su shop reale   |\n\n---","size_chars":855,"tokens_estimate":214}
{"doc_id":"ew-esempio-integrazione-shopify","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/esempio-integrazione-shopify.md","title":"Integrazione Shopify ‚Äì Dettaglio & Esempio Pratico","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Esempio Pratico ‚Äì Recupero Ordini (API)\r","anchor_slug":"esempio-pratico-recupero-ordini-api","chunk_index":3,"content":"## Esempio Pratico ‚Äì Recupero Ordini (API)","size_chars":42,"tokens_estimate":10}
{"doc_id":"ew-esempio-integrazione-shopify","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/esempio-integrazione-shopify.md","title":"Integrazione Shopify ‚Äì Dettaglio & Esempio Pratico","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"1. **Chiamata GET ordini da Shopify**\r","anchor_slug":"1-chiamata-get-ordini-da-shopify","chunk_index":4,"content":"### 1. **Chiamata GET ordini da Shopify**\n\n**Endpoint:**  \r\n`GET https://<shop>.myshopify.com/admin/api/2024-04/orders.json?status=any&limit=5`\n\n**Header:**  \n\nX-Shopify-Access-Token: <token_sicuro_salvato_in_KeyVault>  \r\nContent-Type: application/json","size_chars":252,"tokens_estimate":63}
{"doc_id":"ew-esempio-integrazione-shopify","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/esempio-integrazione-shopify.md","title":"Integrazione Shopify ‚Äì Dettaglio & Esempio Pratico","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"2. **Esempio request (pseudo-codice Node.js/JS)**\r","anchor_slug":"2-esempio-request-pseudo-codice-nodejsjs","chunk_index":5,"content":"### 2. **Esempio request (pseudo-codice Node.js/JS)**\n\n```js\r\nconst axios = require('axios');\r\nconst accessToken = process.env.SHOPIFY_TOKEN; // Recuperato da Key Vault in produzione\n\nconst shop = 'nome-shop';\r\nconst url = `https://${shop}.myshopify.com/admin/api/2024-04/orders.json?status=any&limit=5`;\n\nconst response = await axios.get(url, {\r\n  headers: {\r\n    'X-Shopify-Access-Token': accessToken,\r\n    'Content-Type': 'application/json'\r\n  }\r\n});\r\n// Esempio logging:\r\nconsole.log({\r\n  event: 'shopify_fetch_orders',\r\n  shop,\r\n  tenant_id: 'CDI000001234',\r\n  count: response.data.orders.length,\r\n  status: response.status,\r\n  timestamp: new Date().toISOString()\r\n});\r\n```sql\n\n3. **Esempio risposta JSON (semplificata)**\r\n```sql\r\n{\r\n  \"orders\": [\r\n    {\r\n      \"id\": 123456789,\r\n      \"created_at\": \"2025-07-21T10:20:00+02:00\",\r\n      \"total_price\": \"39.99\",\r\n      \"customer\": {\r\n        \"id\": 99887766,\r\n        \"email\": \"cliente@email.it\",\r\n        \"first_name\": \"Mario\",\r\n        \"last_name\": \"Rossi\"\r\n      },\r\n      \"line_items\": [\r\n        { \"name\": \"T-Shirt Blu\", \"quantity\": 2 }\r\n      ],\r\n      \"financial_status\": \"paid\"\r\n    }\r\n    // ...\r\n  ]\r\n}\r\n```sql\r\n4. **Mapping dati e logica applicativa**\n\n| Campo Shopify | Campo EasyWay Data Portal | Note mapping |\r\n| --- | --- | --- |\r\n| id (ordine) | order_id | Unico per shop/tenant |\r\n| created_at | order_date | UTC standard |\r\n| total_price | total_price | Converte in formato standard |\r\n| customer.email | customer_email | Email masking per privacy |\r\n| line_items | prodotti | Mapping prodotti con codice interno |\r\n| financial_status | payment_status | Mapping dominio valori interno |","size_chars":1657,"tokens_estimate":414}
{"doc_id":"ew-esempio-integrazione-shopify","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/esempio-integrazione-shopify.md","title":"Integrazione Shopify ‚Äì Dettaglio & Esempio Pratico","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"5. **Logging e gestione errori**\r","anchor_slug":"5-logging-e-gestione-errori","chunk_index":6,"content":"### 5. **Logging e gestione errori**\r\n*   Loggare **ogni sync**: esito, count ordini, tenant/shop, timestamp, eventuali errori (es. 401, 429).\r\n    \r\n*   **Gestione errori:**\r\n    *   401/403 ‚Üí alert admin e blocco sync su tenant\r\n        \r\n    *   429 ‚Üí retry con backoff esponenziale\r\n        \r\n    *   Qualsiasi errore fatale: log in `portal-audit`, alert, e chiusura batch","size_chars":376,"tokens_estimate":94}
{"doc_id":"ew-esempio-integrazione-shopify","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/esempio-integrazione-shopify.md","title":"Integrazione Shopify ‚Äì Dettaglio & Esempio Pratico","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"6. **Best practice security**\r","anchor_slug":"6-best-practice-security","chunk_index":7,"content":"### 6. **Best practice security**\n\n*   **Token sempre in Key Vault,** mai in codice/config file.\r\n    \r\n*   **Ogni chiamata API deve portare anche il tenant_id** (per logging e separazione).\r\n    \r\n*   **Abilitare Webhook Shopify** per sync real-time di ordini/eventi rilevanti.","size_chars":278,"tokens_estimate":70}
{"doc_id":"ew-esempio-integrazione-shopify","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/esempio-integrazione-shopify.md","title":"Integrazione Shopify ‚Äì Dettaglio & Esempio Pratico","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"7. **Flusso sintesi (testuale)**\r","anchor_slug":"7-flusso-sintesi-testuale","chunk_index":8,"content":"### 7. **Flusso sintesi (testuale)**\r\n```sql\r\n[EasyWay Portal] ‚Üí [Microservizio Shopify] ‚Üí [Shopify API]\r\n      |\r\n      v\r\n[Recupera token sicuro] ‚Üí [Effettua chiamata GET] ‚Üí [Valida e mappa dati] ‚Üí [Logga evento] ‚Üí [Aggiorna DB]\r\n      |\r\n      +--> [Se errore ‚Üí logga, allerta admin, gestisce retry]\r\n```sql\n\nNota operativa\r\n--------------\n\n*   **Per ogni nuovo shop/tenant**, va generato token OAuth dedicato e salvato in Key Vault associato al tenant_id.\r\n    \r\n*   Prima di andare in produzione, testare tutte le chiamate in ambiente Shopify dev/store di prova.\r\n    \r\n*   Tieni traccia dei mapping tra campi Shopify e DB del portale, aggiornando documentazione a ogni nuova release API.","size_chars":693,"tokens_estimate":173}
{"doc_id":"ew-esempio-integrazione-shopify","path":"EasyWay_WebApp/02_logiche_easyway/api-esterne-integrazione/esempio-integrazione-shopify.md","title":"Integrazione Shopify ‚Äì Dettaglio & Esempio Pratico","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":9,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-readme","path":"EasyWay_WebApp/02_logiche_easyway/logging-and-audit/readme.md","title":"Checklist Operativa ‚Äì Logging & Audit","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Obiettivo\r","anchor_slug":"obiettivo","chunk_index":1,"content":"## Obiettivo\r\nGarantire che tutti i servizi, microservizi, pipeline e infrastrutture rispettino policy di logging, auditing e compliance, minimizzando i rischi e facilitando troubleshooting e auditing normativo.\n\n---","size_chars":216,"tokens_estimate":54}
{"doc_id":"ew-readme","path":"EasyWay_WebApp/02_logiche_easyway/logging-and-audit/readme.md","title":"Checklist Operativa ‚Äì Logging & Audit","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Checklist Logging & Audit\r","anchor_slug":"checklist-logging-audit","chunk_index":2,"content":"## Checklist Logging & Audit\n\n| ID   | Policy/Controllo                                    | Azione da eseguire                                              | Obbligatorio | Note/Best Practice                                      | Stato  |\r\n|------|-----------------------------------------------------|-----------------------------------------------------------------|--------------|---------------------------------------------------------|--------|\r\n| 1    | Log centralizzato                                   | Tutti i log inviati a Log Analytics o `portal-audit` su Datalake| S√¨           | Evitare file log sparsi o solo su disco locale           |        |\r\n| 2    | Retention policy >=12 mesi (>=24 ACL/admin)         | Impostare retention minima 12 mesi (24 per security/admin)       | S√¨           | Anche in ambiente DEV                                    |        |\r\n| 3    | Alert automatici                                    | Attivare alert automatici su errori login, ACL, dati sensibili   | S√¨           | Email/Teams/Monitor                                      |        |\r\n| 4    | Audit trail su DB                                   | Abilitare SQL Audit/trigger su tabelle sensibili                 | S√¨           | Anche accesso diretto a DB                               |        |\r\n| 5    | Log masking                                         | Mascherare password, token, dati personali nei log               | S√¨           | Mai loggare secret in chiaro                             |        |\r\n| 6    | Log ETL/batch separati                              | Pipeline ETL scrivono log separati in `technical/`               | S√¨           | Separare dai log funzionali                              |        |\r\n| 7    | Notifica owner/admin eventi critici                  | Invio notifica su ACL, accesso admin, variazione config          | S√¨           | Sempre notificare responsabile tenant/global             |        |\r\n| 8    | Doc/README policy logging audit                     | Ogni script/template cita questa policy in README/doc            | S√¨           | Policy sempre in evidenza per dev/team                   |        |\r\n| 9    | Log compliance GDPR/SOC2/DORA                       | Loggati solo eventi previsti e con masking conforme              | S√¨           | Seguire policy masking, no dati sensibili in chiaro      |        |\r\n| 10   | Logging sem","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-readme","path":"EasyWay_WebApp/02_logiche_easyway/logging-and-audit/readme.md","title":"Checklist Operativa ‚Äì Logging & Audit","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Checklist Logging & Audit\r","anchor_slug":"checklist-logging-audit","chunk_index":3,"content":"pre attivo anche in test                  | Mai disabilitare logging neanche in DEV/test                     | S√¨           | Catch incidenti prima del go-live                        |        |\n\n---","size_chars":198,"tokens_estimate":50}
{"doc_id":"ew-readme","path":"EasyWay_WebApp/02_logiche_easyway/logging-and-audit/readme.md","title":"Checklist Operativa ‚Äì Logging & Audit","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Template di commento/README da includere in ogni script/codice\r","anchor_slug":"template-di-commentoreadme-da-includere-in-ogni-scriptcodice","chunk_index":4,"content":"## Template di commento/README da includere in ogni script/codice\n\n> ‚ö†Ô∏è **Policy Logging & Audit EasyWay Data Portal:**  \r\n> - Centralizza tutti i log su Log Analytics o cartella `portal-audit`\r\n> - Maschera SEMPRE dati sensibili nei log  \r\n> - Mantieni retention minima 12 mesi (24 per security/admin)  \r\n> - Attiva alert automatici su eventi critici  \r\n> - Documenta questa policy in ogni README/script/template\n\n---","size_chars":418,"tokens_estimate":104}
{"doc_id":"ew-readme","path":"EasyWay_WebApp/02_logiche_easyway/logging-and-audit/readme.md","title":"Checklist Operativa ‚Äì Logging & Audit","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Note operative\r","anchor_slug":"note-operative","chunk_index":5,"content":"## Note operative\n\n- Il rispetto di questa checklist √® richiesto **anche per sviluppatori esterni, fornitori, o dev temporanei**\r\n- Ogni pull request/cambio infrastruttura deve includere validazione di questa checklist\r\n- In caso di dubbi, chiedere conferma a security/data owner o architetto progetto\n\n---","size_chars":306,"tokens_estimate":76}
{"doc_id":"ew-readme","path":"EasyWay_WebApp/02_logiche_easyway/logging-and-audit/readme.md","title":"Checklist Operativa ‚Äì Logging & Audit","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":6,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-esempi-flussi-avanzati-onboarding-login","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/esempi-flussi-avanzati-onboarding-login.md","title":"Esempi Flussi Avanzati Onboarding/Login","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Esempi Flussi Avanzati Onboarding/Login\r","anchor_slug":"esempi-flussi-avanzati-onboardinglogin","chunk_index":1,"content":"## Esempi Flussi Avanzati Onboarding/Login\n\n| Flusso/Variante                   | Attori                   | Step Principali                                                          | Security/ACL                        | Note Operative                                   |\r\n|-----------------------------------|--------------------------|--------------------------------------------------------------------------|--------------------------------------|--------------------------------------------------|\r\n| Onboarding SSO aziendale custom   | Utente azienda/IT admin  | Admin IT configura SSO (es. via Entra ID, SAML, OIDC), provisioning utenti automatico | Policy SSO, ACL mapping, auto-onboard | Flusso zero-touch, utenti creati al primo login   |\r\n| Onboarding da Azure Marketplace   | Cliente marketplace      | Utente acquista/attiva dal marketplace, riceve invito onboarding automatico          | ACL predefiniti, mapping offerta      | Stato ‚Äúpending‚Äù finch√© completato primo login     |\r\n| Gestione consensi privacy         | Utente finale            | Accetta/revoca consensi privacy all‚Äôatto di onboarding o nel profilo                 | Policy privacy, logging, audit       | Gestire versioning consensi e revoca retroattiva  |\r\n| Onboarding con autenticazione forte (SPID/CIE) | Utente pubblico       | Login con SPID/CIE, mappatura identit√† e assegnazione tenant/profilo                 | SPID/CIE integration, ACL mapping    | Obbligatorio in ambito pubblico/PA               |\r\n| Provisioning utenti ‚Äújust-in-time‚Äù| Utente azienda/SSO       | Utente SSO non ancora presente, viene creato ‚Äúal volo‚Äù al primo accesso              | SSO, claim mapping, policy onboarding| Profilo base fino a completamento anagrafica      |\r\n| Gestione consensi granulari       | Utente finale            | Possibilit√† di accettare/negare consensi specifici (newsletter, analytics, ecc.)     | Policy granular, audit consensi      | Stato consensi loggato con timestamp e motivazione|\r\n| Flusso ‚Äúinvito da altro sistema‚Äù  | Admin/integrazione esterna| Invio automatico di invito a utente da altro sistema/app                             | API external, ACL mapping            | Validazione invito e mappatura su tenant esistente|\r\n| Multi-factor onboarding           | Utente finale            | Obbligo attivazione MFA (OTP, Authenticator App) durante onboarding                  | Policy MFA, logging, a","size_chars":2400,"tokens_estimate":600}
{"doc_id":"ew-esempi-flussi-avanzati-onboarding-login","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/esempi-flussi-avanzati-onboarding-login.md","title":"Esempi Flussi Avanzati Onboarding/Login","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Esempi Flussi Avanzati Onboarding/Login\r","anchor_slug":"esempi-flussi-avanzati-onboardinglogin","chunk_index":2,"content":"udit           | Blocco login se MFA non completato                |\r\n| Onboarding/Accesso tramite QR code| Utente mobile/desktop    | Scan QR per onboarding rapido su dispositivi mobili                                  | Token QR one-time, ACL onboarding    | Valido per demo, eventi o partnership             |\n\n---","size_chars":317,"tokens_estimate":79}
{"doc_id":"ew-esempi-flussi-avanzati-onboarding-login","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/esempi-flussi-avanzati-onboarding-login.md","title":"Esempi Flussi Avanzati Onboarding/Login","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Dettaglio Esempio ‚Äì SSO Aziendale Custom (Entra ID/SAML/OIDC)\r","anchor_slug":"dettaglio-esempio-sso-aziendale-custom-entra-idsamloidc","chunk_index":3,"content":"## Dettaglio Esempio ‚Äì SSO Aziendale Custom (Entra ID/SAML/OIDC)\n\n1. Admin IT dell‚Äôazienda entra nell‚Äôarea ‚ÄúConfigura SSO‚Äù\r\n2. Registra dominio e imposta federazione (es: metadati SAML o OIDC)\r\n3. Testa la connessione con account di prova\r\n4. Dal primo login di un utente aziendale ‚Üí provisioning automatico (profilo base, ACL default)\r\n5. Utente pu√≤ essere auto-approvato o soggetto a verifica admin tenant\r\n6. Logging di tutta la procedura su audit centrale e notifica owner tenant\n\n---","size_chars":488,"tokens_estimate":122}
{"doc_id":"ew-esempi-flussi-avanzati-onboarding-login","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/esempi-flussi-avanzati-onboarding-login.md","title":"Esempi Flussi Avanzati Onboarding/Login","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Dettaglio Esempio ‚Äì Gestione Consensi Privacy\r","anchor_slug":"dettaglio-esempio-gestione-consensi-privacy","chunk_index":4,"content":"## Dettaglio Esempio ‚Äì Gestione Consensi Privacy\n\n1. Utente, in fase di onboarding o nella sezione ‚ÄúProfilo‚Äù, visualizza i consensi richiesti e opzionali (es: marketing, profilazione, newsletter, analytics‚Ä¶)\r\n2. Ogni consenso pu√≤ essere accettato/negato singolarmente, con registrazione timestamp e versione testo informativa\r\n3. Modifica consensi tracciata in audit log\r\n4. In caso di revoca, il sistema deve bloccare/aggiornare le funzionalit√† collegate\r\n5. Log e stato consensi accessibili su richiesta (per GDPR)\n\n---","size_chars":521,"tokens_estimate":130}
{"doc_id":"ew-esempi-flussi-avanzati-onboarding-login","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/esempi-flussi-avanzati-onboarding-login.md","title":"Esempi Flussi Avanzati Onboarding/Login","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Dettaglio Esempio ‚Äì Onboarding da Azure Marketplace\r","anchor_slug":"dettaglio-esempio-onboarding-da-azure-marketplace","chunk_index":5,"content":"## Dettaglio Esempio ‚Äì Onboarding da Azure Marketplace\n\n1. Cliente attiva servizio direttamente da Azure Marketplace\r\n2. Sistema genera tenant_id e invia invito onboarding al referente specificato in fase d‚Äôordine\r\n3. Utente accede al portale tramite link ricevuto, completa anagrafica, imposta password/MFA\r\n4. Profilo, ACL e permessi pre-caricati in base al tipo di offerta sottoscritta (es: demo, starter, premium)\r\n5. Logging di tutte le azioni, stato ‚Äúpending‚Äù finch√© onboarding completato\n\n---","size_chars":499,"tokens_estimate":125}
{"doc_id":"ew-esempi-flussi-avanzati-onboarding-login","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/esempi-flussi-avanzati-onboarding-login.md","title":"Esempi Flussi Avanzati Onboarding/Login","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Nota operativa\r","anchor_slug":"nota-operativa","chunk_index":6,"content":"## Nota operativa\n\n- Tutti i flussi avanzati vanno sempre collegati alle stesse policy di logging/audit, notifiche admin, e gestione ACL/tenant.\r\n- Le **customizzazioni (es. SSO, consensi, onboarding esterni)** vanno descritte anche nelle API/contratti REST tra sistemi.","size_chars":270,"tokens_estimate":68}
{"doc_id":"ew-esempi-flussi-avanzati-onboarding-login","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/esempi-flussi-avanzati-onboarding-login.md","title":"Esempi Flussi Avanzati Onboarding/Login","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":7,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-esempi-flussi-verticali-pa-accesso-tramite-spid-e-cie","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/esempi-flussi-verticali-pa-accesso-tramite-spid-e-cie.md","title":"Esempi Flussi Verticali PA ‚Äì Accesso tramite SPID e CIE","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Esempio Dettagliato ‚Äì Accesso tramite SPID\r","anchor_slug":"esempio-dettagliato-accesso-tramite-spid","chunk_index":1,"content":"## Esempio Dettagliato ‚Äì Accesso tramite SPID\n\n1. Utente PA apre la pagina di login e seleziona ‚ÄúAccedi con SPID‚Äù\r\n2. Sistema effettua redirect verso l‚ÄôIdentity Provider SPID scelto dall‚Äôutente\r\n3. Utente completa autenticazione sul portale SPID (livello 1, 2 o 3)\r\n4. Identity Provider rimanda callback all‚Äôapplicazione con attributi (es. codice fiscale, nome, ente di appartenenza)\r\n5. Sistema crea (o aggiorna) profilo utente, associa a tenant/ente corretto, applica ruoli ACL corrispondenti\r\n6. Logging completo di ogni step (tentativi, esito, mapping ACL, dati minimi)\r\n7. Utente accede alla dashboard secondo i permessi assegnati dal mapping\n\n---","size_chars":652,"tokens_estimate":163}
{"doc_id":"ew-esempi-flussi-verticali-pa-accesso-tramite-spid-e-cie","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/esempi-flussi-verticali-pa-accesso-tramite-spid-e-cie.md","title":"Esempi Flussi Verticali PA ‚Äì Accesso tramite SPID e CIE","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Esempio Dettagliato ‚Äì Accesso tramite CIE\r","anchor_slug":"esempio-dettagliato-accesso-tramite-cie","chunk_index":2,"content":"## Esempio Dettagliato ‚Äì Accesso tramite CIE\n\n1. Utente seleziona ‚ÄúAccedi con CIE‚Äù\r\n2. Viene avviato il middleware CIE (browser plugin, desktop app, o mobile NFC)\r\n3. Utente autentica tramite PIN e dispositivo abilitato (NFC, smart card reader)\r\n4. Sistema riceve callback dal servizio CIE con dati anagrafici certificati\r\n5. Creazione/mapping automatico profilo utente, assegnazione tenant e ruoli, logging completo di processo\r\n6. Accesso consentito solo se attributi minimi presenti e validi\n\n---","size_chars":499,"tokens_estimate":125}
{"doc_id":"ew-esempi-flussi-verticali-pa-accesso-tramite-spid-e-cie","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/esempi-flussi-verticali-pa-accesso-tramite-spid-e-cie.md","title":"Esempi Flussi Verticali PA ‚Äì Accesso tramite SPID e CIE","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Esempio Onboarding Integrato SPID/CIE\r","anchor_slug":"esempio-onboarding-integrato-spidcie","chunk_index":3,"content":"## Esempio Onboarding Integrato SPID/CIE\n\n- Al primo accesso tramite SPID o CIE, l‚Äôutente non presente viene automaticamente creato come ‚Äúutente PA‚Äù, associato a tenant dell‚Äôente di appartenenza, e profilato in base agli attributi forniti.\r\n- In caso di accesso ripetuto con provider diverso (es. prima SPID, poi CIE), sistema unifica il profilo in base a codice fiscale.\r\n- Ogni variazione/mapping viene tracciata in audit, con log motivazione e data/ora.\n\n---","size_chars":461,"tokens_estimate":115}
{"doc_id":"ew-esempi-flussi-verticali-pa-accesso-tramite-spid-e-cie","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/esempi-flussi-verticali-pa-accesso-tramite-spid-e-cie.md","title":"Esempi Flussi Verticali PA ‚Äì Accesso tramite SPID e CIE","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Note Operative Verticale PA\r","anchor_slug":"note-operative-verticale-pa","chunk_index":4,"content":"## Note Operative Verticale PA\n\n- **Audit trail dettagliato** per ogni accesso, cambio provider, update profilo\r\n- **Conservazione dati** in conformit√† con linee guida AGID (minimo, necessario, logging)\r\n- **Mapping attributi ‚Üí ACL/ruoli** basato su dati SPID/CIE (ruolo pubblico, ente, funzione)\r\n- **Possibilit√† di auto-provisioning** per enti federati; per altri, validazione manuale admin\r\n- **Alert automatici** su accessi anomali, tentativi falliti, cambi provider\n\n---","size_chars":475,"tokens_estimate":119}
{"doc_id":"ew-esempi-flussi-verticali-pa-accesso-tramite-spid-e-cie","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/esempi-flussi-verticali-pa-accesso-tramite-spid-e-cie.md","title":"Esempi Flussi Verticali PA ‚Äì Accesso tramite SPID e CIE","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Vantaggi per la PA\r","anchor_slug":"vantaggi-per-la-pa","chunk_index":5,"content":"## Vantaggi per la PA\n\n- Accesso **semplice e sicuro** per cittadini, aziende e dipendenti pubblici\r\n- Nessun onboarding manuale: dati certificati da provider\r\n- **Compliance completa** con normative italiane (SPID/CIE, GDPR, AGID)\r\n- Tutto il processo pronto per essere **automatizzato e auditato** via microservizi e policy\n\n---","size_chars":330,"tokens_estimate":82}
{"doc_id":"ew-esempi-flussi-verticali-pa-accesso-tramite-spid-e-cie","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/esempi-flussi-verticali-pa-accesso-tramite-spid-e-cie.md","title":"Esempi Flussi Verticali PA ‚Äì Accesso tramite SPID e CIE","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":6,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-readme","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/readme.md","title":"Flussi Onboarding/Login ‚Äì Dettagli & Variazioni","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Tabella Flussi Aggiuntivi e Variazioni\r","anchor_slug":"tabella-flussi-aggiuntivi-e-variazioni","chunk_index":1,"content":"## Tabella Flussi Aggiuntivi e Variazioni\n\n| Flusso/Variante               | Attori             | Step Principali                                                      | Security/ACL                  | Note Operative                               |\r\n|-------------------------------|--------------------|----------------------------------------------------------------------|-------------------------------|----------------------------------------------|\r\n| Disabilitazione utente        | Admin tenant/sys   | Selezione utente, conferma disabilitazione, update stato in DB       | ACL admin, audit obbligatorio | Utente non pu√≤ accedere n√© ricevere notifiche|\r\n| Re-invito utente              | Admin tenant/sys   | Genera nuovo link di attivazione, invio via email, reset stato       | One-time token, scadenza      | Tracciamento riinvii in audit/log            |\r\n| Upgrade prospect ‚Üí cliente    | Admin globale/sys  | Validazione dati, assegnazione tenant reale, aggiornamento profilo   | ACL admin/global, audit       | Aggiornamento ACL e ruoli automatico         |\r\n| Cambio tenant/azienda utente  | Admin globale      | Scollega da vecchio tenant, collega a nuovo, aggiorna riferimenti    | ACL admin/global, audit       | Bloccare temporaneamente accesso se sensibile|\r\n| Invito aziendale multiplo     | Admin tenant       | Upload elenco email, invio inviti multipli, gestione batch           | Batch token univoci, audit    | Stato ‚Äúpending‚Äù fino a attivazione           |\r\n| Disabilitazione temporanea    | Admin tenant/sys   | Imposta flag temporaneo, logga motivazione, scadenza auto-react      | Policy custom, alert admin    | Accesso negato per X giorni, alert scadenza  |\r\n| Cambio ruolo/profilo          | Admin tenant/sys   | Modifica ruolo ACL, conferma, logging motivazione                    | ACL mapping, audit            | Notifica utente e log obbligatorio           |\r\n| Gestione accessi ‚Äúinvito scaduto‚Äù | Utente finale  | Tenta accesso con link vecchio/scaduto, riceve nuovo invito/reset    | Token scadenza, retry limit   | Log tentativi, alert su abuso                |\r\n| Flusso disiscrizione definitiva | Utente finale    | Richiesta cancellazione, doppia conferma, revoca e anonimizzazione   | GDPR compliant, audit         | Mascheramento/anonymizzazione in DB/log      |\n\n---","size_chars":2312,"tokens_estimate":578}
{"doc_id":"ew-readme","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/readme.md","title":"Flussi Onboarding/Login ‚Äì Dettagli & Variazioni","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Dettaglio Pratiche Operative\r","anchor_slug":"dettaglio-pratiche-operative","chunk_index":2,"content":"## Dettaglio Pratiche Operative\n\n- **Audit trail obbligatorio** per tutte le variazioni di stato utente e ACL.\r\n- **Notifica automatica** agli admin per eventi critici (disabilitazione, upgrade, cambio tenant).\r\n- **Policy di scadenza token** per tutti gli inviti/ri-inviti e reset password.\r\n- **Anonimizzazione dati** in caso di cancellazione/disiscrizione, secondo GDPR.\r\n- **Batch processing** per inviti multipli: gestire stato ‚Äúpending‚Äù, errore invio, e retry limit.\r\n- **Logging motivazione** per ogni variazione manuale da parte di admin.\n\n---","size_chars":551,"tokens_estimate":138}
{"doc_id":"ew-readme","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/readme.md","title":"Flussi Onboarding/Login ‚Äì Dettagli & Variazioni","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Esempio Flusso ‚ÄúUpgrade prospect ‚Üí cliente reale‚Äù\r","anchor_slug":"esempio-flusso-upgrade-prospect-cliente-reale","chunk_index":3,"content":"## Esempio Flusso ‚ÄúUpgrade prospect ‚Üí cliente reale‚Äù\n\n1. Admin globale seleziona utente prospect dal sistema\r\n2. Verifica dati e azienda cliente\r\n3. Assegna utente a tenant reale e aggiorna ruolo/profilo\r\n4. Sistema invia email di upgrade e notifica sia utente che admin tenant\r\n5. Log di ogni step su portal-audit e tabella audit DB\n\n---","size_chars":338,"tokens_estimate":84}
{"doc_id":"ew-readme","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/readme.md","title":"Flussi Onboarding/Login ‚Äì Dettagli & Variazioni","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Esempio Flusso ‚ÄúDisabilitazione temporanea‚Äù\r","anchor_slug":"esempio-flusso-disabilitazione-temporanea","chunk_index":4,"content":"## Esempio Flusso ‚ÄúDisabilitazione temporanea‚Äù\n\n1. Admin tenant seleziona utente da sospendere\r\n2. Imposta flag ‚Äútemporarily_disabled‚Äù e durata (es. 7gg)\r\n3. Utente viene bloccato da login e servizi, riceve email con motivazione\r\n4. Alert automatico agli admin sulla data di riattivazione prevista\r\n5. Sistema riattiva accesso in automatico allo scadere, oppure su intervento manuale\n\n---\n\n> **Nota:**  \r\n> Ogni variazione di stato, ruolo o tenant deve essere tracciata, notificata e soggetta a policy di retention e audit come gi√† definito nella sezione Logging & Audit.","size_chars":571,"tokens_estimate":143}
{"doc_id":"ew-readme","path":"EasyWay_WebApp/02_logiche_easyway/login-flussi-onboarding/readme.md","title":"Flussi Onboarding/Login ‚Äì Dettagli & Variazioni","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":5,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-esempi-notifiche-and-template-email-configurabili","path":"EasyWay_WebApp/02_logiche_easyway/notifiche-gestione/esempi-notifiche-and-template-email-configurabili.md","title":"Esempi Notifiche & Template Email Configurabili (Excel su Storage)","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"1. Flusso Gestione Template Email\r","anchor_slug":"1-flusso-gestione-template-email","chunk_index":1,"content":"## 1. Flusso Gestione Template Email\n\n1. Amministratore o product owner carica un file Excel (es. `email_templates.xlsx`) nella cartella `portal-assets/` dello Storage Datalake.\r\n2. Il microservizio notifiche, ogni volta che deve inviare un‚Äôemail,  \r\n   - accede al file Excel tramite API Storage\r\n   - legge il template relativo al tipo di notifica richiesto (es: onboarding, alert, billing)\r\n   - effettua il merge dei dati dinamici (nome utente, data, tenant, ecc.) nelle variabili del template\r\n   - invia l‚Äôemail secondo le preferenze utente (lingua, canale)\r\n3. Il sistema pu√≤ aggiornare i template **senza deployare codice**, solo sostituendo il file Excel.\r\n4. Tutte le modifiche e gli invii sono loggati (tabella `notification_log`).\n\n---","size_chars":747,"tokens_estimate":187}
{"doc_id":"ew-esempi-notifiche-and-template-email-configurabili","path":"EasyWay_WebApp/02_logiche_easyway/notifiche-gestione/esempi-notifiche-and-template-email-configurabili.md","title":"Esempi Notifiche & Template Email Configurabili (Excel su Storage)","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"2. Struttura file Excel `email_templates.xlsx`\r","anchor_slug":"2-struttura-file-excel-emailtemplatesxlsx","chunk_index":2,"content":"## 2. Struttura file Excel `email_templates.xlsx`\n\n| Tipo_Notifica      | Lingua | Oggetto                               | Corpo                                                        |\r\n|--------------------|--------|---------------------------------------|--------------------------------------------------------------|\r\n| onboarding         | IT     | Benvenuto su EasyWay Data Portal      | Ciao {{nome}}, il tuo account per {{tenant}} √® stato attivato!|\r\n| onboarding         | EN     | Welcome to EasyWay Data Portal        | Hi {{name}}, your account for {{tenant}} is now active!       |\r\n| alert_sicurezza    | IT     | Accesso anomalo rilevato              | √à stato rilevato un accesso anomalo al tuo account il {{data}}|\r\n| alert_sicurezza    | EN     | Suspicious Login Detected             | A suspicious login to your account was detected on {{date}}   |\r\n| reset_password     | IT     | Reimposta la tua password             | Per reimpostare la password clicca qui: {{reset_link}}        |\r\n| reset_password     | EN     | Reset Your Password                   | To reset your password click here: {{reset_link}}             |\n\n- **Colonne consigliate:**  \r\n  `Tipo_Notifica`, `Lingua`, `Oggetto`, `Corpo`\r\n- **Placeholder variabili:**  \r\n  Usa doppie graffe (`{{ }}`) per tutti i dati dinamici (es. nome, link, tenant, data)\n\n---","size_chars":1347,"tokens_estimate":337}
{"doc_id":"ew-esempi-notifiche-and-template-email-configurabili","path":"EasyWay_WebApp/02_logiche_easyway/notifiche-gestione/esempi-notifiche-and-template-email-configurabili.md","title":"Esempi Notifiche & Template Email Configurabili (Excel su Storage)","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"3. Esempio di codice (pseudo, architettura agnostica)\r","anchor_slug":"3-esempio-di-codice-pseudo-architettura-agnostica","chunk_index":3,"content":"## 3. Esempio di codice (pseudo, architettura agnostica)\n\n```python\r\n# Funzione esempio Python: estrai template da Excel e fai merge dati\n\nimport pandas as pd\n\ndef get_template(tipo, lingua, params, excel_path):\r\n    df = pd.read_excel(excel_path)\r\n    tpl = df[(df['Tipo_Notifica']==tipo) & (df['Lingua']==lingua)].iloc[0]\r\n    oggetto = tpl['Oggetto'].format(**params)\r\n    corpo = tpl['Corpo']\r\n    for k, v in params.items():\r\n        corpo = corpo.replace(f'{{{{{k}}}}}', str(v))\r\n    return oggetto, corpo\r\n```sql\r\n# Esempio chiamata:\r\n```sql\r\nparams = {\"nome\": \"Mario\", \"tenant\": \"AziendaXYZ\", \"data\": \"21/07/2025\", \"reset_link\": \"https://...\"}\r\noggetto, corpo = get_template(\"onboarding\", \"IT\", params, \"email_templates.xlsx\")\r\n```sql\n\n4. Flusso ‚ÄúReady for Codice‚Äù\n\n```sql\r\n[Admin] ‚Üí [Carica email_templates.xlsx su portal-assets/]\r\n      |\r\n      v\r\n[Microservizio Notifiche] ‚Üí [Leggi template Excel via API Storage]\r\n      |\r\n      v\r\n[Costruisci email con merge variabili] ‚Üí [Invia email]\r\n      |\r\n      v\r\n[Log invio + template utilizzato + outcome]\r\n```sql\n\n5. Best Practice\r\n----------------\n\n*   **Versiona sempre i template** (timestamp, backup excel)\r\n    \r\n*   **Mantieni template multilingua** e personalizzati per tenant, aggiungendo colonna ‚ÄúTenant‚Äù se serve\r\n    \r\n*   **Testa sempre il parsing/merge dati su ambiente di sviluppo**\r\n    \r\n*   **Logga nome file, versione, tipo notifica per ogni invio**\r\n    \r\n*   **Aggiornare i template non richiede deploy, basta sostituire Excel**\r\n    \n\n* * *\n\n6. Esempi concreti (IT/EN)\r\n--------------------------\n\n**Esempio Onboarding IT:**  \r\nOggetto: `Benvenuto su EasyWay Data Portal`  \r\nCorpo:  \r\n`Ciao {{nome}}, il tuo account per {{tenant}} √® stato attivato!`\r\n**Esempio Alert Sicurezza EN:**  \r\nOggetto: `Suspicious Login Detected`  \r\nCorpo:  \r\n`A suspicious login to your account was detected on {{date}}.`\n\n* * *\n\n> **Nota operativa:**  \r\n> Ogni modifica ai template viene tracciata e pu√≤ essere validata da admin. In produzione i template sono gestiti **solo via Storage** e MAI hardcodati nel codice.","size_chars":2074,"tokens_estimate":518}
{"doc_id":"ew-esempi-notifiche-and-template-email-configurabili","path":"EasyWay_WebApp/02_logiche_easyway/notifiche-gestione/esempi-notifiche-and-template-email-configurabili.md","title":"Esempi Notifiche & Template Email Configurabili (Excel su Storage)","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":4,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming","path":"EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md","title":"üóÇÔ∏è EasyWay DataPortal - Standard Accesso Storage e Datalake (IAM & Naming)","owner":"","tags":["policy/security","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üéØ Scopo del Documento\r","anchor_slug":"scopo-del-documento","chunk_index":1,"content":"## üéØ Scopo del Documento\r\nDefinire le **linee guida ufficiali** per la gestione ordinata, sicura e scalabile degli accessi allo **Storage Account Blob** e al **Datalake Gen2** in EasyWay DataPortal, inclusi:\r\n- Utenze di servizio\r\n- Gruppi di accesso (RBAC)\r\n- Naming convention\r\n- Best practice operative\n\n---","size_chars":311,"tokens_estimate":78}
{"doc_id":"ew-easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming","path":"EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md","title":"üóÇÔ∏è EasyWay DataPortal - Standard Accesso Storage e Datalake (IAM & Naming)","owner":"","tags":["policy/security","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üîé Differenza tra Blob Storage e Datalake HNS\r","anchor_slug":"differenza-tra-blob-storage-e-datalake-hns","chunk_index":2,"content":"## üîé Differenza tra Blob Storage e Datalake HNS\n\n| Nome Utenza               | Ambito               | Scopo principale        | Tipo di accesso        |\r\n|----------------------------|----------------------|--------------------------|-------------------------|\r\n| `portal.storage.*`         | Blob Storage (classico)| Assets, log, template    | RBAC (IAM)               |\r\n| `portal.datalake.*`        | Datalake Gen2 (HNS)   | Tenant data, ETL, staging| RBAC + ACL POSIX (fine-grained) |","size_chars":489,"tokens_estimate":122}
{"doc_id":"ew-easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming","path":"EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md","title":"üóÇÔ∏è EasyWay DataPortal - Standard Accesso Storage e Datalake (IAM & Naming)","owner":"","tags":["policy/security","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"üìÇ Esempio struttura\r","anchor_slug":"esempio-struttura","chunk_index":3,"content":"### üìÇ Esempio struttura\r\n```sql\r\new-datalakedev/\r\n‚îú‚îÄ‚îÄ tenant-xxxx/\r\n‚îÇ   ‚îú‚îÄ‚îÄ landing/\r\n‚îÇ   ‚îú‚îÄ‚îÄ staging/\r\n‚îÇ   ‚îú‚îÄ‚îÄ official/\r\n‚îÇ   ‚îî‚îÄ‚îÄ invalidrows/\r\n‚îú‚îÄ‚îÄ portal-assets/\r\n‚îú‚îÄ‚îÄ portal-audit/\r\n```sql\n\n---","size_chars":196,"tokens_estimate":49}
{"doc_id":"ew-easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming","path":"EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md","title":"üóÇÔ∏è EasyWay DataPortal - Standard Accesso Storage e Datalake (IAM & Naming)","owner":"","tags":["policy/security","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üè∑Ô∏è Naming Convention - Utenze di Servizio\r","anchor_slug":"naming-convention-utenze-di-servizio","chunk_index":4,"content":"## üè∑Ô∏è Naming Convention - Utenze di Servizio\n\n| Nome                       | Permessi                | Scopo             |\r\n|-----------------------------|--------------------------|-------------------|\r\n| `portal.datalake.easyway.read`   | Lettura                 | Interno EasyWay    |\r\n| `portal.datalake.easyway.write`  | Scrittura               | Interno EasyWay    |\r\n| `portal.datalake.vendorA.read`   | Lettura                 | Vendor A           |\r\n| `portal.datalake.vendorA.write`  | Scrittura               | Vendor A           |\r\n| `portal.storage.easyway.read`    | Lettura Blob Storage     | Interno EasyWay    |\r\n| `admin.datalake`                 | Amministrazione Datalake | ACL, gestione dati |\r\n| `admin.storage`                  | Amministrazione Storage  | IAM, risorse Azure |\n\n---","size_chars":806,"tokens_estimate":202}
{"doc_id":"ew-easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming","path":"EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md","title":"üóÇÔ∏è EasyWay DataPortal - Standard Accesso Storage e Datalake (IAM & Naming)","owner":"","tags":["policy/security","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üè∑Ô∏è Naming Convention - Gruppi di Accesso (RBAC)\r","anchor_slug":"naming-convention-gruppi-di-accesso-rbac","chunk_index":5,"content":"## üè∑Ô∏è Naming Convention - Gruppi di Accesso (RBAC)\n\n| Nome Gruppo                     | Ambito        | Permesso             |\r\n|----------------------------------|---------------|-----------------------|\r\n| `grp.portal.datalake.read`       | Datalake      | Lettura               |\r\n| `grp.portal.datalake.write`      | Datalake      | Scrittura             |\r\n| `grp.admin.datalake`             | Datalake      | Amministrazione       |\r\n| `grp.portal.storage.read`        | Blob Storage  | Lettura               |\r\n| `grp.admin.storage`              | Blob Storage  | Amministrazione       |\n\n---","size_chars":600,"tokens_estimate":150}
{"doc_id":"ew-easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming","path":"EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md","title":"üóÇÔ∏è EasyWay DataPortal - Standard Accesso Storage e Datalake (IAM & Naming)","owner":"","tags":["policy/security","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üîê Assegnazione Ruoli Azure RBAC (IAM)\r","anchor_slug":"assegnazione-ruoli-azure-rbac-iam","chunk_index":6,"content":"## üîê Assegnazione Ruoli Azure RBAC (IAM)\n\n| Ambito     | Permesso    | Ruolo Azure                         |\r\n|------------|-------------|--------------------------------------|\r\n| Datalake   | Read        | `Storage Blob Data Reader`           |\r\n| Datalake   | Write       | `Storage Blob Data Contributor`      |\r\n| Datalake   | Admin       | `Storage Account Contributor`        |\r\n| Blob       | Read        | `Storage Blob Data Reader`           |\r\n| Blob       | Admin       | `Storage Account Contributor`        |\n\n---","size_chars":528,"tokens_estimate":132}
{"doc_id":"ew-easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming","path":"EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md","title":"üóÇÔ∏è EasyWay DataPortal - Standard Accesso Storage e Datalake (IAM & Naming)","owner":"","tags":["policy/security","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üìë Best Practice Operative\r","anchor_slug":"best-practice-operative","chunk_index":7,"content":"## üìë Best Practice Operative","size_chars":29,"tokens_estimate":7}
{"doc_id":"ew-easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming","path":"EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md","title":"üóÇÔ∏è EasyWay DataPortal - Standard Accesso Storage e Datalake (IAM & Naming)","owner":"","tags":["policy/security","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"‚úÖ 1. **Utenze di Servizio**\r","anchor_slug":"1-utenze-di-servizio","chunk_index":8,"content":"### ‚úÖ 1. **Utenze di Servizio**\r\n- Create sempre su **Microsoft Entra ID (Azure AD)**\r\n- Separate per ambito (Datalake vs Storage)\r\n- Nessuna licenza necessaria (solo IAM)","size_chars":171,"tokens_estimate":43}
{"doc_id":"ew-easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming","path":"EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md","title":"üóÇÔ∏è EasyWay DataPortal - Standard Accesso Storage e Datalake (IAM & Naming)","owner":"","tags":["policy/security","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"‚úÖ 2. **Gruppi di Accesso**\r","anchor_slug":"2-gruppi-di-accesso","chunk_index":9,"content":"### ‚úÖ 2. **Gruppi di Accesso**\r\n- Nessun utente diretto, solo gruppi (principio Least Privilege)\r\n- Naming `grp.*` sempre chiaro e coerente","size_chars":139,"tokens_estimate":35}
{"doc_id":"ew-easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming","path":"EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md","title":"üóÇÔ∏è EasyWay DataPortal - Standard Accesso Storage e Datalake (IAM & Naming)","owner":"","tags":["policy/security","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"‚úÖ 3. **Permessi e Segregazione**\r","anchor_slug":"3-permessi-e-segregazione","chunk_index":10,"content":"### ‚úÖ 3. **Permessi e Segregazione**\r\n- RBAC su tutto lo Storage Account (IAM Azure)\r\n- ACL POSIX per segregare accesso a cartelle tenant specifiche su Datalake\n\n---","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming","path":"EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md","title":"üóÇÔ∏è EasyWay DataPortal - Standard Accesso Storage e Datalake (IAM & Naming)","owner":"","tags":["policy/security","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üîí Esempio Accesso Vendor (Datalake ACL)\r","anchor_slug":"esempio-accesso-vendor-datalake-acl","chunk_index":11,"content":"## üîí Esempio Accesso Vendor (Datalake ACL)\r\n| Vendor    | Path consentito            | Permesso |\r\n|-----------|-----------------------------|----------|\r\n| Vendor A  | `/tenant-0001/landing`       | Read     |\r\n| Vendor B  | `/tenant-0002/landing`       | Write    |\n\n---","size_chars":273,"tokens_estimate":68}
{"doc_id":"ew-easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming","path":"EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md","title":"üóÇÔ∏è EasyWay DataPortal - Standard Accesso Storage e Datalake (IAM & Naming)","owner":"","tags":["policy/security","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üöÄ Suggerimento Automazione (futuro)\r","anchor_slug":"suggerimento-automazione-futuro","chunk_index":12,"content":"## üöÄ Suggerimento Automazione (futuro)","size_chars":39,"tokens_estimate":10}
{"doc_id":"ew-easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming","path":"EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md","title":"üóÇÔ∏è EasyWay DataPortal - Standard Accesso Storage e Datalake (IAM & Naming)","owner":"","tags":["policy/security","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Tool consigliati:\r","anchor_slug":"tool-consigliati","chunk_index":13,"content":"### Tool consigliati:\r\n- **Terraform / Bicep / ARM Template** per creare:\r\n  - Gruppi\r\n  - Ruoli\r\n  - Utenze\r\n  - Policy ACL","size_chars":124,"tokens_estimate":31}
{"doc_id":"ew-easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming","path":"EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md","title":"üóÇÔ∏è EasyWay DataPortal - Standard Accesso Storage e Datalake (IAM & Naming)","owner":"","tags":["policy/security","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Esempio naming automatizzato:\r","anchor_slug":"esempio-naming-automatizzato","chunk_index":14,"content":"### Esempio naming automatizzato:\r\n```sql\r\naz ad group create --display-name \"grp.portal.datalake.read\" --mail-nickname \"grp.portal.datalake.read\"\r\n```sql\n\n---","size_chars":159,"tokens_estimate":40}
{"doc_id":"ew-easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming","path":"EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md","title":"üóÇÔ∏è EasyWay DataPortal - Standard Accesso Storage e Datalake (IAM & Naming)","owner":"","tags":["policy/security","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üõë Regole Fondamentali (La Bibbia)\r","anchor_slug":"regole-fondamentali-la-bibbia","chunk_index":15,"content":"## üõë Regole Fondamentali (La Bibbia)\r\n- Nessun accesso diretto a utenti umani su Storage Prod\r\n- Tutto segregato tramite gruppi IAM e utenze tecniche\r\n- Ogni utenza ha uno scopo preciso e limitato\r\n- Audit sempre attivo su accessi e permessi\r\n- Naming chiaro, immutabile nel tempo\n\n---","size_chars":286,"tokens_estimate":72}
{"doc_id":"ew-easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming","path":"EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md","title":"üóÇÔ∏è EasyWay DataPortal - Standard Accesso Storage e Datalake (IAM & Naming)","owner":"","tags":["policy/security","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"üîî Prossimi Step\r","anchor_slug":"prossimi-step","chunk_index":16,"content":"## üîî Prossimi Step\r\n- Formalizzare procedure operative (joiner/mover/leaver utenti e gruppi)\r\n- Automatizzare provisioning (Terraform/Bicep)\r\n- Standardizzare nelle policy ISO aziendali (ISO27001, GDPR, DORA)","size_chars":209,"tokens_estimate":52}
{"doc_id":"ew-easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming","path":"EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md","title":"üóÇÔ∏è EasyWay DataPortal - Standard Accesso Storage e Datalake (IAM & Naming)","owner":"","tags":["policy/security","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":17,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"index","path":"EasyWay_WebApp/03_datalake_dev/index.md","title":"Indice","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:31:54+02:00","section_level":2,"anchor_text":"Indice","anchor_slug":"indice","chunk_index":1,"content":"# Indice\n- [easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md](./easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md) - üóÇÔ∏è EasyWay DataPortal - Standard Accesso Storage e Datalake (IAM & Naming)\n- [index.md](./index.md) - Indice","size_chars":273,"tokens_estimate":68}
{"doc_id":"ew-apim-jwt-tenant-claim-policy","path":"EasyWay_WebApp/05_codice_easyway_portale/apim-jwt-tenant-claim-policy.md","title":"apim-jwt-tenant-claim-policy","owner":"team-platform","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T22:37:49+02:00","section_level":2,"anchor_text":"apim-jwt-tenant-claim-policy","anchor_slug":"apim-jwt-tenant-claim-policy","chunk_index":1,"content":"Obiettivo\n- Validare il JWT in ingresso e derivare il tenant da un claim applicativo (es. `ew_tenant_id`).\n- Opzionale: impostare un header interno per compatibilit√† con sistemi legacy o per auditing.\n\nEsempio di policy (inbound)\n```\n<policies>\n  <inbound>\n    <base />\n    <validate-jwt header-name=\"Authorization\" failed-validation-httpcode=\"401\" failed-validation-error-message=\"Invalid token\">\n      <openid-config url=\"https://login.microsoftonline.com/{TENANT_ID}/v2.0/.well-known/openid-configuration\" />\n      <required-claims>\n        <claim name=\"ew_tenant_id\" match=\"any\">\n          <value>.*</value>\n        </claim>\n      </required-claims>\n      <audiences>\n        <audience>api://your-app-id</audience>\n      </audiences>\n    </validate-jwt>\n\n    <!-- Opzionale: header interno, non esposto ai client -->\n    <set-header name=\"X-Tenant-Id\" exists-action=\"override\">\n      <value>@(((Jwt)context.Variables[\"jwt\"]).Claims[\"ew_tenant_id\"])</value>\n    </set-header>\n  </inbound>\n  <backend>\n    <base />\n  </backend>\n  <outbound>\n    <base />\n  </outbound>\n  <on-error>\n    <base />\n  </on-error>\n</policies>\n```\n\nNote\n- Il backend EasyWay non richiede pi√π `X-Tenant-Id` dal client; legge il tenant dai claim del token.\n- L‚Äôheader impostato da APIM pu√≤ servire per audit/troubleshooting, ma non √® necessario.\n- Usa prodotti/policy APIM per rate‚Äëlimit multi‚Äëtenant, IP allowlist e mTLS secondo necessit√†.","size_chars":1416,"tokens_estimate":354}
{"doc_id":"ew-docs","path":"EasyWay_WebApp/05_codice_easyway_portale/docs.md","title":"Domande a cui risponde","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":1,"content":"## Domande a cui risponde\r\n- Quali documenti compongono l‚Äôarea ‚ÄúCodice EasyWay Portale‚Äù?\r\n- Dove trovare API, frontend, policy e script di supporto?\r\n- Quali sono gli step consigliati per leggere e contribuire al codice?\r\n- Come verificare naming, anchor e manifest per questa sezione?","size_chars":285,"tokens_estimate":71}
{"doc_id":"ew-easyway-portal-api","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway-portal-api.md","title":"EasyWay Data Portal ‚Äî Manifesto Tecnologico & Analitico","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Codice\r","anchor_slug":"codice","chunk_index":1,"content":"## Codice\n\nQuesta sezione raccoglie **tutta la documentazione tecnica, di sviluppo e le best practice**  \r\nche guidano la realizzazione, la manutenzione e l‚Äôevoluzione del backend EasyWay Data Portal.\n\nTutti gli step sono allineati al [Manifesto Tecnologico & Analitico] e alle policy di logging, sicurezza, compliance e conversational readiness.\n\nConsulta questa sezione ogni volta che sviluppi, aggiorni o testi nuovi servizi, endpoint o logiche del portale.","size_chars":460,"tokens_estimate":115}
{"doc_id":"ew-easyway-portal-api","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway-portal-api.md","title":"EasyWay Data Portal ‚Äî Manifesto Tecnologico & Analitico","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Premessa e Visione\r","anchor_slug":"premessa-e-visione","chunk_index":2,"content":"## Premessa e Visione\n\nEasyWay Data Portal **non nasce come semplice demo** o prototipo,  \r\nma come piattaforma **enterprise-ready**: **scalabile**, **multi-tenant**, configurabile in modo atomico, pensata per sostenere logiche di branding, sicurezza, compliance, automazione DevOps e conversational intelligence fin dal primo commit.\n\n> **Non costruiamo Hello World. Costruiamo un‚Äôinfrastruttura pronta a crescere, evolvere, parlare.**\n\n---","size_chars":441,"tokens_estimate":110}
{"doc_id":"ew-easyway-portal-api","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway-portal-api.md","title":"EasyWay Data Portal ‚Äî Manifesto Tecnologico & Analitico","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Scelte Architetturali e Motivazioni\r","anchor_slug":"scelte-architetturali-e-motivazioni","chunk_index":3,"content":"## Scelte Architetturali e Motivazioni\n\n- **Node.js + TypeScript**\r\n    - Scegliamo TypeScript per controllo, sicurezza, qualit√† e manutenzione superiore rispetto a JavaScript puro.\r\n    - **Perch√© TypeScript?**\r\n        - Tipizzazione forte e controlli statici: meno bug, meno sorprese.\r\n        - Refactor sicuri, onboarding pi√π rapido di nuovi sviluppatori.\r\n        - Standard cloud moderno, compatibile con qualsiasi team enterprise.\r\n    - **Node.js**: de facto standard per API moderne, ecosistema vastissimo, perfetta integrazione con servizi cloud (Azure in primis).\n\n- **Struttura multi-tenant**\r\n    - Tutto nasce per essere parametrico: ogni tenant (cliente) ha la sua configurazione di branding, etichette, regole di business, senza cambiare codice.\r\n    - **Multi-tenant enforced by design**: ogni richiesta API passa sempre dal middleware che garantisce isolamento dati e comportamenti.\n\n- **Configurazione atomica (YAML su Datalake + DB)**\r\n    - Branding e parametri statici in YAML su Datalake: versionabili, modificabili senza deploy, override per tenant immediato.\r\n    - Parametri dinamici (feature toggle, limiti, preferenze, ACL, conversational settings) su DB: aggiornabili real-time, auditabili, gestibili via portale admin.\n\n- **DevOps, Automazione, e Conversational-Ready**\r\n    - Ogni step √® pensato per essere deployabile tramite pipeline Azure DevOps: **niente operazioni manuali, tutto versionato, tracciabile, rollbackabile**.\r\n    - Script di setup, pipeline, README, best practice **e convenzioni conversational** forniti da subito.\n\n---","size_chars":1571,"tokens_estimate":393}
{"doc_id":"ew-easyway-portal-api","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway-portal-api.md","title":"EasyWay Data Portal ‚Äî Manifesto Tecnologico & Analitico","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Metodo di Lavoro\r","anchor_slug":"metodo-di-lavoro","chunk_index":4,"content":"## Metodo di Lavoro\n\n- **Ogni step viene validato, documentato e spiegato**\r\n    - Ogni scelta tecnologica e strutturale √® motivata, mai casuale.\r\n    - Quando serve, ci fermiamo e ragioniamo sulle alternative.\r\n    - Ogni file, cartella, API ha uno scopo chiaro e una spiegazione ‚Äúperch√©/come‚Äù.\r\n    - **Tutto √® progettato per essere auditabile, ‚Äúspiegabile‚Äù a persone, AI, AMS e chatbot.**\n\n---","size_chars":396,"tokens_estimate":99}
{"doc_id":"ew-easyway-portal-api","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway-portal-api.md","title":"EasyWay Data Portal ‚Äî Manifesto Tecnologico & Analitico","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Punti chiave delle scelte tecniche\r","anchor_slug":"punti-chiave-delle-scelte-tecniche","chunk_index":5,"content":"## Punti chiave delle scelte tecniche\n\n- **TypeScript**\r\n    - Pi√π controllo = meno bug\r\n    - Tipi chiari = team pi√π produttivo\r\n    - Progetti pi√π grandi = meno fatica nel tempo\n\n- **Multi-tenant**\r\n    - Dati e comportamenti sempre separati per tenant, nessuna contaminazione.\r\n    - Ogni tenant √® ‚Äúunico‚Äù senza duplicare codice.\n\n- **Config fuori dal codice**\r\n    - Branding, etichette, path, limiti, conversational settings: tutti parametrici.\r\n    - Modifica config = niente deploy, niente downtime.\n\n- **DevOps & Conversational Ready**\r\n    - Tutto automatizzato: build, test, deploy, backup, logging, monitoring, e interfaccia agent-aware.\n\n---","size_chars":653,"tokens_estimate":163}
{"doc_id":"ew-easyway-portal-api","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway-portal-api.md","title":"EasyWay Data Portal ‚Äî Manifesto Tecnologico & Analitico","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Struttura progetto (STEP 1.1)\r","anchor_slug":"struttura-progetto-step-11","chunk_index":6,"content":"## Struttura progetto (STEP 1.1)\r\n*(vedi albero cartelle dettagliato qui sotto, gi√† validato e documentato nel README)*\n\n**STEP 1.1 ‚Äî Struttura cartelle & file principale**\r\n---------------------------------------------------\n\n\n\n\r\n**STEP 1.1 ‚Äî Struttura cartelle & file principale**\r\n---------------------------------------------------\n\n```sql\r\neasyway-portal-api/  \r\n‚îÇ  \r\n‚îú‚îÄ .env.example # Config base (esempio, non versionato)  \r\n‚îú‚îÄ package.json # Dipendenze, script NPM  \r\n‚îú‚îÄ tsconfig.json # Config TypeScript  \r\n‚îú‚îÄ README.md # Istruzioni tecniche e uso  \r\n‚îÇ  \r\n‚îú‚îÄ /src  \r\n‚îÇ ‚îú‚îÄ app.ts # Entrypoint Express  \r\n‚îÇ ‚îú‚îÄ server.ts # Avvio server standalone  \r\n‚îÇ ‚îú‚îÄ /config  \r\n‚îÇ ‚îÇ ‚îú‚îÄ index.ts # Loader configurazioni (YAML + DB)  \r\n‚îÇ ‚îÇ ‚îú‚îÄ brandingLoader.ts # Funzione lettura YAML dal Datalake  \r\n‚îÇ ‚îÇ ‚îî‚îÄ dbConfigLoader.ts # Funzione lettura config da DB  \r\n‚îÇ ‚îú‚îÄ /routes  \r\n‚îÇ ‚îÇ ‚îî‚îÄ health.ts # Rotta di healthcheck base  \r\n‚îÇ ‚îú‚îÄ /middleware  \r\n‚îÇ ‚îÇ ‚îî‚îÄ tenant.ts # Middleware estrazione tenant  \r\n‚îÇ ‚îú‚îÄ /controllers  \r\n‚îÇ ‚îÇ ‚îî‚îÄ healthController.ts  \r\n‚îÇ ‚îú‚îÄ /models  \r\n‚îÇ ‚îÇ ‚îî‚îÄ configuration.ts # Model config DB  \r\n‚îÇ ‚îú‚îÄ /utils  \r\n‚îÇ ‚îÇ ‚îî‚îÄ logger.ts # Utility logging  \r\n‚îÇ ‚îî‚îÄ /types  \r\n‚îÇ ‚îî‚îÄ config.d.ts # Tipizzazione configurazioni  \r\n‚îÇ  \r\n‚îú‚îÄ /datalake-sample  \r\n‚îÇ ‚îî‚îÄ branding.tenant01.yaml # Esempio YAML branding/config per tenant  \r\n‚îÇ  \r\n‚îî‚îÄ /deploy  \r\n‚îî‚îÄ azure-pipeline.yml # Pipeline base per build/test/deploy\n\n```sql\n\n* * *\n\n\r\n---\n\n**Questo √® il vero punto zero ‚ÄúCodex style‚Äù**:  \r\nogni pezzo pronto all‚Äôuso, **parametrico, multi-tenant, DevOps e conversational-friendly**.\n\n---\n\n**Architettura di una WebApp/Backend moderna (Express/Node.js/TS)**\r\n-------------------------------------------------------------------","size_chars":1704,"tokens_estimate":426}
{"doc_id":"ew-easyway-portal-api","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway-portal-api.md","title":"EasyWay Data Portal ‚Äî Manifesto Tecnologico & Analitico","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**Macro-componenti principali:**\r","anchor_slug":"macro-componenti-principali","chunk_index":7,"content":"### **Macro-componenti principali:**\n\n- **models/**  \r\n    Definiscono la **struttura dei dati** (User, Profile, Notification, ecc.).  \r\n    Cambiano solo se cambia il DB o aggiungi campi.\n\n- **routes/**  \r\n    Definiscono **gli endpoint esposti** (es: `/api/users`, `/api/branding`, ecc.).  \r\n    Mappano l‚Äôendpoint HTTP (GET/POST/PUT/DELETE) al relativo controller.\n\n- **controllers/**  \r\n    Dove risiede la **logica vera** di ogni endpoint:  \r\n    _‚ÄúQuando arriva una GET su `/api/users`, cosa succede?‚Äù_\n\n- **config/**  \r\n    Gestione centralizzata delle **configurazioni** (branding, parametri DB, ecc.).  \r\n    Si aggiorna se cambi modello/config, YAML/DB, override.\n\n- **middleware/**  \r\n    Blocchi riusabili prima dei controller  \r\n    (validazione token, estrazione tenant, logging richieste, agent-aware...).\n\n- **utils/**  \r\n    Funzioni generiche (logging, date, parsing).\n\n- **queries/**  \r\n    SQL versionato, per mantenere la logica dati fuori dal codice.\n\n---\n\n**Controller, routes e config si evolvono pi√π di tutto il resto**  \r\nperch√© qui aggiungi/migliori endpoint, logica e parametrizzazione.\n\n---\n\n**Tabella di sintesi:**\n\n| Cartella     | Cambia spesso? | Perch√© cambia                         |\r\n| ------------ | -------------- | ------------------------------------- |\r\n| controllers  | ‚úÖ spesso      | Cambi logica endpoint                 |\r\n| routes       | ‚úÖ spesso      | Aggiungi/rimuovi endpoint API         |\r\n| config       | ‚úÖ spesso      | Nuovi parametri, gestione config      |\r\n| models       | ‚ùå poco        | Solo se cambia struttura dati         |\r\n| middleware   | ‚ùå poco        | Solo per security/validazione/agent   |\r\n| utils        | ‚ùå poco        | Solo nuove utility                    |\r\n| queries      | ‚ùå poco        | Solo nuova query/ottimizzazione       |\n\n---","size_chars":1817,"tokens_estimate":454}
{"doc_id":"ew-easyway-portal-api","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway-portal-api.md","title":"EasyWay Data Portal ‚Äî Manifesto Tecnologico & Analitico","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Best Practice Logging ‚Äî Dati Sensibili (EasyWay)\r","anchor_slug":"best-practice-logging-dati-sensibili-easyway","chunk_index":8,"content":"## Best Practice Logging ‚Äî Dati Sensibili (EasyWay)\n\n- **Logga solo ci√≤ che serve, maschera tutto il resto.**\r\n- **Mai dati sensibili in chiaro** su file, Datalake, export, workspace.\r\n- **Documenta la policy** e attieniti sempre (es. funzione `maskEmail` in `/utils/logUtils.ts`).\r\n- **Ogni log conversational o di sistema** rispetta questi principi.\n\n---","size_chars":356,"tokens_estimate":89}
{"doc_id":"ew-easyway-portal-api","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway-portal-api.md","title":"EasyWay Data Portal ‚Äî Manifesto Tecnologico & Analitico","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Validazione dati in ingresso ‚Äî Pattern EasyWay\r","anchor_slug":"validazione-dati-in-ingresso-pattern-easyway","chunk_index":9,"content":"## Validazione dati in ingresso ‚Äî Pattern EasyWay\n\n- Ogni endpoint che scrive su DB (POST/PUT) valida i dati con schema TypeScript/Zod.\r\n- Input errato = risposta 400 dettagliata.\r\n- Schemi in `/validators`, middleware in `/middleware/validate.ts`.\r\n- Ogni CRUD ha schema di validazione.\n\n**Esempio errore:**\r\n```json\r\n{\r\n  \"error\": \"Validation failed\",\r\n  \"details\": [\r\n    { \"path\": [\"email\"], \"message\": \"Invalid email\" }\r\n  ]\r\n}\r\n```sql\n\n8. Roadmap evolutiva\n\n| Fase | Azione |\r\n| --- | --- |\r\n| 1 | Refactor endpoint `/upload` in `/api/agent/upload/initiate` |\r\n| 2 | Aggiunta validazione ACL per tutti gli endpoint agent-aware |\r\n| 3 | Standardizzazione risposte JSON |\r\n| 4 | Logging automatico in `portal-audit/` |\r\n| 5 | SDK interno `AgentOrchestrator` per semplificare chiamate |\r\n| 6 | Esporre metadati disponibili per ogni agent |\r\n| 7 | Estensione agenti futuri: DQ, ACL, Audit, Billing |\n\n---","size_chars":906,"tokens_estimate":226}
{"doc_id":"ew-easyway-portal-api","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway-portal-api.md","title":"EasyWay Data Portal ‚Äî Manifesto Tecnologico & Analitico","owner":"","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":10,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-easyway-portal-frontend","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway-portal-frontend.md","title":"Domande a cui risponde","owner":"","tags":["layer/architecture","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":1,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-iac","path":"EasyWay_WebApp/05_codice_easyway_portale/iac.md","title":"Domande a cui risponde","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":1,"content":"## Domande a cui risponde\r\n- Quali risorse IaC sono previste per il portale?\r\n- Come si struttura il deploy (ambiente, variabili, segreti)?\r\n- Dove trovare policy e naming per componenti cloud?\r\n- Come validare naming/ancore e tracciare i cambiamenti?","size_chars":251,"tokens_estimate":63}
{"doc_id":"ew-index","path":"EasyWay_WebApp/05_codice_easyway_portale/index.md","title":"Indice","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":1,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-qa-setup-and-test-locale","path":"EasyWay_WebApp/05_codice_easyway_portale/qa-setup-and-test-locale.md","title":"EasyWay Data Portal ‚Äî Q&A Setup & Test Locale","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Aggiornamenti dal 2025-07-28 al 2025-07-29\r","anchor_slug":"aggiornamenti-dal-2025-07-28-al-2025-07-29","chunk_index":1,"content":"## Aggiornamenti dal 2025-07-28 al 2025-07-29\n\n---","size_chars":50,"tokens_estimate":12}
{"doc_id":"ew-qa-setup-and-test-locale","path":"EasyWay_WebApp/05_codice_easyway_portale/qa-setup-and-test-locale.md","title":"EasyWay Data Portal ‚Äî Q&A Setup & Test Locale","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Errore: ‚Äúnpm: command not found‚Äù / ‚Äúnode: command not found‚Äù\r","anchor_slug":"errore-npm-command-not-found-node-command-not-found","chunk_index":2,"content":"### Errore: ‚Äúnpm: command not found‚Äù / ‚Äúnode: command not found‚Äù\r\n- **Motivo:** Node.js non √® stato aggiunto al PATH di sistema dopo l‚Äôinstallazione.\r\n- **Soluzione:** Riavvia il PC, oppure aggiungi manualmente `C:\\Program Files\\nodejs\\` alla variabile d‚Äôambiente PATH.\n\n---","size_chars":274,"tokens_estimate":68}
{"doc_id":"ew-qa-setup-and-test-locale","path":"EasyWay_WebApp/05_codice_easyway_portale/qa-setup-and-test-locale.md","title":"EasyWay Data Portal ‚Äî Q&A Setup & Test Locale","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Errore: ‚ÄúCould not read package.json‚Äù\r","anchor_slug":"errore-could-not-read-packagejson","chunk_index":3,"content":"### Errore: ‚ÄúCould not read package.json‚Äù\r\n- **Motivo:** Lancio di comandi npm dalla cartella sbagliata (non contiene `package.json`).\r\n- **Soluzione:** Spostati nella cartella giusta con `cd easyway-portal-api`.\n\n---","size_chars":217,"tokens_estimate":54}
{"doc_id":"ew-qa-setup-and-test-locale","path":"EasyWay_WebApp/05_codice_easyway_portale/qa-setup-and-test-locale.md","title":"EasyWay Data Portal ‚Äî Q&A Setup & Test Locale","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Errore: ‚ÄúCannot find module 'zod'‚Äù\r","anchor_slug":"errore-cannot-find-module-zod","chunk_index":4,"content":"### Errore: ‚ÄúCannot find module 'zod'‚Äù\r\n- **Motivo:** La dipendenza `zod` non √® installata.\r\n- **Soluzione:** Lancia `npm install zod` nella cartella giusta.\n\n---","size_chars":162,"tokens_estimate":40}
{"doc_id":"ew-qa-setup-and-test-locale","path":"EasyWay_WebApp/05_codice_easyway_portale/qa-setup-and-test-locale.md","title":"EasyWay Data Portal ‚Äî Q&A Setup & Test Locale","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Errore: ‚ÄúReferenceError: validateParams is not defined‚Äù / ‚ÄúvalidateBody is not defined‚Äù\r","anchor_slug":"errore-referenceerror-validateparams-is-not-defined-validatebody-is-not-defined","chunk_index":5,"content":"### Errore: ‚ÄúReferenceError: validateParams is not defined‚Äù / ‚ÄúvalidateBody is not defined‚Äù\r\n- **Motivo:** Funzione middleware usata senza importarla.\r\n- **Soluzione:** Importa la funzione mancante, es.  \r\n  `import { validateParams, validateBody } from \"../middleware/validate\";`\n\n---","size_chars":285,"tokens_estimate":71}
{"doc_id":"ew-qa-setup-and-test-locale","path":"EasyWay_WebApp/05_codice_easyway_portale/qa-setup-and-test-locale.md","title":"EasyWay Data Portal ‚Äî Q&A Setup & Test Locale","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Errore: ‚ÄúReferenceError: userIdParamSchema is not defined‚Äù\r","anchor_slug":"errore-referenceerror-useridparamschema-is-not-defined","chunk_index":6,"content":"### Errore: ‚ÄúReferenceError: userIdParamSchema is not defined‚Äù\r\n- **Motivo:** Schema usato senza importarlo.\r\n- **Soluzione:** Importa lo schema dove serve, es.  \r\n  `import { userIdParamSchema } from \"../validators/userValidator\";`\n\n---","size_chars":237,"tokens_estimate":59}
{"doc_id":"ew-qa-setup-and-test-locale","path":"EasyWay_WebApp/05_codice_easyway_portale/qa-setup-and-test-locale.md","title":"EasyWay Data Portal ‚Äî Q&A Setup & Test Locale","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Errore: ‚ÄúReferenceError: z is not defined‚Äù\r","anchor_slug":"errore-referenceerror-z-is-not-defined","chunk_index":7,"content":"### Errore: ‚ÄúReferenceError: z is not defined‚Äù\r\n- **Motivo:** Manca import di `z` da Zod.\r\n- **Soluzione:**  \r\n  `import { z } from \"zod\";` all‚Äôinizio del file.\n\n---","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-qa-setup-and-test-locale","path":"EasyWay_WebApp/05_codice_easyway_portale/qa-setup-and-test-locale.md","title":"EasyWay Data Portal ‚Äî Q&A Setup & Test Locale","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Errore: ‚ÄúReferenceError: subscribeNotification is not defined‚Äù / ‚ÄúcontrollerFunction is not defined‚Äù\r","anchor_slug":"errore-referenceerror-subscribenotification-is-not-defined-controllerfunction-is-not-defined","chunk_index":8,"content":"### Errore: ‚ÄúReferenceError: subscribeNotification is not defined‚Äù / ‚ÄúcontrollerFunction is not defined‚Äù\r\n- **Motivo:** Funzione controller non importata o non creata.\r\n- **Soluzione:**  \r\n  - Se esiste:  \r\n    `import { subscribeNotification } from \"../controllers/notificationsController\";`\r\n  - Altrimenti, usa funzione placeholder inline per test:\r\n    ```typescript\r\n    router.post(\"/subscribe\", (req, res) => {\r\n      res.status(201).json({ message: \"Notifica iscrizione ricevuta!\" });\r\n    });\r\n    ```\n\n---","size_chars":515,"tokens_estimate":129}
{"doc_id":"ew-qa-setup-and-test-locale","path":"EasyWay_WebApp/05_codice_easyway_portale/qa-setup-and-test-locale.md","title":"EasyWay Data Portal ‚Äî Q&A Setup & Test Locale","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Errore: ‚ÄúCannot POST /api/notifications/subscribe‚Äù (404 Not Found)\r","anchor_slug":"errore-cannot-post-apinotificationssubscribe-404-not-found","chunk_index":9,"content":"### Errore: ‚ÄúCannot POST /api/notifications/subscribe‚Äù (404 Not Found)\r\n- **Motivo:** Route non implementata o non registrata correttamente in `app.ts`.\r\n- **Soluzione:**  \r\n  - Implementa la route in `routes/notifications.ts`  \r\n  - Registra la route in `app.ts` con:  \r\n    `app.use(\"/api/notifications\", notificationsRoutes);`\n\n---","size_chars":334,"tokens_estimate":84}
{"doc_id":"ew-qa-setup-and-test-locale","path":"EasyWay_WebApp/05_codice_easyway_portale/qa-setup-and-test-locale.md","title":"EasyWay Data Portal ‚Äî Q&A Setup & Test Locale","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Errore: ‚Äú400 Bad Request: Invalid or missing X-Tenant-Id header‚Äù\r","anchor_slug":"errore-400-bad-request-invalid-or-missing-x-tenant-id-header","chunk_index":10,"content":"### Errore: ‚Äú400 Bad Request: Invalid or missing X-Tenant-Id header‚Äù\r\n- **Motivo:** Header `X-Tenant-Id` mancante, richiesto dal middleware multi-tenant.\r\n- **Soluzione:**  \r\n  - Aggiungi l‚Äôheader nella richiesta:\r\n    ```\r\n    X-Tenant-Id: tenant01\r\n    ```\n\n---","size_chars":263,"tokens_estimate":66}
{"doc_id":"ew-qa-setup-and-test-locale","path":"EasyWay_WebApp/05_codice_easyway_portale/qa-setup-and-test-locale.md","title":"EasyWay Data Portal ‚Äî Q&A Setup & Test Locale","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Errore: ‚ÄúMissing script: 'dev'‚Äù\r","anchor_slug":"errore-missing-script-dev","chunk_index":11,"content":"### Errore: ‚ÄúMissing script: 'dev'‚Äù\r\n- **Motivo:** Comando lanciato dalla cartella sbagliata o manca lo script in `package.json`.\r\n- **Soluzione:**  \r\n  - Assicurati di essere in `easyway-portal-api`  \r\n  - Verifica che in `package.json` ci sia:\r\n    ```json\r\n    \"scripts\": {\r\n      \"dev\": \"ts-node-dev --respawn --transpile-only src/server.ts\"\r\n    }\r\n    ```\n\n---","size_chars":366,"tokens_estimate":92}
{"doc_id":"ew-qa-setup-and-test-locale","path":"EasyWay_WebApp/05_codice_easyway_portale/qa-setup-and-test-locale.md","title":"EasyWay Data Portal ‚Äî Q&A Setup & Test Locale","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Come fermare e rilanciare il backend\r","anchor_slug":"come-fermare-e-rilanciare-il-backend","chunk_index":12,"content":"### Come fermare e rilanciare il backend\r\n- **Ferma:** premi `Ctrl + C` nel terminale.\r\n- **Rilancia:** esegui di nuovo `npm run dev`.\n\n---","size_chars":139,"tokens_estimate":35}
{"doc_id":"ew-qa-setup-and-test-locale","path":"EasyWay_WebApp/05_codice_easyway_portale/qa-setup-and-test-locale.md","title":"EasyWay Data Portal ‚Äî Q&A Setup & Test Locale","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Come testare le API senza Postman\r","anchor_slug":"come-testare-le-api-senza-postman","chunk_index":13,"content":"### Come testare le API senza Postman\r\n- **Crea un file `.http`** (es: `easyway-api-test.http`)\r\n- **Installa [REST Client](https://marketplace.visualstudio.com/items?itemName=humao.rest-client)` in VSCode**\r\n- **Scrivi le chiamate, separa con `###`, clicca su ‚ÄúSend Request‚Äù**\n\n---","size_chars":282,"tokens_estimate":70}
{"doc_id":"ew-qa-setup-and-test-locale","path":"EasyWay_WebApp/05_codice_easyway_portale/qa-setup-and-test-locale.md","title":"EasyWay Data Portal ‚Äî Q&A Setup & Test Locale","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"**Note generali**\r","anchor_slug":"note-generali","chunk_index":14,"content":"## **Note generali**\r\n- **Importa sempre tutte le funzioni/schema che usi**\r\n- **Lancia sempre i comandi dalla cartella dove c‚Äô√® `package.json`**\r\n- **Aggiorna il file `.env` con le variabili corrette**\r\n- **Aggiungi sempre gli header richiesti dalle tue policy/middleware**\r\n- **Se vedi ‚Äúnot defined‚Äù, controlla import e percorso**\n\n---\n\n**Prossimi aggiornamenti: aggiungi ogni nuovo errore/soluzione con data,  \r\nper mantenere sempre questa chat come ‚Äúbibbia‚Äù di setup e debug EasyWay!**","size_chars":489,"tokens_estimate":122}
{"doc_id":"ew-qa-setup-and-test-locale","path":"EasyWay_WebApp/05_codice_easyway_portale/qa-setup-and-test-locale.md","title":"EasyWay Data Portal ‚Äî Q&A Setup & Test Locale","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":15,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-readme","path":"EasyWay_WebApp/05_codice_easyway_portale/readme.md","title":"Domande a cui risponde","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":1,"content":"## Domande a cui risponde\r\n- Come √® organizzata la cartella del codice del portale?\r\n- Dove trovare guide di avvio, policy e script utili?\r\n- Quali passi seguire per contribuire o fare troubleshooting?\r\n- Come verificare consistenza (naming/ancore) e generare i manifest?","size_chars":271,"tokens_estimate":68}
{"doc_id":"ew-scripts","path":"EasyWay_WebApp/05_codice_easyway_portale/scripts.md","title":"Domande a cui risponde","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":1,"content":"## Domande a cui risponde\r\n- Quali script sono disponibili per sviluppatori e operatori?\r\n- Come eseguire build, test, lint e normalizzazione documentale?\r\n- Come generare manifest, anchors e chunk per gli agenti?\r\n- Dove consultare i report e come interpretarli?","size_chars":263,"tokens_estimate":66}
{"doc_id":"ew-security-observability","path":"EasyWay_WebApp/05_codice_easyway_portale/security-and-observability.md","title":"security-and-observability","owner":"team-api","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:46+02:00","section_level":2,"anchor_text":"security-and-observability","anchor_slug":"security-and-observability","chunk_index":1,"content":"Obiettivi\n- Hardening API: helmet, CORS ristretto, rate limiting, body limit, compression.\n- Correlazione e tracciamento: `X-Request-Id`, `X-Correlation-Id`, log coerenti.\n- Autenticazione: JWT (Entra ID), estrazione tenant da claim applicativo (no header client).\n\nImplementazione (backend)\n- `src/app.ts`:\n  - `helmet()`\n  - `cors()` con allowlist da `ALLOWED_ORIGINS` (CSV)\n  - `compression()`\n  - `express-rate-limit` (env: `RATE_LIMIT_WINDOW_MS`, `RATE_LIMIT_MAX`)\n  - `express.json({ limit: BODY_LIMIT })`\n  - generazione di `X-Request-Id` e `X-Correlation-Id` (uuid v4), riutilizzando header in ingresso se presenti\n  - `authenticateJwt` prima di tutte le rotte (verifica token via JWKS)\n  - `extractTenantId` usa il claim dal token (default `ew_tenant_id` configurabile via `TENANT_CLAIM`)\n  - `withTenantContext(tenantId, fn)` imposta `SESSION_CONTEXT('tenant_id')` su SQL (RLS); flag `RLS_CONTEXT_ENABLED=false` per disattivare in debug\n  - helper `runTenantQuery(tenantId, fn)` per route GOLD/REPORTING future\n\nOsservabilit√† (OTel + App Insights)\n- Imposta in `.env.local`:\n  - `APPLICATIONINSIGHTS_CONNECTION_STRING` (da Azure Portal)\n  - `OTEL_ENABLED=true`\n  - (Opzionale) `OTEL_RESOURCE_ATTRIBUTES=service.name=easyway-portal-api,service.namespace=easyway,deployment.environment=dev`\n- Avvio: l‚ÄôSDK OTel viene attivato automaticamente (auto‚Äëinstrumentations HTTP/SQL/Blob)\n- Verifica in App Insights:\n  - `requests | order by timestamp desc`\n  - `dependencies | where type in ('SQL','http') | order by timestamp desc`\n\nPropagazione\n- Logger allega implicitamente gli ID (tramite middleware di logging); gli handler possono accedere a `req.requestId` e `req.correlationId`.\n- In futuro: OpenTelemetry per tracing distribuito (span DB/Blob) e Application Insights.\n\nConfigurazione\n- `ALLOWED_ORIGINS`: domini abilitati (CSV). Default: `http://localhost:3000`.\n- `RATE_LIMIT_WINDOW_MS`: finestra (ms). Default: `60000`.\n- `RATE_LIMIT_MAX`: richieste per finestra. Default: `600`.\n- `BODY_LIMIT`: default `1mb`.\n- `PORTAL_BASE_PATH`: default `/portal`.\n\nNote\n- Per ambienti dietro LB, impostare `TRUST_PROXY=true` per X-Forwarded-*.\n- Validazione input gi√† gestita via Zod nei middleware.\n- Rimuovere `X-Tenant-Id` dai client: il tenant √® determinato dal token.","size_chars":2272,"tokens_estimate":568}
{"doc_id":"ew-security-observability","path":"EasyWay_WebApp/05_codice_easyway_portale/security-and-observability.md","title":"security-and-observability","owner":"team-api","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:35:46+02:00","section_level":2,"anchor_text":"security-and-observability","anchor_slug":"security-and-observability","chunk_index":2,"content":"Uso consigliato (GOLD/REPORTING)\n- Per rotte GOLD/REPORTING e query sensibili, usa una di queste forme:\n  - `await runTenantQuery(req.tenantId, (reqDb) => reqDb.query('...'))`\n  - `await withTenantContext(req.tenantId, async (tx) => new sql.Request(tx).query('...'))`\n- Per debug locale senza RLS: imposta `RLS_CONTEXT_ENABLED=false` in `.env.local`.\n- `AUTH_ISSUER`, `AUTH_JWKS_URI`, `AUTH_AUDIENCE` (opzionale), `TENANT_CLAIM` (default `ew_tenant_id`)\n- `RLS_CONTEXT_ENABLED` (default `true`): se `false`, non imposta il contesto RLS a DB (debug)\n\nApprofondimenti\n- Parametrizzazione completa: vedi `Wiki/EasyWayData.wiki/parametrization-best-practices.md`","size_chars":658,"tokens_estimate":164}
{"doc_id":"ew-agentic-readiness-examples","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/agentic-readiness-and-examples.md","title":"Agentic Readiness & Esempi (Users/Onboarding)","owner":"team-api","tags":["layer/reference","artifact/agentic","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Scopo\r","anchor_slug":"scopo","chunk_index":1,"content":"## Scopo\r\nRendere il Portale 100% agentico: agenti (LLM/tooling) devono poter proporre, generare e applicare DDL/SP in modo sicuro e idempotente, rispettando gli standard EasyWay, con test e pipeline.","size_chars":200,"tokens_estimate":50}
{"doc_id":"ew-agentic-readiness-examples","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/agentic-readiness-and-examples.md","title":"Agentic Readiness & Esempi (Users/Onboarding)","owner":"team-api","tags":["layer/reference","artifact/agentic","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Linee guida agentiche\r","anchor_slug":"linee-guida-agentiche","chunk_index":2,"content":"## Linee guida agentiche\r\n- Riferimento centrale: `docs/agentic/AGENTIC_READINESS.md:1`\r\n  - Principi: idempotenza, solo SP per DML, logging obbligatorio, variante `_DEBUG`, naming, sicurezza.\r\n  - Mini‚ÄëDSL JSON per generare DDL e SP dai template.\r\n  - Guardrail e processo PR/migrazioni.\r\n- Template SQL:\r\n  - DDL tabella: `docs/agentic/templates/ddl/template_table.sql:1`\r\n  - SP produzione: `docs/agentic/templates/sp/template_sp_insert.sql:1`, `template_sp_update.sql:1`, `template_sp_delete.sql:1`\r\n  - SP debug: `docs/agentic/templates/sp/template_sp_debug_insert.sql:1`","size_chars":576,"tokens_estimate":144}
{"doc_id":"ew-agentic-readiness-examples","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/agentic-readiness-and-examples.md","title":"Agentic Readiness & Esempi (Users/Onboarding)","owner":"team-api","tags":["layer/reference","artifact/agentic","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Esempio 1 ‚Äî USERS (CRUD via SP)\r","anchor_slug":"esempio-1-users-crud-via-sp","chunk_index":3,"content":"## Esempio 1 ‚Äî USERS (CRUD via SP)\r\nObiettivo: eliminare DML diretti dalle API e passare a SP coerenti con il DDL standard `PORTAL.USERS`.\n\n1) Mini‚ÄëDSL JSON proposto all‚Äôagente\r\n```json\r\n{\r\n  \"entity\": \"USERS\",\r\n  \"schema\": \"PORTAL\",\r\n  \"columns\": [\r\n    {\"name\": \"user_id\", \"type\": \"NVARCHAR(50)\", \"constraints\": [\"UNIQUE\", \"NOT NULL\"]},\r\n    {\"name\": \"tenant_id\", \"type\": \"NVARCHAR(50)\", \"constraints\": [\"NOT NULL\"]},\r\n    {\"name\": \"email\", \"type\": \"NVARCHAR(255)\", \"constraints\": [\"NOT NULL\"]},\r\n    {\"name\": \"profile_code\", \"type\": \"NVARCHAR(50)\", \"constraints\": [\"NOT NULL\"]},\r\n    {\"name\": \"status\", \"type\": \"NVARCHAR(50)\", \"constraints\": []}\r\n  ],\r\n  \"ndg\": {\"sequence\": \"SEQ_USER_ID\", \"prefix\": \"CDI\", \"width\": 9},\r\n  \"sp\": {\r\n    \"insert\": {\"name\": \"sp_insert_user\"},\r\n    \"update\": {\"name\": \"sp_update_user\"},\r\n    \"delete\": {\"name\": \"sp_delete_user\"},\r\n    \"debug\":  {\"name\": \"sp_debug_insert_user\"}\r\n  }\r\n}\r\n```\n\n2) Output atteso (generato dai template)\r\n- SP produzione: `PORTAL.sp_insert_user`, `PORTAL.sp_update_user`, `PORTAL.sp_delete_user`\r\n- SP debug: `PORTAL.sp_debug_insert_user`\r\n- Tutte con TRY/CATCH, TRANSACTION e scrittura su `PORTAL.STATS_EXECUTION_LOG`.\n\n3) Integrazione API\r\n- Il controller `easyway-portal-api/src/controllers/usersController.ts:1` deve invocare solo SP (`pool.request().execute('PORTAL.sp_update_user')`, ecc.).\r\n- Validatori Zod aggiornati al modello DDL: `profile_code`, `status` (e/o mapping documentato da `display_name/profile_id`).\n\n4) Test\r\n- REST Client: `tests/api/rest-client/users.http:1`\r\n- Checklist agentica: `tests/agentic/README.md:1`","size_chars":1597,"tokens_estimate":399}
{"doc_id":"ew-agentic-readiness-examples","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/agentic-readiness-and-examples.md","title":"Agentic Readiness & Esempi (Users/Onboarding)","owner":"team-api","tags":["layer/reference","artifact/agentic","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Esempio 2 ‚Äî ONBOARDING (Tenant + Admin User)\r","anchor_slug":"esempio-2-onboarding-tenant-admin-user","chunk_index":4,"content":"## Esempio 2 ‚Äî ONBOARDING (Tenant + Admin User)\r\nObiettivo: confermare il pattern SP + variante DEBUG per onboarding.\n\n1) SP di riferimento (Wiki)\r\n- Produzione: `PORTAL.sp_register_tenant_and_user` (vedi `EasyWay_WebApp/01_database_architecture/01b_schema_structure/PORTAL/programmability/stored-procedure.md:2798`)\r\n- Debug: `PORTAL.sp_debug_register_tenant_and_user` (`.../stored-procedure.md:2901`)\n\n2) Mini‚ÄëDSL JSON (per generare/aggiornare le SP da template)\r\n```json\r\n{\r\n  \"entity\": \"tenant_and_user\",\r\n  \"schema\": \"PORTAL\",\r\n  \"sp\": {\r\n    \"insert\": {\"name\": \"sp_register_tenant_and_user\"},\r\n    \"debug\":  {\"name\": \"sp_debug_register_tenant_and_user\"}\r\n  },\r\n  \"ndg\": {\r\n    \"tenant\": {\"sequence\": \"SEQ_TENANT_ID\", \"prefix\": \"TEN\", \"width\": 9},\r\n    \"user\":   {\"sequence\": \"SEQ_USER_ID\",   \"prefix\": \"CDI\", \"width\": 9}\r\n  }\r\n}\r\n```\n\n3) Integrazione API\r\n- Controller: `easyway-portal-api/src/controllers/onboardingController.ts:1` gi√† invoca la SP debug via `.execute(\"PORTAL.sp_debug_register_tenant_and_user\")`.\r\n- Input validato: `easyway-portal-api/src/validators/onboardingValidator.ts:1`\n\n4) Test\r\n- REST Client: `tests/api/rest-client/onboarding.http:1`\r\n- Log conversazionali/agent-aware: presenti nel controller con `logger.info/error`.","size_chars":1253,"tokens_estimate":313}
{"doc_id":"ew-agentic-readiness-examples","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/agentic-readiness-and-examples.md","title":"Agentic Readiness & Esempi (Users/Onboarding)","owner":"team-api","tags":["layer/reference","artifact/agentic","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Processo PR/Migrazioni (riassunto)\r","anchor_slug":"processo-prmigrazioni-riassunto","chunk_index":5,"content":"## Processo PR/Migrazioni (riassunto)\r\n1. L‚Äôagente propone mini‚ÄëDSL JSON e genera i file SQL dai template (`docs/agentic/templates/...`).\r\n2. I file vanno versionati in `DataBase/migrations/` con naming data‚Äëbased.\r\n3. Aggiornare la Wiki (questa pagina) con i riferimenti a nuove SP/tabelle.\r\n4. Pipeline: applica migrazioni in `test`, esegue smoke test (`tests/api/rest-client/...`).\r\n5. Approvazione e promozione verso UAT/PROD.","size_chars":430,"tokens_estimate":108}
{"doc_id":"ew-dinamiche-di-manutenzione","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/dinamiche-di-manutenzione.md","title":"Capitolo ‚Äì Dinamiche di Manutenzione","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Architettura delle Cartelle ‚Äî Dinamiche di Manutenzione\r","anchor_slug":"architettura-delle-cartelle-dinamiche-di-manutenzione","chunk_index":1,"content":"## Architettura delle Cartelle ‚Äî Dinamiche di Manutenzione\n\nIn EasyWay Data Portal, la struttura delle cartelle segue pattern enterprise  \r\nper garantire chiarezza, scalabilit√†, facile manutenzione e onboarding immediato di nuovi sviluppatori e agenti automatici.\n\n---","size_chars":268,"tokens_estimate":67}
{"doc_id":"ew-dinamiche-di-manutenzione","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/dinamiche-di-manutenzione.md","title":"Capitolo ‚Äì Dinamiche di Manutenzione","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Quali cartelle ‚Äúsi muovono‚Äù di pi√π?\r","anchor_slug":"quali-cartelle-si-muovono-di-pi","chunk_index":2,"content":"### Quali cartelle ‚Äúsi muovono‚Äù di pi√π?\n\n| Cartella      | Modifica frequente? | Perch√© cambia |\r\n|---------------|:-------------------:|--------------|\r\n| `/controllers`|   ‚úÖ (spesso)       | Qui vive la logica degli endpoint. Cambia ogni volta che si aggiorna una funzione, una regola, una validazione, ecc. |\r\n| `/routes`     |   ‚úÖ (spesso)       | Qui mappi tutti gli endpoint REST. Cambia quando aggiungi, togli o rinomini API. |\r\n| `/config`     |   ‚úÖ (spesso)       | Gestisce le modalit√† di caricamento delle configurazioni (YAML, DB, blob). Cambia quando aggiungi nuove opzioni parametriche. |\r\n| `/models`     |   ‚ùå (raramente)    | Fotografia della struttura dati (DB). Cambia solo se cambia il database o la business entity. |\r\n| `/middleware` |   ‚ùå (raramente)    | Blocchi di logica riusabile (es: security, logging, multi-tenant, conversational hooks). Cambia solo per nuove policy di sicurezza, logging o agent-awareness. |\r\n| `/utils`      |   ‚ùå (raramente)    | Utility generiche, funzioni di supporto. Cambia poco, solo con nuove necessit√† tecniche o evoluzioni conversational. |\r\n| `/queries`    |   ‚ùå (raramente)    | Query SQL pronte all‚Äôuso, versionate e riusate. Cambiano solo per ottimizzazioni, evoluzioni del dato, nuove policy di accesso. |\n\n---","size_chars":1273,"tokens_estimate":318}
{"doc_id":"ew-dinamiche-di-manutenzione","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/dinamiche-di-manutenzione.md","title":"Capitolo ‚Äì Dinamiche di Manutenzione","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**Best Practice per la manutenzione**\r","anchor_slug":"best-practice-per-la-manutenzione","chunk_index":3,"content":"### **Best Practice per la manutenzione**\n\n- **Focus sui controller**: qui vive la business logic e la conversational logic. Documenta bene funzioni, parametri di input/output e motivazione (‚Äúintent‚Äù).\r\n- **Routes sempre minimali**: nessuna logica nelle route, solo collegamento route ‚Üí controller.\r\n- **Config chiara e centralizzata**: ogni nuova configurazione/documentazione va aggiornata con fonte, formato, chi la usa e se √® accessibile anche ad agenti automatici.\r\n- **Aggiorna sempre la sezione ‚ÄúArchitettura‚Äù** ogni volta che introduci una nuova funzionalit√† o evolvi una logica chiave.\r\n- **Commenta ogni nuovo file e funzione**: specifica a cosa serve, chi la usa (umano, agent, servizio), esempio d‚Äôuso.\r\n- **Rivedi e aggiorna la tabella delle dinamiche** ogni volta che la struttura o le policy si evolvono.\n\n---","size_chars":824,"tokens_estimate":206}
{"doc_id":"ew-dinamiche-di-manutenzione","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/dinamiche-di-manutenzione.md","title":"Capitolo ‚Äì Dinamiche di Manutenzione","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**Esempio concreto**\r","anchor_slug":"esempio-concreto","chunk_index":4,"content":"### **Esempio concreto**\n\n- Un nuovo sviluppatore, QA o agente automatico che entra e vede `/controllers/usersController.ts`,  \r\n  trova l√¨ la logica per `/api/users` e sa che ogni modifica utenti passa da qui.\r\n- Per sapere dove e come si carica la configurazione di un tenant o di una feature, va in `/config/` e trova documentazione aggiornata.\r\n- Per tracciare una nuova azione conversational, aggiungi/migliora il logging e documenta subito la nuova entry-point in questa sezione.\n\n---\n\n**Questa sezione va sempre all‚Äôinizio della documentazione tecnica.  \r\nFacilita onboarding di persone e AI, riduce errori, aumenta la trasparenza e rende il progetto self-maintainable nel tempo.**","size_chars":688,"tokens_estimate":172}
{"doc_id":"ew-dinamiche-di-manutenzione","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/dinamiche-di-manutenzione.md","title":"Capitolo ‚Äì Dinamiche di Manutenzione","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":5,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-endpoint","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/endpoint.md","title":"Domande a cui risponde","owner":"","tags":["layer/how-to","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":1,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-gestione-log-and-policy-dati-sensibili","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili.md","title":"Gestione Log ‚Äî EasyWay Data Portal","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"**Principi guida**\r","anchor_slug":"principi-guida","chunk_index":1,"content":"## **Principi guida**\r\n- **Logga solo ci√≤ che serve**, maschera tutto il resto.\r\n- **Mai dati sensibili in chiaro** su file, Datalake, o esportazione.\r\n- **Documenta la policy**: scrivi sempre cosa si pu√≤ loggare e come si mascherano i dati.\r\n- Tutti i log business/audit sono in formato JSON e pronti per essere esportati su Datalake.\n\n---","size_chars":340,"tokens_estimate":85}
{"doc_id":"ew-gestione-log-and-policy-dati-sensibili","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili.md","title":"Gestione Log ‚Äî EasyWay Data Portal","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"**Tipi di log gestiti**\r","anchor_slug":"tipi-di-log-gestiti","chunk_index":2,"content":"## **Tipi di log gestiti**\n\n| Tipo                | Dove va                         | Livello | Retention | Destinazione finale         |\r\n|---------------------|---------------------------------|---------|-----------|----------------------------|\r\n| Log applicativo     | Console, file locale            | info, error, warn, debug | 7gg     | Solo DEV/Debug             |\r\n| Log business/audit  | File JSON (`logs/business.log.json`) | info, error         | 30gg    | Datalake, BI, auditing     |\r\n| Log tecnico/trace   | File locale, Log Analytics (solo warning/error) | warning, error | 3gg     | Log Analytics (con filtro) |\n\n---","size_chars":633,"tokens_estimate":158}
{"doc_id":"ew-gestione-log-and-policy-dati-sensibili","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili.md","title":"Gestione Log ‚Äî EasyWay Data Portal","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"**Policy dati sensibili**\r","anchor_slug":"policy-dati-sensibili","chunk_index":3,"content":"## **Policy dati sensibili**\r\n- **Password, hash, CF, IBAN, dati sanitari**: **NON devono mai apparire nei log.**\r\n- **Email, nomi**: Devono essere **mascherati** o pseudonimizzati (vedi funzione `maskEmail` in `/utils/logUtils.ts`).\r\n- **Solo ID interni e chiavi tecniche nei log standard.**\n\n---","size_chars":297,"tokens_estimate":74}
{"doc_id":"ew-gestione-log-and-policy-dati-sensibili","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili.md","title":"Gestione Log ‚Äî EasyWay Data Portal","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"**Best practice**\r","anchor_slug":"best-practice","chunk_index":4,"content":"## **Best practice**\r\n- **Logging a livelli differenti** in base all‚Äôambiente (`LOG_LEVEL` via .env/config)\r\n- **Rotazione automatica** dei file di log (no log ‚Äúgiganti‚Äù)\r\n- **Log di errore e business in file separati**\r\n- **Esportazione dei log business/audit su Datalake** (via pipeline/script)\r\n- **Controllo accessi**: Solo gruppi tecnici possono leggere i log completi\n\n---","size_chars":378,"tokens_estimate":94}
{"doc_id":"ew-gestione-log-and-policy-dati-sensibili","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili.md","title":"Gestione Log ‚Äî EasyWay Data Portal","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"**Snippet esempio log business**\r","anchor_slug":"snippet-esempio-log-business","chunk_index":5,"content":"## **Snippet esempio log business**\r\n```json\r\n{\r\n  \"level\": \"info\",\r\n  \"message\": \"User created\",\r\n  \"tenantId\": \"tenant01\",\r\n  \"userEmail\": \"j****e@easyway.com\",  // Mascherato!\r\n  \"event\": \"USER_CREATE\",\r\n  \"time\": \"2025-07-27T12:34:56.789Z\"\r\n}\r\n```sql\n\n**Workflow export log**\r\n-----------------------\n\n1.  I log business/audit vengono scritti in `logs/business.log.json`\r\n    \r\n2.  Una pipeline automatica copia periodicamente i file log su Datalake (`/portal-logs/`)\r\n    \r\n3.  Log business e audit sono pronti per analisi, compliance, auditing ‚Äî e **mai contengono dati sensibili**!\n\n\r\n**Riferimenti**\r\n---------------\n\n*   Policy e best practice allineate con GDPR, SOC2, DORA\r\n    \r\n*   Vedi anche sezione ‚ÄúValidazione avanzata dati in ingresso‚Äù per evitare log di dati errati o rumorosi\n\n**Best practice e check periodico**\r\n---------------\r\n*    Log e policy aggiornati dopo ogni refactor\r\n    \r\n*    Verifica periodica di mascheramento dati su nuovi endpoint\r\n    \r\n*    Test export/automation sempre con dati fittizi/anonimizzati\r\n    \r\n*    Documentazione aggiornata su ogni nuovo tipo di log","size_chars":1105,"tokens_estimate":276}
{"doc_id":"ew-gestione-log-and-policy-dati-sensibili","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili.md","title":"Gestione Log ‚Äî EasyWay Data Portal","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":6,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"index","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/index.md","title":"Indice","owner":"team-api","tags":["layer/reference","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":1,"content":"## Domande a cui risponde\r\n- Che cosa raccoglie questo indice?\r\n- Dove sono i documenti principali collegati?\r\n- Come verificare naming e ancore per questa cartella?\r\n- Dove trovare entit√† e guide correlate?","size_chars":207,"tokens_estimate":52}
{"doc_id":"ew-policy-api-store-procedure-easyway-data-portal","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/policy-api-store-procedure-easyway-data-portal.md","title":"Policy API/Store Procedure ‚Äî EasyWay Data Portal","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Principio Guida\r","anchor_slug":"principio-guida","chunk_index":1,"content":"## Principio Guida\n\nTutta la business logic principale di EasyWay Data Portal risiede **nelle Store Procedure (SP) del database**.  \r\nLe API backend **non contengono regole o logiche complesse**:  \r\nsi limitano a **orchestrare le chiamate alle SP**, validare l‚Äôinput, gestire autenticazione e logging conversazionale.\n\n---","size_chars":322,"tokens_estimate":80}
{"doc_id":"ew-policy-api-store-procedure-easyway-data-portal","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/policy-api-store-procedure-easyway-data-portal.md","title":"Policy API/Store Procedure ‚Äî EasyWay Data Portal","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Vantaggi del modello\r","anchor_slug":"vantaggi-del-modello","chunk_index":2,"content":"## Vantaggi del modello\n\n- **Centralizzazione delle regole**:  \r\n  Ogni logica (onboarding, ACL, auditing, preferenze, notifica, ecc.) vive solo su una SP,  \r\n  evitando duplicazioni o divergenze tra codice e dati.\r\n- **Evoluzione rapida**:  \r\n  Modifiche a una SP sono subito attive per tutte le API che la chiamano,  \r\n  senza bisogno di deployare di nuovo il backend.\r\n- **Audit e compliance**:  \r\n  Tutte le operazioni critiche sono tracciate dal DB,  \r\n  con logging, auditing e security policy definite una volta sola.\r\n- **Chiarezza e onboarding**:  \r\n  Gli sviluppatori backend si concentrano su orchestrazione, validazione e logging,  \r\n  chi lavora sul DB pu√≤ evolvere la logica senza impattare le API.\n\n---","size_chars":717,"tokens_estimate":179}
{"doc_id":"ew-policy-api-store-procedure-easyway-data-portal","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/policy-api-store-procedure-easyway-data-portal.md","title":"Policy API/Store Procedure ‚Äî EasyWay Data Portal","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Pattern operativo\r","anchor_slug":"pattern-operativo","chunk_index":3,"content":"## Pattern operativo\n\n1. **Chiamata API**:  \r\n   L‚Äôutente (o agent) invia una richiesta REST all‚Äôendpoint (es: `/api/onboarding`).\r\n2. **Validazione e logging**:  \r\n   Il backend verifica l‚Äôinput (middleware, validator), logga l‚Äôazione (conversational/agent-aware).\r\n3. **Chiamata Store Procedure**:  \r\n   Il controller esegue la SP di riferimento (`PORTAL.sp_debug_register_tenant_and_user` e simili),  \r\n   passando tutti i parametri richiesti dal modello dati.\r\n4. **Risposta e logging**:  \r\n   Il risultato della SP viene restituito all‚ÄôAPI e loggato secondo policy di auditing/conversational.\r\n5. **Modifiche alla logica**:  \r\n   Tutto ci√≤ che riguarda la business rule si aggiorna solo a livello di SP.\n\n---","size_chars":713,"tokens_estimate":178}
{"doc_id":"ew-policy-api-store-procedure-easyway-data-portal","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/policy-api-store-procedure-easyway-data-portal.md","title":"Policy API/Store Procedure ‚Äî EasyWay Data Portal","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Esempio pratico\r","anchor_slug":"esempio-pratico","chunk_index":4,"content":"## Esempio pratico\n\n```ts\r\n// Chiamata API (controller)\r\nawait pool.request()\r\n  .input(\"tenant_id\", sql.NVarChar, tenantId)\r\n  .input(\"user_email\", sql.NVarChar, user_email)\r\n  .input(\"profile_id\", sql.NVarChar, profile_id)\r\n  .execute(\"PORTAL.sp_debug_register_tenant_and_user\");\r\n```sql\n\n_La SP si occupa di tutte le regole: validazione, insert, auditing, ACL, logging su DB‚Ä¶_\n\n* * *\n\nBest Practice\r\n-------------\n\n*   **Ogni endpoint API deve chiamare solo la SP di riferimento,**  \r\n    senza replicare logiche di business lato Node.js.\r\n    \r\n*   **Documenta sempre la relazione ‚ÄúAPI ‚Üí Store Procedure‚Äù** in modo chiaro (Wiki, codice, README).\r\n    \r\n*   **Le evoluzioni di business rule avvengono a livello di SP:**  \r\n    le API backend restano leggere, manutenibili, sicure.\r\n    \r\n*   **Tutti i controller devono gestire errori SP e logging in modo conversational/agent-aware.**","size_chars":888,"tokens_estimate":222}
{"doc_id":"ew-policy-api-store-procedure-easyway-data-portal","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/policy-api-store-procedure-easyway-data-portal.md","title":"Policy API/Store Procedure ‚Äî EasyWay Data Portal","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":5,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-step-1-setup-ambiente","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-1-setup-ambiente.md","title":"**B) Dove stanno i file realmente**","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**B) Dove stanno i file realmente**\r","anchor_slug":"b-dove-stanno-i-file-realmente","chunk_index":1,"content":"### **B) Dove stanno i file realmente**\n\n*   **package.json, tsconfig.json, README.md, src/**  \r\n    Sono **file e cartelle di codice**:\r\n    *   **Vanno SEMPRE nella root del repository di codice** (`easyway-portal-api/`)\r\n        \r\n    *   **Non devono mai stare sul Datalake**, n√© in cartelle dati, n√© su storage pubblico\r\n        \r\n    *   Sono gestiti da Git/Azure DevOps come ogni altro codice di backend\r\n        \n\n* * *","size_chars":427,"tokens_estimate":107}
{"doc_id":"ew-step-1-setup-ambiente","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-1-setup-ambiente.md","title":"**B) Dove stanno i file realmente**","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**C) Cosa metti (e NON metti) su Datalake**\r","anchor_slug":"c-cosa-metti-e-non-metti-su-datalake","chunk_index":2,"content":"### **C) Cosa metti (e NON metti) su Datalake**\n\n*   **Su Datalake** metterai SOLO i file di configurazione/branding YAML ‚Äúproduttivi‚Äù,  \r\n    cio√® quelli che l‚Äôapp dovr√† leggere per mostrare i colori, le etichette, le immagini per ciascun tenant.\r\n    \r\n*   **Nel repo di codice** tieni una cartella `/datalake-sample` (o simile)  \r\n    **solo per esempi** e versionamento degli ‚Äúschemi‚Äù di configurazione  \r\n    (non √® usata a runtime, serve solo come template/copia).\r\n    \n\n* * *","size_chars":483,"tokens_estimate":121}
{"doc_id":"ew-step-1-setup-ambiente","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-1-setup-ambiente.md","title":"**B) Dove stanno i file realmente**","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**D) Dettaglio file per file**\r","anchor_slug":"d-dettaglio-file-per-file","chunk_index":3,"content":"### **D) Dettaglio file per file**\n\n* * *\n\n#### **1. package.json**\n\n*   **Dove va:**  \r\n    `easyway-portal-api/package.json` (root della repo del codice, **mai su datalake**)\r\n    \r\n*   **A cosa serve:**  \r\n    File di **configurazione NPM**.  \r\n    Contiene:\r\n    *   Nome progetto\r\n        \r\n    *   Versione\r\n        \r\n    *   Script di avvio/build/test\r\n        \r\n    *   Dipendenze (librerie di Node.js e TypeScript)\r\n        \r\n*   **Perch√© serve:**  \r\n    Senza questo, il progetto non √® gestibile da Node.js, non puoi installare o usare dipendenze, n√© fare il deploy.\r\n    \n\n* * *\n\n#### **2. tsconfig.json**\n\n*   **Dove va:**  \r\n    `easyway-portal-api/tsconfig.json`\r\n    \r\n*   **A cosa serve:**  \r\n    File di **configurazione TypeScript** (regole di compilazione, output, etc.)\r\n    \r\n*   **Perch√© serve:**  \r\n    Permette di scrivere in TypeScript e ottenere il codice pronto da eseguire su Node.js.\r\n    \n\n* * *\n\n#### **3. README.md**\n\n*   **Dove va:**  \r\n    `easyway-portal-api/README.md`\r\n    \r\n*   **A cosa serve:**  \r\n    Guida tecnica per chi lavora sul progetto.  \r\n    Spiega comandi, cartelle, configurazioni minime, come avviare/localmente/buildare.\r\n    \n\n* * *\n\n#### **4. /src/**\n\n*   **Dove va:**  \r\n    `easyway-portal-api/src/`\r\n    \r\n*   **A cosa serve:**  \r\n    Contiene **TUTTO il codice sorgente** della webapp (Express, middleware, API, ecc.)\r\n    \r\n*   **Perch√© serve:**  \r\n    Qui scrivi e mantieni tutto il backend dell‚Äôapplicazione.\r\n    \n\n* * *\n\n#### **5. /datalake-sample/**\n\n*   **Dove va:**  \r\n    `easyway-portal-api/datalake-sample/`\r\n    \r\n*   **A cosa serve:**  \r\n    **Solo per esempio/template** dei file di configurazione YAML da usare/produrre su Datalake.\r\n    \r\n*   **Cosa va davvero su Datalake:**  \r\n    Solo i file definitivi, tipo `/portal-assets/config/branding.tenant01.yaml`  \r\n    (i file di esempio sono solo reference per sviluppatori).\r\n    \n\n* * *\n\n#### **6. /deploy/**\n\n*   **Dove va:**  \r\n    `easyway-portal-api/deploy/`\r\n    \r\n*   **A cosa serve:**  \r\n    File di pipeline Azure DevOps (`azure-pipelines.yml`), script di deploy CI/CD,  \r\n    **mai su datalake**, solo nel repo di codice o su Azure DevOps.\r\n    \n\n* * *\n\n**In sintesi pratica**\r\n----------------------","size_chars":2234,"tokens_estimate":558}
{"doc_id":"ew-step-1-setup-ambiente","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-1-setup-ambiente.md","title":"**B) Dove stanno i file realmente**","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**D) Dettaglio file per file**\r","anchor_slug":"d-dettaglio-file-per-file","chunk_index":4,"content":"*   **Tutto il codice (Node.js/TypeScript, config progetti, pipeline) sta nella repo codice.**\r\n    \r\n*   **Solo le configurazioni di branding, label, path, ecc. che servono all‚Äôapp in runtime, vanno in Datalake (e ci vanno tramite pipeline/script, non ‚Äúa mano‚Äù).**\r\n    \r\n*   **Tutto ci√≤ che riguarda tabelle e insert DB, sta solo nella chat DB, mai qui.**","size_chars":357,"tokens_estimate":89}
{"doc_id":"ew-step-1-setup-ambiente","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-1-setup-ambiente.md","title":"**B) Dove stanno i file realmente**","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":5,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-step-2-‚Äî-struttura-src-e-primi-file","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/STEP-2-‚Äî-Struttura-src-e-primi-file.md","title":"Domande a cui risponde","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":1,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-step-3---gestione-configurazioni-(yaml-+-db)","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/STEP-3-‚Äî-Gestione-configurazioni-(YAML-+-DB).md","title":"Domande a cui risponde","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T22:11:25+02:00","section_level":2,"anchor_text":"Domande a cui risponde","anchor_slug":"domande-a-cui-risponde","chunk_index":1,"content":"## Domande a cui risponde\n- Cosa fa questa pagina?\n- Quali sono i prerequisiti?\n- Quali passi devo seguire?\n- Quali sono gli errori comuni?\n- Dove approfondire?","size_chars":160,"tokens_estimate":40}
{"doc_id":"ew-step-4-query-dinamiche-locale-datalake","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-4-query-dinamiche-locale-datalake.md","title":"Gestione delle query SQL nel backend EasyWay","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"Gestione delle query SQL nel backend EasyWay\r","anchor_slug":"gestione-delle-query-sql-nel-backend-easyway","chunk_index":1,"content":"### Gestione delle query SQL nel backend EasyWay\n\n**Pattern adottato: ‚ÄúLocale + Custom/Blob‚Äù**\n\n- Tutte le query core, CRUD, migration, viste e stored procedure sono versionate nella cartella `src/queries/` del backend.\r\n    - Ogni modifica a queste query richiede una nuova versione e un deploy del backend (best practice per coerenza e audit).\r\n    - Sono facilmente consultabili e manutenibili da tutto il team.\r\n- In casi particolari (override temporanei, hotfix urgenti, necessit√† di patch ‚Äúa caldo‚Äù, report dinamici multi-tenant):\r\n    - Le query possono essere salvate su Azure Datalake/Blob sotto `/portal-config/queries/`.\r\n    - Il backend √® predisposto a cercare prima la versione custom (blob), e se non trovata, utilizza quella locale.\r\n    - La pipeline DevOps gestisce versioning, update e audit anche dei file custom.\n\n**Vantaggi:**\r\n- Massima coerenza e sicurezza per la logica core.\r\n- Flessibilit√† per esigenze particolari o evoluzioni future, senza cambiare il bundle del backend.","size_chars":1000,"tokens_estimate":250}
{"doc_id":"ew-step-4-query-dinamiche-locale-datalake","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-4-query-dinamiche-locale-datalake.md","title":"Gestione delle query SQL nel backend EasyWay","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**A. Struttura della cartella queries**\r","anchor_slug":"a-struttura-della-cartella-queries","chunk_index":2,"content":"### **A. Struttura della cartella queries**\n\nCrea questa struttura nel tuo progetto:\r\n```sql\r\neasyway-portal-api/\r\n‚îî‚îÄ src/\r\n    ‚îî‚îÄ queries/\r\n        ‚îú‚îÄ users_insert.sql\r\n        ‚îú‚îÄ users_select_by_tenant.sql\r\n        ‚îú‚îÄ users_update.sql\r\n        ‚îú‚îÄ users_delete.sql\r\n        ‚îî‚îÄ ... (aggiungi altre query quando servono)\r\n```sql\n\nB. Esempio di file SQL (users_insert.sql)\n\n```sql\r\n-- users_insert.sql\r\nEXEC PORTAL.sp_debug_register_tenant_and_user\r\n  @tenant_id = @tenant_id,\r\n  @email = @email,\r\n  @display_name = @display_name,\r\n  @profile_id = @profile_id;\r\n```sql","size_chars":566,"tokens_estimate":142}
{"doc_id":"ew-step-4-query-dinamiche-locale-datalake","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-4-query-dinamiche-locale-datalake.md","title":"Gestione delle query SQL nel backend EasyWay","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**C. Funzione di caricamento query con fallback (custom su blob, locale default)**\r","anchor_slug":"c-funzione-di-caricamento-query-con-fallback-custom-su-blob-locale-default","chunk_index":3,"content":"### **C. Funzione di caricamento query con fallback (custom su blob, locale default)**\n\n`src/queries/queryLoader.ts`\n\n```sql\r\nimport fs from \"fs\";\r\nimport path from \"path\";\r\nimport { loadSqlQueryFromBlob } from \"../config/queryLoader\";\n\n/**\r\n * Carica una query SQL:\r\n * - Prima cerca su Blob Storage (custom override)\r\n * - Se non trovata, usa la versione locale sotto /src/queries\r\n */\r\nexport async function loadQueryWithFallback(fileName: string): Promise<string> {\r\n  try {\r\n    // Tenta override su Blob (custom)\r\n    return await loadSqlQueryFromBlob(fileName);\r\n  } catch (err) {\r\n    // Se errore (es: blob non esiste), fallback su query locale\r\n    const localPath = path.join(__dirname, fileName);\r\n    if (!fs.existsSync(localPath)) {\r\n      throw new Error(`Query \"${fileName}\" non trovata n√© su Blob n√© localmente`);\r\n    }\r\n    return fs.readFileSync(localPath, \"utf-8\");\r\n  }\r\n}\r\n```sql\n\nD. Uso nel controller utenti (esempio su createUser)\r\nsrc/controllers/usersController.ts\n\n```sql\r\nimport { loadQueryWithFallback } from \"../queries/queryLoader\";\n\nexport async function createUser(req: Request, res: Response) {\r\n  try {\r\n    const tenantId = (req as any).tenantId;\r\n    const { email, display_name, profile_id } = req.body;\r\n    const pool = await sql.connect(process.env.DB_CONN_STRING!);\n\n    // Usa il loader \"con fallback\"\r\n    const sqlQuery = await loadQueryWithFallback(\"users_insert.sql\");\n\n    const result = await pool.request()\r\n      .input(\"tenant_id\", sql.NVarChar, tenantId)\r\n      .input(\"email\", sql.NVarChar, email)\r\n      .input(\"display_name\", sql.NVarChar, display_name)\r\n      .input(\"profile_id\", sql.NVarChar, profile_id)\r\n      .query(sqlQuery);\n\n    res.status(201).json(result.recordset[0]);\r\n  } catch (err: any) {\r\n    res.status(500).json({ error: err.message });\r\n  }\r\n}\r\n```sql\r\n(Stesso schema su tutte le altre operazioni CRUD)","size_chars":1880,"tokens_estimate":470}
{"doc_id":"ew-step-4-query-dinamiche-locale-datalake","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-4-query-dinamiche-locale-datalake.md","title":"Gestione delle query SQL nel backend EasyWay","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":4,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-step-5-validazione-avanzata-dati-in-ingresso","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-5-validazione-avanzata-dati-in-ingresso.md","title":"**Perch√© serve**","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**Perch√© serve**\r","anchor_slug":"perch-serve","chunk_index":1,"content":"### **Perch√© serve**\n\n*   **Blocca subito i dati errati o ‚Äúsporchi‚Äù** prima che arrivino al database.\r\n    \r\n*   **Evita bug e log inutili** (meno errori sulle API e meno dati da gestire nei log).\r\n    \r\n*   **Obbliga a rispettare le regole di business** su formato, presenza, coerenza dei dati.\r\n    \r\n*   **Aiuta a mantenere i log DB ‚Äúpuliti‚Äù e comprensibili**.\n\nvalidazione completa su:\r\n- Body (POST/PUT)\r\n- Querystring (GET con filtri, paginazione‚Ä¶)\r\n- Parametri route (`:user_id`)\r\n- Header (`X-Tenant-Id`)\r\n    \n\n* * *","size_chars":525,"tokens_estimate":131}
{"doc_id":"ew-step-5-validazione-avanzata-dati-in-ingresso","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-5-validazione-avanzata-dati-in-ingresso.md","title":"**Perch√© serve**","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**A. Tecnologia consigliata: Zod (alternativa: Joi)**\r","anchor_slug":"a-tecnologia-consigliata-zod-alternativa-joi","chunk_index":2,"content":"### **A. Tecnologia consigliata: Zod (alternativa: Joi)**\n\n*   **Zod** √® una libreria TypeScript, perfetta per progetti moderni e typed.\r\n    \r\n*   Definisci ‚Äúschemi‚Äù per ogni entit√†/endpoint: se i dati non rispettano lo schema, la richiesta viene bloccata (errore 400).\r\n    \n\n* * *","size_chars":283,"tokens_estimate":71}
{"doc_id":"ew-step-5-validazione-avanzata-dati-in-ingresso","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-5-validazione-avanzata-dati-in-ingresso.md","title":"**Perch√© serve**","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**B. Esempio di validazione per utenti (create e update)**\r","anchor_slug":"b-esempio-di-validazione-per-utenti-create-e-update","chunk_index":3,"content":"### **B. Esempio di validazione per utenti (create e update)**\n\n#### **1. Installa Zod**\r\n```sql\r\nnpm install zod\r\n```sql\r\n#### **2. Crea schema di validazione**\n\n`src/validators/userValidator.ts`\n\n```sql\r\nimport { z } from \"zod\";\n\nexport const userCreateSchema = z.object({\r\n  email: z.string().email(),\r\n  display_name: z.string().min(3).max(100),\r\n  profile_id: z.string().min(1),\r\n});\n\nexport const userUpdateSchema = z.object({\r\n  email: z.string().email().optional(),\r\n  display_name: z.string().min(3).max(100).optional(),\r\n  profile_id: z.string().min(1).optional(),\r\n  is_active: z.boolean().optional()\r\n});\n\n```sql\n\n#### **3. Middleware generico di validazione**\n\n`src/middleware/validate.ts`\n\n```sql\r\nimport { Request, Response, NextFunction } from \"express\";\r\nimport { ZodSchema } from \"zod\";\n\nexport function validateBody(schema: ZodSchema<any>) {\r\n  return (req: Request, res: Response, next: NextFunction) => {\r\n    const result = schema.safeParse(req.body);\r\n    if (!result.success) {\r\n      return res.status(400).json({ error: \"Validation failed\", details: result.error.errors });\r\n    }\r\n    req.body = result.data; // eventuale sanitizzazione\r\n    next();\r\n  };\r\n}\r\n```sql\n\n#### **4. Usa il middleware nelle route utenti**\n\n`src/routes/users.ts`\n\n```sql\r\nimport { Router } from \"express\";\r\nimport { getUsers, createUser, updateUser, deleteUser } from \"../controllers/usersController\";\r\nimport { validateBody } from \"../middleware/validate\";\r\nimport { userCreateSchema, userUpdateSchema } from \"../validators/userValidator\";\n\nconst router = Router();\n\nrouter.get(\"/\", getUsers);\r\nrouter.post(\"/\", validateBody(userCreateSchema), createUser);\r\nrouter.put(\"/:user_id\", validateBody(userUpdateSchema), updateUser);\r\nrouter.delete(\"/:user_id\", deleteUser);\n\nexport default router;\n\n```sql","size_chars":1804,"tokens_estimate":451}
{"doc_id":"ew-step-5-validazione-avanzata-dati-in-ingresso","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-5-validazione-avanzata-dati-in-ingresso.md","title":"**Perch√© serve**","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":4,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-endp-001-get-api-config","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-001-get-api-config.md","title":"ENDPOINT: GET `/api/config`","owner":"","tags":["domain/webapp","layer/reference","artifact/endpoint","audience/dev","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"ENDPOINT: GET `/api/config`\r","anchor_slug":"endpoint-get-apiconfig","chunk_index":1,"content":"### ENDPOINT: GET `/api/config`\n\n**Descrizione**\r\n> Restituisce la configurazione dinamica per il tenant corrente, leggendo dalla tabella `PORTAL.CONFIGURATION`.  \r\n> Permette di ottenere tutti i parametri o filtrarli per sezione (`?section=nome_sezione`).\n\n---\n\n**Best Practice**\r\n- Richiede header `X-Tenant-Id`\r\n- Permette filtro opzionale via querystring (`?section=feature_toggle`, ecc.)\r\n- Risposta 404 se nessuna config trovata per tenant/section\r\n- Gestione chiara degli errori\r\n- Risposta sempre JSON (`{ \"config_key\": \"config_value\", ... }`)\n\n---\n\n**Cosa fa tecnicamente**\r\n1. Estrae `tenantId` dal middleware\r\n2. Legge (opzionalmente) il parametro `section` dalla querystring\r\n3. Interroga la tabella `PORTAL.CONFIGURATION` per quel tenant e sezione\r\n4. Ritorna i parametri come oggetto chiave/valore\n\n---\n\n**Come si testa**\r\n- Avvia il backend (`npm run dev`)\r\n- Esegui una GET su `/api/config` con header `X-Tenant-Id: tenant01`\r\n- (Opzionale) Aggiungi `?section=feature_toggle` alla URL\r\n- Risposta attesa (esempio):\r\n  ```json\r\n  {\r\n    \"enable_data_quality\": \"true\",\r\n    \"max_file_size\": \"1048576\"\r\n  }\r\n  ```\r\n- Risposta errore:\r\n  ```json\r\n  { \"error\": \"No configuration found for this tenant/section\" }\r\n  ```\r\n- Esempio chiamata:\n\n  ```json\r\n     curl -X GET \"http://localhost:3000/api/config?section=feature_toggle\" \\\r\n     -H \"X-Tenant-Id: tenant01\"\r\n  ```\n\n---\n\n**Con questo hai un endpoint parametrico, dinamico e multi-tenant  \r\n- stesso pattern riusabile per ogni futura configurazione!**","size_chars":1515,"tokens_estimate":379}
{"doc_id":"ew-endp-001-get-api-config","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-001-get-api-config.md","title":"ENDPOINT: GET `/api/config`","owner":"","tags":["domain/webapp","layer/reference","artifact/endpoint","audience/dev","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":2,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-endp-001a-get-api-config-da-db","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-001a-get-api-config-da-db.md","title":"A. Codice - File da creare/aggiornare","owner":"","tags":["domain/webapp","layer/how-to","artifact/endpoint","audience/dev","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"A. Codice - File da creare/aggiornare\r","anchor_slug":"a-codice-file-da-creareaggiornare","chunk_index":1,"content":"## A. Codice - File da creare/aggiornare\n\n1. `src/routes/config.ts`\n\n```sql\r\n// easyway-portal-api/src/routes/config.ts\r\nimport { Router } from \"express\";\r\nimport { getDbConfig } from \"../controllers/configController\";\n\nconst router = Router();\n\n// Endpoint GET /api/config\r\nrouter.get(\"/\", getDbConfig);\n\nexport default router;\r\n```sql\n\n2. `src/controllers/configController.ts`\n\n```sql\r\n// easyway-portal-api/src/controllers/configController.ts\r\nimport { Request, Response } from \"express\";\r\nimport { loadDbConfig } from \"../config/dbConfigLoader\";\n\nexport async function getDbConfig(req: Request, res: Response) {\r\n  try {\r\n    const tenantId = (req as any).tenantId;\r\n    const section = req.query.section as string | undefined;\n\n    const config = await loadDbConfig(tenantId, section);\n\n    if (Object.keys(config).length === 0) {\r\n      return res.status(404).json({ error: \"No configuration found for this tenant/section\" });\r\n    }\n\n    res.json(config);\r\n  } catch (err: any) {\r\n    res.status(500).json({ error: err.message || \"Internal server error\" });\r\n  }\r\n}\r\n```sql\n\n3. Aggiorna `src/app.ts` per includere la nuova rotta\r\n   - Aggiungi dopo gli altri import:\r\n```sql\r\nimport configRoutes from \"./routes/config\";\r\n```sql\r\n   - Aggiungi questa riga sotto le altre rotte:\r\n```sql\r\napp.use(\"/api/config\", configRoutes);\r\n```sql","size_chars":1338,"tokens_estimate":334}
{"doc_id":"ew-endp-001a-get-api-config-da-db","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-001a-get-api-config-da-db.md","title":"A. Codice - File da creare/aggiornare","owner":"","tags":["domain/webapp","layer/how-to","artifact/endpoint","audience/dev","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":2,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-endp-002-get-api-branding","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-002-get-api-branding.md","title":"**1. `src/routes/branding.ts`**","owner":"","tags":["domain/webapp","layer/reference","artifact/endpoint","audience/dev","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T21:50:10+02:00","section_level":3,"anchor_text":"**1. `src/routes/branding.ts`**\r","anchor_slug":"1-srcroutesbrandingts","chunk_index":1,"content":"### **1. `src/routes/branding.ts`**\n\n```sql\r\n// easyway-portal-api/src/routes/branding.ts\r\nimport { Router } from \"express\";\r\nimport { getBrandingConfig } from \"../controllers/brandingController\";\n\nconst router = Router();\n\n// Endpoint GET /api/branding\r\nrouter.get(\"/\", getBrandingConfig);\n\nexport default router;\n\n```sql\n\n**Dove va:**  \r\n`easyway-portal-api/src/routes/branding.ts`","size_chars":383,"tokens_estimate":96}
{"doc_id":"ew-endp-002-get-api-branding","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-002-get-api-branding.md","title":"**1. `src/routes/branding.ts`**","owner":"","tags":["domain/webapp","layer/reference","artifact/endpoint","audience/dev","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T21:50:10+02:00","section_level":3,"anchor_text":"**2. `src/controllers/brandingController.ts`**\r","anchor_slug":"2-srccontrollersbrandingcontrollerts","chunk_index":2,"content":"### **2. `src/controllers/brandingController.ts`**\n\n\r\n```sql\n// easyway-portal-api/src/controllers/brandingController.ts\nimport { Request, Response } from \"express\";\nimport { loadBrandingConfig } from \"../config/brandingLoader\";\n\nexport async function getBrandingConfig(req: Request, res: Response) {\n  try {\n    const tenantId = (req as any).tenantId;\n    const config = await loadBrandingConfig(tenantId);\n    res.json(config);\n  } catch (err: any) {\n    res.status(404).json({ error: err.message || \"Branding config not found\" });\n  }\n}\n```sql\n\n**Dove va:**  \r\n`easyway-portal-api/src/controllers/brandingController.ts`\n\n**3. Aggiungi la rotta in `src/app.ts`**\n\nAggiungi questa riga **sotto** la riga in cui importi le rotte health:\n\n```sql\r\nimport brandingRoutes from \"./routes/branding\";\r\n```sql\r\nE subito **dopo** la riga  \r\n```sql\r\napp.use(\"/api/health\", healthRoutes);`\r\n```sql\r\naggiungi:\r\n```sql\r\napp.use(\"/api/branding\", brandingRoutes);\r\n```sql\n\n`src/app.ts` (snippet aggiornato):\n\n```sql\r\n// easyway-portal-api/src/app.ts\r\nimport express from \"express\";\r\nimport dotenv from \"dotenv\";\r\nimport { logger } from \"./utils/logger\";\r\nimport { extractTenantId } from \"./middleware/tenant\";\r\nimport healthRoutes from \"./routes/health\";\r\nimport brandingRoutes from \"./routes/branding\";\n\n// Carica variabili di ambiente (.env)\r\ndotenv.config();\n\nconst app = express();\r\napp.use(express.json());\n\n// Logging di ogni richiesta base\r\napp.use((req, res, next) => {\r\n  logger.info(`[${req.method}] ${req.originalUrl}`);\r\n  next();\r\n});\n\n// Middleware per estrarre tenant_id da header/JWT (customizza a piacere)\r\napp.use(extractTenantId);\n\n// Rotte API\r\napp.use(\"/api/health\", healthRoutes);\r\napp.use(\"/api/branding\", brandingRoutes);\n\nexport default app;\n\n\r\n```sql","size_chars":1761,"tokens_estimate":440}
{"doc_id":"ew-endp-002-get-api-branding","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-002-get-api-branding.md","title":"**1. `src/routes/branding.ts`**","owner":"","tags":["domain/webapp","layer/reference","artifact/endpoint","audience/dev","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T21:50:10+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":3,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-endp-003-get-crud-api-users","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-003-get-crud-api-users.md","title":"ENDPOINT: CRUD `/api/users`","owner":"","tags":["domain/webapp","layer/reference","artifact/endpoint","audience/dev","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"ENDPOINT: CRUD `/api/users`\r","anchor_slug":"endpoint-crud-apiusers","chunk_index":1,"content":"### ENDPOINT: CRUD `/api/users`\n\n**Descrizione**\r\n> Permette la gestione completa degli utenti di un tenant (elenco, creazione, modifica, cancellazione/disattivazione).\r\n> Tutto filtrato per `tenantId`, nessun tenant pu√≤ accedere agli utenti degli altri.\r\nGestione completa degli utenti per tenant, tutto filtrato su `tenantId`.\r\nLe query SQL vengono caricate dalla cartella `src/queries/` (fallback su custom Blob se serve).\n\n**Best Practice**\r\n- Validazione input obbligatoria (header, body)\r\n- Tutte le operazioni sono sempre scoperte solo per il tenant corrente\r\n- Risposta coerente e tipizzata, errori gestiti e chiari\r\n- Logging di tutte le operazioni (minimo su console/logger, poi DB/audit trail)\r\n- Testabilit√† garantita via Postman, REST Client, cURL\r\n- Validazione input e sicurezza sempre attiva (header, body)\r\n- Risposta coerente, errori gestiti\r\n- Logging delle operazioni consigliato\n\n**Cosa fa tecnicamente**\r\n1. Recupera il `tenantId` dal middleware\r\n2. Esegue query solo su utenti del tenant\r\n3. Per ogni operazione (GET, POST, PUT, DELETE) aggiorna solo record del tenant\r\n4. Restituisce risposta JSON, o errore\r\n5. Recupera `tenantId` via middleware\r\n6. Esegue query SQL caricata con fallback (Blob o locale)\r\n7. Ogni endpoint risponde solo per il tenant corrente\n\n**Come si testa**\r\n- Avvia il backend (`npm run dev`)\r\n- GET `/api/users` con header `X-Tenant-Id: tenant01` (elenco utenti tenant)\r\n- POST `/api/users` con body JSON (creazione utente)\r\n- PUT `/api/users/:user_id` (aggiornamento)\r\n- DELETE `/api/users/:user_id` (disattivazione)\n\n\r\n**Endpoint CRUD Utenti Multi-Tenant**\r\n-------------------------------------\n\n**Obiettivo:**  \r\nCreare gli endpoint CRUD (Create, Read, Update, Delete) per la tabella `USERS`,  \r\nseguendo le best practice multi-tenant e la struttura gi√† definita.","size_chars":1815,"tokens_estimate":454}
{"doc_id":"ew-endp-003-get-crud-api-users","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-003-get-crud-api-users.md","title":"ENDPOINT: CRUD `/api/users`","owner":"","tags":["domain/webapp","layer/reference","artifact/endpoint","audience/dev","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**A. Logica e best practice**\r","anchor_slug":"a-logica-e-best-practice","chunk_index":2,"content":"### **A. Logica e best practice**\n\n*   **Ogni operazione su USERS √® SEMPRE filtrata su `tenantId`** (nessun utente di un tenant pu√≤ vedere o modificare utenti di un altro tenant)\r\n    \r\n*   **Risposta e input sempre in JSON**\r\n    \r\n*   **Errori gestiti e descrittivi**\r\n    \r\n*   **Tipizzazione tramite TypeScript**\r\n    \r\n*   **Logging di operazioni CRUD (minimo via logger, poi estendibile su DB)**\r\n    \n\n* * *","size_chars":414,"tokens_estimate":104}
{"doc_id":"ew-endp-003-get-crud-api-users","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-003-get-crud-api-users.md","title":"ENDPOINT: CRUD `/api/users`","owner":"","tags":["domain/webapp","layer/reference","artifact/endpoint","audience/dev","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**B. Struttura dei nuovi file**\r","anchor_slug":"b-struttura-dei-nuovi-file","chunk_index":3,"content":"### **B. Struttura dei nuovi file**\n\n```sql\r\n/src/\r\n‚îú‚îÄ controllers/\r\n‚îÇ    ‚îî‚îÄ usersController.ts\r\n‚îú‚îÄ models/\r\n‚îÇ    ‚îî‚îÄ user.ts\r\n‚îî‚îÄ routes/\r\n     ‚îî‚îÄ users.ts\r\n```sql","size_chars":162,"tokens_estimate":40}
{"doc_id":"ew-endp-003-get-crud-api-users","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-003-get-crud-api-users.md","title":"ENDPOINT: CRUD `/api/users`","owner":"","tags":["domain/webapp","layer/reference","artifact/endpoint","audience/dev","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**C. 1. Model (tipizzazione)**\r","anchor_slug":"c-1-model-tipizzazione","chunk_index":4,"content":"### **C. 1. Model (tipizzazione)**\n\n`src/models/user.ts`\n\n```sql\r\n// easyway-portal-api/src/models/user.ts\n\nexport interface User {\r\n  user_id: string;        // NDG, es: CDI0000010001\r\n  tenant_id: string;\r\n  email: string;\r\n  display_name: string;\r\n  is_active: boolean;\r\n  profile_id: string;\r\n  created_at: Date;\r\n  updated_at: Date;\r\n}\r\n```sql","size_chars":348,"tokens_estimate":87}
{"doc_id":"ew-endp-003-get-crud-api-users","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-003-get-crud-api-users.md","title":"ENDPOINT: CRUD `/api/users`","owner":"","tags":["domain/webapp","layer/reference","artifact/endpoint","audience/dev","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**C. 2. Controller (logica CRUD base)**\r","anchor_slug":"c-2-controller-logica-crud-base","chunk_index":5,"content":"### **C. 2. Controller (logica CRUD base)**\n\n`src/controllers/usersController.ts`\n\n```sql\r\n// easyway-portal-api/src/controllers/usersController.ts\r\nimport { Request, Response } from \"express\";\r\nimport sql from \"mssql\";\r\nimport { User } from \"../models/user\";\n\n// Utility per estrarre tenant da req\r\nfunction getTenantId(req: Request): string {\r\n  return (req as any).tenantId;\r\n}\n\n// GET /api/users - lista utenti per tenant\r\nexport async function getUsers(req: Request, res: Response) {\r\n  try {\r\n    const tenantId = getTenantId(req);\r\n    const pool = await sql.connect(process.env.DB_CONN_STRING!);\n\n    const result = await pool.request()\r\n      .input(\"tenant_id\", sql.NVarChar, tenantId)\r\n      .query(\"SELECT * FROM PORTAL.USERS WHERE tenant_id = @tenant_id\");\n\n    res.json(result.recordset as User[]);\r\n  } catch (err: any) {\r\n    res.status(500).json({ error: err.message });\r\n  }\r\n}\n\n// POST /api/users - crea utente per tenant\r\nexport async function createUser(req: Request, res: Response) {\r\n  try {\r\n    const tenantId = getTenantId(req);\r\n    const { email, display_name, profile_id } = req.body;\n\n    const pool = await sql.connect(process.env.DB_CONN_STRING!);\r\n    // Generate nuovo NDG\r\n    // Qui puoi mettere la tua logica: esempio con sequence SQL Server\n\n    const result = await pool.request()\r\n      .input(\"tenant_id\", sql.NVarChar, tenantId)\r\n      .input(\"email\", sql.NVarChar, email)\r\n      .input(\"display_name\", sql.NVarChar, display_name)\r\n      .input(\"profile_id\", sql.NVarChar, profile_id)\r\n      .query(`\r\n        INSERT INTO PORTAL.USERS (tenant_id, email, display_name, profile_id, is_active, created_at, updated_at)\r\n        VALUES (@tenant_id, @email, @display_name, @profile_id, 1, SYSUTCDATETIME(), SYSUTCDATETIME());\r\n        SELECT * FROM PORTAL.USERS WHERE user_id = SCOPE_IDENTITY();\r\n      `);\n\n    res.status(201).json(result.recordset[0] as User);\r\n  } catch (err: any) {\r\n    res.status(500).json({ error: err.message });\r\n  }\r\n}\n\n// PUT /api/users/:user_id - aggiorna utente per tenant\r\nexport async function updateUser(req: Request, res: Response) {\r\n  try {\r\n    const tenantId = getTenantId(req);\r\n    const { user_id } = req.params;\r\n    const { email, display_name, profile_id, is_active } = req.body;\n\n    const pool = await sql.connect(process.env.DB_CONN_STRING!);","size_chars":2325,"tokens_estimate":581}
{"doc_id":"ew-endp-003-get-crud-api-users","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-003-get-crud-api-users.md","title":"ENDPOINT: CRUD `/api/users`","owner":"","tags":["domain/webapp","layer/reference","artifact/endpoint","audience/dev","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**C. 2. Controller (logica CRUD base)**\r","anchor_slug":"c-2-controller-logica-crud-base","chunk_index":6,"content":"    const result = await pool.request()\r\n      .input(\"user_id\", sql.NVarChar, user_id)\r\n      .input(\"tenant_id\", sql.NVarChar, tenantId)\r\n      .input(\"email\", sql.NVarChar, email)\r\n      .input(\"display_name\", sql.NVarChar, display_name)\r\n      .input(\"profile_id\", sql.NVarChar, profile_id)\r\n      .input(\"is_active\", sql.Bit, is_active)\r\n      .query(`\r\n        UPDATE PORTAL.USERS\r\n        SET email = @email,\r\n            display_name = @display_name,\r\n            profile_id = @profile_id,\r\n            is_active = @is_active,\r\n            updated_at = SYSUTCDATETIME()\r\n        WHERE user_id = @user_id AND tenant_id = @tenant_id;\r\n        SELECT * FROM PORTAL.USERS WHERE user_id = @user_id AND tenant_id = @tenant_id;\r\n      `);\n\n    res.json(result.recordset[0] as User);\r\n  } catch (err: any) {\r\n    res.status(500).json({ error: err.message });\r\n  }\r\n}\n\n// DELETE /api/users/:user_id - disattiva utente per tenant\r\nexport async function deleteUser(req: Request, res: Response) {\r\n  try {\r\n    const tenantId = getTenantId(req);\r\n    const { user_id } = req.params;\n\n    const pool = await sql.connect(process.env.DB_CONN_STRING!);\n\n    await pool.request()\r\n      .input(\"user_id\", sql.NVarChar, user_id)\r\n      .input(\"tenant_id\", sql.NVarChar, tenantId)\r\n      .query(`\r\n        UPDATE PORTAL.USERS\r\n        SET is_active = 0,\r\n            updated_at = SYSUTCDATETIME()\r\n        WHERE user_id = @user_id AND tenant_id = @tenant_id;\r\n      `);\n\n    res.status(204).send();\r\n  } catch (err: any) {\r\n    res.status(500).json({ error: err.message });\r\n  }\r\n}\r\n```sql","size_chars":1578,"tokens_estimate":394}
{"doc_id":"ew-endp-003-get-crud-api-users","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-003-get-crud-api-users.md","title":"ENDPOINT: CRUD `/api/users`","owner":"","tags":["domain/webapp","layer/reference","artifact/endpoint","audience/dev","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**C. 4. Aggiornamento app.ts**\r","anchor_slug":"c-4-aggiornamento-appts","chunk_index":7,"content":"### **C. 4. Aggiornamento app.ts**\n\nAggiungi l'import:\n\n```sql\r\nimport usersRoutes from \"./routes/users\";\n\n```sql\n\nE sotto le altre route:\r\n```sql\r\napp.use(\"/api/users\", usersRoutes);\r\n```sql","size_chars":191,"tokens_estimate":48}
{"doc_id":"ew-endp-003-get-crud-api-users","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/endp-003-get-crud-api-users.md","title":"ENDPOINT: CRUD `/api/users`","owner":"","tags":["domain/webapp","layer/reference","artifact/endpoint","audience/dev","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":8,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"index","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/index.md","title":"Indice","owner":"","tags":null,"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-19T22:31:54+02:00","section_level":2,"anchor_text":"Indice","anchor_slug":"indice","chunk_index":1,"content":"# Indice\n- [endp-001-get-api-config.md](./endp-001-get-api-config.md) - ENDPOINT: GET `/api/config`\n- [endp-001a-get-api-config-da-db.md](./endp-001a-get-api-config-da-db.md) - A. Codice - File da creare/aggiornare\n- [endp-002-get-api-branding.md](./endp-002-get-api-branding.md) - **1. `src/routes/branding.ts`**\n- [endp-003-get-crud-api-users.md](./endp-003-get-crud-api-users.md) - ENDPOINT: CRUD `/api/users`\n- [INDEX.md](./INDEX.md) - Indice\n- [Template-ENDPOINT.md](./Template-ENDPOINT.md) - ENDPOINT: [HTTP_VERB] `/api/your-endpoint`","size_chars":540,"tokens_estimate":135}
{"doc_id":"ew-template-endpoint","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/template-endpoint.md","title":"ENDPOINT: [HTTP_VERB] `/api/your-endpoint`","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"ENDPOINT: [HTTP_VERB] `/api/your-endpoint`\r","anchor_slug":"endpoint-httpverb-apiyour-endpoint","chunk_index":1,"content":"### ENDPOINT: [HTTP_VERB] `/api/your-endpoint`\n\n**Descrizione**\r\n> [Breve descrizione della funzione dell‚Äôendpoint.  \r\nEsempio: ‚ÄúRestituisce la configurazione di branding (colori, etichette, immagini, path) per il tenant corrente.‚Äù]\n\n---\n\n**Best Practice**\r\n- Validazione degli input (header, parametri, body) obbligatoria\r\n- L‚Äôheader `X-Tenant-Id` deve sempre essere presente e valido\r\n- Gestione esplicita degli errori (404 se config mancante, 400 su input errato, 500 per errori interni)\r\n- Risposta sempre in JSON, coerente con le tipizzazioni definite in `/types/config.d.ts`\r\n- Logging di accesso ed errori tramite logger centralizzato\r\n- Ogni endpoint deve poter essere testato tramite Postman/cURL (testabilit√† garantita)\n\n---\n\n**Cosa fa tecnicamente**\r\n1. Estrae il `tenantId` tramite middleware multi-tenant\r\n2. [Esegue le operazioni specifiche ‚Äî es: lettura config YAML, query DB, ecc.]\r\n3. Restituisce la risposta JSON strutturata (o errore gestito)\n\n---\n\n**Come si testa**\r\n- Avvia il backend (`npm run dev`)\r\n- Esegui una richiesta `[HTTP_VERB]` su `/api/your-endpoint`  \r\n  con header `X-Tenant-Id: [nome_tenant]`\r\n- [Se necessario: aggiungi body, querystring, ecc.]\r\n- Risposta attesa:  \r\n  ```json\r\n  {\r\n    // Esempio di risposta attesa\r\n  }\n\nRisposta in caso di errore:\r\n{\r\n  \"error\": \"Messaggio di errore\"\r\n}\n\nEsempio chiamata (curl/Postman)\r\ncurl -X [HTTP_VERB] \"http://localhost:3000/api/your-endpoint\" \\\r\n  -H \"X-Tenant-Id: tenant01\"\r\n  [--data '{\"param\": \"value\"}']\n\n\r\n---\n\n**Puoi copiarlo e riutilizzarlo identico per ogni endpoint futuro.  \r\nPronto a produrre subito il prossimo endpoint (es: GET `/api/config` da DB)?**\n\n```sql","size_chars":1654,"tokens_estimate":414}
{"doc_id":"ew-template-endpoint","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/template-endpoint.md","title":"ENDPOINT: [HTTP_VERB] `/api/your-endpoint`","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":2,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-come-si-testa","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/ENDPOINT/Template-ENDPOINT/come-si-testa.md","title":"Domande a cui risponde","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":1,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-automazione-export-log-su-datalake-e-compliance","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili/automazione-export-log-su-datalake-e-compliance.md","title":"Automazione export log su Datalake & Compliance","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Obiettivo\r","anchor_slug":"obiettivo","chunk_index":1,"content":"## Obiettivo\r\nCentralizzare e storicizzare i log business/audit esportandoli su Azure Datalake  \r\nin modo automatizzato, sicuro e compliant con policy GDPR, SOC2, DORA.\n\n---","size_chars":173,"tokens_estimate":43}
{"doc_id":"ew-automazione-export-log-su-datalake-e-compliance","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili/automazione-export-log-su-datalake-e-compliance.md","title":"Automazione export log su Datalake & Compliance","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Soluzione consigliata (EasyWay Data Portal)\r","anchor_slug":"soluzione-consigliata-easyway-data-portal","chunk_index":2,"content":"## Soluzione consigliata (EasyWay Data Portal)\n\n- **Pipeline Azure DevOps** che esegue periodicamente (es. ogni notte) un export automatico dei file log (`logs/business.log.json`) sul Datalake (`/portal-logs/`).\r\n- **Task di export** basato su [azcopy](https://learn.microsoft.com/en-us/azure/storage/common/storage-use-azcopy-v10)  \r\n  (CLI ufficiale Microsoft, auditata e supportata).\n\n---","size_chars":391,"tokens_estimate":98}
{"doc_id":"ew-automazione-export-log-su-datalake-e-compliance","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili/automazione-export-log-su-datalake-e-compliance.md","title":"Automazione export log su Datalake & Compliance","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Flusso tecnico\r","anchor_slug":"flusso-tecnico","chunk_index":3,"content":"## Flusso tecnico\n\n1. **Scrittura dei log**:  \r\n   Il backend scrive tutti i log business/audit in file JSON locali (`logs/business.log.json`).\r\n2. **Automazione export**:  \r\n   Una pipeline DevOps (o uno script schedulato) lancia azcopy per copiare i log sul container Datalake dedicato.\r\n3. **Sicurezza**:  \r\n   Solo l‚Äôidentit√† di servizio della pipeline pu√≤ scrivere su `/portal-logs/`.\r\n4. **Audit trail**:  \r\n   Ogni run della pipeline √® tracciata (chi, quando, esito) e auditabile via Azure DevOps.\n\n---","size_chars":509,"tokens_estimate":127}
{"doc_id":"ew-automazione-export-log-su-datalake-e-compliance","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili/automazione-export-log-su-datalake-e-compliance.md","title":"Automazione export log su Datalake & Compliance","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Snippet esempio pipeline (YAML)\r","anchor_slug":"snippet-esempio-pipeline-yaml","chunk_index":4,"content":"## Snippet esempio pipeline (YAML)\n\n```yaml\r\ntrigger: none\n\nschedules:\r\n  - cron: \"0 1 * * *\"  # Ogni notte alle 01:00\r\n    displayName: Export business log to Datalake\r\n    branches:\r\n      include: [\"main\"]\n\njobs:\r\n- job: ExportBusinessLog\r\n  pool:\r\n    vmImage: 'ubuntu-latest'\r\n  steps:\r\n  - script: |\r\n      azcopy copy \"logs/business.log.json\" \"https://NOMESTORAGE.dfs.core.windows.net/portal-logs/business_$(date +%Y%m%d).log.json\" --overwrite=true\r\n    displayName: 'Upload log su Datalake'\r\n    env:\r\n      AZCOPY_SPA_CLIENT_SECRET: $(AZCOPY_SPA_CLIENT_SECRET)\r\n```sql\n\nPolicy e best practice\r\n----------------------\n\n*   **Logga solo ci√≤ che serve, maschera tutto il resto.**\r\n    \r\n*   **Mai dati sensibili in chiaro**: i log su Datalake non devono contenere password, hash, dati personali non mascherati, info sensibili (vedi policy log).\r\n    \r\n*   **Tutto il workflow di export √® tracciato via pipeline,** con alert in caso di errore/fallimento.\r\n    \r\n*   **L‚Äôutenza di servizio usata da azcopy** √® segregata e ha solo i permessi minimi necessari.\r\n    \n\n* * *\n\nAlternative e note\r\n------------------\n\n*   Per esigenze ETL complesse o grandi volumi: valuta Azure Data Factory (ADF) per orchestrare export e trasformazioni log.\r\n    \r\n*   Composer/Airflow solo per ambienti gi√† maturi DataOps o multi-cloud.\r\n    \r\n*   Mai export ‚Äúa mano‚Äù: solo automazione tracciata.\r\n    \n\n* * *\n\nCompliance\r\n----------\n\n*   **Soluzione auditabile, tracciata e gestita via Azure AD** (RBAC, Managed Identity).\r\n    \r\n*   Retention su Datalake secondo policy di sicurezza/legale.\r\n    \r\n*   Allineata a best practice Microsoft, GDPR, SOC2, DORA.\r\n    \n\n* * *\n\n**Vedi anche:**\r\n*   Sezione ‚ÄúGestione Log‚Äù\r\n    \r\n*   Policy log dati sensibili","size_chars":1738,"tokens_estimate":434}
{"doc_id":"ew-automazione-export-log-su-datalake-e-compliance","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili/automazione-export-log-su-datalake-e-compliance.md","title":"Automazione export log su Datalake & Compliance","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":5,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-logging-conversational-ready-agent-aware","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili/logging-conversational-ready-agent-aware.md","title":"Logging conversational-ready (agent-aware)","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**C. Cosa fare lato chiamanti (frontend, agent, chatbot, orchestratori):**\r","anchor_slug":"c-cosa-fare-lato-chiamanti-frontend-agent-chatbot-orchestratori","chunk_index":1,"content":"### **C. Cosa fare lato chiamanti (frontend, agent, chatbot, orchestratori):**\r\n- Passa sempre header:\r\n  - `X-Origin`: chi sta chiamando (\"user\", \"agent\", \"ams\", \"api\", \"job\"‚Ä¶)\r\n  - `X-Agent-Id`: identificativo agente, se chiamata da agent/app\r\n  - `X-Conversation-Id`: se la chiamata fa parte di un workflow o conversazione bot\n\n---","size_chars":334,"tokens_estimate":84}
{"doc_id":"ew-logging-conversational-ready-agent-aware","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili/logging-conversational-ready-agent-aware.md","title":"Logging conversational-ready (agent-aware)","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**D. Dove integrare nel progetto**\r","anchor_slug":"d-dove-integrare-nel-progetto","chunk_index":2,"content":"### **D. Dove integrare nel progetto**\r\n- File modificati:\r\n  - `/src/controllers/onboardingController.ts`\r\n  - `/src/utils/logger.ts` (deve supportare campi aggiuntivi)\r\n  - `/README.md` e/o Wiki (sezione Logging agent-aware e Risposta standardizzata)\n\n---","size_chars":257,"tokens_estimate":64}
{"doc_id":"ew-logging-conversational-ready-agent-aware","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/gestione-log-and-policy-dati-sensibili/logging-conversational-ready-agent-aware.md","title":"Logging conversational-ready (agent-aware)","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":3,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-create-json","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-1-setup-ambiente/create-json.md","title":"EasyWay Data Portal API ‚Äî Starter Kit","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Comandi principali\r","anchor_slug":"comandi-principali","chunk_index":1,"content":"## Comandi principali\n\n- `npm install` ‚Äî installa tutte le dipendenze\r\n- `npm run dev` ‚Äî avvia il backend in modalit√† sviluppo (hot reload)\r\n- `npm run build` ‚Äî compila TypeScript in `/dist`\r\n- `npm start` ‚Äî avvia il backend dalla build","size_chars":236,"tokens_estimate":59}
{"doc_id":"ew-create-json","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-1-setup-ambiente/create-json.md","title":"EasyWay Data Portal API ‚Äî Starter Kit","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Struttura file configurazione\r","anchor_slug":"struttura-file-configurazione","chunk_index":2,"content":"## Struttura file configurazione\n\n- `/datalake-sample/branding.tenant01.yaml` ‚Äî esempio YAML branding\r\n- Tabella `PORTAL.CONFIGURATION` (solo DB) ‚Äî per parametri runtime (script SQL in chat DB)\r\n```sql\n\n**Dove va:**  \r\n`easyway-portal-api/README.md`  \r\n**A cosa serve:**  \r\nGuida rapida per sviluppatori (setup, build, configurazioni).\n\n* * *\n\n**4. `easyway-portal-api/datalake-sample/branding.tenant01.yaml`**\r\n------------------------------------------------------------------\n\n```sql\r\nbranding:\r\n  primary_color: \"#009FE3\"\r\n  secondary_color: \"#FFD900\"\r\n  background_image: \"/portal-assets/img/tenant01_bg.jpg\"\r\n  logo: \"/portal-assets/img/logo_tenant01.svg\"\r\n  font: \"Inter, Arial, sans-serif\"\n\nlabels:\r\n  portal_title: \"EasyWay Data Portal\"\r\n  login_button: \"Accedi\"\r\n  welcome_message: \"Benvenuto su EasyWay!\"\n\npaths:\r\n  official_data: \"/official/tenant01/\"\r\n  staging_data: \"/staging/tenant01/\"\r\n  portal_assets: \"/portal-assets/\"\n\n```sql\n\n**Dove va:**  \r\n`easyway-portal-api/datalake-sample/branding.tenant01.yaml`  \r\n**A cosa serve:**  \r\nEsempio/template file di branding e config UI per ogni tenant.  \r\n**In produzione:** verr√† copiato/gestito in Datalake, path es: `/portal-assets/config/branding.tenant01.yaml`\n\n* * *\n\n**5. Database (schema tabella di configurazione)**\r\n--------------------------------------------------\n\n**Non incluso qui!**  \r\nScript SQL **solo nella chat DB**:\n\n> **EasyWay DataPortal - DB (modello dati, schema, convenzioni)**","size_chars":1460,"tokens_estimate":365}
{"doc_id":"ew-create-json","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-1-setup-ambiente/create-json.md","title":"EasyWay Data Portal API ‚Äî Starter Kit","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":3,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-conversational-and-agent-aware-ready","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-2-struttura-src-e-primi-file/conversational-and-agent-aware-ready.md","title":"**. Controller**","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**. Controller**\r","anchor_slug":"controller","chunk_index":1,"content":"### **. Controller**\n\n\r\n```sql\r\nimport { Request, Response } from \"express\";\r\nimport sql from \"mssql\";\r\nimport { logger } from \"../utils/logger\";\n\nexport async function onboarding(req: Request, res: Response) {\r\n  const startTime = Date.now();\r\n  const pool = await sql.connect(process.env.DB_CONN_STRING!);\n\n  // Recupero header conversational/agent-aware\r\n  const origin = req.headers[\"x-origin\"] || \"api\"; // user, agent, ams, api...\r\n  const agent_id = req.headers[\"x-agent-id\"] || null;\r\n  const conversation_id = req.headers[\"x-conversation-id\"] || null;\n\n  try {\r\n    const {\r\n      tenant_name,\r\n      user_email,\r\n      display_name,\r\n      profile_id,\r\n      ext_attributes = {}\r\n    } = req.body;\n\n    // Chiamata store procedure di onboarding\r\n    const result = await pool.request()\r\n      .input(\"tenant_name\", sql.NVarChar, tenant_name)\r\n      .input(\"user_email\", sql.NVarChar, user_email)\r\n      .input(\"display_name\", sql.NVarChar, display_name)\r\n      .input(\"profile_id\", sql.NVarChar, profile_id)\r\n      .input(\"ext_attributes\", sql.NVarChar, JSON.stringify(ext_attributes))\r\n      .execute(\"PORTAL.sp_debug_register_tenant_and_user\");\n\n    const executionTime = Date.now() - startTime;\n\n    // Logging conversational/agent-aware\r\n    logger.info(\"Onboarding completato\", {\r\n      intent: \"ONBOARDING_TENANT_USER\",\r\n      origin,\r\n      agent_id,\r\n      user_id: result.recordset[0]?.user_id || null,\r\n      tenant_id: result.recordset[0]?.tenant_id || null,\r\n      conversation_id,\r\n      esito: \"success\",\r\n      executionTime,\r\n      context: { ...ext_attributes, source_ip: req.ip }\r\n    });\n\n    // Risposta standard conversational/agent-aware\r\n    res.status(201).json({\r\n      status: \"success\",\r\n      message: \"Onboarding completato\",\r\n      data: result.recordset,\r\n      intent: \"ONBOARDING_TENANT_USER\",\r\n      esito: \"success\",\r\n      conversation_id,\r\n      origin\r\n    });\n\n  } catch (err: any) {\r\n    logger.error(\"Errore onboarding\", {\r\n      intent: \"ONBOARDING_TENANT_USER\",\r\n      origin,\r\n      agent_id,\r\n      conversation_id,\r\n      user_email: req.body.user_email,\r\n      tenant_name: req.body.tenant_name,\r\n      esito: \"error\",\r\n      error: err.message,\r\n      context: { ...req.body.ext_attributes, source_ip: req.ip }\r\n    });","size_chars":2277,"tokens_estimate":569}
{"doc_id":"ew-conversational-and-agent-aware-ready","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-2-struttura-src-e-primi-file/conversational-and-agent-aware-ready.md","title":"**. Controller**","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**. Controller**\r","anchor_slug":"controller","chunk_index":2,"content":"    res.status(500).json({\r\n      status: \"error\",\r\n      message: err.message,\r\n      intent: \"ONBOARDING_TENANT_USER\",\r\n      esito: \"error\",\r\n      conversation_id,\r\n      origin\r\n    });\r\n  }\r\n}\r\n```sql","size_chars":206,"tokens_estimate":52}
{"doc_id":"ew-conversational-and-agent-aware-ready","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-2-struttura-src-e-primi-file/conversational-and-agent-aware-ready.md","title":"**. Controller**","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":3,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-query-in-src-queries","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-4-query-dinamiche-locale-datalake/query-in-src-queries.md","title":"Domande a cui risponde","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":1,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-validazione-avanzata","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-5-validazione-avanzata-dati-in-ingresso/validazione-avanzata.md","title":"**A. Middleware di validazione per parametri e querystring**","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**A. Middleware di validazione per parametri e querystring**\r","anchor_slug":"a-middleware-di-validazione-per-parametri-e-querystring","chunk_index":1,"content":"### **A. Middleware di validazione per parametri e querystring**\n\n#### **1. Middleware generico per parametri route e query**\n\n`src/middleware/validate.ts`  \r\n_(aggiungi queste funzioni accanto a `validateBody`)_\n\n```sql\r\nimport { ZodSchema } from \"zod\";\r\nimport { Request, Response, NextFunction } from \"express\";\n\n// Body gi√† visto prima\r\nexport function validateBody(schema: ZodSchema<any>) {\r\n  return (req: Request, res: Response, next: NextFunction) => {\r\n    const result = schema.safeParse(req.body);\r\n    if (!result.success) {\r\n      return res.status(400).json({ error: \"Validation failed\", details: result.error.errors });\r\n    }\r\n    req.body = result.data;\r\n    next();\r\n  };\r\n}\n\n// Querystring\r\nexport function validateQuery(schema: ZodSchema<any>) {\r\n  return (req: Request, res: Response, next: NextFunction) => {\r\n    const result = schema.safeParse(req.query);\r\n    if (!result.success) {\r\n      return res.status(400).json({ error: \"Invalid query parameters\", details: result.error.errors });\r\n    }\r\n    req.query = result.data;\r\n    next();\r\n  };\r\n}\n\n// Parametri di route (es: /api/users/:user_id)\r\nexport function validateParams(schema: ZodSchema<any>) {\r\n  return (req: Request, res: Response, next: NextFunction) => {\r\n    const result = schema.safeParse(req.params);\r\n    if (!result.success) {\r\n      return res.status(400).json({ error: \"Invalid route parameters\", details: result.error.errors });\r\n    }\r\n    req.params = result.data;\r\n    next();\r\n  };\r\n}\n\n```sql\n\n#### **2. Schema di validazione per parametri**\n\nEsempio per `user_id` (NDG alfanumerico):\r\n`src/validators/userValidator.ts`  \r\n_(aggiungi accanto agli altri schema)_\n\n```sql\r\nexport const userIdParamSchema = z.object({\r\n  user_id: z.string().min(6).max(32), // adatta a come hai impostato NDG\r\n});\n\n```sql\n\n#### **3. Schema di validazione per header**\n\nPer `X-Tenant-Id` puoi validare direttamente nel middleware  \r\n(oppure, se vuoi modularizzare, usa zod).","size_chars":1955,"tokens_estimate":489}
{"doc_id":"ew-validazione-avanzata","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-5-validazione-avanzata-dati-in-ingresso/validazione-avanzata.md","title":"**A. Middleware di validazione per parametri e querystring**","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**B. Esempio di applicazione nelle rotte**\r","anchor_slug":"b-esempio-di-applicazione-nelle-rotte","chunk_index":2,"content":"### **B. Esempio di applicazione nelle rotte**\n\n`src/routes/users.ts`\n\n```sql\r\nimport { Router } from \"express\";\r\nimport { getUsers, createUser, updateUser, deleteUser } from \"../controllers/usersController\";\r\nimport { validateBody, validateParams } from \"../middleware/validate\";\r\nimport { userCreateSchema, userUpdateSchema, userIdParamSchema } from \"../validators/userValidator\";\n\nconst router = Router();\n\nrouter.get(\"/\", getUsers);\n\nrouter.post(\"/\", validateBody(userCreateSchema), createUser);\n\nrouter.put(\r\n  \"/:user_id\",\r\n  validateParams(userIdParamSchema),\r\n  validateBody(userUpdateSchema),\r\n  updateUser\r\n);\n\nrouter.delete(\r\n  \"/:user_id\",\r\n  validateParams(userIdParamSchema),\r\n  deleteUser\r\n);\n\nexport default router;\n\n```sql","size_chars":739,"tokens_estimate":185}
{"doc_id":"ew-validazione-avanzata","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-5-validazione-avanzata-dati-in-ingresso/validazione-avanzata.md","title":"**A. Middleware di validazione per parametri e querystring**","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":3,"anchor_text":"**C. Validazione header (X-Tenant-Id)**\r","anchor_slug":"c-validazione-header-x-tenant-id","chunk_index":3,"content":"### **C. Validazione header (X-Tenant-Id)**\n\nNel middleware tenant, puoi aggiungere controllo pi√π robusto:\r\n`src/middleware/tenant.ts`\n\n```sql\r\nimport { Request, Response, NextFunction } from \"express\";\n\nexport function extractTenantId(req: Request, res: Response, next: NextFunction) {\r\n  const tenantId = req.header(\"X-Tenant-Id\");\r\n  if (!tenantId || tenantId.length < 3 || tenantId.length > 32) {\r\n    return res.status(400).json({ error: \"Invalid or missing X-Tenant-Id header\" });\r\n  }\r\n  (req as any).tenantId = tenantId;\r\n  next();\r\n}\n\n```sql","size_chars":550,"tokens_estimate":138}
{"doc_id":"ew-validazione-avanzata","path":"EasyWay_WebApp/05_codice_easyway_portale/easyway_portal_api/step-5-validazione-avanzata-dati-in-ingresso/validazione-avanzata.md","title":"**A. Middleware di validazione per parametri e querystring**","owner":"","tags":["","privacy/internal","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":4,"content":"## Domande a cui risponde\r\n- Cosa fa questa pagina?\r\n- Quali sono i prerequisiti?\r\n- Quali passi devo seguire?\r\n- Quali sono gli errori comuni?\r\n- Dove approfondire?","size_chars":165,"tokens_estimate":41}
{"doc_id":"ew-scripts","path":"scripts/scripts.md","title":"Scripts - One-shot e routine frequenti","owner":"team-docs","tags":["layer/how-to","automation","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"One-shot: rigenera tutto (root corrente)\r","anchor_slug":"one-shot-rigenera-tutto-root-corrente","chunk_index":1,"content":"## One-shot: rigenera tutto (root corrente)\r\n```powershell\r\n# 1) Naming + indici + anchor check\r\nEasyWayData.wiki/scripts/review-run.ps1 -Root EasyWayData.wiki -Mode kebab -CheckAnchors\n\n# 2) Entities index\r\n. EasyWayData.wiki/scripts/generate-entities-index.ps1 -Root EasyWayData.wiki\n\n# 3) Manifest (CSV/JSONL) + Anchors\r\n. EasyWayData.wiki/scripts/generate-master-index.ps1 -Root EasyWayData.wiki\n\n# 4) Export chunk atomici (H2/H3)\r\n. EasyWayData.wiki/scripts/export-chunks-jsonl.ps1 -Root EasyWayData.wiki\n\n# 5) Lint atomicit√†\r\n. EasyWayData.wiki/scripts/lint-atomicity.ps1 -Root EasyWayData.wiki\n\n# 6) Log\r\n. EasyWayData.wiki/scripts/add-log.ps1 -Type REVIEW -Scope full-rebuild -Status success -Owner team-docs -Message \"Rigenerazione completa indici/manifest/chunk/lint\" -Split monthly\r\n```","size_chars":797,"tokens_estimate":199}
{"doc_id":"ew-scripts","path":"scripts/scripts.md","title":"Scripts - One-shot e routine frequenti","owner":"team-docs","tags":["layer/how-to","automation","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Multi-root: aggrega pi√π progetti\r","anchor_slug":"multi-root-aggrega-pi-progetti","chunk_index":2,"content":"## Multi-root: aggrega pi√π progetti\r\n```powershell\r\n# Pre-requisito: genera gli artefatti per ogni root\r\n. EasyWayData.wiki/scripts/generate-master-index.ps1 -Root EasyWayData.wiki\r\n. EasyWayData.wiki/scripts/generate-master-index.ps1 -Root OtherWiki\n\n# Aggregazione in file *_all (nella workspace root)\r\n. EasyWayData.wiki/scripts/generate-master-index-aggregate.ps1 -Roots @('EasyWayData.wiki','OtherWiki')\r\n```","size_chars":413,"tokens_estimate":103}
{"doc_id":"ew-scripts","path":"scripts/scripts.md","title":"Scripts - One-shot e routine frequenti","owner":"team-docs","tags":["layer/how-to","automation","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Multi-root: normalizzazione (scan/apply) e report\r","anchor_slug":"multi-root-normalizzazione-scanapply-e-report","chunk_index":3,"content":"## Multi-root: normalizzazione (scan/apply) e report\r\n```powershell\r\n# Scansione senza modifiche (report per-root + sommario)\r\n. EasyWayData.wiki/scripts/normalize-project-multi.ps1 -Roots @('EasyWayData.wiki','OtherWiki') -Mode scan\n\n# Applicazione con front matter minimo dove manca\r\n. EasyWayData.wiki/scripts/normalize-project-multi.ps1 -Roots @('EasyWayData.wiki','OtherWiki') -Mode apply -EnsureFrontMatter\r\n```","size_chars":417,"tokens_estimate":104}
{"doc_id":"ew-scripts","path":"scripts/scripts.md","title":"Scripts - One-shot e routine frequenti","owner":"team-docs","tags":["layer/how-to","automation","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Job: Full‚Äëpass multi‚Äëroot (normalize ‚Üí rebuild ‚Üí lint)\r","anchor_slug":"job-fullpass-multiroot-normalize-rebuild-lint","chunk_index":4,"content":"## Job: Full‚Äëpass multi‚Äëroot (normalize ‚Üí rebuild ‚Üí lint)\r\n```powershell\r\n$roots = @('EasyWayData.wiki','OtherWiki')\n\n# 1) Normalizza tutte le radici\r\n. EasyWayData.wiki/scripts/normalize-project-multi.ps1 -Roots $roots -Mode apply -EnsureFrontMatter\n\n# 2) Rebuild artefatti e lint per ogni root\r\nforeach($r in $roots){\r\n  $rootPath = Resolve-Path $r\r\n  EasyWayData.wiki/scripts/review-run.ps1 -Root $rootPath -Mode kebab -CheckAnchors | Out-Host\r\n  . EasyWayData.wiki/scripts/generate-entities-index.ps1 -Root $rootPath | Out-Host\r\n  . EasyWayData.wiki/scripts/generate-master-index.ps1 -Root $rootPath | Out-Host\r\n  . EasyWayData.wiki/scripts/export-chunks-jsonl.ps1 -Root $rootPath | Out-Host\r\n  . EasyWayData.wiki/scripts/lint-atomicity.ps1 -Root $rootPath | Out-Host\r\n}\n\n# 3) Log finale\r\n. EasyWayData.wiki/scripts/add-log.ps1 -Type REVIEW -Scope full-pass-multi -Status success -Owner team-docs -Message \"Full pass multi-root: normalize+rebuild+lint\" -Split monthly\r\n```","size_chars":976,"tokens_estimate":244}
{"doc_id":"ew-scripts","path":"scripts/scripts.md","title":"Scripts - One-shot e routine frequenti","owner":"team-docs","tags":["layer/how-to","automation","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Utility: aggiungi front matter mancante\r","anchor_slug":"utility-aggiungi-front-matter-mancante","chunk_index":5,"content":"## Utility: aggiungi front matter mancante\r\n```powershell\r\n. EasyWayData.wiki/scripts/bulk-frontmatter.ps1 -Root EasyWayData.wiki -DefaultTag 'layer/reference'\r\n```","size_chars":164,"tokens_estimate":41}
{"doc_id":"ew-scripts","path":"scripts/scripts.md","title":"Scripts - One-shot e routine frequenti","owner":"team-docs","tags":["layer/how-to","automation","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Log attivit√† (esempio)\r","anchor_slug":"log-attivit-esempio","chunk_index":6,"content":"## Log attivit√† (esempio)\r\n```powershell\r\n. EasyWayData.wiki/scripts/add-log.ps1 -Type DOC -Scope wiki -Status success -Owner team-docs -Message \"Aggiornata guida scripts\"\r\n```","size_chars":176,"tokens_estimate":44}
{"doc_id":"ew-scripts","path":"scripts/scripts.md","title":"Scripts - One-shot e routine frequenti","owner":"team-docs","tags":["layer/how-to","automation","language/it"],"entities":null,"llm.include":"","llm.pii":"","chunk_hint":"","updated":"2025-10-18T20:50:50+02:00","section_level":2,"anchor_text":"Domande a cui risponde\r","anchor_slug":"domande-a-cui-risponde","chunk_index":7,"content":"## Domande a cui risponde\r\n- Quali script usare per normalizzare e ricostruire la wiki?\r\n- Come eseguire le routine multi-root e generare report?\r\n- Dove trovare esempi one-shot e job completi?\r\n- Come tracciare i risultati nei log?","size_chars":232,"tokens_estimate":58}
