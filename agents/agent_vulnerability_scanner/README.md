# Agent Vulnerability Scanner

**Version:** 2.0.0
**Evolution Level:** 2 (LLM-powered)
**LLM Provider:** DeepSeek (deepseek-chat)
**Status:** Production Ready
**Owner:** team-platform

---

## Overview

Security scanner agent che esegue scansioni giornaliere e usa DeepSeek LLM per analisi intelligente dei risultati.

**Capabilities:**
- CVE Detection su Docker images
- EOL Monitoring via endoflife.date API
- Version Compatibility check (compatibility-matrix.json)
- NPM/Python dependency audit
- **LLM Analysis** - DeepSeek analizza i risultati e genera raccomandazioni prioritizzate

## Quick Start

```powershell
# Full scan con analisi LLM
./scripts/pwsh/agent-vulnerability-scanner.ps1 -Mode full -OutputFormat markdown

# Quick scan (no LLM)
./scripts/pwsh/agent-vulnerability-scanner.ps1 -Mode quick

# Solo compatibilita
./scripts/pwsh/agent-vulnerability-scanner.ps1 -Mode compatibility-only -DryRun
```

## File Structure

```
agents/agent_vulnerability_scanner/
├── manifest.json                 # Agent config v2.0 (con llm_config)
├── priority.json                 # Validation rules & guardrails
├── PROMPTS.md                    # System prompt per DeepSeek
├── README.md                     # This file
├── compatibility-matrix.json     # Version compatibility rules
├── memory/
│   └── context.json              # Agent memory (stats, knowledge, llm_usage)
└── templates/
    ├── intent.vuln-scan-full.sample.json
    ├── intent.vuln-scan-quick.sample.json
    └── intent.vuln-scan-compatibility.sample.json
```

## LLM Integration (Level 2)

Questo agent usa **DeepSeek Chat** per analisi post-scan:

| Aspetto | Valore |
|---------|--------|
| Provider | DeepSeek |
| Model | deepseek-chat |
| Cost per call | ~$0.00025 |
| Monthly estimate | ~$0.03 |
| Temperature | 0.1 (deterministic) |
| Max tokens | 1000 |

### Come funziona

1. Lo scanner raccoglie dati (CVE, EOL, compatibility)
2. I risultati vengono passati a DeepSeek con il system prompt da PROMPTS.md
3. DeepSeek analizza, prioritizza e genera raccomandazioni in italiano
4. L'output LLM viene aggiunto al report finale

### Costi

Con 1 scan/giorno: **~$0.03/mese** (praticamente gratis).
Servirebbero 4 milioni di scan per spendere $1.000.

## Actions

| Action | Description | LLM |
|--------|-------------|-----|
| `vuln-scan:full` | Scan completa + analisi LLM | Si |
| `vuln-scan:quick` | EOL + compatibility only | No |
| `vuln-scan:compatibility-only` | Solo matrix check | No |

## Guardrails (priority.json)

- **Read-only**: mai modificare sistemi di produzione
- **No secrets in output**: API keys e credenziali mascherate
- **LLM cost guard**: max 1 chiamata per scan, max 1000 tokens
- **Critical alert**: findings critici triggerano alert immediato

## Migration from v1.0

Migrated from `.agent/workflows/agent_vulnerability_scanner/` (v1.0 prototype) to `agents/agent_vulnerability_scanner/` (v2.0 standard).

Changes:
- Added `llm_config` with DeepSeek integration
- Added `skills_required` / `skills_optional`
- Added `priority.json` guardrails
- Added intent templates
- Enhanced `memory/context.json` with knowledge tracking
- Follows `agent_template` standard structure
