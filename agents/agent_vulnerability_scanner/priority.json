{
  "id": "agent_vulnerability_scanner",
  "priority": [
    { "action": "vuln-scan:full", "weight": 1.0 },
    { "action": "vuln-scan:quick", "weight": 0.7 },
    { "action": "vuln-scan:compatibility-only", "weight": 0.5 }
  ],
  "rules": [
    {
      "id": "no-destructive-actions",
      "description": "Scanner is read-only, never modify production systems",
      "severity": "mandatory",
      "when": { "always": true },
      "checklist": [
        "Non eseguire mai docker rm/stop/restart",
        "Non modificare configurazioni di produzione",
        "Solo operazioni di lettura: inspect, version, ls"
      ]
    },
    {
      "id": "no-secrets-in-output",
      "description": "Never include secrets or API keys in reports",
      "severity": "mandatory",
      "when": { "intentContains": ["vuln-scan:full", "vuln-scan:quick"] },
      "checklist": [
        "Non includere API keys nei report",
        "Non loggare credenziali SSH",
        "Mascherare IP interni se il report Ã¨ pubblico"
      ]
    },
    {
      "id": "llm-cost-guard",
      "description": "Limit LLM API calls to control costs",
      "severity": "warning",
      "when": { "intentContains": ["vuln-scan:full"] },
      "checklist": [
        "Max 1 chiamata LLM per scansione",
        "Max 1000 tokens di output per chiamata",
        "Usare cache se scan identica nelle ultime 6 ore"
      ]
    },
    {
      "id": "critical-immediate-alert",
      "description": "CRITICAL findings must trigger immediate notification",
      "severity": "mandatory",
      "when": { "severity_found": "critical" },
      "checklist": [
        "Inviare alert Slack immediatamente",
        "Inviare email al team DevOps",
        "Non attendere la fine della scansione completa"
      ]
    }
  ]
}
