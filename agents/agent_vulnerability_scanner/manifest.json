{
  "id": "agent_vulnerability_scanner",
  "name": "agent_vulnerability_scanner",
  "role": "Agent_Vulnerability_Scanner",
  "description": "Daily security scanner for CVEs, EOL dates, version compatibility, and certificate expiry. Level 2 agent with DeepSeek LLM-powered analysis.",
  "owner": "team-platform",
  "version": "2.0.0",
  "classification": "arm",
  "evolution_level": 2,

  "llm_config": {
    "provider": "deepseek",
    "model": "deepseek-chat",
    "api_base": "https://api.deepseek.com",
    "temperature": 0.1,
    "max_tokens": 1000,
    "system_prompt": "agents/agent_vulnerability_scanner/PROMPTS.md",
    "tools": ["function_calling"],
    "cost_estimate": {
      "per_call": "$0.00025",
      "daily_scan": "$0.001",
      "monthly": "$0.03"
    },
    "usage": {
      "analyze_scan_results": "Post-scan analysis with prioritized recommendations",
      "suggest_remediation": "Context-aware fix suggestions based on stack",
      "risk_assessment": "Combined risk evaluation of multiple findings"
    }
  },

  "context_config": {
    "memory_files": [
      "agents/agent_vulnerability_scanner/memory/context.json",
      "agents/agent_vulnerability_scanner/compatibility-matrix.json"
    ],
    "context_limit_tokens": 128000
  },

  "skills_required": [
    "security.cve-scan",
    "utilities.version-compatibility"
  ],

  "skills_optional": [
    "security.secret-vault",
    "observability.health-check",
    "integration.slack-message",
    "utilities.convert-markdown",
    "utilities.retry-backoff",
    "retrieval.llm-with-rag",
    "retrieval.rag-search"
  ],

  "rag_config": {
    "enabled": true,
    "collection": "easyway_wiki",
    "top_k": 3,
    "min_score": 0.3,
    "context_domains": ["security", "hardening", "deployment", "cve"],
    "description": "RAG provides Wiki context for vulnerability remediation and security hardening recommendations"
  },

  "allowed_tools": ["pwsh", "ssh", "curl", "docker"],

  "actions": [
    {
      "name": "vuln-scan:full",
      "description": "Full scan: CVE + EOL + compatibility + NPM audit + LLM analysis",
      "uses_skills": ["security.cve-scan", "utilities.version-compatibility"],
      "params": {
        "output_format": { "type": "string", "enum": ["json", "markdown", "slack"], "default": "markdown" },
        "llm_analysis": { "type": "boolean", "default": true }
      }
    },
    {
      "name": "vuln-scan:quick",
      "description": "Quick scan: compatibility + EOL check only",
      "uses_skills": ["utilities.version-compatibility"],
      "params": {
        "output_format": { "type": "string", "enum": ["json", "markdown"], "default": "markdown" }
      }
    },
    {
      "name": "vuln-scan:compatibility-only",
      "description": "Version compatibility matrix check only",
      "uses_skills": ["utilities.version-compatibility"],
      "params": {}
    }
  ],

  "allowed_paths": {
    "read": [
      "agents/",
      "Wiki/EasyWayData.wiki/security/",
      "scripts/pwsh/"
    ],
    "write": [
      "Wiki/EasyWayData.wiki/security/",
      "agents/agent_vulnerability_scanner/memory/"
    ]
  },

  "required_gates": ["KB_Consistency"],

  "knowledge_sources": [
    {
      "priority": "high",
      "path": "agents/agent_vulnerability_scanner/compatibility-matrix.json",
      "type": "data"
    },
    {
      "priority": "medium",
      "path": "Wiki/EasyWayData.wiki/Q-A-deployment-security-hardening.md",
      "type": "document"
    }
  ],

  "schedule": {
    "cron": "0 6 * * *",
    "timezone": "Europe/Rome",
    "description": "Daily at 6:00 AM"
  },

  "integrations": {
    "n8n": {
      "workflow_id": "vulnerability_scanner_daily",
      "webhook_url": "/webhook/security-scan"
    },
    "notification_channels": {
      "critical": ["slack", "email", "pagerduty"],
      "high": ["slack", "email"],
      "medium": ["slack"],
      "low": ["wiki_report"]
    }
  },

  "severity_thresholds": {
    "critical": { "cvss_score": ">=9.0", "eol_days_remaining": "<=7", "action": "immediate_alert" },
    "high": { "cvss_score": ">=7.0", "eol_days_remaining": "<=30", "action": "alert_and_report" },
    "medium": { "cvss_score": ">=4.0", "eol_days_remaining": "<=90", "action": "daily_report" },
    "low": { "cvss_score": "<4.0", "eol_days_remaining": ">90", "action": "weekly_summary" }
  },

  "error_handling": {
    "retry_count": 3,
    "retry_delay_seconds": 60,
    "fallback_mode": "use_cached_data",
    "alert_on_failure": true
  },

  "readme": "README.md"
}
