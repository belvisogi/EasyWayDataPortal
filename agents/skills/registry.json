{
  "version": "2.10.0",
  "last_updated": "2026-02-28T16:00:00Z",
  "skills": [
    {
      "id": "security.cve-scan",
      "name": "Invoke-CVEScan",
      "domain": "security",
      "file": "skills/security/Invoke-CVEScan.ps1",
      "version": "1.0.0",
      "description": "Scan Docker images for CVE vulnerabilities using Docker Scout, Snyk, or Trivy",
      "parameters": [
        {
          "name": "ImageName",
          "type": "string",
          "required": true,
          "description": "Docker image to scan"
        },
        {
          "name": "Scanner",
          "type": "string",
          "required": false,
          "default": "docker-scout",
          "enum": [
            "docker-scout",
            "snyk",
            "trivy"
          ]
        },
        {
          "name": "FailOnSeverity",
          "type": "string",
          "required": false,
          "default": "none",
          "enum": [
            "critical",
            "high",
            "medium",
            "low",
            "none"
          ]
        },
        {
          "name": "OutputFormat",
          "type": "string",
          "required": false,
          "default": "object",
          "enum": [
            "object",
            "json"
          ]
        }
      ],
      "returns": {
        "type": "object",
        "description": "CVE scan results for the specified Docker image",
        "output_fields": [
          {
            "name": "image",
            "type": "string",
            "description": "Image name scanned"
          },
          {
            "name": "scanner",
            "type": "string",
            "description": "Scanner used"
          },
          {
            "name": "critical",
            "type": "integer",
            "description": "Count of CRITICAL CVEs"
          },
          {
            "name": "high",
            "type": "integer",
            "description": "Count of HIGH CVEs"
          },
          {
            "name": "medium",
            "type": "integer",
            "description": "Count of MEDIUM CVEs"
          },
          {
            "name": "low",
            "type": "integer",
            "description": "Count of LOW CVEs"
          },
          {
            "name": "passed",
            "type": "boolean",
            "description": "True if below FailOnSeverity threshold"
          },
          {
            "name": "raw",
            "type": "object",
            "description": "Full scanner output"
          }
        ]
      },
      "dependencies": [
        "docker",
        "docker-scout OR snyk OR trivy"
      ],
      "tags": [
        "security",
        "cve",
        "docker",
        "vulnerability",
        "scanning"
      ],
      "security": {
        "requires_approval": false,
        "blast_radius": "LOW",
        "audit_log": true,
        "allowed_callers": [
          "agent_vulnerability_scanner",
          "agent_security"
        ]
      }
    },
    {
      "id": "security.secret-vault",
      "name": "Invoke-SecretVault",
      "domain": "security",
      "file": "skills/security/Invoke-SecretVault.ps1",
      "version": "1.0.0",
      "description": "Manage secrets in Azure Key Vault (set, reference, list, rotate)",
      "parameters": [
        {
          "name": "Operation",
          "type": "string",
          "required": true,
          "enum": [
            "set",
            "reference",
            "list",
            "rotate"
          ]
        },
        {
          "name": "VaultName",
          "type": "string",
          "required": true
        },
        {
          "name": "SecretName",
          "type": "string",
          "required": false
        },
        {
          "name": "SecretValue",
          "type": "string",
          "required": false
        },
        {
          "name": "Tags",
          "type": "hashtable",
          "required": false
        }
      ],
      "returns": {
        "type": "object",
        "description": "Result of the Key Vault operation",
        "output_fields": [
          {
            "name": "operation",
            "type": "string",
            "description": "Operation performed (set/reference/list/rotate)"
          },
          {
            "name": "secretName",
            "type": "string",
            "description": "Secret name involved"
          },
          {
            "name": "vaultUri",
            "type": "string",
            "description": "Key Vault URI"
          },
          {
            "name": "secrets",
            "type": "array",
            "description": "List of secret names (list operation only)"
          }
        ]
      },
      "dependencies": [
        "az"
      ],
      "tags": [
        "security",
        "keyvault",
        "secrets",
        "azure"
      ],
      "security": {
        "requires_approval": true,
        "blast_radius": "MEDIUM",
        "audit_log": true,
        "allowed_callers": [
          "agent_security"
        ]
      }
    },
    {
      "id": "utilities.version-compatibility",
      "name": "Test-VersionCompatibility",
      "domain": "utilities",
      "file": "skills/utilities/Test-VersionCompatibility.ps1",
      "version": "1.0.0",
      "description": "Check version compatibility against compatibility matrix rules",
      "parameters": [
        {
          "name": "Component",
          "type": "string",
          "required": true
        },
        {
          "name": "Version",
          "type": "string",
          "required": true
        },
        {
          "name": "MatrixFile",
          "type": "string",
          "required": false,
          "default": "./compatibility-matrix.json"
        },
        {
          "name": "CurrentVersions",
          "type": "hashtable",
          "required": false
        }
      ],
      "returns": {
        "type": "object",
        "description": "Compatibility check result for the specified component and version",
        "output_fields": [
          {
            "name": "component",
            "type": "string",
            "description": "Component name checked"
          },
          {
            "name": "version",
            "type": "string",
            "description": "Version checked"
          },
          {
            "name": "compatible",
            "type": "boolean",
            "description": "True if version is compatible"
          },
          {
            "name": "conflicts",
            "type": "array",
            "description": "List of conflicting components/versions"
          },
          {
            "name": "recommendation",
            "type": "string",
            "description": "Suggested compatible version if conflict found"
          }
        ]
      },
      "dependencies": [],
      "tags": [
        "compatibility",
        "version",
        "validation"
      ],
      "security": {
        "requires_approval": false,
        "blast_radius": "LOW",
        "audit_log": false,
        "allowed_callers": [
          "*"
        ]
      }
    },
    {
      "id": "utilities.retry-backoff",
      "name": "Invoke-RetryBackoff",
      "domain": "utilities",
      "file": "skills/utilities/Invoke-RetryBackoff.ps1",
      "version": "1.0.0",
      "description": "Execute a script block with retry and exponential backoff",
      "parameters": [
        {
          "name": "ScriptBlock",
          "type": "scriptblock",
          "required": true
        },
        {
          "name": "MaxRetries",
          "type": "integer",
          "required": false,
          "default": 3
        },
        {
          "name": "InitialDelay",
          "type": "integer",
          "required": false,
          "default": 2
        },
        {
          "name": "MaxDelay",
          "type": "integer",
          "required": false,
          "default": 60
        },
        {
          "name": "RetryableErrors",
          "type": "array",
          "required": false
        }
      ],
      "returns": {
        "type": "object",
        "description": "Result of the script block execution after retries",
        "output_fields": [
          {
            "name": "result",
            "type": "object",
            "description": "Return value of the ScriptBlock on success"
          },
          {
            "name": "attempts",
            "type": "integer",
            "description": "Number of attempts made (1 = success on first try)"
          },
          {
            "name": "totalDurationSec",
            "type": "number",
            "description": "Total elapsed time including waits"
          },
          {
            "name": "lastError",
            "type": "string",
            "description": "Last error message if all retries exhausted"
          }
        ]
      },
      "dependencies": [],
      "tags": [
        "retry",
        "backoff",
        "resilience",
        "error-handling"
      ],
      "security": {
        "requires_approval": false,
        "blast_radius": "LOW",
        "audit_log": false,
        "allowed_callers": [
          "*"
        ]
      }
    },
    {
      "id": "utilities.convert-markdown",
      "name": "ConvertTo-MarkdownReport",
      "domain": "utilities",
      "file": "skills/utilities/ConvertTo-MarkdownReport.ps1",
      "version": "1.0.0",
      "description": "Convert structured data to formatted Markdown report",
      "parameters": [
        {
          "name": "Data",
          "type": "object",
          "required": true
        },
        {
          "name": "Title",
          "type": "string",
          "required": false,
          "default": "Report"
        },
        {
          "name": "Format",
          "type": "string",
          "required": false,
          "default": "markdown",
          "enum": [
            "markdown",
            "console",
            "json"
          ]
        },
        {
          "name": "IncludeTimestamp",
          "type": "boolean",
          "required": false,
          "default": true
        }
      ],
      "returns": {
        "type": "object",
        "description": "Formatted report in the requested output format",
        "output_fields": [
          {
            "name": "content",
            "type": "string",
            "description": "Formatted report content (markdown/console/json)"
          },
          {
            "name": "title",
            "type": "string",
            "description": "Report title used"
          },
          {
            "name": "format",
            "type": "string",
            "description": "Output format used"
          },
          {
            "name": "generatedAt",
            "type": "string",
            "description": "ISO timestamp of report generation"
          }
        ]
      },
      "dependencies": [],
      "tags": [
        "markdown",
        "report",
        "formatting",
        "export"
      ],
      "security": {
        "requires_approval": false,
        "blast_radius": "LOW",
        "audit_log": false,
        "allowed_callers": [
          "*"
        ]
      }
    },
    {
      "id": "utilities.json-validate",
      "name": "Test-JsonValid",
      "domain": "utilities",
      "file": "skills/utilities/Test-JsonValid.ps1",
      "version": "1.0.0",
      "description": "Validate JSON files for syntax, required fields, and schema compliance",
      "parameters": [
        {
          "name": "Path",
          "type": "string",
          "required": false
        },
        {
          "name": "Content",
          "type": "string",
          "required": false
        },
        {
          "name": "RequiredFields",
          "type": "array",
          "required": false
        },
        {
          "name": "SchemaPath",
          "type": "string",
          "required": false
        }
      ],
      "returns": {
        "type": "object",
        "description": "JSON validation result with errors and field coverage",
        "output_fields": [
          {
            "name": "valid",
            "type": "boolean",
            "description": "True if JSON is syntactically valid and passes all checks"
          },
          {
            "name": "errors",
            "type": "array",
            "description": "List of validation errors (syntax, missing fields, schema)"
          },
          {
            "name": "missingFields",
            "type": "array",
            "description": "Required fields not found in the JSON"
          },
          {
            "name": "schemaViolations",
            "type": "array",
            "description": "Schema constraint violations (if SchemaPath provided)"
          }
        ]
      },
      "dependencies": [],
      "tags": [
        "json",
        "validation",
        "schema",
        "manifest"
      ],
      "security": {
        "requires_approval": false,
        "blast_radius": "LOW",
        "audit_log": false,
        "allowed_callers": [
          "*"
        ]
      }
    },
    {
      "id": "utilities.import-secrets",
      "name": "Import-AgentSecrets",
      "domain": "utilities",
      "file": "skills/utilities/Import-AgentSecrets.ps1",
      "version": "1.0.0",
      "description": "Loads platform secrets from .env.secrets into process environment (idempotent, non-destructive). Single entry point for secrets in all agent runners. No-op if env vars already set (container/CI scenario).",
      "parameters": [
        {
          "name": "SecretsFile",
          "type": "string",
          "required": false,
          "default": "/opt/easyway/.env.secrets (Linux) or $USERPROFILE\\.easyway\\secrets (Windows)",
          "description": "Path to .env-format secrets file. Override for CI or testing."
        }
      ],
      "returns": {
        "type": "hashtable",
        "description": "Keys loaded during this call (values masked as '***'). Empty if all keys already set or file not found.",
        "output_fields": [
          {
            "name": "<KEY_NAME>",
            "type": "string",
            "description": "'***' for each secret key loaded (value never logged)"
          }
        ]
      },
      "dependencies": [],
      "tags": [
        "secrets",
        "environment",
        "bootstrap",
        "security",
        "idempotent"
      ],
      "security": {
        "requires_approval": false,
        "blast_radius": "LOW",
        "audit_log": false,
        "allowed_callers": [
          "*"
        ],
        "notes": "Never logs actual secret values. Non-destructive: only sets vars not already present."
      }
    },
    {
      "id": "observability.health-check",
      "name": "Invoke-HealthCheck",
      "domain": "observability",
      "file": "skills/observability/Invoke-HealthCheck.ps1",
      "version": "1.0.0",
      "description": "Check health of Docker containers and services",
      "parameters": [
        {
          "name": "Target",
          "type": "string",
          "required": false,
          "default": "all"
        },
        {
          "name": "Timeout",
          "type": "integer",
          "required": false,
          "default": 10
        }
      ],
      "returns": {
        "type": "object",
        "description": "Health status of containers and services",
        "output_fields": [
          {
            "name": "healthy",
            "type": "boolean",
            "description": "True if all checked services are healthy"
          },
          {
            "name": "services",
            "type": "array",
            "description": "Per-service health results (name, status, uptime)"
          },
          {
            "name": "unhealthyCount",
            "type": "integer",
            "description": "Number of services in unhealthy state"
          },
          {
            "name": "checkedAt",
            "type": "string",
            "description": "ISO timestamp of the check"
          }
        ]
      },
      "dependencies": [
        "docker"
      ],
      "tags": [
        "health",
        "monitoring",
        "containers",
        "observability"
      ],
      "security": {
        "requires_approval": false,
        "blast_radius": "LOW",
        "audit_log": true,
        "allowed_callers": [
          "agent_observability",
          "agent_infra",
          "agent_security"
        ]
      }
    },
    {
      "id": "integration.slack-message",
      "name": "Send-SlackMessage",
      "domain": "integration",
      "file": "skills/integration/Send-SlackMessage.ps1",
      "version": "1.0.0",
      "description": "Send formatted messages to Slack via webhook",
      "parameters": [
        {
          "name": "WebhookUrl",
          "type": "string",
          "required": false
        },
        {
          "name": "Message",
          "type": "string",
          "required": true
        },
        {
          "name": "Channel",
          "type": "string",
          "required": false
        },
        {
          "name": "Severity",
          "type": "string",
          "required": false,
          "default": "info",
          "enum": [
            "info",
            "warning",
            "error",
            "critical"
          ]
        }
      ],
      "returns": {
        "type": "object",
        "description": "Result of the Slack message delivery",
        "output_fields": [
          {
            "name": "delivered",
            "type": "boolean",
            "description": "True if Slack returned HTTP 200"
          },
          {
            "name": "channel",
            "type": "string",
            "description": "Channel the message was sent to"
          },
          {
            "name": "httpStatus",
            "type": "integer",
            "description": "HTTP response status from Slack webhook"
          },
          {
            "name": "timestamp",
            "type": "string",
            "description": "ISO timestamp of send attempt"
          }
        ]
      },
      "dependencies": [],
      "tags": [
        "slack",
        "notification",
        "messaging",
        "alert"
      ],
      "security": {
        "requires_approval": false,
        "blast_radius": "LOW",
        "audit_log": true,
        "allowed_callers": [
          "*"
        ]
      }
    },
    {
      "id": "retrieval.rag-search",
      "name": "Invoke-RAGSearch",
      "domain": "retrieval",
      "file": "skills/retrieval/Invoke-RAGSearch.ps1",
      "version": "1.0.0",
      "description": "Search the EasyWay Wiki using RAG (Qdrant)",
      "parameters": [
        {
          "name": "Query",
          "type": "string",
          "required": true
        },
        {
          "name": "Limit",
          "type": "integer",
          "required": false,
          "default": 3
        }
      ],
      "returns": {
        "type": "object",
        "description": "Ranked Wiki chunks matching the query",
        "output_fields": [
          {
            "name": "chunks",
            "type": "array",
            "description": "Array of matching chunks (text, source, score)"
          },
          {
            "name": "count",
            "type": "integer",
            "description": "Number of chunks returned"
          },
          {
            "name": "queryEmbeddingMs",
            "type": "integer",
            "description": "Time to embed the query in ms"
          }
        ]
      },
      "dependencies": [
        "python3",
        "qdrant-client"
      ],
      "tags": [
        "rag",
        "search",
        "wiki",
        "qdrant"
      ],
      "security": {
        "requires_approval": false,
        "blast_radius": "LOW",
        "audit_log": false,
        "allowed_callers": [
          "*"
        ]
      }
    },
    {
      "id": "retrieval.rag-enhanced-prompt",
      "name": "Invoke-RAGEnhancedPrompt",
      "domain": "retrieval",
      "file": "skills/retrieval/Invoke-RAGEnhancedPrompt.ps1",
      "version": "1.0.0",
      "description": "Enhance LLM prompts with RAG context from Wiki knowledge base",
      "parameters": [
        {
          "name": "Query",
          "type": "string",
          "required": true,
          "description": "User query to enhance"
        },
        {
          "name": "Limit",
          "type": "integer",
          "required": false,
          "default": 3,
          "description": "Max RAG chunks to retrieve"
        },
        {
          "name": "SystemPrompt",
          "type": "string",
          "required": false,
          "description": "Base system prompt to enhance"
        }
      ],
      "returns": {
        "type": "object",
        "description": "Enhanced prompt with injected Wiki context ready for LLM consumption",
        "output_fields": [
          {
            "name": "EnhancedPrompt",
            "type": "string",
            "description": "System prompt with RAG context injected"
          },
          {
            "name": "RAGResultCount",
            "type": "integer",
            "description": "Number of Wiki chunks injected"
          },
          {
            "name": "Sources",
            "type": "array",
            "description": "Source file paths for the injected chunks"
          },
          {
            "name": "Success",
            "type": "boolean",
            "description": "True if RAG retrieval succeeded"
          }
        ]
      },
      "dependencies": [
        "python3",
        "qdrant-client",
        "deepseek-api"
      ],
      "tags": [
        "rag",
        "llm",
        "prompt-engineering",
        "context"
      ],
      "security": {
        "requires_approval": false,
        "blast_radius": "LOW",
        "audit_log": false,
        "allowed_callers": [
          "*"
        ]
      }
    },
    {
      "id": "retrieval.rag-query-rewriter",
      "name": "Invoke-RAGQueryRewriter",
      "domain": "retrieval",
      "file": "skills/retrieval/Invoke-RAGQueryRewriter.ps1",
      "version": "1.0.0",
      "description": "Optimize RAG queries using pattern-based rewriting for better hit rate",
      "parameters": [
        {
          "name": "Query",
          "type": "string",
          "required": true,
          "description": "Original query to optimize"
        },
        {
          "name": "MaxVariants",
          "type": "integer",
          "required": false,
          "default": 3,
          "description": "Max query variants to generate"
        }
      ],
      "returns": {
        "type": "object",
        "description": "Rewritten query variants for improved RAG hit rate",
        "output_fields": [
          {
            "name": "original",
            "type": "string",
            "description": "Original query as provided"
          },
          {
            "name": "variants",
            "type": "array",
            "description": "Array of rewritten query strings"
          },
          {
            "name": "bestVariant",
            "type": "string",
            "description": "Recommended query variant for primary search"
          }
        ]
      },
      "dependencies": [],
      "tags": [
        "rag",
        "query-optimization",
        "search",
        "antifragile"
      ],
      "security": {
        "requires_approval": false,
        "blast_radius": "LOW",
        "audit_log": false,
        "allowed_callers": [
          "*"
        ]
      }
    },
    {
      "id": "database.migration",
      "name": "Invoke-DatabaseMigration",
      "domain": "database",
      "file": "skills/database/Invoke-DatabaseMigration.ps1",
      "version": "1.0.0",
      "description": "Execute database migrations with rollback support",
      "parameters": [
        {
          "name": "MigrationFile",
          "type": "string",
          "required": true
        },
        {
          "name": "Rollback",
          "type": "boolean",
          "required": false,
          "default": false
        },
        {
          "name": "DryRun",
          "type": "boolean",
          "required": false,
          "default": false
        }
      ],
      "returns": {
        "type": "object",
        "description": "Database migration execution result",
        "output_fields": [
          {
            "name": "migrationFile",
            "type": "string",
            "description": "Path to the migration file executed"
          },
          {
            "name": "applied",
            "type": "boolean",
            "description": "True if migration was successfully applied"
          },
          {
            "name": "rolledBack",
            "type": "boolean",
            "description": "True if rollback was performed"
          },
          {
            "name": "dryRun",
            "type": "boolean",
            "description": "True if executed in dry-run mode (no changes)"
          },
          {
            "name": "sqlOutput",
            "type": "string",
            "description": "Raw SQL execution output"
          },
          {
            "name": "durationMs",
            "type": "integer",
            "description": "Execution time in milliseconds"
          }
        ]
      },
      "dependencies": [
        "sqlcmd",
        "az"
      ],
      "tags": [
        "database",
        "migration",
        "sql",
        "schema"
      ],
      "security": {
        "requires_approval": true,
        "blast_radius": "HIGH",
        "audit_log": true,
        "allowed_callers": [
          "agent_dba"
        ]
      }
    },
    {
      "id": "database.test-connection",
      "name": "Test-DatabaseConnection",
      "domain": "database",
      "file": "skills/database/Test-DatabaseConnection.ps1",
      "version": "1.0.0",
      "description": "Test database connectivity and credentials",
      "parameters": [
        {
          "name": "Server",
          "type": "string",
          "required": true
        },
        {
          "name": "Database",
          "type": "string",
          "required": true
        },
        {
          "name": "Timeout",
          "type": "integer",
          "required": false,
          "default": 10
        }
      ],
      "returns": {
        "type": "object",
        "description": "Database connectivity test result",
        "output_fields": [
          {
            "name": "connected",
            "type": "boolean",
            "description": "True if connection succeeded"
          },
          {
            "name": "server",
            "type": "string",
            "description": "Server address tested"
          },
          {
            "name": "database",
            "type": "string",
            "description": "Database name tested"
          },
          {
            "name": "latencyMs",
            "type": "integer",
            "description": "Round-trip latency in milliseconds"
          },
          {
            "name": "error",
            "type": "string",
            "description": "Error message if connection failed"
          }
        ]
      },
      "dependencies": [
        "sqlcmd"
      ],
      "tags": [
        "database",
        "connectivity",
        "validation"
      ],
      "security": {
        "requires_approval": false,
        "blast_radius": "LOW",
        "audit_log": true,
        "allowed_callers": [
          "agent_dba",
          "agent_observability"
        ]
      }
    },
    {
      "id": "retrieval.llm-with-rag",
      "name": "Invoke-LLMWithRAG",
      "domain": "retrieval",
      "file": "skills/retrieval/Invoke-LLMWithRAG.ps1",
      "version": "2.0.0",
      "description": "Combined RAG retrieval + DeepSeek LLM call for Level 2 agents. Retrieves Wiki context from Qdrant, injects into system prompt, calls DeepSeek, and tracks usage stats. Supports optional Evaluator-Optimizer loop.",
      "parameters": [
        {
          "name": "Query",
          "type": "string",
          "required": true,
          "description": "The query/task for the LLM"
        },
        {
          "name": "AgentId",
          "type": "string",
          "required": true,
          "description": "Agent ID for memory tracking"
        },
        {
          "name": "SystemPrompt",
          "type": "string",
          "required": false,
          "description": "System prompt (defaults to generic)"
        },
        {
          "name": "TopK",
          "type": "integer",
          "required": false,
          "default": 5,
          "description": "Number of RAG chunks to retrieve"
        },
        {
          "name": "Temperature",
          "type": "number",
          "required": false,
          "default": 0.1
        },
        {
          "name": "MaxTokens",
          "type": "integer",
          "required": false,
          "default": 1000
        },
        {
          "name": "SkipRAG",
          "type": "boolean",
          "required": false,
          "default": false,
          "description": "Skip RAG retrieval (LLM-only mode)"
        },
        {
          "name": "EnableEvaluator",
          "type": "switch",
          "required": false,
          "description": "Activate the Evaluator-Optimizer loop (Gap 1)"
        },
        {
          "name": "AcceptanceCriteria",
          "type": "array",
          "required": false,
          "description": "List of AC predicates for the evaluator to check"
        },
        {
          "name": "MaxIterations",
          "type": "integer",
          "required": false,
          "default": 2,
          "description": "Max generator-evaluator iterations (1-5)"
        },
        {
          "name": "EvaluatorModel",
          "type": "string",
          "required": false,
          "description": "Override model for the evaluator call (defaults to same as Model)"
        }
      ],
      "returns": {
        "type": "object",
        "description": "LLM answer with RAG context, usage stats, and optional evaluator results",
        "output_fields": [
          {
            "name": "Answer",
            "type": "string",
            "description": "LLM-generated answer text"
          },
          {
            "name": "RAGContext",
            "type": "string",
            "description": "Wiki context chunks injected into the prompt"
          },
          {
            "name": "TokensIn",
            "type": "integer",
            "description": "Total prompt tokens consumed (all iterations)"
          },
          {
            "name": "TokensOut",
            "type": "integer",
            "description": "Total completion tokens generated (all iterations)"
          },
          {
            "name": "CostUSD",
            "type": "number",
            "description": "Estimated API cost in USD"
          },
          {
            "name": "DurationSec",
            "type": "number",
            "description": "Total duration in seconds"
          },
          {
            "name": "EvaluatorEnabled",
            "type": "boolean",
            "description": "True if Evaluator-Optimizer was active"
          },
          {
            "name": "EvaluatorIterations",
            "type": "integer",
            "description": "Number of generator-evaluator cycles performed"
          },
          {
            "name": "EvaluatorPassed",
            "type": "boolean",
            "description": "True if all AC predicates passed (when evaluator active)"
          },
          {
            "name": "EvaluatorResults",
            "type": "array",
            "description": "Per-AC pass/fail results from the evaluator"
          }
        ]
      },
      "dependencies": [
        "python3",
        "qdrant-client",
        "deepseek-api"
      ],
      "tags": [
        "rag",
        "llm",
        "deepseek",
        "level2",
        "agent-bridge",
        "evaluator-optimizer"
      ],
      "security": {
        "requires_approval": false,
        "blast_radius": "LOW",
        "audit_log": true,
        "allowed_callers": [
          "agent_backend",
          "agent_dba",
          "agent_docs_sync",
          "agent_governance",
          "agent_infra",
          "agent_pr_manager",
          "agent_review",
          "agent_security",
          "agent_vulnerability_scanner",
          "agent_retrieval"
        ]
      }
    },
    {
      "id": "analysis.impact-analysis",
      "name": "Invoke-ImpactAnalysis",
      "domain": "analysis",
      "file": "skills/analysis/Invoke-ImpactAnalysis.ps1",
      "version": "1.0.0",
      "description": "Butterfly Effect cascade analysis - analyzes downstream impact of changes",
      "parameters": [
        {
          "name": "ChangeDescription",
          "type": "string",
          "required": true,
          "description": "Description of the change to analyze"
        },
        {
          "name": "Scope",
          "type": "string",
          "required": false,
          "default": "all",
          "enum": [
            "agents",
            "infra",
            "api",
            "frontend",
            "all"
          ]
        }
      ],
      "returns": {
        "type": "object",
        "description": "Cascade impact analysis across the specified scope",
        "output_fields": [
          {
            "name": "affectedComponents",
            "type": "array",
            "description": "List of components impacted by the change"
          },
          {
            "name": "riskLevel",
            "type": "string",
            "description": "Overall risk: LOW / MEDIUM / HIGH / CRITICAL"
          },
          {
            "name": "cascadeDepth",
            "type": "integer",
            "description": "Maximum dependency depth of the impact"
          },
          {
            "name": "summary",
            "type": "string",
            "description": "Human-readable impact summary"
          },
          {
            "name": "recommendations",
            "type": "array",
            "description": "Mitigation actions to reduce blast radius"
          }
        ]
      },
      "dependencies": [],
      "tags": [
        "analysis",
        "impact",
        "cascade",
        "butterfly-effect"
      ],
      "security": {
        "requires_approval": false,
        "blast_radius": "LOW",
        "audit_log": false,
        "allowed_callers": [
          "*"
        ]
      }
    },
    {
      "id": "git.checkout",
      "name": "Invoke-GitCheckout",
      "domain": "git",
      "file": "skills/git/Invoke-GitCheckout.ps1",
      "version": "1.0.0",
      "description": "Safely checks out a branch, verifying it exists or creating it if new",
      "parameters": [
        {
          "name": "Branch",
          "type": "string",
          "required": true
        },
        {
          "name": "Create",
          "type": "boolean",
          "required": false
        },
        {
          "name": "Force",
          "type": "boolean",
          "required": false
        }
      ],
      "returns": {
        "type": "object",
        "description": "Result of the git checkout operation",
        "output_fields": [
          {
            "name": "branch",
            "type": "string",
            "description": "Branch now checked out"
          },
          {
            "name": "created",
            "type": "boolean",
            "description": "True if the branch was newly created"
          },
          {
            "name": "previousBranch",
            "type": "string",
            "description": "Branch that was active before checkout"
          }
        ]
      },
      "dependencies": [
        "git"
      ],
      "tags": [
        "git",
        "checkout",
        "branch"
      ],
      "security": {
        "requires_approval": false,
        "blast_radius": "MEDIUM",
        "audit_log": true,
        "allowed_callers": [
          "agent_pr_manager",
          "agent_release",
          "agent_developer"
        ]
      }
    },
    {
      "id": "git.merge",
      "name": "Invoke-GitMerge",
      "domain": "git",
      "file": "skills/git/Invoke-GitMerge.ps1",
      "version": "1.0.0",
      "description": "Merges a source branch into current, with logic to abort on conflict",
      "parameters": [
        {
          "name": "SourceBranch",
          "type": "string",
          "required": true
        },
        {
          "name": "Squash",
          "type": "boolean",
          "required": false
        },
        {
          "name": "NoFastForward",
          "type": "boolean",
          "required": false
        }
      ],
      "returns": {
        "type": "object",
        "description": "Result of the git merge operation",
        "output_fields": [
          {
            "name": "merged",
            "type": "boolean",
            "description": "True if merge completed without conflicts"
          },
          {
            "name": "sourceBranch",
            "type": "string",
            "description": "Branch that was merged in"
          },
          {
            "name": "targetBranch",
            "type": "string",
            "description": "Branch that received the merge"
          },
          {
            "name": "commitHash",
            "type": "string",
            "description": "Resulting merge commit hash"
          },
          {
            "name": "conflicts",
            "type": "array",
            "description": "Files with conflicts if merge was aborted"
          }
        ]
      },
      "dependencies": [
        "git"
      ],
      "tags": [
        "git",
        "merge"
      ],
      "security": {
        "requires_approval": true,
        "blast_radius": "HIGH",
        "audit_log": true,
        "allowed_callers": [
          "agent_pr_manager",
          "agent_release"
        ]
      }
    },
    {
      "id": "git.push",
      "name": "Invoke-GitPush",
      "domain": "git",
      "file": "skills/git/Invoke-GitPush.ps1",
      "version": "1.0.0",
      "description": "Pushes changes to remote, with safety checks",
      "parameters": [
        {
          "name": "Branch",
          "type": "string",
          "required": false
        },
        {
          "name": "Remote",
          "type": "string",
          "required": false,
          "default": "origin"
        },
        {
          "name": "SetUpstream",
          "type": "boolean",
          "required": false
        },
        {
          "name": "Force",
          "type": "boolean",
          "required": false
        },
        {
          "name": "ProtectedBranches",
          "type": "array",
          "required": false,
          "default": [
            "main",
            "master"
          ]
        }
      ],
      "returns": {
        "type": "object",
        "description": "Result of the git push operation",
        "output_fields": [
          {
            "name": "pushed",
            "type": "boolean",
            "description": "True if push succeeded"
          },
          {
            "name": "branch",
            "type": "string",
            "description": "Branch pushed"
          },
          {
            "name": "remote",
            "type": "string",
            "description": "Remote repository pushed to"
          },
          {
            "name": "remoteRef",
            "type": "string",
            "description": "Full remote ref updated (e.g. refs/heads/main)"
          }
        ]
      },
      "dependencies": [
        "git"
      ],
      "tags": [
        "git",
        "push"
      ],
      "security": {
        "requires_approval": true,
        "blast_radius": "HIGH",
        "audit_log": true,
        "allowed_callers": [
          "agent_pr_manager",
          "agent_release"
        ]
      }
    },
    {
      "id": "git.server-sync",
      "name": "Invoke-GitServerSync",
      "domain": "git",
      "file": "skills/git/Invoke-GitServerSync.ps1",
      "version": "1.0.0",
      "description": "Safely syncs a remote server repository via SSH with backup, stash, and ff-only pull",
      "parameters": [
        {
          "name": "ServerHost",
          "type": "string",
          "required": true
        },
        {
          "name": "ServerUser",
          "type": "string",
          "required": false,
          "default": "ubuntu"
        },
        {
          "name": "ServerRepoPath",
          "type": "string",
          "required": false,
          "default": "~/EasyWayDataPortal"
        },
        {
          "name": "Branch",
          "type": "string",
          "required": false,
          "default": "main"
        },
        {
          "name": "ServerSshKeyPath",
          "type": "string",
          "required": false
        },
        {
          "name": "SkipClean",
          "type": "boolean",
          "required": false
        },
        {
          "name": "SudoCleanPaths",
          "type": "array",
          "required": false
        },
        {
          "name": "AllowHardReset",
          "type": "boolean",
          "required": false
        },
        {
          "name": "Yes",
          "type": "boolean",
          "required": false
        }
      ],
      "returns": {
        "type": "object",
        "description": "Result of the server git pull/sync operation",
        "output_fields": [
          {
            "name": "synced",
            "type": "boolean",
            "description": "True if server is now at the expected commit"
          },
          {
            "name": "commitBefore",
            "type": "string",
            "description": "Server commit hash before sync"
          },
          {
            "name": "commitAfter",
            "type": "string",
            "description": "Server commit hash after sync"
          },
          {
            "name": "filesChanged",
            "type": "integer",
            "description": "Number of files changed during pull"
          },
          {
            "name": "backupBranch",
            "type": "string",
            "description": "Backup branch created on server before sync"
          }
        ]
      },
      "dependencies": [
        "git",
        "ssh"
      ],
      "tags": [
        "git",
        "release",
        "deploy",
        "server-sync",
        "ssh"
      ],
      "security": {
        "requires_approval": true,
        "blast_radius": "CRITICAL",
        "audit_log": true,
        "allowed_callers": [
          "agent_release",
          "agent_infra"
        ]
      }
    },
    {
      "id": "git.new-pbi-branch",
      "name": "New-PbiBranch",
      "domain": "git",
      "file": "skills/git/New-PbiBranch.ps1",
      "version": "1.0.0",
      "description": "Crea un branch git per un PBI ADO (feat/PBI-<id>-<slug>) e genera il template PR pre-compilato con AB#<id> e Acceptance Criteria. Antifragile: funziona anche se ADO non e' raggiungibile (fallback graceful con placeholder).",
      "parameters": [
        {
          "name": "PbiId",
          "type": "integer",
          "required": true,
          "description": "ID del work item ADO (PBI) da collegare al branch"
        },
        {
          "name": "Pat",
          "type": "string",
          "required": false,
          "default": "env:AZURE_DEVOPS_EXT_PAT",
          "description": "PAT Azure DevOps. Se omesso usa AZURE_DEVOPS_EXT_PAT. Se mancante: fallback a placeholder."
        },
        {
          "name": "BaseBranch",
          "type": "string",
          "required": false,
          "default": "develop",
          "description": "Branch di partenza per il nuovo branch feature"
        },
        {
          "name": "DryRun",
          "type": "boolean",
          "required": false,
          "default": false,
          "description": "Mostra piano senza creare branch o PR"
        },
        {
          "name": "SkipFetch",
          "type": "boolean",
          "required": false,
          "default": false,
          "description": "Salta il fetch ADO API; usa placeholder per titolo e AC"
        },
        {
          "name": "CreatePR",
          "type": "boolean",
          "required": false,
          "default": false,
          "description": "Push branch + crea PR su ADO con template pre-compilato"
        },
        {
          "name": "Json",
          "type": "boolean",
          "required": false,
          "default": false,
          "description": "Output strutturato JSON per agent consumption"
        }
      ],
      "returns": {
        "type": "object",
        "description": "Risultato creazione branch e template PR",
        "output_fields": [
          {
            "name": "pbiId",
            "type": "integer",
            "description": "ID work item ADO"
          },
          {
            "name": "pbiTitle",
            "type": "string",
            "description": "Titolo del PBI (da ADO o placeholder)"
          },
          {
            "name": "branch",
            "type": "string",
            "description": "Nome branch creato: feat/PBI-<id>-<slug>"
          },
          {
            "name": "prTitle",
            "type": "string",
            "description": "Titolo PR suggerito: [PBI-<id>] <title>"
          },
          {
            "name": "prTemplate",
            "type": "string",
            "description": "Corpo PR pre-compilato con AB#<id> e AC"
          },
          {
            "name": "acFetched",
            "type": "boolean",
            "description": "True se AC sono stati recuperati da ADO; false se placeholder"
          },
          {
            "name": "prUrl",
            "type": "string",
            "description": "URL PR ADO creata (solo se -CreatePR)"
          },
          {
            "name": "templateFile",
            "type": "string",
            "description": "Path .git/PBI_PR_TEMPLATE.md scritto su disco"
          }
        ]
      },
      "dependencies": [
        "git",
        "pwsh"
      ],
      "tags": [
        "git",
        "ado",
        "pbi",
        "branch",
        "pr",
        "traceability",
        "workflow"
      ],
      "security": {
        "requires_approval": false,
        "blast_radius": "LOW",
        "audit_log": false,
        "allowed_callers": [
          "agent_backlog_planner",
          "agent_ado_userstory",
          "agent_developer",
          "agent_scrummaster"
        ]
      }
    },
    {
      "id": "analysis.summarize",
      "name": "Invoke-Summarize",
      "domain": "analysis",
      "file": "skills/analysis/Invoke-Summarize.ps1",
      "version": "1.0.0",
      "description": "Summarize text using #COSTAR prompt framework. Supports business/technical/conversational styles.",
      "parameters": [
        {
          "name": "InputText",
          "type": "string",
          "required": true,
          "description": "Text to summarize"
        },
        {
          "name": "MaxWords",
          "type": "integer",
          "required": false,
          "default": 150
        },
        {
          "name": "Style",
          "type": "string",
          "required": false,
          "default": "business",
          "enum": [
            "business",
            "technical",
            "conversational"
          ]
        },
        {
          "name": "OutputFormat",
          "type": "string",
          "required": false,
          "default": "object",
          "enum": [
            "object",
            "json",
            "markdown"
          ]
        },
        {
          "name": "DryRun",
          "type": "boolean",
          "required": false,
          "default": false,
          "description": "Return assembled prompt without calling LLM"
        }
      ],
      "costar_prompt": {
        "context": "You are given the following document: {{InputText}}",
        "objective": "Produce a concise summary in no more than {{MaxWords}} words.",
        "style": "Configurable: business / technical / conversational",
        "tone": "Neutral, informative, factual",
        "audience": "Determined by Style parameter",
        "response_format": "JSON { summary, key_points, word_count }"
      },
      "returns": {
        "type": "object",
        "description": "Concise summary with key points extracted from the input text",
        "output_fields": [
          {
            "name": "summary",
            "type": "string",
            "description": "Condensed summary text"
          },
          {
            "name": "key_points",
            "type": "array",
            "description": "Bullet-point key takeaways"
          },
          {
            "name": "word_count",
            "type": "integer",
            "description": "Actual word count of the summary"
          },
          {
            "name": "style",
            "type": "string",
            "description": "Style used (business/technical/conversational)"
          }
        ]
      },
      "dependencies": [],
      "tags": [
        "analysis",
        "summarize",
        "costar",
        "llm",
        "nlp"
      ],
      "security": {
        "requires_approval": false,
        "blast_radius": "LOW",
        "audit_log": false,
        "allowed_callers": [
          "*"
        ]
      }
    },
    {
      "id": "analysis.sql-query",
      "name": "Invoke-SQLQuery",
      "domain": "analysis",
      "file": "skills/analysis/Invoke-SQLQuery.ps1",
      "version": "1.0.0",
      "description": "Generate safe read-only SQL from natural language using #COSTAR. Optional execution.",
      "parameters": [
        {
          "name": "Question",
          "type": "string",
          "required": true,
          "description": "Natural-language question"
        },
        {
          "name": "SchemaContext",
          "type": "string",
          "required": false,
          "description": "Database DDL / schema"
        },
        {
          "name": "Execute",
          "type": "boolean",
          "required": false,
          "default": false
        },
        {
          "name": "Server",
          "type": "string",
          "required": false
        },
        {
          "name": "Database",
          "type": "string",
          "required": false
        },
        {
          "name": "DryRun",
          "type": "boolean",
          "required": false,
          "default": false
        }
      ],
      "costar_prompt": {
        "context": "Database schema + user question",
        "objective": "Generate a safe, read-only SQL SELECT query answering the question.",
        "style": "Technical SQL with inline comments, CTEs for complex queries",
        "tone": "Precise, minimal",
        "audience": "Developer or DBA",
        "response_format": "JSON { sql, explanation, tables_used }"
      },
      "returns": {
        "type": "object",
        "description": "Generated SQL query with explanation; optionally includes execution results",
        "output_fields": [
          {
            "name": "sql",
            "type": "string",
            "description": "Generated SELECT SQL query (read-only)"
          },
          {
            "name": "explanation",
            "type": "string",
            "description": "Plain-language explanation of the query"
          },
          {
            "name": "tables_used",
            "type": "array",
            "description": "List of table names referenced in the query"
          },
          {
            "name": "executionResult",
            "type": "object",
            "description": "Query execution result rows (only if Execute=true)"
          }
        ]
      },
      "dependencies": [],
      "tags": [
        "analysis",
        "sql",
        "costar",
        "llm",
        "database",
        "nlp"
      ],
      "security": {
        "requires_approval": false,
        "blast_radius": "MEDIUM",
        "audit_log": true,
        "allowed_callers": [
          "agent_dba",
          "agent_backend"
        ]
      }
    },
    {
      "id": "analysis.classify-intent",
      "name": "Invoke-ClassifyIntent",
      "domain": "analysis",
      "file": "skills/analysis/Invoke-ClassifyIntent.ps1",
      "version": "1.0.0",
      "description": "Classify user intent into known categories with confidence score using #COSTAR.",
      "parameters": [
        {
          "name": "UserInput",
          "type": "string",
          "required": true,
          "description": "User input to classify"
        },
        {
          "name": "IntentList",
          "type": "array",
          "required": false,
          "description": "Known intent labels"
        },
        {
          "name": "DryRun",
          "type": "boolean",
          "required": false,
          "default": false
        }
      ],
      "costar_prompt": {
        "context": "User input + known intent categories",
        "objective": "Classify input into exactly one intent with confidence score.",
        "style": "Analytical, data-driven classification",
        "tone": "Objective, precise",
        "audience": "Orchestration engine for request routing",
        "response_format": "JSON { intent, confidence, reasoning }"
      },
      "returns": {
        "type": "object",
        "description": "Intent classification with confidence score and reasoning",
        "output_fields": [
          {
            "name": "intent",
            "type": "string",
            "description": "Classified intent label"
          },
          {
            "name": "confidence",
            "type": "number",
            "description": "Confidence score 0.0-1.0 for the classification"
          },
          {
            "name": "reasoning",
            "type": "string",
            "description": "Brief explanation of why this intent was chosen"
          },
          {
            "name": "alternatives",
            "type": "array",
            "description": "Runner-up intents with their confidence scores"
          }
        ]
      },
      "dependencies": [],
      "tags": [
        "analysis",
        "intent",
        "classification",
        "costar",
        "llm",
        "nlp"
      ],
      "security": {
        "requires_approval": false,
        "blast_radius": "LOW",
        "audit_log": false,
        "allowed_callers": [
          "*"
        ]
      }
    },
    {
      "id": "session.manage",
      "name": "Manage-AgentSession",
      "domain": "session",
      "file": "skills/session/Manage-AgentSession.ps1",
      "version": "1.0.0",
      "description": "CRUD operations for agent working memory sessions (Gap 2 - agent-evolution-roadmap). Creates, reads, updates, and closes ephemeral session.json files that store intermediate state for multi-step L2/L3 agent workflows. Sessions expire automatically (default TTL: 30 min).",
      "parameters": [
        {
          "name": "Operation",
          "type": "string",
          "required": true,
          "description": "One of: New, Get, Update, SetStep, Close, Cleanup"
        },
        {
          "name": "AgentId",
          "type": "string",
          "required": false,
          "description": "Agent ID (required for Operation=New)"
        },
        {
          "name": "Intent",
          "type": "string",
          "required": false,
          "description": "Task intent in '<domain>:<action>' format (required for Operation=New)"
        },
        {
          "name": "SessionFile",
          "type": "string",
          "required": false,
          "description": "Path to session.json (required for Get/Update/SetStep/Close)"
        },
        {
          "name": "CompletedStep",
          "type": "string",
          "required": false,
          "description": "Step name to mark as completed (for Operation=Update)"
        },
        {
          "name": "StepResult",
          "type": "hashtable",
          "required": false,
          "description": "Key-value pairs to merge into intermediate_results (for Operation=Update)"
        },
        {
          "name": "Confidence",
          "type": "number",
          "required": false,
          "description": "Confidence score 0.0-1.0 to update on the session (for Operation=Update); -1 = skip"
        },
        {
          "name": "StepName",
          "type": "string",
          "required": false,
          "description": "Step name to set as current_step (for Operation=SetStep)"
        },
        {
          "name": "TtlMinutes",
          "type": "integer",
          "required": false,
          "description": "Session TTL in minutes (default: 30, for Operation=New)"
        },
        {
          "name": "InitialMetadata",
          "type": "hashtable",
          "required": false,
          "description": "Agent-specific metadata to store (for Operation=New)"
        },
        {
          "name": "CorrelationId",
          "type": "string",
          "required": false,
          "description": "External correlation ID (PR number, n8n execution ID, etc.)"
        },
        {
          "name": "CleanupAgentId",
          "type": "string",
          "required": false,
          "description": "Agent ID whose expired sessions to remove (for Operation=Cleanup; empty = all agents)"
        }
      ],
      "returns": {
        "type": "object",
        "description": "Result hashtable. Shape varies by Operation: New returns SessionId+SessionFile+ExpiresAt; Get returns Session object; Update/SetStep return SessionId; Close returns summary; Cleanup returns RemovedCount.",
        "output_fields": [
          {
            "name": "Success",
            "type": "boolean",
            "description": "True if the operation succeeded"
          },
          {
            "name": "SessionId",
            "type": "string",
            "description": "UUID of the session (New/Update/SetStep/Close)"
          },
          {
            "name": "SessionFile",
            "type": "string",
            "description": "Absolute path to session.json (New)"
          },
          {
            "name": "ExpiresAt",
            "type": "string",
            "description": "ISO 8601 expiry timestamp (New)"
          },
          {
            "name": "Session",
            "type": "object",
            "description": "Full session object (Get)"
          },
          {
            "name": "Expired",
            "type": "boolean",
            "description": "True if the session has passed its expires_at (Get)"
          },
          {
            "name": "StepsCompleted",
            "type": "array",
            "description": "Ordered list of completed step names (Close)"
          },
          {
            "name": "FinalConfidence",
            "type": "number",
            "description": "Confidence at session close, or null (Close)"
          },
          {
            "name": "RemovedCount",
            "type": "integer",
            "description": "Number of expired sessions removed (Cleanup)"
          }
        ]
      },
      "dependencies": [],
      "tags": [
        "session",
        "working-memory",
        "gap2",
        "state",
        "l2",
        "l3"
      ],
      "security": {
        "requires_approval": false,
        "blast_radius": "LOW",
        "audit_log": false,
        "allowed_callers": [
          "*"
        ]
      }
    },
    {
      "id": "orchestration.parallel-agents",
      "name": "Invoke-ParallelAgents",
      "domain": "orchestration",
      "file": "skills/orchestration/Invoke-ParallelAgents.ps1",
      "version": "1.0.0",
      "description": "Run multiple agent scripts concurrently using Start-ThreadJob (PS7+) or Start-Job (PS5.1 fallback). Returns merged results when all complete or GlobalTimeout is reached. Implements Gap 3 - Parallelization.",
      "function": "Invoke-ParallelAgents",
      "parameters": [
        {
          "name": "AgentJobs",
          "type": "array",
          "required": true,
          "description": "Array of hashtables: {Name, Script, Args, Timeout}. Script is relative to repo root."
        },
        {
          "name": "GlobalTimeout",
          "type": "integer",
          "required": false,
          "default": 180,
          "description": "Maximum seconds to wait for ALL jobs. After timeout, remaining jobs are stopped."
        },
        {
          "name": "FailFast",
          "type": "switch",
          "required": false,
          "description": "If set: first job failure aborts all remaining jobs immediately."
        },
        {
          "name": "SecureMode",
          "type": "switch",
          "required": false,
          "description": "If set: suppresses logging of sensitive fields (ApiKey, credentials)."
        }
      ],
      "returns": {
        "shape": "hashtable",
        "fields": [
          {
            "name": "Success",
            "type": "boolean",
            "description": "True if at least one job succeeded"
          },
          {
            "name": "JobResults",
            "type": "hashtable",
            "description": "Keyed by Name; each value is the job output or error hashtable"
          },
          {
            "name": "Failed",
            "type": "string[]",
            "description": "Names of jobs that failed or timed out"
          },
          {
            "name": "DurationSec",
            "type": "number",
            "description": "Total wall-clock execution time in seconds"
          }
        ]
      },
      "dependencies": [],
      "tags": [
        "parallelization",
        "multi-agent",
        "orchestration",
        "gap3",
        "start-threadjob",
        "start-job"
      ],
      "notes": "Prefers Start-ThreadJob (PS7+) for shared memory performance; falls back to Start-Job (PS5.1) for subprocess isolation. Use case: agent_review + agent_security in parallel for PR gates.",
      "security": {
        "requires_approval": false,
        "blast_radius": "MEDIUM",
        "audit_log": true,
        "allowed_callers": [
          "*"
        ]
      }
    },
    {
      "id": "devops.deploy-server",
      "name": "Invoke-ServerDeploy",
      "domain": "devops",
      "file": "scripts/pwsh/Deploy-Server.ps1",
      "version": "1.0.0",
      "description": "SSH deploy on-demand sul server OCI: git fetch+reset + docker compose up. Supporta deploy di singolo service (-Service agent-runner) o stack completo. Il deploy automatico su merge main e'in DeployMain stage (azure-pipelines.yml).",
      "parameters": [
        {
          "name": "Branch",
          "type": "string",
          "required": false,
          "default": "main",
          "description": "Branch da deployare sul server"
        },
        {
          "name": "Service",
          "type": "string",
          "required": false,
          "default": "",
          "description": "Vuoto = stack completo; es. agent-runner = solo runner"
        },
        {
          "name": "SshKey",
          "type": "string",
          "required": false,
          "default": "C:\\old\\Virtual-machine\\ssh-key-2026-01-25.key"
        },
        {
          "name": "SshHost",
          "type": "string",
          "required": false,
          "default": "ubuntu@80.225.86.168"
        },
        {
          "name": "WhatIf",
          "type": "switch",
          "required": false,
          "description": "Dry-run: stampa il comando SSH senza eseguirlo"
        },
        {
          "name": "Json",
          "type": "switch",
          "required": false,
          "description": "Output JSON per agent consumption"
        }
      ],
      "returns": {
        "type": "object",
        "description": "Risultato del deploy con SHA post-deploy",
        "output_fields": [
          {
            "name": "success",
            "type": "boolean",
            "description": "True se DEPLOY_OK ricevuto"
          },
          {
            "name": "sha",
            "type": "string",
            "description": "SHA breve del commit deployato"
          },
          {
            "name": "branch",
            "type": "string"
          },
          {
            "name": "service",
            "type": "string",
            "description": "Service deployato (vuoto = tutti)"
          }
        ]
      },
      "dependencies": [
        "ssh.exe"
      ],
      "tags": [
        "devops",
        "deploy",
        "ssh",
        "docker",
        "server"
      ],
      "security": {
        "requires_approval": true,
        "blast_radius": "HIGH",
        "audit_log": true,
        "allowed_callers": [
          "agent_infra",
          "agent_scrummaster",
          "*"
        ]
      }
    },
    {
      "id": "devops.create-release-pr",
      "name": "New-ReleasePR",
      "domain": "devops",
      "file": "scripts/pwsh/Create-ReleasePR.ps1",
      "version": "1.0.0",
      "description": "Crea una Release PR da develop verso main su ADO con titolo/descrizione auto-generati (tabella PR mergeate + delta SHA + checklist deploy) e governance integrata. Merge strategy noFastForward.",
      "parameters": [
        { "name": "SourceBranch", "type": "string",  "required": false, "default": "develop",  "description": "Branch sorgente (deve essere 'develop' o 'release/*')" },
        { "name": "TargetBranch", "type": "string",  "required": false, "default": "main",     "description": "Branch destinazione (deve essere 'main')" },
        { "name": "SessionLabel", "type": "string",  "required": false, "default": "",         "description": "Etichetta sessione (es. 'Session 37'). Se vuoto, auto-detect dall'ultima Release PR su main." },
        { "name": "Pat",          "type": "string",  "required": false, "default": "",         "description": "ADO PAT. Fallback: env:AZURE_DEVOPS_EXT_PAT  C:\\old\\.env.local" },
        { "name": "WhatIf",       "type": "switch",  "required": false,                        "description": "Dry-run: stampa titolo+descrizione senza creare la PR" },
        { "name": "Json",         "type": "switch",  "required": false,                        "description": "Output JSON machine-readable per agent consumption" }
      ],
      "returns": {
        "type": "object",
        "description": "PR creata con ID, URL e metadati delta",
        "output_fields": [
          { "name": "id",         "type": "integer", "description": "ADO PR ID" },
          { "name": "url",        "type": "string",  "description": "Link diretto alla PR" },
          { "name": "title",      "type": "string",  "description": "Titolo generato" },
          { "name": "sourceSHA",  "type": "string",  "description": "SHA breve del branch sorgente" },
          { "name": "targetSHA",  "type": "string",  "description": "SHA breve del branch target" },
          { "name": "deltaCount", "type": "integer", "description": "Numero di PR nel delta" }
        ]
      },
      "dependencies": ["Invoke-RestMethod"],
      "tags": ["devops", "pr", "release", "ado", "governance"],
      "security": {
        "requires_approval": true,
        "blast_radius": "MEDIUM",
        "audit_log": true,
        "allowed_callers": ["agent_scrummaster", "agent_pr_gate", "*"]
      }
    }
  ]
}