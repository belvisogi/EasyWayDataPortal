{
  "rules": [
    {
      "id": "release-clean-tree",
      "description": "La release parte solo da working tree pulito (salvo override esplicito).",
      "severity": "mandatory",
      "when": { "intentContains": ["release:promote"] },
      "checklist": [
        "Verificare `git status --porcelain` vuoto",
        "Confermare source e target diversi",
        "Confermare sync con `origin` prima del merge"
      ]
    },
    {
      "id": "release-main-guard",
      "description": "Promozioni verso main devono essere esplicite e tracciabili.",
      "severity": "mandatory",
      "when": { "intentContains": ["release:promote"] },
      "checklist": [
        "Se target=main, warning esplicito e conferma utente",
        "Abort su merge conflict (git merge --abort)",
        "Generare draft release notes in `agents/logs/`"
      ]
    }
  ]
}

