{"id":"kb-setup-env-001","intent":"setup-local-env","question":"Come imposto l'ambiente locale (.env.local)?","tags":["env","local","powershell"],"preconditions":["PowerShell 7+","repo clonato"],"steps":["pwsh scripts/setup-env.ps1 -TenantId <TENANT> -AuthClientId <CLIENT_ID> -DbConnString '<CONN>' -DefaultBusinessTenant tenant01"],"verify":["File .env.local creato","Checklist OK"],"rollback":["Eliminare .env.local o rigenerare"],"outputs":["EasyWay-DataPortal/easyway-portal-api/.env.local"],"references":["EasyWay-DataPortal/easyway-portal-api/README.md","scripts/setup-env.ps1"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-activity-approved-030","intent":"activity-approved","question":"Come leggo direttamente gli eventi approvati via la nuova rotta /api/docs/activity/approved?","tags":["activity","audit","ams"],"steps":["# Bash:","curl -s http://localhost:3000/api/docs/activity/approved","# PowerShell:","Invoke-RestMethod -Uri 'http://localhost:3000/api/docs/activity/approved' | ConvertTo-Json -Depth 5"],"verify":["La risposta contiene solo eventi con govApproved=true (filtro lato server)"],"references":["EasyWay-DataPortal/easyway-portal-api/src/routes/docs.ts","Wiki/EasyWayData.wiki/ACTIVITY_LOG.md"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-checklist-002","intent":"predeploy-checklist","question":"Come eseguo il Checklist Bot?","tags":["checklist","quality"],"steps":["pwsh scripts/checklist.ps1"],"verify":["summary.ok=true"],"outputs":["checklist.json (artifact)"],"references":["EasyWay-DataPortal/easyway-portal-api/src/tools/checklist.ts","azure-pipelines.yml"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-start-api-003","intent":"start-api","question":"Come avvio l'API in sviluppo?","tags":["api","dev"],"steps":["cd EasyWay-DataPortal/easyway-portal-api","npm ci","npm run dev"],"verify":["http://localhost:3000/portal risponde"],"references":["EasyWay-DataPortal/easyway-portal-api/README.md"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-flyway-migrate-004","intent":"db-migrate","question":"Come eseguo le migrazioni Flyway?","tags":["db","flyway"],"preconditions":["FLYWAY_URL","FLYWAY_USER","FLYWAY_PASSWORD"],"steps":["flyway -configFiles=db/flyway/flyway.conf validate","flyway -configFiles=db/flyway/flyway.conf migrate"],"verify":["Tabella flyway_schema_history aggiornata"],"references":["db/flyway/README.md"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-terraform-plan-005","intent":"infra-plan","question":"Come eseguo Terraform plan/apply?","tags":["infra","terraform"],"preconditions":["RESOURCE_GROUP_NAME","STORAGE_ACCOUNT_NAME","TENANTS"],"steps":["cd infra/terraform","terraform init","terraform plan -var 'project_name=easyway' -var 'resource_group_name=${env:RESOURCE_GROUP_NAME}' -var 'storage_account_name=${env:STORAGE_ACCOUNT_NAME}' -var 'tenants=${env:TENANTS}'"],"verify":["Nessun errore nel plan"],"references":["infra/terraform/README.md","azure-pipelines.yml"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-ci-verify-ewctl-flyway-011","intent":"ci-verify-ewctl-flyway","question":"Come verifico i gates via ewctl e Flyway su una branch non-main?","tags":["ci","gates","flyway","ewctl"],"preconditions":["Azure DevOps collegato","Variable Group 'EasyWay-Secrets' con FLYWAY_URL, FLYWAY_USER, FLYWAY_PASSWORD","USE_EWCTL_GATES=true","FLYWAY_ENABLED=true"],"steps":["Crea branch 'ci-verify-ewctl' e push","Avvia manualmente la pipeline su questa branch","Verifica il job 'GovernanceGatesEWCTL' (usa ewctl con --logevent)","Controlla artifact: 'activity-log', 'gates-report' e, se presenti, 'db-drift' e 'checklist'","Verifica lo stage DB: 'FlywayValidateAny' gira su tutte le branch e 'FlywayMigrateDevelop' gira su develop"],"verify":["Artifact 'activity-log' pubblicato con events.jsonl aggiornato","'gates-report.json' pubblicato e coerente","Flyway validate completato; migrate eseguito su develop"],"rollback":["Ripristina USE_EWCTL_GATES/FLYWAY_ENABLED a 'false' se necessario"],"references":["azure-pipelines.yml","docs/ci/ewctl-gates.md","Wiki/EasyWayData.wiki/ci-verifica-ewctl-gates-e-flyway.md"],"updated":"2025-10-20T00:00:00Z"}
{"id":"kb-argos-gates-activate-101","intent":"argos-gates-activate-ewctl","question":"Come attivo i Quality Gates ARGOS via ewctl in CI/CD?","tags":["argos","gates","ewctl","ci"],"preconditions":["Variabile pipeline USE_EWCTL_GATES=true","File 'scripts/ewctl.ps1' presente"],"steps":["Apri 'azure-pipelines.yml' e verifica il job 'GovernanceGatesEWCTL' con: pwsh scripts/ewctl.ps1 --engine ps --checklist --dbdrift --kbconsistency --noninteractive --logevent","Imposta USE_EWCTL_GATES=true nelle variabili di pipeline o nel file YAML","Esegui la pipeline e attendi il completamento dello stage 'BuildAndTest'","Verifica gli eventi registrati e l'esito dei gates"],"verify":["Job 'GovernanceGatesEWCTL' eseguito senza errori","Eventi scritti (agents/logs/events.jsonl o artifact 'activity-log')","Report gates pubblicato (se configurato)"],"rollback":["Imposta USE_EWCTL_GATES=false per tornare ai job legacy","Disabilita il job dalla pipeline se necessario"],"outputs":["agents/logs/events.jsonl","artifact 'activity-log'"],"references":["azure-pipelines.yml","AGENTS.md","Wiki/EasyWayData.wiki/argos/argos-quality-gates.md"],"updated":"2025-10-27T00:00:00Z"}
{"id":"kb-argos-playbook-serialize-102","intent":"argos-playbook-serialize","question":"Come serializzo un Playbook ARGOS in YAML e lo valido?","tags":["argos","playbook","yaml","ci"],"preconditions":["Cartella 'docs/agentic/playbooks/' creata","Schema YAML disponibile (facoltativo)"],"steps":["Crea un file YAML per il playbook in 'docs/agentic/playbooks/pb-<ID>.yaml' con i campi: PB_ID,TITLE,VERSION,OWNER,MODE,SCOPE,TAGS,TRIGGERS,GUARDRAIL,PROCEDURA(steps),BACKOUT,KPI,PRIVACY","Aggiungi link alla Decision Trace e al ticket nel campo telemetria/output","(Facoltativo) Aggiungi un job in pipeline che validi lo schema YAML (es. con action/script dedicato)","Aggiorna la Wiki: 'Wiki/EasyWayData.wiki/argos/argos-playbook-catalog.md' con il nuovo PB"],"verify":["File YAML valido (review e/o schema check)","PB referenziato in Wiki e disponibile in indice"],"rollback":["Rinominare o spostare il file fuori da 'docs/agentic/playbooks'","Ripristinare la versione precedente dal controllo versione"],"outputs":["docs/agentic/playbooks/pb-<ID>.yaml"],"references":["Wiki/EasyWayData.wiki/argos/argos-playbook-catalog.md","Wiki/EasyWayData.wiki/argos/argos-quality-gates.md"],"updated":"2025-10-27T00:00:00Z"}
{"id":"kb-argos-events-validate-103","intent":"argos-events-schema-validate","question":"Come valido gli Event Schema JSON degli eventi argos.* in CI?","tags":["argos","events","json-schema","ci"],"preconditions":["Node.js in CI","Cartelle 'docs/agentic/templates/events/schemas' e 'docs/agentic/templates/events/samples'"],"steps":["Salva gli schema in 'docs/agentic/templates/events/schemas/*.schema.json' (uno per evento: argos.run.completed, argos.gate.decision, …)","Aggiungi esempi payload in 'docs/agentic/templates/events/samples/*.json'","In pipeline, aggiungi uno step Node che valida: npx ajv validate -s docs/agentic/templates/events/schemas/*.schema.json -d docs/agentic/templates/events/samples/*.json","Pubblica il report di validazione come artifact"],"verify":["Build fallisce se un payload non rispetta lo schema","Artifact 'event-schema-report' pubblicato (se previsto)"],"rollback":["Rimuovere/Commentare lo step di validazione dalla pipeline","Ripristinare gli schema precedenti"],"outputs":["docs/agentic/templates/events/schemas","docs/agentic/templates/events/samples"],"references":["Wiki/EasyWayData.wiki/argos/argos-event-schema.md","azure-pipelines.yml"],"updated":"2025-10-27T00:00:00Z"}
{"id":"kb-argos-generate-yaml-104","intent":"argos-generate-yaml","question":"Come genero YAML minimali (policy set / playbook) on-the-fly dalle configurazioni DB?","tags":["argos","yaml","generator","ci"],"preconditions":["Un job esporta le configurazioni da DB in JSON (registry/playbook)","Node.js disponibile in locale/CI"],"steps":["Esporta il Policy Set dal DB in JSON nel path: docs/agentic/templates/registry-sample/policy-set.sample.json (o un path equivalente)","Genera YAML policy set: node scripts/argos-generate-yaml.mjs --type policy-set --registry docs/agentic/templates/registry-sample/policy-set.sample.json --domain customer --flow orders --instance ord_v2_daily --out out/argos","(Opzionale) Genera YAML playbook: node scripts/argos-generate-yaml.mjs --type playbook --playbook docs/agentic/playbooks/pb-UNIQ-04.sample.json --out out/argos","Pubblica la cartella out/argos come artifact di pipeline"],"verify":["File YAML generati nella cartella out/argos","YAML minimali e coerenti con le configurazioni DB esportate"],"rollback":["Rimuovere lo step di generazione YAML dalla pipeline","Cambiare l'export JSON senza toccare lo script"],"outputs":["out/argos/policy-set.<domain>.<flow>.<instance>.yaml","out/argos/PB-*.yaml"],"references":["scripts/argos-generate-yaml.mjs","Wiki/EasyWayData.wiki/argos/argos-policy-dsl.md","Wiki/EasyWayData.wiki/argos/argos-playbook-catalog.md"],"updated":"2025-10-27T00:00:00Z"}
{"id":"kb-wiki-llm-lint-105","intent":"wiki-llm-frontmatter-lint","question":"Come rendo obbligatorio il front‑matter LLM nell'intera Wiki (token‑savvy)?","tags":["wiki","llm","lint","ci"],"preconditions":["PowerShell 7+ in CI","scripts/wiki-frontmatter-lint.ps1 presente"],"steps":["Imposta ENABLE_WIKI_LLM_LINT=true nelle variabili di pipeline (default già true)","(Opzionale) Imposta WIKI_LLM_LINT_PATH='Wiki/EasyWayData.wiki' o un sotto-percorso per limitare l'ambito","Verifica in 'azure-pipelines.yml' lo stage Pre-Checks → job 'Wiki LLM Front-Matter Lint (Whole Wiki)'","Esegui la pipeline; se mancano i campi richiesti il job fallisce","Apri l'artifact 'wiki-frontmatter-lint' per il report JSON"],"verify":["Job lint eseguito correttamente","Report JSON pubblicato","Pagine senza front‑matter vengono segnalate/fail"],"rollback":["Imposta ENABLE_WIKI_LLM_LINT=false per disabilitare il gate temporaneamente","Restringi l'ambito con WIKI_LLM_LINT_PATH per rollout graduale"],"references":["scripts/wiki-frontmatter-lint.ps1","Wiki/EasyWayData.wiki/docs-conventions.md","azure-pipelines.yml"],"updated":"2025-10-27T00:00:00Z"}
{"id":"kb-wiki-llm-autofix-106","intent":"wiki-llm-frontmatter-autofix","question":"Come normalizzo automaticamente il front‑matter sulle pagine Wiki mancanti e preparo una PR?","tags":["wiki","llm","autofix","ci"],"preconditions":["PowerShell 7+","Permessi di push su branch feature"],"steps":["Crea branch: git checkout -b chore/wiki-frontmatter-autofix","Esegui dry-run: pwsh scripts/wiki-frontmatter-autofix.ps1 -Path Wiki/EasyWayData.wiki -SummaryOut wiki-frontmatter-autofix.json","Apri il report JSON e rivedi i file con action=inserted/replaced_unterminated","Applica fix: pwsh scripts/wiki-frontmatter-autofix.ps1 -Path Wiki/EasyWayData.wiki -Apply","Riesegui lint: pwsh scripts/wiki-frontmatter-lint.ps1 -Path Wiki/EasyWayData.wiki -FailOnError","Commit: git add -A && git commit -m 'chore(wiki): normalize LLM front-matter'","Push: git push --set-upstream origin chore/wiki-frontmatter-autofix","Apri PR e completa la Checklist (vedi PULL_REQUEST_TEMPLATE.md)"],"verify":["Lint senza errori","Diff PR mostra solo aggiunta/sostituzione front‑matter"],"rollback":["git reset --hard HEAD~1 se necessario","Ripristina i file da main se alcuni front‑matter richiedono revisione manuale"],"references":["scripts/wiki-frontmatter-autofix.ps1","scripts/wiki-frontmatter-lint.ps1","PULL_REQUEST_TEMPLATE.md","Wiki/EasyWayData.wiki/docs-conventions.md"],"updated":"2025-10-27T00:00:00Z"}
{"id":"kb-agent-dq-blueprint-201","intent":"dq-blueprint-from-file","question":"Come genero un blueprint DQ (Policy Proposal + Policy Set) da un file CSV/XLSX?","tags":["argos","dq","blueprint","agent","csv","xlsx"],"preconditions":["File CSV o XLSX di esempio","PowerShell 7+ oppure Node.js + ts-node","(opz.) heuristics v0: agents/agent_dq_blueprint/heuristics/heuristics.v0.json"],"steps":["PowerShell (Windows/Linux/Mac):","pwsh agents/agent_dq_blueprint/run.ps1 -Action blueprint-from-file -Input path/to/file.csv -Domain <domain_id> -Flow <flow_id> -Instance <instance_id> -Impact 0.5","Oppure Node (ts-node):","npx ts-node agents/agent_dq_blueprint/src/cli.ts --action blueprint-from-file --input path/to/file.csv --domain <domain_id> --flow <flow_id> --instance <instance_id> --impact 0.5","Rivedi l'output a console (summary) e i file generati in out/blueprint/","Apri out/blueprint/policy_proposals.json per le regole suggerite e out/blueprint/policy_set.json per il set minimo"],"verify":["Console mostra ok=true e conteggi (columns, rules_proposed)","Esistono i file out/blueprint/policy_proposals.json e out/blueprint/policy_set.json"],"outputs":["out/blueprint/policy_proposals.json","out/blueprint/policy_set.json"],"references":["Wiki/EasyWayData.wiki/agents/agent-dq-blueprint.md","agents/agent_dq_blueprint/manifest.json","agents/agent_dq_blueprint/heuristics/heuristics.v0.json","agents/agent_dq_blueprint/run.ps1","agents/agent_dq_blueprint/src/cli.ts","docs/agentic/templates/policy-proposal.template.yaml","docs/agentic/templates/flow-onboarding.template.yaml"],"updated":"2025-10-27T00:00:00Z"}
{"id":"kb-ado-vg-006","intent":"ado-variable-group","question":"Come creo/aggiorno il Variable Group in ADO?","tags":["ado","variables"],"steps":["pwsh scripts/ado-set-variable-group.ps1 -OrgUrl <ORG> -Project <PROJ> -Pat <PAT> -GroupName EasyWay-Secrets -VariablesJsonPath scripts/variables/easyway-secrets.sample.json -SecretsKeys 'AZURE_STORAGE_CONNECTION_STRING,DB_CONN_STRING'"],"verify":["Variable Group aggiornato"],"references":["scripts/ado-set-variable-group.ps1","scripts/variables/easyway-secrets.sample.json"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-db-docs-007","intent":"db-generate-docs","question":"Come genero ERD e catalogo SP?","tags":["db","docs"],"steps":["cd EasyWay-DataPortal/easyway-portal-api","npm run db:generate-docs"],"verify":["Wiki/EasyWayData.wiki/.../ERD.md aggiornato"],"references":["EasyWay-DataPortal/easyway-portal-api/src/tools/db/generate-docs.ts"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-db-drift-008","intent":"db-drift-check","question":"Come verifico mancanze di oggetti DB?","tags":["db","quality"],"steps":["cd EasyWay-DataPortal/easyway-portal-api","npm run db:drift"],"verify":["report.ok=true"],"references":["EasyWay-DataPortal/easyway-portal-api/src/tools/db/drift-check.ts","scripts/variables/db-required-objects.sample.json"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-branding-009","intent":"branding-upload","question":"Come carico il branding yaml in dev?","tags":["storage","branding"],"steps":["Creare container 'portal-assets'","Caricare 'config/branding.tenant01.yaml' (vedi datalake-sample) in Blob/Azurite"],"verify":["/portal/tenant/tenant01 usa colori/logo"],"references":["EasyWay-DataPortal/easyway-portal-api/datalake-sample/branding.tenant01.yaml","EasyWay-DataPortal/easyway-portal-api/src/config/brandingLoader.ts"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-db-generate-012","intent":"db-generate-artifacts","question":"Come genero DDL+SP da un mini-DSL JSON?","tags":["db","generator","dsl","flyway"],"preconditions":["Node.js installato","Template presenti in docs/agentic/templates"],"steps":["Salva il DSL in es. dsl/user.json (vedi Wiki)","node agents/core/generate-db-artifacts.js --in dsl/user.json --out db/flyway/sql","Controlla il file VYYYYMMDDHHMMSS__PORTAL_users_generated.sql","Esegui 'FlywayValidateAny' in CI o flyway validate in locale"],"verify":["File generato con DDL e SP conformi ai template","flyway validate OK"],"references":["Wiki/EasyWayData.wiki/db-generate-artifacts-dsl.md","agents/core/generate-db-artifacts.js","docs/agentic/AGENTIC_READINESS.md"],"updated":"2025-10-20T00:00:00Z"}
{"id":"kb-ci-enforcer-013","intent":"ci-enforcer-check","question":"Perché e come usare EnforcerCheck in CI?","tags":["ci","guardrail","governance"],"steps":["Aggiunge stage 'PreChecks' e job 'EnforcerCheck' in pipeline (già presente)","Il job esegue scripts/enforcer.ps1 per agent_governance, agent_docs_review, agent_pr_manager","Configura il job EnforcerCheck come 'required' nelle Branch Policies per PR verso develop/main"],"verify":["PR con modifiche fuori dagli allowed_paths fallisce su EnforcerCheck"],"references":["azure-pipelines.yml","docs/ci/ewctl-gates.md","Wiki/EasyWayData.wiki/enforcer-guardrail.md"],"updated":"2025-10-20T00:00:00Z"}
{"id":"kb-ado-required-job-014","intent":"ado-required-enforcer","question":"Come marcare EnforcerCheck come 'Required' nelle PR?","tags":["ado","branch-policies","governance"],"steps":["Repos > Branches > develop > Branch policies","Build validation > Add policy > seleziona pipeline CI","Imposta Required=ON, Automatic, salva","Ripeti per main"],"verify":["Le PR mostrano EnforcerCheck come check richiesto"],"references":["Wiki/EasyWayData.wiki/checklist-ado-required-job.md","Wiki/EasyWayData.wiki/enforcer-guardrail.md"],"updated":"2025-10-20T00:00:00Z"}
{"id":"kb-agent-priority-methodology-015","intent":"agent-priority-methodology","question":"Come adottare la metodologia priority/mandatory per tutti gli agenti?","tags":["agents","governance","methodology"],"steps":["Per ogni agente, aggiungi agents/<agent>/priority.json basato su agents/core/templates/priority.template.json","Integra gli script dell’agente con scripts/agent-priority.ps1 e mostra checklist solo quando richiesto","Aggiungi Wiki/EasyWayData.wiki/agent-priority-and-checklists.md alle knowledge_sources del manifest","Verifica in PR che la checklist compaia nei casi previsti"],"verify":["Checklists proposte solo quando le regole matchano","Branch principali e cambi DB/pipeline triggerano mandatory"],"references":["Wiki/EasyWayData.wiki/agent-priority-and-checklists.md","agents/core/schemas/agent-priority.schema.json","agents/core/templates/priority.template.json"],"updated":"2025-10-20T00:00:00Z"}
{"id":"kb-portal-demo-010","intent":"portal-login-register","question":"Come provo login & registrazione dalla demo?","tags":["portal","auth"],"steps":["Impostare AUTH_CLIENT_ID e AUTH_TENANT_ID in .env.local","Aprire http://localhost:3000/portal/app","Login con Microsoft e registrare utente"],"verify":["/api/onboarding 201","/api/users elenca l'utente"],"references":["EasyWay-DataPortal/easyway-portal-api/src/routes/portal.ts"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-dual-db-mode-030","intent":"db-dual-mode","question":"Come attivo il DB dual-mode (mock|sql) in locale?","tags":["db","dev","costs"],"steps":["Impostare DB_MODE=mock in .env.local per usare file JSON locale","Avviare l'API: cd EasyWay-DataPortal/easyway-portal-api && npm run dev","Testare: GET /api/users (serve JWT valido) restituisce i dati da data/dev-users.json","Passare a SQL impostando DB_MODE=sql e variabili DB_* (o DB_CONN_STRING)"],"verify":["Con DB_MODE=mock, crea utente e persiste in data/dev-users.json","Con DB_MODE=sql, le stesse API usano Azure SQL"],"references":["EasyWay-DataPortal/easyway-portal-api/src/repositories","EasyWay-DataPortal/easyway-portal-api/src/controllers/usersController.ts"],"updated":"2025-10-21T00:00:00Z"}
{"id":"kb-agent-first-quickstart-040","intent":"agent-first-quickstart","question":"Qual è il metodo di lavoro agent-first in EasyWay?","tags":["agents","governance","onboarding"],"steps":["Leggere agent-first-method.md e intent-contract.md nella Wiki","Usare scripts/ewctl.ps1 come entrypoint comune","Aggiornare sempre KB (agents/kb/recipes.jsonl) e una pagina Wiki con ogni modifica","Verificare gates (Checklist/DB Drift/KB Consistency) prima del merge"],"verify":["Ricetta KB e pagina Wiki aggiornate","Eventi presenti in agents/logs/events.jsonl"],"references":["AGENTS.md","Wiki/EasyWayData.wiki/agent-first-method.md","Wiki/EasyWayData.wiki/intent-contract.md"],"updated":"2025-10-21T00:00:00Z"}
{"id":"kb-agent-template-echo-050","intent":"agent-template-echo","question":"Come eseguo il template agente (sample:echo)?","tags":["agents","template"],"steps":["pwsh scripts/ewctl.ps1 --engine ps --intent sample-echo","Oppure: pwsh scripts/agent-template.ps1 -Action sample:echo -IntentPath agents/agent_template/templates/intent.sample.json -NonInteractive -LogEvent"],"verify":["Output JSON stampato a console","Riga evento in agents/logs/events.jsonl se usi -LogEvent"],"references":["agents/agent_template/README.md","scripts/agent-template.ps1"],"updated":"2025-10-21T00:00:00Z"}
{"id":"kb-agent-dba-db-user-create-060","intent":"db-user-create","question":"Come creo un utente DB (contained) con l'agente DBA?","tags":["agents","dba","security"],"steps":["Apri e adatta l'intent: agents/agent_dba/templates/intent.db-user-create.sample.json","Esegui: pwsh scripts/ewctl.ps1 --engine ps --intent db-user-create","(Anteprima) Lo script stampa output JSON con dati utente e password masked","(Passo successivo) Integrare sqlcmd e Key Vault per esecuzione reale"],"verify":["Output JSON con username/ruoli","Evento log (se -LogEvent)"],"references":["agents/agent_dba/manifest.json","scripts/agent-dba.ps1"],"updated":"2025-10-21T00:00:00Z"}
{"id":"kb-agent-dba-db-user-rotate-061","intent":"db-user-rotate","question":"Come ruoto la password di un utente DB?","tags":["agents","dba","security"],"steps":["Apri e adatta l'intent: agents/agent_dba/templates/intent.db-user-rotate.sample.json","Esegui: pwsh scripts/ewctl.ps1 --engine ps --intent db-user-rotate"],"verify":["Output JSON con executed=true (se whatIf=false)","Nuova versione secret in Key Vault se abilitato"],"references":["agents/agent_dba/manifest.json","scripts/agent-dba.ps1"],"updated":"2025-10-21T00:00:00Z"}
{"id":"kb-agent-dba-db-user-revoke-062","intent":"db-user-revoke","question":"Come revoco un utente DB?","tags":["agents","dba","security"],"steps":["Apri e adatta l'intent: agents/agent_dba/templates/intent.db-user-revoke.sample.json","Esegui: pwsh scripts/ewctl.ps1 --engine ps --intent db-user-revoke"],"verify":["Output JSON executed=true (se whatIf=false)","Utente assente in sys.database_principals"],"references":["agents/agent_dba/manifest.json","scripts/agent-dba.ps1"],"updated":"2025-10-21T00:00:00Z"}
{"id":"kb-agent-dba-db-user-create-070","intent":"db-user-create","question":"Esempio output (stateBefore/stateAfter) della creazione utente","tags":["agents","dba","examples"],"steps":["Eseguire in WhatIf per validare lo stato prima dell'applicazione"],"example_output":{"action":"db-user:create","whatIf":true,"output":{"username":"svc_tenant01_writer","roles":["portal_reader","portal_writer"],"auth":"aad","executed":false,"stateBefore":{"readerExists":true,"writerExists":true,"userExists":false,"memberReader":false,"memberWriter":false},"stateAfter":null}},"references":["scripts/agent-dba.ps1"],"updated":"2025-10-21T00:00:00Z"}
{"id":"kb-agent-dba-db-user-rotate-071","intent":"db-user-rotate","question":"Esempio output (stateBefore/stateAfter) della rotazione password","tags":["agents","dba","examples"],"steps":["Eseguire in WhatIf per vedere lo stato senza modifiche"],"example_output":{"action":"db-user:rotate","whatIf":true,"output":{"username":"svc_tenant01_writer","auth":"aad","executed":false,"stateBefore":{"readerExists":true,"writerExists":true,"userExists":true,"memberReader":true,"memberWriter":true},"stateAfter":null}},"references":["scripts/agent-dba.ps1"],"updated":"2025-10-21T00:00:00Z"}
{"id":"kb-agent-dba-db-user-revoke-072","intent":"db-user-revoke","question":"Esempio output (stateBefore/stateAfter) della revoca utente","tags":["agents","dba","examples"],"steps":["Eseguire in WhatIf per stimare l'effetto","Eseguire senza WhatIf per applicare"],"example_output":{"action":"db-user:revoke","whatIf":true,"output":{"username":"svc_tenant01_writer","auth":"aad","executed":false,"stateBefore":{"readerExists":true,"writerExists":true,"userExists":true,"memberReader":true,"memberWriter":true},"stateAfter":null}},"references":["scripts/agent-dba.ps1"],"updated":"2025-10-21T00:00:00Z"}
{"id":"kb-agent-dlk-ensure-structure-080","intent":"dlk-ensure-structure","question":"Ensure Structure (WhatIf): che output mi aspetto?","tags":["datalake","whatif","examples"],"steps":["Eseguire in WhatIf: mostra differenze (missing container/path, naming drift)","Applicare solo dopo verifica"],"example_output":{"action":"dlk-ensure-structure","whatIf":true,"output":{"changesPreview":[{"type":"create-container","name":"dlk-tenant01-raw"},{"type":"create-path","path":"raw/tenant01/landing/"}]}},"references":["Wiki/EasyWayData.wiki/datalake-ensure-structure.md"],"updated":"2025-10-21T00:00:00Z"}
{"id":"kb-agent-dlk-ensure-structure-080a","intent":"dlk-ensure-structure","question":"Come fornisco i path correnti (provider locale)?","tags":["datalake","whatif","inputs"],"steps":["Nel template aggiungi params.currentPaths oppure params.currentPathsFile","Se usi il file: JSON con { paths:["landing/tenant01/", ...] } oppure testo con un path per riga"],"verify":["L'output mostra expectedPaths e changesPreview coerenti"],"references":["Wiki/EasyWayData.wiki/datalake-ensure-structure.md","scripts/agent-datalake.ps1"],"updated":"2025-10-21T00:00:00Z"}
{"id":"kb-agent-dlk-apply-acl-081","intent":"dlk-apply-acl","question":"Apply ACL (WhatIf): che output mi aspetto?","tags":["datalake","security","whatif","examples"],"steps":["Eseguire in WhatIf: mostra ACL correnti vs proposte e conflitti"],"example_output":{"action":"dlk-apply-acl","whatIf":true,"output":{"diff":[{"path":"raw/tenant01","current":"r-x","proposed":"rwx","principal":"svc_tenant01_writer"}]}},"references":["Wiki/EasyWayData.wiki/datalake-apply-acl.md"],"updated":"2025-10-21T00:00:00Z"}
{"id":"kb-agent-dlk-set-retention-082","intent":"dlk-set-retention","question":"Retention (WhatIf): che output mi aspetto?","tags":["datalake","retention","whatif","examples"],"steps":["Eseguire in WhatIf: mostra policy proposte (path→days)","Applicare dopo verifica"],"example_output":{"action":"dlk-set-retention","whatIf":true,"output":{"policies":[{"path":"landing/","days":180,"change":"create_or_update"},{"path":"official/","days":null,"change":"noop"}]}},"references":["Wiki/EasyWayData.wiki/datalake-set-retention.md"],"updated":"2025-10-21T00:00:00Z"}
{"id":"kb-dba-verify-connect-063","intent":"dba-verify-connect","question":"Come verifico con una SELECT lo stato del DB (ruoli/utente)?","tags":["dba","verify","whatif"],"steps":["Eseguire: pwsh scripts/db-verify-connect.ps1 -ConnString $env:DB_ADMIN_CONN_STRING -CheckUser svc_tenant01_writer","Oppure AAD: pwsh scripts/db-verify-connect.ps1 -Server tcp:... -Database ... -AAD -CheckUser ..."],"verify":["ok=true","roles.reader/roles.writer valorizzati","userExists true/false"],"references":["scripts/db-verify-connect.ps1"],"updated":"2025-10-21T00:00:00Z"}
{"id":"kb-enable-rls-011","intent":"db-enable-rls","question":"Come abilito la Row-Level Security (RLS) su USERS?","tags":["db","rls"],"preconditions":["Connessione SQL con privilegi"],"steps":["sqlcmd -S <server> -d <db> -Q \"ALTER SECURITY POLICY PORTAL.RLS_TENANT_POLICY_USERS WITH (STATE = ON);\""],"verify":["SELECT * FROM sys.security_policies WHERE name='RLS_TENANT_POLICY_USERS' mostra state ON"],"references":["db/flyway/sql/V5__rls_setup.sql"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-deploy-appservice-012","intent":"deploy-appservice","question":"Come deployo l'API su Azure App Service (dev)?","tags":["deploy","azure"],"preconditions":["az login","Resource Group e App Service esistenti o permessi di creazione"],"steps":["az webapp up -n <appName> -g <rg> -l westeurope --runtime \"NODE|20-lts\"","az webapp config appsettings set -g <rg> -n <appName> --settings AUTH_ISSUER=... AUTH_JWKS_URI=... AUTH_CLIENT_ID=... AUTH_TENANT_ID=... DB_CONN_STRING=... AZURE_STORAGE_CONNECTION_STRING=... BRANDING_CONTAINER=portal-assets BRANDING_PREFIX=config","az webapp restart -g <rg> -n <appName>"],"verify":["curl https://<appName>.azurewebsites.net/api/health -> 401 (auth richiesta)","/portal risponde"],"references":["EasyWay-DataPortal/easyway-portal-api/README.md"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-teams-check-013","intent":"teams-post-checklist","question":"Come invio l'esito Checklist su Teams?","tags":["teams","checklist"],"preconditions":["Teams Incoming Webhook URL"],"steps":["pwsh scripts/checklist.ps1 -JsonOnly","curl -H 'Content-Type: application/json' -d @EasyWay-DataPortal/easyway-portal-api/checklist.json <TEAMS_WEBHOOK_URL>"],"verify":["Messaggio ricevuto nel canale Teams"],"references":["scripts/checklist.ps1","azure-pipelines.yml"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-portal-basepath-014","intent":"set-portal-base-path","question":"Come cambio il base path del mini‑portale?","tags":["portal","config"],"steps":["Impostare PORTAL_BASE_PATH=/myportal in .env.local o App Settings","Riavviare l'applicazione"],"verify":["GET http://localhost:3000/myportal risponde"],"references":["EasyWay-DataPortal/easyway-portal-api/src/app.ts","EasyWay-DataPortal/easyway-portal-api/src/routes/portal.ts","Wiki/EasyWayData.wiki/PARAMETRIZATION_BEST_PRACTICES.md"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-rate-limit-015","intent":"set-rate-limit","question":"Come imposto il rate limit a 120 richieste/minuto?","tags":["security","config"],"steps":["Impostare RATE_LIMIT_WINDOW_MS=60000 e RATE_LIMIT_MAX=120 in .env.local o App Settings","Riavviare l'applicazione"],"verify":["Verificare con test di carico che oltre 120 req/min riceva 429"],"references":["EasyWay-DataPortal/easyway-portal-api/src/app.ts","Wiki/EasyWayData.wiki/PARAMETRIZATION_BEST_PRACTICES.md"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-log-dir-016","intent":"set-log-dir","question":"Come cambio la cartella dei log dell'API?","tags":["logging","config"],"steps":["Impostare LOG_DIR (es. LOG_DIR=logs_dev) in .env.local oppure come App Setting su App Service","Riavviare l'applicazione"],"verify":["Verificare la creazione di <LOG_DIR>/business.log.json ed <LOG_DIR>/error.log.json"],"references":["EasyWay-DataPortal/easyway-portal-api/src/utils/logger.ts","EasyWay-DataPortal/easyway-portal-api/README.md","Wiki/EasyWayData.wiki/PARAMETRIZATION_BEST_PRACTICES.md"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-toggle-gates-017","intent":"toggle-pipeline-gates","question":"Come abilito/disabilito rapidamente i gates in pipeline (Checklist/Drift/KB)?","tags":["pipeline","ado","governance"],"steps":["In Azure DevOps → Pipelines → Run pipeline: aggiungere le variabili ENABLE_CHECKLIST, ENABLE_DB_DRIFT, ENABLE_KB_CONSISTENCY con valori 'true'/'false'","Oppure modificare temporaneamente azure-pipelines.yml impostando le variabili sotto 'variables:'","(Opzionale) Spostare i toggle in un Variable Group per gestione centralizzata e ricaricarli nella pipeline"],"verify":["Esecuzione mostra/skip dei job corrispondenti secondo le condizioni"],"references":["azure-pipelines.yml","ci/versions.yml","Wiki/EasyWayData.wiki/PARAMETRIZATION_BEST_PRACTICES.md"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-ado-rest-toggle-018","intent":"ado-toggle-gates-rest","question":"Come aggiorno i toggle dei gates (ENABLE_CHECKLIST/DB_DRIFT/KB_CONSISTENCY) via REST API di Azure DevOps?","tags":["pipeline","ado","rest","governance"],"preconditions":["PAT ADO con permesso Variable Groups","OrgUrl e Project"],"steps":["$pat='<PAT>'; $org='https://dev.azure.com/<org>'; $project='<project>'; $group='EasyWay-Secrets'","# PowerShell (consigliato):","pwsh scripts/ado-set-variable-group.ps1 -OrgUrl $org -Project $project -Pat $pat -GroupName $group -Variables @{ ENABLE_CHECKLIST='true'; ENABLE_DB_DRIFT='false'; ENABLE_KB_CONSISTENCY='true' }","# REST raw (curl):","# 1) Basic auth header: echo -n :$PAT | base64","# 2) GET id del Variable Group: GET $org/$project/_apis/distributedtask/variablegroups?api-version=7.1-preview.2","# 3) PUT il body aggiornato (includendo tutte le variabili esistenti + i toggle):","curl -H 'Authorization: Basic <base64(:PAT)>' -H 'Content-Type: application/json' -X PUT -d @body.json $org/$project/_apis/distributedtask/variablegroups/<VG_ID>?api-version=7.1-preview.2"],"verify":["Nuova esecuzione di pipeline rispetta i toggle (job condizionati)"],"references":["scripts/ado-set-variable-group.ps1","azure-pipelines.yml","Wiki/EasyWayData.wiki/PARAMETRIZATION_BEST_PRACTICES.md"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-update-versions-019","intent":"ci-update-tool-versions","question":"Come aggiorno le versioni di Node/Flyway/Terraform usate in CI?","tags":["ci","versions","governance"],"steps":["Aprire ci/versions.yml","Aggiornare node_version (es. '22.x'), flyway_version (es. '9.22.3'), terraform_version (es. '1.9.5')","Salvare e aprire PR","Verificare nei log pipeline che NodeTool/Flyway/Installer usino le nuove versioni"],"verify":["Task NodeTool@0 usa $(node_version)","Job Flyway install scarica la versione aggiornata","(Se configurato) terraform usa la versione attesa"],"references":["ci/versions.yml","azure-pipelines.yml"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-enable-otel-020","intent":"enable-otel","question":"Come abilito OpenTelemetry + Application Insights in Dev/Test?","tags":["observability","otel","appinsights"],"steps":["Creare/recuperare un Application Insights e copiare la Connection String","Impostare in .env.local: APPLICATIONINSIGHTS_CONNECTION_STRING=<conn>, OTEL_ENABLED=true","(Opzionale) OTEL_RESOURCE_ATTRIBUTES=service.name=easyway-portal-api,service.namespace=easyway,deployment.environment=dev","Riavviare l'app","Verificare in App Insights: requests/dependencies visibili"],"verify":["requests | order by timestamp desc","dependencies | where type in ('SQL','http')"],"references":["EasyWay-DataPortal/easyway-portal-api/src/observability/tracing.ts","EasyWay-DataPortal/easyway-portal-api/.env.example","Wiki/EasyWayData.wiki/EasyWay_WebApp/05_codice_easyway_portale/security-and-observability.md"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-deploy-stage-021","intent":"enable-deploy-stage","question":"Come abilito lo stage di Deploy su Azure App Service?","tags":["deploy","azure","pipeline"],"steps":["Creare una Service Connection in ADO (Azure RM) e definire WEBAPP_NAME/RESOURCE_GROUP","Aggiungere in Variable Group: AZURE_SERVICE_CONNECTION, WEBAPP_NAME, RESOURCE_GROUP","Impostare ENABLE_DEPLOY=true (variabile pipeline)","Eseguire la pipeline; verificare lo stage Deploy"],"verify":["App Service risponde a /portal e /api/docs"],"references":["azure-pipelines.yml","EasyWay-DataPortal/easyway-portal-api/README.md"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-deploy-stage-toggle-022","intent":"deploy-stage-toggle","question":"Come abilito/disabilito rapidamente lo stage Deploy?","tags":["deploy","pipeline","toggle"],"steps":["Impostare ENABLE_DEPLOY=true/false nella pipeline (Run pipeline) oppure nel Variable Group","Definire AZURE_SERVICE_CONNECTION, WEBAPP_NAME, RESOURCE_GROUP","(Opzionale) WEBAPP_SLOT per deployment su slot"],"verify":["Lo stage Deploy appare/scompare ed esegue il deploy quando abilitato"],"references":["azure-pipelines.yml"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-deploy-slot-swap-023","intent":"deploy-slot-swap","question":"Come deployo su uno slot e poi swappo controllatamente?","tags":["deploy","slot","azure"],"steps":["Impostare ENABLE_DEPLOY=true","Definire AZURE_SERVICE_CONNECTION, WEBAPP_NAME, RESOURCE_GROUP","Impostare WEBAPP_SLOT=staging","(Facoltativo) Abilitare ENABLE_SWAP=true per eseguire lo swap verso production"],"verify":["Verificare su Azure Portal che lo slot staging sia aggiornato e (se abilitato) lo swap completato"],"references":["azure-pipelines.yml"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-test-mock-jwt-024","intent":"test-mock-jwt","question":"Come eseguo un test positivo con JWT mockato?","tags":["test","jwt","supertest"],"steps":["Eseguire 'npm test' in EasyWay-DataPortal/easyway-portal-api","Il test __tests__/auth_positive.test.ts genera una coppia di chiavi e imposta AUTH_TEST_JWKS in env per validare localmente","Il token include il claim 'ew_tenant_id' e consente di accedere a /api/health"],"verify":["I test passano (200 su /api/health con token valido)"],"references":["EasyWay-DataPortal/easyway-portal-api/src/middleware/auth.ts","EasyWay-DataPortal/easyway-portal-api/__tests__/auth_positive.test.ts"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-starter-appsettings-026","intent":"apply-appsettings-starter","question":"Come applico lo starter JSON degli App Settings via Azure CLI e REST ARM?","tags":["deploy","appsettings","azure","cli","rest"],"preconditions":["az login","Permessi su Resource Group/WebApp"],"steps":["# Azure CLI (singole chiavi):","az webapp config appsettings set -g <RESOURCE_GROUP> -n <WEBAPP_NAME> --settings AUTH_ISSUER=https://login.microsoftonline.com/<TENANT_ID>/v2.0 AUTH_JWKS_URI=https://login.microsoftonline.com/<TENANT_ID>/discovery/v2.0/keys DEFAULT_TENANT_ID=tenant01 PORTAL_BASE_PATH=/portal","# Azure CLI (da file JSON key=value): creare appsettings.json con { \"name\":\"KEY\",\"value\":\"VAL\" } in array, quindi:","az webapp config appsettings set -g <RESOURCE_GROUP> -n <WEBAPP_NAME> --settings @appsettings.json","# REST ARM (via az rest):","az rest --method POST --uri https://management.azure.com/subscriptions/<SUB_ID>/resourceGroups/<RESOURCE_GROUP>/providers/Microsoft.Web/sites/<WEBAPP_NAME>/config/appsettings?api-version=2022-03-01 --body '{"properties": {"AUTH_ISSUER": "https://login.microsoftonline.com/<TENANT_ID>/v2.0", "AUTH_JWKS_URI": "https://login.microsoftonline.com/<TENANT_ID>/discovery/v2.0/keys", "DEFAULT_TENANT_ID": "tenant01", "PORTAL_BASE_PATH": "/portal"}}'"],"verify":["In Azure Portal → Configuration compaiono le nuove chiavi","L'app usa i valori aggiornati (riavvio automatico o forzato)"],"references":["Wiki/EasyWayData.wiki/DEPLOY_APP_SERVICE.md","azure-pipelines.yml"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-generate-appsettings-027","intent":"generate-appsettings-from-env","question":"Come genero appsettings.json a partire da .env.local (per flusso agentico)?","tags":["deploy","appsettings","automation"],"steps":["pwsh scripts/generate-appsettings.ps1 -ApiPath EasyWay-DataPortal/easyway-portal-api -OutDir ./out","Verranno creati: out/appsettings.cli.json (per az CLI) e out/appsettings.task.json (per AzureAppServiceSettings@1)","Applicare con: az webapp config appsettings set --settings @out/appsettings.cli.json oppure usare il file task nella pipeline"],"verify":["File generati e applicati; App Service mostra le chiavi in Configuration"],"references":["scripts/generate-appsettings.ps1","Wiki/EasyWayData.wiki/DEPLOY_APP_SERVICE.md"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-sync-appsettings-guardrail-028","intent":"sync-appsettings-guardrail","question":"Come supero il guardrail per sincronizzare App Settings su main/prod?","tags":["deploy","governance","appsettings"],"steps":["In Azure DevOps → Run pipeline, impostare ENABLE_SYNC_APPSETTINGS=true","Se il branch è main o ENVIRONMENT=prod, impostare anche GOV_APPROVED=true (approvazione Governance)","Impostare AZURE_SERVICE_CONNECTION, WEBAPP_NAME, RESOURCE_GROUP, (opz.) WEBAPP_SLOT","Eseguire pipeline; il job 'Sync App Settings from .env.local' verrà eseguito in sicurezza"],"verify":["Il job di Sync viene eseguito solo con GOV_APPROVED=true su main/prod","App Service mostra le chiavi aggiornate"],"references":["azure-pipelines.yml","Wiki/EasyWayData.wiki/DEPLOY_APP_SERVICE.md"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-activity-gov-approved-029","intent":"activity-gov-approved","question":"Come leggo gli eventi con approvazione Governance (govApproved=true) via API?","tags":["activity","audit","ams"],"steps":["# Bash + jq:","curl -s http://localhost:3000/api/docs/activity.json | jq '[ .[] | select(.govApproved=="true") ]'","# PowerShell:","(Invoke-RestMethod -Uri 'http://localhost:3000/api/docs/activity.json') | Where-Object { $_.govApproved -eq 'true' } | ConvertTo-Json -Depth 5"],"verify":["La risposta contiene solo eventi con govApproved=true (badge ✅ nel log)"],"references":["EasyWay-DataPortal/easyway-portal-api/src/routes/docs.ts","Wiki/EasyWayData.wiki/ACTIVITY_LOG.md"],"updated":"2025-10-19T00:00:00Z"}
{"id":"kb-scrummaster-seed-boards-031","intent":"scrummaster-seed-boards","question":"Come eseguo il seed di Epics/Features su Azure Boards dal repo?","tags":["scrum","boards","ado","governance"],"preconditions":["az CLI installato","Estensione azure-devops","Login az (o PAT)","OrgUrl e Project configurati"],"steps":["# Dry‑run (anteprima):","pwsh scripts/ado/boards-seed.ps1 -DryRun","# Esecuzione reale:","pwsh scripts/ado/boards-seed.ps1 -OrgUrl https://dev.azure.com/<org> -Project <project>","# (Opz.) Impostare Area/Iteration:","pwsh scripts/ado/boards-seed.ps1 -OrgUrl https://dev.azure.com/<org> -Project <project> -AreaPath '<project>\\Area' -IterationPath '<project>\\Sprint 1'"],"verify":["Output: Created/Exists per Epics F0–F5 e Features","In Azure Boards le Features sono collegate (Parent) ai rispettivi Epics"],"references":["scripts/ado/boards-seed.ps1","scripts/ado/README.md","Wiki/EasyWayData.wiki/agents-scrummaster.md"],"updated":"2025-10-20T00:00:00Z"}
{"id":"kb-scrummaster-update-links-032","intent":"scrummaster-update-boards-links","question":"Come verifico e sistemo i link Feature→Epic in Azure Boards?","tags":["scrum","boards","ado","governance"],"preconditions":["az CLI + estensione azure-devops","OrgUrl/Project impostati"],"steps":["# Set defaults (una tantum):","az devops configure --defaults organization=https://dev.azure.com/<org> project=<project>","# Trovare Feature senza Parent (WIQL):","az boards query --wiql \"SELECT [System.Id] FROM WorkItems WHERE [System.WorkItemType]='Feature' AND [System.TeamProject]=@project AND [System.Parent] IS NULL\"","# Collegare una Feature a un Epic (esempi):","az boards work-item relation add --id <FeatureId> --relation-type System.LinkTypes.Hierarchy-Reverse --target-id <EpicId>","# PowerShell (batch):","$features = (az boards query --wiql \"SELECT [System.Id] FROM WorkItems WHERE [System.WorkItemType]='Feature' AND [System.TeamProject]=@project AND [System.Parent] IS NULL\" --output json | ConvertFrom-Json).workItems","foreach($f in $features){ az boards work-item relation add --id $f.id --relation-type System.LinkTypes.Hierarchy-Reverse --target-id <EpicId> }"],"verify":["Le Feature mostrano il Parent corretto","La query WIQL precedente ritorna 0 elementi"],"references":["scripts/ado/README.md","Wiki/EasyWayData.wiki/agents-scrummaster.md"],"updated":"2025-10-20T00:00:00Z"}
{"id":"kb-scrummaster-close-sprint-033","intent":"scrummaster-close-sprint","question":"Come chiudo uno sprint e sposto il lavoro residuo al prossimo?","tags":["scrum","boards","ado"],"preconditions":["Iterazioni create (es. Sprint 1, Sprint 2)","Permission su Boards"],"steps":["# Defaults:","az devops configure --defaults organization=https://dev.azure.com/<org> project=<project>","# Elencare item non-Done nell'iterazione corrente:","az boards query --wiql \"SELECT [System.Id],[System.Title] FROM WorkItems WHERE [System.IterationPath] UNDER '<project>\\<team>\\Sprint 1' AND [System.State] <> 'Done'\"","# Spostare i work item alla prossima iterazione (esempio singolo):","az boards work-item update --id <WI_ID> --fields \"System.IterationPath=<project>\\<team>\\Sprint 2\"","# PowerShell (batch move):","$wi = (az boards query --wiql \"SELECT [System.Id] FROM WorkItems WHERE [System.IterationPath] UNDER '<project>\\<team>\\Sprint 1' AND [System.State] <> 'Done'\" --output json | ConvertFrom-Json).workItems","foreach($w in $wi){ az boards work-item update --id $w.id --fields \"System.IterationPath=<project>\\<team>\\Sprint 2\" }"],"verify":["Backlog Sprint 1 contiene solo 'Done'","Backlog Sprint 2 contiene i work item spostati"],"references":["scripts/ado/README.md","Wiki/EasyWayData.wiki/agents-scrummaster.md"],"updated":"2025-10-20T00:00:00Z"}
{"id":"kb-docs-001","intent":"wiki-normalize-review","question":"Come eseguo la normalizzazione e review della Wiki?","tags":["docs","wiki","lint"],"preconditions":null,"steps":["pwsh scripts/agent-docs-review.ps1 -Wiki","pwsh Wiki/EasyWayData.wiki/scripts/normalize-project.ps1 -Root Wiki/EasyWayData.wiki -EnsureFrontMatter","pwsh Wiki/EasyWayData.wiki/scripts/review-run.ps1 -Root Wiki/EasyWayData.wiki -Mode kebab -CheckAnchors","pwsh Wiki/EasyWayData.wiki/scripts/generate-master-index.ps1 -Root Wiki/EasyWayData.wiki","pwsh Wiki/EasyWayData.wiki/scripts/export-chunks-jsonl.ps1 -Root Wiki/EasyWayData.wiki","pwsh Wiki/EasyWayData.wiki/scripts/lint-atomicity.ps1 -Root Wiki/EasyWayData.wiki"],"verify":["Nessun errore nel naming/anchor check","Artefatti e report generati in Wiki/EasyWayData.wiki/logs/reports"],"rollback":null,"outputs":null,"references":["Wiki/EasyWayData.wiki/scripts/scripts.md"],"updated":"2025-10-20T10:05:23.3293144Z"}
{"id":"kb-agent-dlk-ensure-structure-080b","intent":"dlk-ensure-structure","question":"C'è un file di esempio per currentPaths?","tags":["datalake","whatif","inputs"],"steps":["Usa: agents/agent_datalake/templates/currentPaths.sample.json","Imposta params.currentPathsFile a quel percorso nel tuo intent"],"verify":["Vedi changesPreview generata in base ai path di esempio"],"references":["agents/agent_datalake/templates/currentPaths.sample.json"],"updated":"2025-10-21T00:00:00Z"}
{"id":"kb-etl-bootstrap-100","intent":"etl-pipeline-bootstrap","question":"Come avvio la documentazione di una nuova pipeline ETL/ELT?","tags":["etl","playbook","template"],"steps":["Apri il Template: Wiki/EasyWayData.wiki/etl-elt-template.md e duplica la pagina","Compila sezioni Sorgente, Naming/Partizionamento, Mapping, DQ, Schedule, Monitoraggio, Audit","Collega la pagina alla sezione Indice e al Playbook"],"verify":["Pagina creata con front matter completo","Sezioni minime compilate","Link dal Playbook e dall'Indice"],"references":["Wiki/EasyWayData.wiki/etl-elt-playbook.md","Wiki/EasyWayData.wiki/etl-elt-template.md","Wiki/EasyWayData.wiki/docs-conventions.md"],"updated":"2025-10-26T00:00:00Z"}
{"id":"kb-etl-tech-choices-101","intent":"etl-technology-choices","question":"Quali tecnologie uso per orchestrazione/esecuzione?","tags":["etl","tech","choices"],"steps":["Per dev: Airflow (Small, managed) + Databricks (job cluster piccolo, auto-terminate)","Per copy semplici: ADF Copy/Mapping Data Flow","Per orchestrazioni complesse: Airflow","Per ELT compute-intensive: Databricks"],"verify":["Decisione esplicitata nella pagina Scelte Tecnologiche","Guardrail di costo e governance elencati"],"references":["Wiki/EasyWayData.wiki/etl-elt-technology-choices.md"],"updated":"2025-10-26T00:00:00Z"}
{"id":"kb-etl-logging-102","intent":"etl-logging-audit","question":"Come traccio l'esecuzione delle pipeline (audit log)?","tags":["etl","audit","logging"],"steps":["Scrivere log esecuzione in portal-audit/etl-execution-logs/ con chiavi minime","Registrare status, tempi, KPI volumetrici, correlation id","Linkare ai log tecnici di dettaglio (Log Analytics / Storage)"],"verify":["File/log presenti per ogni run","Dashboard/reader possono ricostruire stato e trend"],"references":["Wiki/EasyWayData.wiki/etl-elt-playbook.md","Wiki/EasyWayData.wiki/easyway-webapp/03-datalake-dev.md"],"updated":"2025-10-26T00:00:00Z"}
{"id":"kb-etl-dq-bootstrap-103","intent":"etl-dq-bootstrap","question":"Come definisco e documento le regole DQ della pipeline?","tags":["etl","dq","playbook"],"steps":["Parti da ETL – DQ Framework","Compila in pagina per-pipeline le regole per classe (completezza, formato, dominio, range, unicità, referenziale)","Definisci severità e gestione scarti (invalidrows)"],"verify":["Regole elencate e mappate alla pipeline","Esito DQ documentato (OK/BLOCKED)"],"references":["Wiki/EasyWayData.wiki/etl-dq-framework.md","Wiki/EasyWayData.wiki/etl-elt-template.md"],"updated":"2025-10-26T00:00:00Z"}
{"id":"kb-etl-table-log-104","intent":"etl-table-log","question":"Come strutturo i log delle esecuzioni ETL?","tags":["etl","logging","audit"],"steps":["Definisci le tabelle/file di log (workflow, run, task_run, metric, alert)","Assicura che gli agenti scrivano Output Contract con summary/stato/tempi/KPI","Collega i log tecnici di dettaglio con correlation id"],"verify":["Query operative: ultimo stato, fallimenti 24h, stuck, SLA breaches, throughput"],"references":["Wiki/EasyWayData.wiki/etl-table-log-model.md","Wiki/EasyWayData.wiki/etl-elt-playbook.md"],"updated":"2025-10-26T00:00:00Z"}
{"id":"kb-etl-governance-sla-106","intent":"etl-governance-sla","question":"Come definisco SLA/SLO ed escalation per una pipeline?","tags":["etl","sla","governance"],"steps":["Definire SLI (puntualità, success, throughput, DQ, latency)","Assegnare SLO per tier (1/2/3) e RTO/RPO","Stabilire error budget e gating (Doc Alignment, Output Validation, WhatIf)","Mappare alerting ed escalation per severity e canali","Pubblicare runbook di fallback e collegare dashboard"],"verify":["SLO versionati in repo","Alerting attivo","Runbook accessibili"],"references":["Wiki/EasyWayData.wiki/etl-governance-sla.md","Wiki/EasyWayData.wiki/output-contract.md","Wiki/EasyWayData.wiki/doc-alignment-gate.md"],"updated":"2025-10-26T00:00:00Z"}
{"id":"kb-etl-slo-validate-107","intent":"etl-slo-validate","question":"Come valido la SLO spec di una pipeline?","tags":["etl","sla","slo"],"steps":["Parti dal sample JSON: agents/agent_datalake/templates/slo/slo.sample.json","Imposta il path nel template intent: agents/agent_datalake/templates/intent.etl-slo-validate.sample.json","Esegui: pwsh scripts/ewctl.ps1 --engine ps --intent etl-slo-validate"],"verify":["Output JSON ok=true se campi minimi presenti","In caso contrario, 'missing' elenca i campi da completare"],"references":["Wiki/EasyWayData.wiki/etl-governance-sla.md","scripts/agent-datalake.ps1"],"updated":"2025-10-26T00:00:00Z"}
