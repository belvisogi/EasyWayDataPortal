{
  "role": "Agent_Datalake",
  "description": "Gestione operativa e compliance del Datalake: naming, ACL, audit, retention, export log, policy.",
  "allowed_paths": {
    "read": [
      "EasyWay_WebApp/03_datalake_dev/**",
      "infra/terraform/**",
      "scripts/pwsh/agent-datalake.ps1",
      "agents/kb/recipes.jsonl"
    ],
    "write": [
      "agents/agent_datalake/memory/",
      "agents/logs/"
    ]
  },
  "allowed_tools": [
    "pwsh",
    "azcopy",
    "terraform"
  ],
  "required_gates": [
    "Datalake_Compliance",
    "KB_Consistency"
  ],
  "approvals": {},
  "knowledge_sources": [
    {
      "priority": "medium",
      "type": "document",
      "path": "EasyWay_WebApp/03_datalake_dev/easyway-dataportal-standard-accesso-storage-e-datalake-iam-and-naming.md"
    },
    {
      "priority": "medium",
      "type": "data",
      "path": "agents/kb/recipes.jsonl"
    }
  ],
  "actions": [
    {
      "name": "dlk-ensure-structure",
      "description": "Verifica e applica struttura/naming del Datalake (WhatIf di default)",
      "params": {
        "subscriptionId": {
          "type": "string",
          "required": true
        },
        "resourceGroup": {
          "type": "string",
          "required": true
        },
        "storageAccount": {
          "type": "string",
          "required": true
        },
        "filesystem": {
          "type": "string",
          "required": true
        },
        "tenantId": {
          "type": "string",
          "required": true
        },
        "dryRun": {
          "type": "boolean",
          "required": false
        }
      }
    },
    {
      "name": "dlk-apply-acl",
      "description": "Calcola e applica ACL su path del Datalake (WhatIf di default)",
      "params": {
        "subscriptionId": {
          "type": "string",
          "required": true
        },
        "resourceGroup": {
          "type": "string",
          "required": true
        },
        "storageAccount": {
          "type": "string",
          "required": true
        },
        "filesystem": {
          "type": "string",
          "required": true
        },
        "path": {
          "type": "string",
          "required": true
        },
        "acl": {
          "type": "array",
          "items": {
            "type": "object"
          },
          "required": true
        },
        "dryRun": {
          "type": "boolean",
          "required": false
        }
      }
    },
    {
      "name": "dlk-set-retention",
      "description": "Imposta/verifica policy di retention su filesystem/path (WhatIf di default)",
      "params": {
        "subscriptionId": {
          "type": "string",
          "required": true
        },
        "resourceGroup": {
          "type": "string",
          "required": true
        },
        "storageAccount": {
          "type": "string",
          "required": true
        },
        "filesystem": {
          "type": "string",
          "required": true
        },
        "rules": {
          "type": "array",
          "items": {
            "type": "object"
          },
          "required": true
        },
        "dryRun": {
          "type": "boolean",
          "required": false
        }
      }
    },
    {
      "name": "dlk-export-log",
      "description": "Esporta log su Datalake/Storage con naming/retention (WhatIf di default)",
      "params": {
        "subscriptionId": {
          "type": "string",
          "required": true
        },
        "resourceGroup": {
          "type": "string",
          "required": true
        },
        "storageAccount": {
          "type": "string",
          "required": true
        },
        "filesystem": {
          "type": "string",
          "required": true
        },
        "source": {
          "type": "string",
          "required": true
        },
        "targetPath": {
          "type": "string",
          "required": true
        },
        "schedule": {
          "type": "string",
          "required": false
        },
        "dryRun": {
          "type": "boolean",
          "required": false
        }
      }
    },
    {
      "name": "etl-slo:validate",
      "description": "Valida la presenza e i campi minimi della SLO spec per una pipeline (stub, WhatIf)",
      "params": {
        "specPath": {
          "type": "string",
          "required": true
        }
      }
    }
  ],
  "name": "agent_datalake",
  "readme": "README.md",
  "classification": "arm",
  "id": "agent_datalake",
  "owner": "team-platform",
  "version": "1.0.0",
  "evolution_level": 1,
  "context_config": {
    "memory_files": [
      "agents/kb/recipes.jsonl"
    ],
    "context_limit_tokens": 128000,
    "enable_memory": true
  },
  "skills_required": [],
  "llm_config": {
    "provider": "openai",
    "model": "gpt-4o",
    "temperature": 0.0,
    "system_prompt": "agents/agent_datalake/PROMPTS.md",
    "tools": [
      "function_calling"
    ]
  },
  "error_handling": {
    "fallback_mode": "log_and_skip",
    "alert_on_failure": false,
    "retry_delay_seconds": 15,
    "retry_count": 2
  },
  "skills_optional": [
    "utilities.json-validate",
    "utilities.retry-backoff"
  ]
}
